var $e=Object.defineProperty;var Ke=(n,e,t)=>e in n?$e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var we=(n,e,t)=>(Ke(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const main="",fontAwesome="";function makeMap(n,e){const t=Object.create(null),r=n.split(",");for(let s=0;s<r.length;s++)t[r[s]]=!0;return e?s=>!!t[s.toLowerCase()]:s=>!!t[s]}function normalizeStyle(n){if(isArray$1(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=isString(r)?parseStringStyle(r):normalizeStyle(r);if(s)for(const a in s)e[a]=s[a]}return e}else{if(isString(n))return n;if(isObject(n))return n}}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*.*?\*\//gs;function parseStringStyle(n){const e={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(t=>{if(t){const r=t.split(propertyDelimiterRE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function normalizeClass(n){let e="";if(isString(n))e=n;else if(isArray$1(n))for(let t=0;t<n.length;t++){const r=normalizeClass(n[t]);r&&(e+=r+" ")}else if(isObject(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}const toDisplayString=n=>isString(n)?n:n==null?"":isArray$1(n)||isObject(n)&&(n.toString===objectToString||!isFunction(n.toString))?JSON.stringify(n,replacer,2):String(n),replacer=(n,e)=>e&&e.__v_isRef?replacer(n,e.value):isMap(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s])=>(t[`${r} =>`]=s,t),{})}:isSet(e)?{[`Set(${e.size})`]:[...e.values()]}:isObject(e)&&!isArray$1(e)&&!isPlainObject(e)?String(e):e,EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=n=>onRE.test(n),isModelListener=n=>n.startsWith("onUpdate:"),extend=Object.assign,remove=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(n,e)=>hasOwnProperty$1.call(n,e),isArray$1=Array.isArray,isMap=n=>toTypeString(n)==="[object Map]",isSet=n=>toTypeString(n)==="[object Set]",isFunction=n=>typeof n=="function",isString=n=>typeof n=="string",isSymbol=n=>typeof n=="symbol",isObject=n=>n!==null&&typeof n=="object",isPromise$1=n=>isObject(n)&&isFunction(n.then)&&isFunction(n.catch),objectToString=Object.prototype.toString,toTypeString=n=>objectToString.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(e,t)=>t?t.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,e)=>!Object.is(n,e),invokeArrayFns=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},def=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},looseToNumber=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let activeEffectScope;class EffectScope{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!e&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=activeEffectScope;try{return activeEffectScope=this,e()}finally{activeEffectScope=t}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function recordEffectScope(n,e=activeEffectScope){e&&e.active&&e.effects.push(n)}function getCurrentScope(){return activeEffectScope}const createDep=n=>{const e=new Set(n);return e.w=0,e.n=0,e},wasTracked=n=>(n.w&trackOpBit)>0,newTracked=n=>(n.n&trackOpBit)>0,initDepMarkers=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=trackOpBit},finalizeDepMarkers=n=>{const{deps:e}=n;if(e.length){let t=0;for(let r=0;r<e.length;r++){const s=e[r];wasTracked(s)&&!newTracked(s)?s.delete(n):e[t++]=s,s.w&=~trackOpBit,s.n&=~trackOpBit}e.length=t}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,r)}run(){if(!this.active)return this.fn();let e=activeEffect,t=shouldTrack;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function track(n,e,t){if(shouldTrack&&activeEffect){let r=targetMap.get(n);r||targetMap.set(n,r=new Map);let s=r.get(t);s||r.set(t,s=createDep()),trackEffects(s)}}function trackEffects(n,e){let t=!1;effectTrackDepth<=maxMarkerBits?newTracked(n)||(n.n|=trackOpBit,t=!wasTracked(n)):t=!n.has(activeEffect),t&&(n.add(activeEffect),activeEffect.deps.push(n))}function trigger(n,e,t,r,s,a){const i=targetMap.get(n);if(!i)return;let o=[];if(e==="clear")o=[...i.values()];else if(t==="length"&&isArray$1(n)){const u=Number(r);i.forEach((l,c)=>{(c==="length"||c>=u)&&o.push(l)})}else switch(t!==void 0&&o.push(i.get(t)),e){case"add":isArray$1(n)?isIntegerKey(t)&&o.push(i.get("length")):(o.push(i.get(ITERATE_KEY)),isMap(n)&&o.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$1(n)||(o.push(i.get(ITERATE_KEY)),isMap(n)&&o.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(n)&&o.push(i.get(ITERATE_KEY));break}if(o.length===1)o[0]&&triggerEffects(o[0]);else{const u=[];for(const l of o)l&&u.push(...l);triggerEffects(createDep(u))}}function triggerEffects(n,e){const t=isArray$1(n)?n:[...n];for(const r of t)r.computed&&triggerEffect(r);for(const r of t)r.computed||triggerEffect(r)}function triggerEffect(n,e){(n!==activeEffect||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol)),get$1=createGetter(),shallowGet=createGetter(!1,!0),readonlyGet=createGetter(!0),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=toRaw(this);for(let a=0,i=this.length;a<i;a++)track(r,"get",a+"");const s=r[e](...t);return s===-1||s===!1?r[e](...t.map(toRaw)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){pauseTracking();const r=toRaw(this)[e].apply(this,t);return resetTracking(),r}}),n}function hasOwnProperty(n){const e=toRaw(this);return track(e,"has",n),e.hasOwnProperty(n)}function createGetter(n=!1,e=!1){return function(r,s,a){if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&a===(n?e?shallowReadonlyMap:readonlyMap:e?shallowReactiveMap:reactiveMap).get(r))return r;const i=isArray$1(r);if(!n){if(i&&hasOwn(arrayInstrumentations,s))return Reflect.get(arrayInstrumentations,s,a);if(s==="hasOwnProperty")return hasOwnProperty}const o=Reflect.get(r,s,a);return(isSymbol(s)?builtInSymbols.has(s):isNonTrackableKeys(s))||(n||track(r,"get",s),e)?o:isRef(o)?i&&isIntegerKey(s)?o:o.value:isObject(o)?n?readonly(o):reactive(o):o}}const set$1=createSetter(),shallowSet=createSetter(!0);function createSetter(n=!1){return function(t,r,s,a){let i=t[r];if(isReadonly(i)&&isRef(i)&&!isRef(s))return!1;if(!n&&(!isShallow(s)&&!isReadonly(s)&&(i=toRaw(i),s=toRaw(s)),!isArray$1(t)&&isRef(i)&&!isRef(s)))return i.value=s,!0;const o=isArray$1(t)&&isIntegerKey(r)?Number(r)<t.length:hasOwn(t,r),u=Reflect.set(t,r,s,a);return t===toRaw(a)&&(o?hasChanged(s,i)&&trigger(t,"set",r,s):trigger(t,"add",r,s)),u}}function deleteProperty(n,e){const t=hasOwn(n,e);n[e];const r=Reflect.deleteProperty(n,e);return r&&t&&trigger(n,"delete",e,void 0),r}function has$1(n,e){const t=Reflect.has(n,e);return(!isSymbol(e)||!builtInSymbols.has(e))&&track(n,"has",e),t}function ownKeys$1(n){return track(n,"iterate",isArray$1(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}const mutableHandlers={get:get$1,set:set$1,deleteProperty,has:has$1,ownKeys:ownKeys$1},readonlyHandlers={get:readonlyGet,set(n,e){return!0},deleteProperty(n,e){return!0}},shallowReactiveHandlers=extend({},mutableHandlers,{get:shallowGet,set:shallowSet}),toShallow=n=>n,getProto=n=>Reflect.getPrototypeOf(n);function get(n,e,t=!1,r=!1){n=n.__v_raw;const s=toRaw(n),a=toRaw(e);t||(e!==a&&track(s,"get",e),track(s,"get",a));const{has:i}=getProto(s),o=r?toShallow:t?toReadonly:toReactive;if(i.call(s,e))return o(n.get(e));if(i.call(s,a))return o(n.get(a));n!==s&&n.get(e)}function has$2(n,e=!1){const t=this.__v_raw,r=toRaw(t),s=toRaw(n);return e||(n!==s&&track(r,"has",n),track(r,"has",s)),n===s?t.has(n):t.has(n)||t.has(s)}function size(n,e=!1){return n=n.__v_raw,!e&&track(toRaw(n),"iterate",ITERATE_KEY),Reflect.get(n,"size",n)}function add(n){n=toRaw(n);const e=toRaw(this);return getProto(e).has.call(e,n)||(e.add(n),trigger(e,"add",n,n)),this}function set(n,e){e=toRaw(e);const t=toRaw(this),{has:r,get:s}=getProto(t);let a=r.call(t,n);a||(n=toRaw(n),a=r.call(t,n));const i=s.call(t,n);return t.set(n,e),a?hasChanged(e,i)&&trigger(t,"set",n,e):trigger(t,"add",n,e),this}function deleteEntry(n){const e=toRaw(this),{has:t,get:r}=getProto(e);let s=t.call(e,n);s||(n=toRaw(n),s=t.call(e,n)),r&&r.call(e,n);const a=e.delete(n);return s&&trigger(e,"delete",n,void 0),a}function clear(){const n=toRaw(this),e=n.size!==0,t=n.clear();return e&&trigger(n,"clear",void 0,void 0),t}function createForEach(n,e){return function(r,s){const a=this,i=a.__v_raw,o=toRaw(i),u=e?toShallow:n?toReadonly:toReactive;return!n&&track(o,"iterate",ITERATE_KEY),i.forEach((l,c)=>r.call(s,u(l),u(c),a))}}function createIterableMethod(n,e,t){return function(...r){const s=this.__v_raw,a=toRaw(s),i=isMap(a),o=n==="entries"||n===Symbol.iterator&&i,u=n==="keys"&&i,l=s[n](...r),c=t?toShallow:e?toReadonly:toReactive;return!e&&track(a,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:d,done:f}=l.next();return f?{value:d,done:f}:{value:o?[c(d[0]),c(d[1])]:c(d),done:f}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...e){return n==="delete"?!1:this}}function createInstrumentations(){const n={get(a){return get(this,a)},get size(){return size(this)},has:has$2,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},e={get(a){return get(this,a,!1,!0)},get size(){return size(this)},has:has$2,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},t={get(a){return get(this,a,!0)},get size(){return size(this,!0)},has(a){return has$2.call(this,a,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},r={get(a){return get(this,a,!0,!0)},get size(){return size(this,!0)},has(a){return has$2.call(this,a,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{n[a]=createIterableMethod(a,!1,!1),t[a]=createIterableMethod(a,!0,!1),e[a]=createIterableMethod(a,!1,!0),r[a]=createIterableMethod(a,!0,!0)}),[n,t,e,r]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(n,e){const t=e?n?shallowReadonlyInstrumentations:shallowInstrumentations:n?readonlyInstrumentations:mutableInstrumentations;return(r,s,a)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(hasOwn(t,s)&&s in r?t:r,s,a)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(n,e,t,r,s){if(!isObject(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const a=s.get(n);if(a)return a;const i=getTargetType(n);if(i===0)return n;const o=new Proxy(n,i===2?r:t);return s.set(n,o),o}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return isReactive(n)||isReadonly(n)}function toRaw(n){const e=n&&n.__v_raw;return e?toRaw(e):n}function markRaw(n){return def(n,"__v_skip",!0),n}const toReactive=n=>isObject(n)?reactive(n):n,toReadonly=n=>isObject(n)?readonly(n):n;function trackRefValue(n){shouldTrack&&activeEffect&&(n=toRaw(n),trackEffects(n.dep||(n.dep=createDep())))}function triggerRefValue(n,e){n=toRaw(n);const t=n.dep;t&&triggerEffects(t)}function isRef(n){return!!(n&&n.__v_isRef===!0)}function ref(n){return createRef(n,!1)}function shallowRef(n){return createRef(n,!0)}function createRef(n,e){return isRef(n)?n:new RefImpl(n,e)}class RefImpl{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:toRaw(e),this._value=t?e:toReactive(e)}get value(){return trackRefValue(this),this._value}set value(e){const t=this.__v_isShallow||isShallow(e)||isReadonly(e);e=t?e:toRaw(e),hasChanged(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:toReactive(e),triggerRefValue(this))}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,e,t)=>unref(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return isRef(s)&&!isRef(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}var _a$1;class ComputedRefImpl{constructor(e,t,r,s){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[_a$1]=!1,this._dirty=!0,this.effect=new ReactiveEffect(e,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=toRaw(this);return trackRefValue(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}_a$1="__v_isReadonly";function computed$1(n,e,t=!1){let r,s;const a=isFunction(n);return a?(r=n,s=NOOP):(r=n.get,s=n.set),new ComputedRefImpl(r,s,a||!s,t)}function warn(n,...e){}function callWithErrorHandling(n,e,t,r){let s;try{s=r?n(...r):n()}catch(a){handleError(a,e,t)}return s}function callWithAsyncErrorHandling(n,e,t,r){if(isFunction(n)){const a=callWithErrorHandling(n,e,t,r);return a&&isPromise$1(a)&&a.catch(i=>{handleError(i,e,t)}),a}const s=[];for(let a=0;a<n.length;a++)s.push(callWithAsyncErrorHandling(n[a],e,t,r));return s}function handleError(n,e,t,r=!0){const s=e?e.vnode:null;if(e){let a=e.parent;const i=e.proxy,o=t;for(;a;){const l=a.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](n,i,o)===!1)return}a=a.parent}const u=e.appContext.config.errorHandler;if(u){callWithErrorHandling(u,null,10,[n,i,o]);return}}logError(n,t,s,r)}function logError(n,e,t,r=!0){console.error(n)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(n){const e=currentFlushPromise||resolvedPromise;return n?e.then(this?n.bind(this):n):e}function findInsertionIndex(n){let e=flushIndex+1,t=queue.length;for(;e<t;){const r=e+t>>>1;getId(queue[r])<n?e=r+1:t=r}return e}function queueJob(n){(!queue.length||!queue.includes(n,isFlushing&&n.allowRecurse?flushIndex+1:flushIndex))&&(n.id==null?queue.push(n):queue.splice(findInsertionIndex(n.id),0,n),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(n){const e=queue.indexOf(n);e>flushIndex&&queue.splice(e,1)}function queuePostFlushCb(n){isArray$1(n)?pendingPostFlushCbs.push(...n):(!activePostFlushCbs||!activePostFlushCbs.includes(n,n.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(n),queueFlush()}function flushPreFlushCbs(n,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const t=queue[e];t&&t.pre&&(queue.splice(e,1),e--,t())}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...e);return}for(activePostFlushCbs=e,activePostFlushCbs.sort((t,r)=>getId(t)-getId(r)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?1/0:n.id,comparator=(n,e)=>{const t=getId(n)-getId(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function flushJobs(n){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const e=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const t=queue[flushIndex];t&&t.active!==!1&&callWithErrorHandling(t,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||EMPTY_OBJ;let s=t;const a=e.startsWith("update:"),i=a&&e.slice(7);if(i&&i in r){const c=`${i==="modelValue"?"model":i}Modifiers`,{number:d,trim:f}=r[c]||EMPTY_OBJ;f&&(s=t.map(g=>isString(g)?g.trim():g)),d&&(s=t.map(looseToNumber))}let o,u=r[o=toHandlerKey(e)]||r[o=toHandlerKey(camelize(e))];!u&&a&&(u=r[o=toHandlerKey(hyphenate(e))]),u&&callWithAsyncErrorHandling(u,n,6,s);const l=r[o+"Once"];if(l){if(!n.emitted)n.emitted={};else if(n.emitted[o])return;n.emitted[o]=!0,callWithAsyncErrorHandling(l,n,6,s)}}function normalizeEmitsOptions(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const a=n.emits;let i={},o=!1;if(!isFunction(n)){const u=l=>{const c=normalizeEmitsOptions(l,e,!0);c&&(o=!0,extend(i,c))};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!a&&!o?(isObject(n)&&r.set(n,null),null):(isArray$1(a)?a.forEach(u=>i[u]=null):extend(i,a),isObject(n)&&r.set(n,i),i)}function isEmitListener(n,e){return!n||!isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),hasOwn(n,e[0].toLowerCase()+e.slice(1))||hasOwn(n,hyphenate(e))||hasOwn(n,e))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const e=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,e}function pushScopeId(n){currentScopeId=n}function popScopeId(){currentScopeId=null}function withCtx(n,e=currentRenderingInstance,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&setBlockTracking(-1);const a=setCurrentRenderingInstance(e);let i;try{i=n(...s)}finally{setCurrentRenderingInstance(a),r._d&&setBlockTracking(1)}return i};return r._n=!0,r._c=!0,r._d=!0,r}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:e,vnode:t,proxy:r,withProxy:s,props:a,propsOptions:[i],slots:o,attrs:u,emit:l,render:c,renderCache:d,data:f,setupState:g,ctx:m,inheritAttrs:v}=n;let y,E;const _=setCurrentRenderingInstance(n);try{if(t.shapeFlag&4){const S=s||r;y=normalizeVNode(c.call(S,S,d,a,g,f,m)),E=u}else{const S=e;y=normalizeVNode(S.length>1?S(a,{attrs:u,slots:o,emit:l}):S(a,null)),E=e.props?u:getFunctionalFallthrough(u)}}catch(S){blockStack.length=0,handleError(S,n,1),y=createVNode(Comment)}let T=y;if(E&&v!==!1){const S=Object.keys(E),{shapeFlag:x}=T;S.length&&x&7&&(i&&S.some(isModelListener)&&(E=filterModelListeners(E,i)),T=cloneVNode(T,E))}return t.dirs&&(T=cloneVNode(T),T.dirs=T.dirs?T.dirs.concat(t.dirs):t.dirs),t.transition&&(T.transition=t.transition),y=T,setCurrentRenderingInstance(_),y}const getFunctionalFallthrough=n=>{let e;for(const t in n)(t==="class"||t==="style"||isOn(t))&&((e||(e={}))[t]=n[t]);return e},filterModelListeners=(n,e)=>{const t={};for(const r in n)(!isModelListener(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function shouldUpdateComponent(n,e,t){const{props:r,children:s,component:a}=n,{props:i,children:o,patchFlag:u}=e,l=a.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&u>=0){if(u&1024)return!0;if(u&16)return r?hasPropsChanged(r,i,l):!!i;if(u&8){const c=e.dynamicProps;for(let d=0;d<c.length;d++){const f=c[d];if(i[f]!==r[f]&&!isEmitListener(l,f))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:r===i?!1:r?i?hasPropsChanged(r,i,l):!0:!!i;return!1}function hasPropsChanged(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const a=r[s];if(e[a]!==n[a]&&!isEmitListener(t,a))return!0}return!1}function updateHOCHostEl({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,e){e&&e.pendingBranch?isArray$1(n)?e.effects.push(...n):e.effects.push(n):queuePostFlushCb(n)}function provide(n,e){if(currentInstance){let t=currentInstance.provides;const r=currentInstance.parent&&currentInstance.parent.provides;r===t&&(t=currentInstance.provides=Object.create(r)),t[n]=e}}function inject(n,e,t=!1){const r=currentInstance||currentRenderingInstance;if(r){const s=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&n in s)return s[n];if(arguments.length>1)return t&&isFunction(e)?e.call(r.proxy):e}}const INITIAL_WATCHER_VALUE={};function watch(n,e,t){return doWatch(n,e,t)}function doWatch(n,e,{immediate:t,deep:r,flush:s,onTrack:a,onTrigger:i}=EMPTY_OBJ){const o=getCurrentScope()===(currentInstance==null?void 0:currentInstance.scope)?currentInstance:null;let u,l=!1,c=!1;if(isRef(n)?(u=()=>n.value,l=isShallow(n)):isReactive(n)?(u=()=>n,r=!0):isArray$1(n)?(c=!0,l=n.some(T=>isReactive(T)||isShallow(T)),u=()=>n.map(T=>{if(isRef(T))return T.value;if(isReactive(T))return traverse(T);if(isFunction(T))return callWithErrorHandling(T,o,2)})):isFunction(n)?e?u=()=>callWithErrorHandling(n,o,2):u=()=>{if(!(o&&o.isUnmounted))return d&&d(),callWithAsyncErrorHandling(n,o,3,[f])}:u=NOOP,e&&r){const T=u;u=()=>traverse(T())}let d,f=T=>{d=E.onStop=()=>{callWithErrorHandling(T,o,4)}},g;if(isInSSRComponentSetup)if(f=NOOP,e?t&&callWithAsyncErrorHandling(e,o,3,[u(),c?[]:void 0,f]):u(),s==="sync"){const T=useSSRContext();g=T.__watcherHandles||(T.__watcherHandles=[])}else return NOOP;let m=c?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const v=()=>{if(E.active)if(e){const T=E.run();(r||l||(c?T.some((S,x)=>hasChanged(S,m[x])):hasChanged(T,m)))&&(d&&d(),callWithAsyncErrorHandling(e,o,3,[T,m===INITIAL_WATCHER_VALUE?void 0:c&&m[0]===INITIAL_WATCHER_VALUE?[]:m,f]),m=T)}else E.run()};v.allowRecurse=!!e;let y;s==="sync"?y=v:s==="post"?y=()=>queuePostRenderEffect(v,o&&o.suspense):(v.pre=!0,o&&(v.id=o.uid),y=()=>queueJob(v));const E=new ReactiveEffect(u,y);e?t?v():m=E.run():s==="post"?queuePostRenderEffect(E.run.bind(E),o&&o.suspense):E.run();const _=()=>{E.stop(),o&&o.scope&&remove(o.scope.effects,E)};return g&&g.push(_),_}function instanceWatch(n,e,t){const r=this.proxy,s=isString(n)?n.includes(".")?createPathGetter(r,n):()=>r[n]:n.bind(r,r);let a;isFunction(e)?a=e:(a=e.handler,t=e);const i=currentInstance;setCurrentInstance(this);const o=doWatch(s,a.bind(r),t);return i?setCurrentInstance(i):unsetCurrentInstance(),o}function createPathGetter(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}function traverse(n,e){if(!isObject(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),isRef(n))traverse(n.value,e);else if(isArray$1(n))for(let t=0;t<n.length;t++)traverse(n[t],e);else if(isSet(n)||isMap(n))n.forEach(t=>{traverse(t,e)});else if(isPlainObject(n))for(const t in n)traverse(n[t],e);return n}function defineComponent(n){return isFunction(n)?{setup:n,name:n.name}:n}const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,e){registerKeepAliveHook(n,"a",e)}function onDeactivated(n,e){registerKeepAliveHook(n,"da",e)}function registerKeepAliveHook(n,e,t=currentInstance){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(injectHook(e,r,t),t){let s=t.parent;for(;s&&s.parent;)isKeepAlive(s.parent.vnode)&&injectToKeepAliveRoot(r,e,t,s),s=s.parent}}function injectToKeepAliveRoot(n,e,t,r){const s=injectHook(e,n,r,!0);onUnmounted(()=>{remove(r[e],s)},t)}function injectHook(n,e,t=currentInstance,r=!1){if(t){const s=t[n]||(t[n]=[]),a=e.__weh||(e.__weh=(...i)=>{if(t.isUnmounted)return;pauseTracking(),setCurrentInstance(t);const o=callWithAsyncErrorHandling(e,t,n,i);return unsetCurrentInstance(),resetTracking(),o});return r?s.unshift(a):s.push(a),a}}const createHook=n=>(e,t=currentInstance)=>(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...r)=>e(...r),t),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,e=currentInstance){injectHook("ec",n,e)}function invokeDirectiveHook(n,e,t,r){const s=n.dirs,a=e&&e.dirs;for(let i=0;i<s.length;i++){const o=s[i];a&&(o.oldValue=a[i].value);let u=o.dir[r];u&&(pauseTracking(),callWithAsyncErrorHandling(u,t,8,[n.el,o,n,e]),resetTracking())}}const COMPONENTS="components";function resolveComponent(n,e){return resolveAsset(COMPONENTS,n,!0,e)||n}const NULL_DYNAMIC_COMPONENT=Symbol();function resolveDynamicComponent(n){return isString(n)?resolveAsset(COMPONENTS,n,!1)||n:n||NULL_DYNAMIC_COMPONENT}function resolveAsset(n,e,t=!0,r=!1){const s=currentRenderingInstance||currentInstance;if(s){const a=s.type;if(n===COMPONENTS){const o=getComponentName(a,!1);if(o&&(o===e||o===camelize(e)||o===capitalize(camelize(e))))return a}const i=resolve(s[n]||a[n],e)||resolve(s.appContext[n],e);return!i&&r?a:i}}function resolve(n,e){return n&&(n[e]||n[camelize(e)]||n[capitalize(camelize(e))])}function renderList(n,e,t,r){let s;const a=t&&t[r];if(isArray$1(n)||isString(n)){s=new Array(n.length);for(let i=0,o=n.length;i<o;i++)s[i]=e(n[i],i,void 0,a&&a[i])}else if(typeof n=="number"){s=new Array(n);for(let i=0;i<n;i++)s[i]=e(i+1,i,void 0,a&&a[i])}else if(isObject(n))if(n[Symbol.iterator])s=Array.from(n,(i,o)=>e(i,o,void 0,a&&a[o]));else{const i=Object.keys(n);s=new Array(i.length);for(let o=0,u=i.length;o<u;o++){const l=i[o];s[o]=e(n[l],l,o,a&&a[o])}}else s=[];return t&&(t[r]=s),s}function renderSlot(n,e,t={},r,s){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return e!=="default"&&(t.name=e),createVNode("slot",t,r&&r());let a=n[e];a&&a._c&&(a._d=!1),openBlock();const i=a&&ensureValidVNode(a(t)),o=createBlock(Fragment$1,{key:t.key||i&&i.key||`_${e}`},i||(r?r():[]),i&&n._===1?64:-2);return!s&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),a&&a._c&&(a._d=!0),o}function ensureValidVNode(n){return n.some(e=>isVNode(e)?!(e.type===Comment||e.type===Fragment$1&&!ensureValidVNode(e.children)):!0)?n:null}const getPublicInstance=n=>n?isStatefulComponent(n)?getExposeProxy(n)||n.proxy:getPublicInstance(n.parent):null,publicPropertiesMap=extend(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>queueJob(n.update)),$nextTick:n=>n.n||(n.n=nextTick.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,e)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn(n,e),PublicInstanceProxyHandlers={get({_:n},e){const{ctx:t,setupState:r,data:s,props:a,accessCache:i,type:o,appContext:u}=n;let l;if(e[0]!=="$"){const g=i[e];if(g!==void 0)switch(g){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return a[e]}else{if(hasSetupBinding(r,e))return i[e]=1,r[e];if(s!==EMPTY_OBJ&&hasOwn(s,e))return i[e]=2,s[e];if((l=n.propsOptions[0])&&hasOwn(l,e))return i[e]=3,a[e];if(t!==EMPTY_OBJ&&hasOwn(t,e))return i[e]=4,t[e];shouldCacheAccess&&(i[e]=0)}}const c=publicPropertiesMap[e];let d,f;if(c)return e==="$attrs"&&track(n,"get",e),c(n);if((d=o.__cssModules)&&(d=d[e]))return d;if(t!==EMPTY_OBJ&&hasOwn(t,e))return i[e]=4,t[e];if(f=u.config.globalProperties,hasOwn(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:a}=n;return hasSetupBinding(s,e)?(s[e]=t,!0):r!==EMPTY_OBJ&&hasOwn(r,e)?(r[e]=t,!0):hasOwn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(a[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:a}},i){let o;return!!t[i]||n!==EMPTY_OBJ&&hasOwn(n,i)||hasSetupBinding(e,i)||(o=a[0])&&hasOwn(o,i)||hasOwn(r,i)||hasOwn(publicPropertiesMap,i)||hasOwn(s.config.globalProperties,i)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:hasOwn(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};let shouldCacheAccess=!0;function applyOptions(n){const e=resolveMergedOptions(n),t=n.proxy,r=n.ctx;shouldCacheAccess=!1,e.beforeCreate&&callHook(e.beforeCreate,n,"bc");const{data:s,computed:a,methods:i,watch:o,provide:u,inject:l,created:c,beforeMount:d,mounted:f,beforeUpdate:g,updated:m,activated:v,deactivated:y,beforeDestroy:E,beforeUnmount:_,destroyed:T,unmounted:S,render:x,renderTracked:b,renderTriggered:A,errorCaptured:R,serverPrefetch:C,expose:w,inheritAttrs:I,components:L,directives:D,filters:O}=e;if(l&&resolveInjections(l,r,null,n.appContext.config.unwrapInjectedRef),i)for(const H in i){const j=i[H];isFunction(j)&&(r[H]=j.bind(t))}if(s){const H=s.call(t,t);isObject(H)&&(n.data=reactive(H))}if(shouldCacheAccess=!0,a)for(const H in a){const j=a[H],q=isFunction(j)?j.bind(t,t):isFunction(j.get)?j.get.bind(t,t):NOOP,Q=!isFunction(j)&&isFunction(j.set)?j.set.bind(t):NOOP,U=computed({get:q,set:Q});Object.defineProperty(r,H,{enumerable:!0,configurable:!0,get:()=>U.value,set:$=>U.value=$})}if(o)for(const H in o)createWatcher(o[H],r,t,H);if(u){const H=isFunction(u)?u.call(t):u;Reflect.ownKeys(H).forEach(j=>{provide(j,H[j])})}c&&callHook(c,n,"c");function F(H,j){isArray$1(j)?j.forEach(q=>H(q.bind(t))):j&&H(j.bind(t))}if(F(onBeforeMount,d),F(onMounted,f),F(onBeforeUpdate,g),F(onUpdated,m),F(onActivated,v),F(onDeactivated,y),F(onErrorCaptured,R),F(onRenderTracked,b),F(onRenderTriggered,A),F(onBeforeUnmount,_),F(onUnmounted,S),F(onServerPrefetch,C),isArray$1(w))if(w.length){const H=n.exposed||(n.exposed={});w.forEach(j=>{Object.defineProperty(H,j,{get:()=>t[j],set:q=>t[j]=q})})}else n.exposed||(n.exposed={});x&&n.render===NOOP&&(n.render=x),I!=null&&(n.inheritAttrs=I),L&&(n.components=L),D&&(n.directives=D)}function resolveInjections(n,e,t=NOOP,r=!1){isArray$1(n)&&(n=normalizeInject(n));for(const s in n){const a=n[s];let i;isObject(a)?"default"in a?i=inject(a.from||s,a.default,!0):i=inject(a.from||s):i=inject(a),isRef(i)&&r?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function callHook(n,e,t){callWithAsyncErrorHandling(isArray$1(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function createWatcher(n,e,t,r){const s=r.includes(".")?createPathGetter(t,r):()=>t[r];if(isString(n)){const a=e[n];isFunction(a)&&watch(s,a)}else if(isFunction(n))watch(s,n.bind(t));else if(isObject(n))if(isArray$1(n))n.forEach(a=>createWatcher(a,e,t,r));else{const a=isFunction(n.handler)?n.handler.bind(t):e[n.handler];isFunction(a)&&watch(s,a,n)}}function resolveMergedOptions(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:a,config:{optionMergeStrategies:i}}=n.appContext,o=a.get(e);let u;return o?u=o:!s.length&&!t&&!r?u=e:(u={},s.length&&s.forEach(l=>mergeOptions$1(u,l,i,!0)),mergeOptions$1(u,e,i)),isObject(e)&&a.set(e,u),u}function mergeOptions$1(n,e,t,r=!1){const{mixins:s,extends:a}=e;a&&mergeOptions$1(n,a,t,!0),s&&s.forEach(i=>mergeOptions$1(n,i,t,!0));for(const i in e)if(!(r&&i==="expose")){const o=internalOptionMergeStrats[i]||t&&t[i];n[i]=o?o(n[i],e[i]):e[i]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeObjectOptions,emits:mergeObjectOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,e){return e?n?function(){return extend(isFunction(n)?n.call(this,this):n,isFunction(e)?e.call(this,this):e)}:e:n}function mergeInject(n,e){return mergeObjectOptions(normalizeInject(n),normalizeInject(e))}function normalizeInject(n){if(isArray$1(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function mergeAsArray(n,e){return n?[...new Set([].concat(n,e))]:e}function mergeObjectOptions(n,e){return n?extend(extend(Object.create(null),n),e):e}function mergeWatchOptions(n,e){if(!n)return e;if(!e)return n;const t=extend(Object.create(null),n);for(const r in e)t[r]=mergeAsArray(n[r],e[r]);return t}function initProps(n,e,t,r=!1){const s={},a={};def(a,InternalObjectKey,1),n.propsDefaults=Object.create(null),setFullProps(n,e,s,a);for(const i in n.propsOptions[0])i in s||(s[i]=void 0);t?n.props=r?s:shallowReactive(s):n.type.props?n.props=s:n.props=a,n.attrs=a}function updateProps(n,e,t,r){const{props:s,attrs:a,vnode:{patchFlag:i}}=n,o=toRaw(s),[u]=n.propsOptions;let l=!1;if((r||i>0)&&!(i&16)){if(i&8){const c=n.vnode.dynamicProps;for(let d=0;d<c.length;d++){let f=c[d];if(isEmitListener(n.emitsOptions,f))continue;const g=e[f];if(u)if(hasOwn(a,f))g!==a[f]&&(a[f]=g,l=!0);else{const m=camelize(f);s[m]=resolvePropValue(u,o,m,g,n,!1)}else g!==a[f]&&(a[f]=g,l=!0)}}}else{setFullProps(n,e,s,a)&&(l=!0);let c;for(const d in o)(!e||!hasOwn(e,d)&&((c=hyphenate(d))===d||!hasOwn(e,c)))&&(u?t&&(t[d]!==void 0||t[c]!==void 0)&&(s[d]=resolvePropValue(u,o,d,void 0,n,!0)):delete s[d]);if(a!==o)for(const d in a)(!e||!hasOwn(e,d))&&(delete a[d],l=!0)}l&&trigger(n,"set","$attrs")}function setFullProps(n,e,t,r){const[s,a]=n.propsOptions;let i=!1,o;if(e)for(let u in e){if(isReservedProp(u))continue;const l=e[u];let c;s&&hasOwn(s,c=camelize(u))?!a||!a.includes(c)?t[c]=l:(o||(o={}))[c]=l:isEmitListener(n.emitsOptions,u)||(!(u in r)||l!==r[u])&&(r[u]=l,i=!0)}if(a){const u=toRaw(t),l=o||EMPTY_OBJ;for(let c=0;c<a.length;c++){const d=a[c];t[d]=resolvePropValue(s,u,d,l[d],n,!hasOwn(l,d))}}return i}function resolvePropValue(n,e,t,r,s,a){const i=n[t];if(i!=null){const o=hasOwn(i,"default");if(o&&r===void 0){const u=i.default;if(i.type!==Function&&isFunction(u)){const{propsDefaults:l}=s;t in l?r=l[t]:(setCurrentInstance(s),r=l[t]=u.call(null,e),unsetCurrentInstance())}else r=u}i[0]&&(a&&!o?r=!1:i[1]&&(r===""||r===hyphenate(t))&&(r=!0))}return r}function normalizePropsOptions(n,e,t=!1){const r=e.propsCache,s=r.get(n);if(s)return s;const a=n.props,i={},o=[];let u=!1;if(!isFunction(n)){const c=d=>{u=!0;const[f,g]=normalizePropsOptions(d,e,!0);extend(i,f),g&&o.push(...g)};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!a&&!u)return isObject(n)&&r.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray$1(a))for(let c=0;c<a.length;c++){const d=camelize(a[c]);validatePropName(d)&&(i[d]=EMPTY_OBJ)}else if(a)for(const c in a){const d=camelize(c);if(validatePropName(d)){const f=a[c],g=i[d]=isArray$1(f)||isFunction(f)?{type:f}:Object.assign({},f);if(g){const m=getTypeIndex(Boolean,g.type),v=getTypeIndex(String,g.type);g[0]=m>-1,g[1]=v<0||m<v,(m>-1||hasOwn(g,"default"))&&o.push(d)}}}const l=[i,o];return isObject(n)&&r.set(n,l),l}function validatePropName(n){return n[0]!=="$"}function getType(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function isSameType(n,e){return getType(n)===getType(e)}function getTypeIndex(n,e){return isArray$1(e)?e.findIndex(t=>isSameType(t,n)):isFunction(e)&&isSameType(e,n)?0:-1}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray$1(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot$1=(n,e,t)=>{if(e._n)return e;const r=withCtx((...s)=>normalizeSlotValue(e(...s)),t);return r._c=!1,r},normalizeObjectSlots=(n,e,t)=>{const r=n._ctx;for(const s in n){if(isInternalKey(s))continue;const a=n[s];if(isFunction(a))e[s]=normalizeSlot$1(s,a,r);else if(a!=null){const i=normalizeSlotValue(a);e[s]=()=>i}}},normalizeVNodeSlots=(n,e)=>{const t=normalizeSlotValue(e);n.slots.default=()=>t},initSlots=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=toRaw(e),def(e,"_",t)):normalizeObjectSlots(e,n.slots={})}else n.slots={},e&&normalizeVNodeSlots(n,e);def(n.slots,InternalObjectKey,1)},updateSlots=(n,e,t)=>{const{vnode:r,slots:s}=n;let a=!0,i=EMPTY_OBJ;if(r.shapeFlag&32){const o=e._;o?t&&o===1?a=!1:(extend(s,e),!t&&o===1&&delete s._):(a=!e.$stable,normalizeObjectSlots(e,s)),i=e}else e&&(normalizeVNodeSlots(n,e),i={default:1});if(a)for(const o in s)!isInternalKey(o)&&!(o in i)&&delete s[o]};function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,e){return function(r,s=null){isFunction(r)||(r=Object.assign({},r)),s!=null&&!isObject(s)&&(s=null);const a=createAppContext(),i=new Set;let o=!1;const u=a.app={_uid:uid$1++,_component:r,_props:s,_container:null,_context:a,_instance:null,version,get config(){return a.config},set config(l){},use(l,...c){return i.has(l)||(l&&isFunction(l.install)?(i.add(l),l.install(u,...c)):isFunction(l)&&(i.add(l),l(u,...c))),u},mixin(l){return a.mixins.includes(l)||a.mixins.push(l),u},component(l,c){return c?(a.components[l]=c,u):a.components[l]},directive(l,c){return c?(a.directives[l]=c,u):a.directives[l]},mount(l,c,d){if(!o){const f=createVNode(r,s);return f.appContext=a,c&&e?e(f,l):n(f,l,d),o=!0,u._container=l,l.__vue_app__=u,getExposeProxy(f.component)||f.component.proxy}},unmount(){o&&(n(null,u._container),delete u._container.__vue_app__)},provide(l,c){return a.provides[l]=c,u}};return u}}function setRef(n,e,t,r,s=!1){if(isArray$1(n)){n.forEach((f,g)=>setRef(f,e&&(isArray$1(e)?e[g]:e),t,r,s));return}if(isAsyncWrapper(r)&&!s)return;const a=r.shapeFlag&4?getExposeProxy(r.component)||r.component.proxy:r.el,i=s?null:a,{i:o,r:u}=n,l=e&&e.r,c=o.refs===EMPTY_OBJ?o.refs={}:o.refs,d=o.setupState;if(l!=null&&l!==u&&(isString(l)?(c[l]=null,hasOwn(d,l)&&(d[l]=null)):isRef(l)&&(l.value=null)),isFunction(u))callWithErrorHandling(u,o,12,[i,c]);else{const f=isString(u),g=isRef(u);if(f||g){const m=()=>{if(n.f){const v=f?hasOwn(d,u)?d[u]:c[u]:u.value;s?isArray$1(v)&&remove(v,a):isArray$1(v)?v.includes(a)||v.push(a):f?(c[u]=[a],hasOwn(d,u)&&(d[u]=c[u])):(u.value=[a],n.k&&(c[n.k]=u.value))}else f?(c[u]=i,hasOwn(d,u)&&(d[u]=i)):g&&(u.value=i,n.k&&(c[n.k]=i))};i?(m.id=-1,queuePostRenderEffect(m,t)):m()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,e){const t=getGlobalThis();t.__VUE__=!0;const{insert:r,remove:s,patchProp:a,createElement:i,createText:o,createComment:u,setText:l,setElementText:c,parentNode:d,nextSibling:f,setScopeId:g=NOOP,insertStaticContent:m}=n,v=(k,P,M,Y=null,Z=null,ee=null,oe=!1,re=null,se=!!P.dynamicChildren)=>{if(k===P)return;k&&!isSameVNodeType(k,P)&&(Y=B(k),$(k,Z,ee,!0),k=null),P.patchFlag===-2&&(se=!1,P.dynamicChildren=null);const{type:J,ref:le,shapeFlag:ue}=P;switch(J){case Text:y(k,P,M,Y);break;case Comment:E(k,P,M,Y);break;case Static:k==null&&_(P,M,Y,oe);break;case Fragment$1:L(k,P,M,Y,Z,ee,oe,re,se);break;default:ue&1?x(k,P,M,Y,Z,ee,oe,re,se):ue&6?D(k,P,M,Y,Z,ee,oe,re,se):(ue&64||ue&128)&&J.process(k,P,M,Y,Z,ee,oe,re,se,X)}le!=null&&Z&&setRef(le,k&&k.ref,ee,P||k,!P)},y=(k,P,M,Y)=>{if(k==null)r(P.el=o(P.children),M,Y);else{const Z=P.el=k.el;P.children!==k.children&&l(Z,P.children)}},E=(k,P,M,Y)=>{k==null?r(P.el=u(P.children||""),M,Y):P.el=k.el},_=(k,P,M,Y)=>{[k.el,k.anchor]=m(k.children,P,M,Y,k.el,k.anchor)},T=({el:k,anchor:P},M,Y)=>{let Z;for(;k&&k!==P;)Z=f(k),r(k,M,Y),k=Z;r(P,M,Y)},S=({el:k,anchor:P})=>{let M;for(;k&&k!==P;)M=f(k),s(k),k=M;s(P)},x=(k,P,M,Y,Z,ee,oe,re,se)=>{oe=oe||P.type==="svg",k==null?b(P,M,Y,Z,ee,oe,re,se):C(k,P,Z,ee,oe,re,se)},b=(k,P,M,Y,Z,ee,oe,re)=>{let se,J;const{type:le,props:ue,shapeFlag:de,transition:pe,dirs:ge}=k;if(se=k.el=i(k.type,ee,ue&&ue.is,ue),de&8?c(se,k.children):de&16&&R(k.children,se,null,Y,Z,ee&&le!=="foreignObject",oe,re),ge&&invokeDirectiveHook(k,null,Y,"created"),A(se,k,k.scopeId,oe,Y),ue){for(const ve in ue)ve!=="value"&&!isReservedProp(ve)&&a(se,ve,null,ue[ve],ee,k.children,Y,Z,W);"value"in ue&&a(se,"value",null,ue.value),(J=ue.onVnodeBeforeMount)&&invokeVNodeHook(J,Y,k)}ge&&invokeDirectiveHook(k,null,Y,"beforeMount");const ye=(!Z||Z&&!Z.pendingBranch)&&pe&&!pe.persisted;ye&&pe.beforeEnter(se),r(se,P,M),((J=ue&&ue.onVnodeMounted)||ye||ge)&&queuePostRenderEffect(()=>{J&&invokeVNodeHook(J,Y,k),ye&&pe.enter(se),ge&&invokeDirectiveHook(k,null,Y,"mounted")},Z)},A=(k,P,M,Y,Z)=>{if(M&&g(k,M),Y)for(let ee=0;ee<Y.length;ee++)g(k,Y[ee]);if(Z){let ee=Z.subTree;if(P===ee){const oe=Z.vnode;A(k,oe,oe.scopeId,oe.slotScopeIds,Z.parent)}}},R=(k,P,M,Y,Z,ee,oe,re,se=0)=>{for(let J=se;J<k.length;J++){const le=k[J]=re?cloneIfMounted(k[J]):normalizeVNode(k[J]);v(null,le,P,M,Y,Z,ee,oe,re)}},C=(k,P,M,Y,Z,ee,oe)=>{const re=P.el=k.el;let{patchFlag:se,dynamicChildren:J,dirs:le}=P;se|=k.patchFlag&16;const ue=k.props||EMPTY_OBJ,de=P.props||EMPTY_OBJ;let pe;M&&toggleRecurse(M,!1),(pe=de.onVnodeBeforeUpdate)&&invokeVNodeHook(pe,M,P,k),le&&invokeDirectiveHook(P,k,M,"beforeUpdate"),M&&toggleRecurse(M,!0);const ge=Z&&P.type!=="foreignObject";if(J?w(k.dynamicChildren,J,re,M,Y,ge,ee):oe||j(k,P,re,null,M,Y,ge,ee,!1),se>0){if(se&16)I(re,P,ue,de,M,Y,Z);else if(se&2&&ue.class!==de.class&&a(re,"class",null,de.class,Z),se&4&&a(re,"style",ue.style,de.style,Z),se&8){const ye=P.dynamicProps;for(let ve=0;ve<ye.length;ve++){const xe=ye[ve],z=ue[xe],te=de[xe];(te!==z||xe==="value")&&a(re,xe,z,te,Z,k.children,M,Y,W)}}se&1&&k.children!==P.children&&c(re,P.children)}else!oe&&J==null&&I(re,P,ue,de,M,Y,Z);((pe=de.onVnodeUpdated)||le)&&queuePostRenderEffect(()=>{pe&&invokeVNodeHook(pe,M,P,k),le&&invokeDirectiveHook(P,k,M,"updated")},Y)},w=(k,P,M,Y,Z,ee,oe)=>{for(let re=0;re<P.length;re++){const se=k[re],J=P[re],le=se.el&&(se.type===Fragment$1||!isSameVNodeType(se,J)||se.shapeFlag&70)?d(se.el):M;v(se,J,le,null,Y,Z,ee,oe,!0)}},I=(k,P,M,Y,Z,ee,oe)=>{if(M!==Y){if(M!==EMPTY_OBJ)for(const re in M)!isReservedProp(re)&&!(re in Y)&&a(k,re,M[re],null,oe,P.children,Z,ee,W);for(const re in Y){if(isReservedProp(re))continue;const se=Y[re],J=M[re];se!==J&&re!=="value"&&a(k,re,J,se,oe,P.children,Z,ee,W)}"value"in Y&&a(k,"value",M.value,Y.value)}},L=(k,P,M,Y,Z,ee,oe,re,se)=>{const J=P.el=k?k.el:o(""),le=P.anchor=k?k.anchor:o("");let{patchFlag:ue,dynamicChildren:de,slotScopeIds:pe}=P;pe&&(re=re?re.concat(pe):pe),k==null?(r(J,M,Y),r(le,M,Y),R(P.children,M,le,Z,ee,oe,re,se)):ue>0&&ue&64&&de&&k.dynamicChildren?(w(k.dynamicChildren,de,M,Z,ee,oe,re),(P.key!=null||Z&&P===Z.subTree)&&traverseStaticChildren(k,P,!0)):j(k,P,M,le,Z,ee,oe,re,se)},D=(k,P,M,Y,Z,ee,oe,re,se)=>{P.slotScopeIds=re,k==null?P.shapeFlag&512?Z.ctx.activate(P,M,Y,oe,se):O(P,M,Y,Z,ee,oe,se):N(k,P,se)},O=(k,P,M,Y,Z,ee,oe)=>{const re=k.component=createComponentInstance(k,Y,Z);if(isKeepAlive(k)&&(re.ctx.renderer=X),setupComponent(re),re.asyncDep){if(Z&&Z.registerDep(re,F),!k.el){const se=re.subTree=createVNode(Comment);E(null,se,P,M)}return}F(re,k,P,M,Z,ee,oe)},N=(k,P,M)=>{const Y=P.component=k.component;if(shouldUpdateComponent(k,P,M))if(Y.asyncDep&&!Y.asyncResolved){H(Y,P,M);return}else Y.next=P,invalidateJob(Y.update),Y.update();else P.el=k.el,Y.vnode=P},F=(k,P,M,Y,Z,ee,oe)=>{const re=()=>{if(k.isMounted){let{next:le,bu:ue,u:de,parent:pe,vnode:ge}=k,ye=le,ve;toggleRecurse(k,!1),le?(le.el=ge.el,H(k,le,oe)):le=ge,ue&&invokeArrayFns(ue),(ve=le.props&&le.props.onVnodeBeforeUpdate)&&invokeVNodeHook(ve,pe,le,ge),toggleRecurse(k,!0);const xe=renderComponentRoot(k),z=k.subTree;k.subTree=xe,v(z,xe,d(z.el),B(z),k,Z,ee),le.el=xe.el,ye===null&&updateHOCHostEl(k,xe.el),de&&queuePostRenderEffect(de,Z),(ve=le.props&&le.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(ve,pe,le,ge),Z)}else{let le;const{el:ue,props:de}=P,{bm:pe,m:ge,parent:ye}=k,ve=isAsyncWrapper(P);if(toggleRecurse(k,!1),pe&&invokeArrayFns(pe),!ve&&(le=de&&de.onVnodeBeforeMount)&&invokeVNodeHook(le,ye,P),toggleRecurse(k,!0),ue&&ce){const xe=()=>{k.subTree=renderComponentRoot(k),ce(ue,k.subTree,k,Z,null)};ve?P.type.__asyncLoader().then(()=>!k.isUnmounted&&xe()):xe()}else{const xe=k.subTree=renderComponentRoot(k);v(null,xe,M,Y,k,Z,ee),P.el=xe.el}if(ge&&queuePostRenderEffect(ge,Z),!ve&&(le=de&&de.onVnodeMounted)){const xe=P;queuePostRenderEffect(()=>invokeVNodeHook(le,ye,xe),Z)}(P.shapeFlag&256||ye&&isAsyncWrapper(ye.vnode)&&ye.vnode.shapeFlag&256)&&k.a&&queuePostRenderEffect(k.a,Z),k.isMounted=!0,P=M=Y=null}},se=k.effect=new ReactiveEffect(re,()=>queueJob(J),k.scope),J=k.update=()=>se.run();J.id=k.uid,toggleRecurse(k,!0),J()},H=(k,P,M)=>{P.component=k;const Y=k.vnode.props;k.vnode=P,k.next=null,updateProps(k,P.props,Y,M),updateSlots(k,P.children,M),pauseTracking(),flushPreFlushCbs(),resetTracking()},j=(k,P,M,Y,Z,ee,oe,re,se=!1)=>{const J=k&&k.children,le=k?k.shapeFlag:0,ue=P.children,{patchFlag:de,shapeFlag:pe}=P;if(de>0){if(de&128){Q(J,ue,M,Y,Z,ee,oe,re,se);return}else if(de&256){q(J,ue,M,Y,Z,ee,oe,re,se);return}}pe&8?(le&16&&W(J,Z,ee),ue!==J&&c(M,ue)):le&16?pe&16?Q(J,ue,M,Y,Z,ee,oe,re,se):W(J,Z,ee,!0):(le&8&&c(M,""),pe&16&&R(ue,M,Y,Z,ee,oe,re,se))},q=(k,P,M,Y,Z,ee,oe,re,se)=>{k=k||EMPTY_ARR,P=P||EMPTY_ARR;const J=k.length,le=P.length,ue=Math.min(J,le);let de;for(de=0;de<ue;de++){const pe=P[de]=se?cloneIfMounted(P[de]):normalizeVNode(P[de]);v(k[de],pe,M,null,Z,ee,oe,re,se)}J>le?W(k,Z,ee,!0,!1,ue):R(P,M,Y,Z,ee,oe,re,se,ue)},Q=(k,P,M,Y,Z,ee,oe,re,se)=>{let J=0;const le=P.length;let ue=k.length-1,de=le-1;for(;J<=ue&&J<=de;){const pe=k[J],ge=P[J]=se?cloneIfMounted(P[J]):normalizeVNode(P[J]);if(isSameVNodeType(pe,ge))v(pe,ge,M,null,Z,ee,oe,re,se);else break;J++}for(;J<=ue&&J<=de;){const pe=k[ue],ge=P[de]=se?cloneIfMounted(P[de]):normalizeVNode(P[de]);if(isSameVNodeType(pe,ge))v(pe,ge,M,null,Z,ee,oe,re,se);else break;ue--,de--}if(J>ue){if(J<=de){const pe=de+1,ge=pe<le?P[pe].el:Y;for(;J<=de;)v(null,P[J]=se?cloneIfMounted(P[J]):normalizeVNode(P[J]),M,ge,Z,ee,oe,re,se),J++}}else if(J>de)for(;J<=ue;)$(k[J],Z,ee,!0),J++;else{const pe=J,ge=J,ye=new Map;for(J=ge;J<=de;J++){const fe=P[J]=se?cloneIfMounted(P[J]):normalizeVNode(P[J]);fe.key!=null&&ye.set(fe.key,J)}let ve,xe=0;const z=de-ge+1;let te=!1,ie=0;const he=new Array(z);for(J=0;J<z;J++)he[J]=0;for(J=pe;J<=ue;J++){const fe=k[J];if(xe>=z){$(fe,Z,ee,!0);continue}let _e;if(fe.key!=null)_e=ye.get(fe.key);else for(ve=ge;ve<=de;ve++)if(he[ve-ge]===0&&isSameVNodeType(fe,P[ve])){_e=ve;break}_e===void 0?$(fe,Z,ee,!0):(he[_e-ge]=J+1,_e>=ie?ie=_e:te=!0,v(fe,P[_e],M,null,Z,ee,oe,re,se),xe++)}const me=te?getSequence(he):EMPTY_ARR;for(ve=me.length-1,J=z-1;J>=0;J--){const fe=ge+J,_e=P[fe],Te=fe+1<le?P[fe+1].el:Y;he[J]===0?v(null,_e,M,Te,Z,ee,oe,re,se):te&&(ve<0||J!==me[ve]?U(_e,M,Te,2):ve--)}}},U=(k,P,M,Y,Z=null)=>{const{el:ee,type:oe,transition:re,children:se,shapeFlag:J}=k;if(J&6){U(k.component.subTree,P,M,Y);return}if(J&128){k.suspense.move(P,M,Y);return}if(J&64){oe.move(k,P,M,X);return}if(oe===Fragment$1){r(ee,P,M);for(let ue=0;ue<se.length;ue++)U(se[ue],P,M,Y);r(k.anchor,P,M);return}if(oe===Static){T(k,P,M);return}if(Y!==2&&J&1&&re)if(Y===0)re.beforeEnter(ee),r(ee,P,M),queuePostRenderEffect(()=>re.enter(ee),Z);else{const{leave:ue,delayLeave:de,afterLeave:pe}=re,ge=()=>r(ee,P,M),ye=()=>{ue(ee,()=>{ge(),pe&&pe()})};de?de(ee,ge,ye):ye()}else r(ee,P,M)},$=(k,P,M,Y=!1,Z=!1)=>{const{type:ee,props:oe,ref:re,children:se,dynamicChildren:J,shapeFlag:le,patchFlag:ue,dirs:de}=k;if(re!=null&&setRef(re,null,M,k,!0),le&256){P.ctx.deactivate(k);return}const pe=le&1&&de,ge=!isAsyncWrapper(k);let ye;if(ge&&(ye=oe&&oe.onVnodeBeforeUnmount)&&invokeVNodeHook(ye,P,k),le&6)ae(k.component,M,Y);else{if(le&128){k.suspense.unmount(M,Y);return}pe&&invokeDirectiveHook(k,null,P,"beforeUnmount"),le&64?k.type.remove(k,P,M,Z,X,Y):J&&(ee!==Fragment$1||ue>0&&ue&64)?W(J,P,M,!1,!0):(ee===Fragment$1&&ue&384||!Z&&le&16)&&W(se,P,M),Y&&K(k)}(ge&&(ye=oe&&oe.onVnodeUnmounted)||pe)&&queuePostRenderEffect(()=>{ye&&invokeVNodeHook(ye,P,k),pe&&invokeDirectiveHook(k,null,P,"unmounted")},M)},K=k=>{const{type:P,el:M,anchor:Y,transition:Z}=k;if(P===Fragment$1){G(M,Y);return}if(P===Static){S(k);return}const ee=()=>{s(M),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(k.shapeFlag&1&&Z&&!Z.persisted){const{leave:oe,delayLeave:re}=Z,se=()=>oe(M,ee);re?re(k.el,ee,se):se()}else ee()},G=(k,P)=>{let M;for(;k!==P;)M=f(k),s(k),k=M;s(P)},ae=(k,P,M)=>{const{bum:Y,scope:Z,update:ee,subTree:oe,um:re}=k;Y&&invokeArrayFns(Y),Z.stop(),ee&&(ee.active=!1,$(oe,k,P,M)),re&&queuePostRenderEffect(re,P),queuePostRenderEffect(()=>{k.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},W=(k,P,M,Y=!1,Z=!1,ee=0)=>{for(let oe=ee;oe<k.length;oe++)$(k[oe],P,M,Y,Z)},B=k=>k.shapeFlag&6?B(k.component.subTree):k.shapeFlag&128?k.suspense.next():f(k.anchor||k.el),V=(k,P,M)=>{k==null?P._vnode&&$(P._vnode,null,null,!0):v(P._vnode||null,k,P,null,null,null,M),flushPreFlushCbs(),flushPostFlushCbs(),P._vnode=k},X={p:v,um:$,m:U,r:K,mt:O,mc:R,pc:j,pbc:w,n:B,o:n};let ne,ce;return e&&([ne,ce]=e(X)),{render:V,hydrate:ne,createApp:createAppAPI(V,ne)}}function toggleRecurse({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function traverseStaticChildren(n,e,t=!1){const r=n.children,s=e.children;if(isArray$1(r)&&isArray$1(s))for(let a=0;a<r.length;a++){const i=r[a];let o=s[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[a]=cloneIfMounted(s[a]),o.el=i.el),t||traverseStaticChildren(i,o)),o.type===Text&&(o.el=i.el)}}function getSequence(n){const e=n.slice(),t=[0];let r,s,a,i,o;const u=n.length;for(r=0;r<u;r++){const l=n[r];if(l!==0){if(s=t[t.length-1],n[s]<l){e[r]=s,t.push(r);continue}for(a=0,i=t.length-1;a<i;)o=a+i>>1,n[t[o]]<l?a=o+1:i=o;l<n[t[a]]&&(a>0&&(e[r]=t[a-1]),t[a]=r)}}for(a=t.length,i=t[a-1];a-- >0;)t[a]=i,i=e[i];return t}const isTeleport=n=>n.__isTeleport,Fragment$1=Symbol(void 0),Text=Symbol(void 0),Comment=Symbol(void 0),Static=Symbol(void 0),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n){isBlockTreeEnabled+=n}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,e,t,r,s,a){return setupBlock(createBaseVNode(n,e,t,r,s,a,!0))}function createBlock(n,e,t,r,s){return setupBlock(createVNode(n,e,t,r,s,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,e){return n.type===e.type&&n.key===e.key}const InternalObjectKey="__vInternal",normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:e,ref_for:t})=>n!=null?isString(n)||isRef(n)||isFunction(n)?{i:currentRenderingInstance,r:n,k:e,f:!!t}:n:null;function createBaseVNode(n,e=null,t=null,r=0,s=null,a=n===Fragment$1?0:1,i=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&normalizeKey(e),ref:e&&normalizeRef(e),scopeId:currentScopeId,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return o?(normalizeChildren(u,t),a&128&&n.normalize(u)):t&&(u.shapeFlag|=isString(t)?8:16),isBlockTreeEnabled>0&&!i&&currentBlock&&(u.patchFlag>0||a&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(n,e=null,t=null,r=0,s=null,a=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const o=cloneVNode(n,e,!0);return t&&normalizeChildren(o,t),isBlockTreeEnabled>0&&!a&&currentBlock&&(o.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=o:currentBlock.push(o)),o.patchFlag|=-2,o}if(isClassComponent(n)&&(n=n.__vccOpts),e){e=guardReactiveProps(e);let{class:o,style:u}=e;o&&!isString(o)&&(e.class=normalizeClass(o)),isObject(u)&&(isProxy(u)&&!isArray$1(u)&&(u=extend({},u)),e.style=normalizeStyle(u))}const i=isString(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject(n)?4:isFunction(n)?2:0;return createBaseVNode(n,e,t,r,s,i,a,!0)}function guardReactiveProps(n){return n?isProxy(n)||InternalObjectKey in n?extend({},n):n:null}function cloneVNode(n,e,t=!1){const{props:r,ref:s,patchFlag:a,children:i}=n,o=e?mergeProps(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:o,key:o&&normalizeKey(o),ref:e&&e.ref?t&&s?isArray$1(s)?s.concat(normalizeRef(e)):[s,normalizeRef(e)]:normalizeRef(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:i,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Fragment$1?a===-1?16:a|16:a,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function createTextVNode(n=" ",e=0){return createVNode(Text,null,n,e)}function createCommentVNode(n="",e=!1){return e?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray$1(n)?createVNode(Fragment$1,null,n.slice()):typeof n=="object"?cloneIfMounted(n):createVNode(Text,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(isArray$1(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),normalizeChildren(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!(InternalObjectKey in e)?e._ctx=currentRenderingInstance:s===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else isFunction(e)?(e={default:e,_ctx:currentRenderingInstance},t=32):(e=String(e),r&64?(t=16,e=[createTextVNode(e)]):t=8);n.children=e,n.shapeFlag|=t}function mergeProps(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=normalizeClass([e.class,r.class]));else if(s==="style")e.style=normalizeStyle([e.style,r.style]);else if(isOn(s)){const a=e[s],i=r[s];i&&a!==i&&!(isArray$1(a)&&a.includes(i))&&(e[s]=a?[].concat(a,i):i)}else s!==""&&(e[s]=r[s])}return e}function invokeVNodeHook(n,e,t,r=null){callWithAsyncErrorHandling(n,e,7,[t,r])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||emptyAppContext,a={uid:uid++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(r,s),emitsOptions:normalizeEmitsOptions(r,s),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:r.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=emit.bind(null,a),n.ce&&n.ce(a),a}let currentInstance=null;const setCurrentInstance=n=>{currentInstance=n,n.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),currentInstance=null};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,e=!1){isInSSRComponentSetup=e;const{props:t,children:r}=n.vnode,s=isStatefulComponent(n);initProps(n,t,s,e),initSlots(n,r);const a=s?setupStatefulComponent(n,e):void 0;return isInSSRComponentSetup=!1,a}function setupStatefulComponent(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=markRaw(new Proxy(n.ctx,PublicInstanceProxyHandlers));const{setup:r}=t;if(r){const s=n.setupContext=r.length>1?createSetupContext(n):null;setCurrentInstance(n),pauseTracking();const a=callWithErrorHandling(r,n,0,[n.props,s]);if(resetTracking(),unsetCurrentInstance(),isPromise$1(a)){if(a.then(unsetCurrentInstance,unsetCurrentInstance),e)return a.then(i=>{handleSetupResult(n,i,e)}).catch(i=>{handleError(i,n,0)});n.asyncDep=a}else handleSetupResult(n,a,e)}else finishComponentSetup(n,e)}function handleSetupResult(n,e,t){isFunction(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:isObject(e)&&(n.setupState=proxyRefs(e)),finishComponentSetup(n,t)}let compile;function finishComponentSetup(n,e,t){const r=n.type;if(!n.render){if(!e&&compile&&!r.render){const s=r.template||resolveMergedOptions(n).template;if(s){const{isCustomElement:a,compilerOptions:i}=n.appContext.config,{delimiters:o,compilerOptions:u}=r,l=extend(extend({isCustomElement:a,delimiters:o},i),u);r.render=compile(s,l)}}n.render=r.render||NOOP}setCurrentInstance(n),pauseTracking(),applyOptions(n),resetTracking(),unsetCurrentInstance()}function createAttrsProxy(n){return new Proxy(n.attrs,{get(e,t){return track(n,"get","$attrs"),e[t]}})}function createSetupContext(n){const e=r=>{n.exposed=r||{}};let t;return{get attrs(){return t||(t=createAttrsProxy(n))},slots:n.slots,emit:n.emit,expose:e}}function getExposeProxy(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in publicPropertiesMap)return publicPropertiesMap[t](n)},has(e,t){return t in e||t in publicPropertiesMap}}))}function getComponentName(n,e=!0){return isFunction(n)?n.displayName||n.name:n.name||e&&n.__name}function isClassComponent(n){return isFunction(n)&&"__vccOpts"in n}const computed=(n,e)=>computed$1(n,e,isInSSRComponentSetup);function h(n,e,t){const r=arguments.length;return r===2?isObject(e)&&!isArray$1(e)?isVNode(e)?createVNode(n,null,[e]):createVNode(n,e):createVNode(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&isVNode(t)&&(t=[t]),createVNode(n,e,t))}const ssrContextKey=Symbol(""),useSSRContext=()=>inject(ssrContextKey),version="3.2.47",svgNS="http://www.w3.org/2000/svg",doc$1=typeof document<"u"?document:null,templateContainer=doc$1&&doc$1.createElement("template"),nodeOps={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e?doc$1.createElementNS(svgNS,n):doc$1.createElement(n,t?{is:t}:void 0);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>doc$1.createTextNode(n),createComment:n=>doc$1.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc$1.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,a){const i=t?t.previousSibling:e.lastChild;if(s&&(s===a||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===a||!(s=s.nextSibling)););else{templateContainer.innerHTML=r?`<svg>${n}</svg>`:n;const o=templateContainer.content;if(r){const u=o.firstChild;for(;u.firstChild;)o.appendChild(u.firstChild);o.removeChild(u)}e.insertBefore(o,t)}return[i?i.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function patchClass(n,e,t){const r=n._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function patchStyle(n,e,t){const r=n.style,s=isString(t);if(t&&!s){if(e&&!isString(e))for(const a in e)t[a]==null&&setStyle(r,a,"");for(const a in t)setStyle(r,a,t[a])}else{const a=r.display;s?e!==t&&(r.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(r.display=a)}}const importantRE=/\s*!important$/;function setStyle(n,e,t){if(isArray$1(t))t.forEach(r=>setStyle(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=autoPrefix(n,e);importantRE.test(t)?n.setProperty(hyphenate(r),t.replace(importantRE,""),"important"):n[r]=t}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,e){const t=prefixCache[e];if(t)return t;let r=camelize(e);if(r!=="filter"&&r in n)return prefixCache[e]=r;r=capitalize(r);for(let s=0;s<prefixes.length;s++){const a=prefixes[s]+r;if(a in n)return prefixCache[e]=a}return e}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,e,t,r,s){if(r&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(xlinkNS,e.slice(6,e.length)):n.setAttributeNS(xlinkNS,e,t);else{const a=isSpecialBooleanAttr(e);t==null||a&&!includeBooleanAttr(t)?n.removeAttribute(e):n.setAttribute(e,a?"":t)}}function patchDOMProp(n,e,t,r,s,a,i){if(e==="innerHTML"||e==="textContent"){r&&i(r,s,a),n[e]=t??"";return}if(e==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=t;const u=t??"";(n.value!==u||n.tagName==="OPTION")&&(n.value=u),t==null&&n.removeAttribute(e);return}let o=!1;if(t===""||t==null){const u=typeof n[e];u==="boolean"?t=includeBooleanAttr(t):t==null&&u==="string"?(t="",o=!0):u==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(e)}function addEventListener(n,e,t,r){n.addEventListener(e,t,r)}function removeEventListener(n,e,t,r){n.removeEventListener(e,t,r)}function patchEvent(n,e,t,r,s=null){const a=n._vei||(n._vei={}),i=a[e];if(r&&i)i.value=r;else{const[o,u]=parseName(e);if(r){const l=a[e]=createInvoker(r,s);addEventListener(n,o,l,u)}else i&&(removeEventListener(n,o,i,u),a[e]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let e;if(optionsModifierRE.test(n)){e={};let r;for(;r=n.match(optionsModifierRE);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),e]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(r,t.value),e,5,[r])};return t.value=n,t.attached=getNow(),t}function patchStopImmediatePropagation(n,e){if(isArray$1(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const nativeOnRE=/^on[a-z]/,patchProp=(n,e,t,r,s=!1,a,i,o,u)=>{e==="class"?patchClass(n,r,s):e==="style"?patchStyle(n,t,r):isOn(e)?isModelListener(e)||patchEvent(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):shouldSetAsProp(n,e,r,s))?patchDOMProp(n,e,r,a,i,o,u):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),patchAttr(n,e,r,s))};function shouldSetAsProp(n,e,t,r){return r?!!(e==="innerHTML"||e==="textContent"||e in n&&nativeOnRE.test(e)&&isFunction(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||nativeOnRE.test(e)&&isString(t)?!1:e in n}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>systemModifiers.some(t=>n[`${t}Key`]&&!e.includes(t))},withModifiers=(n,e)=>(t,...r)=>{for(let s=0;s<e.length;s++){const a=modifierGuards[e[s]];if(a&&a(t,e))return}return n(t,...r)},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(n,e)=>t=>{if(!("key"in t))return;const r=hyphenate(t.key);if(e.some(s=>s===r||keyNames[s]===r))return n(t)},rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...n)=>{const e=ensureRenderer().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=normalizeContainer(r);if(!s)return;const a=e._component;!isFunction(a)&&!a.render&&!a.template&&(a.template=s.innerHTML),s.innerHTML="";const i=t(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},e};function normalizeContainer(n){return isString(n)?document.querySelector(n):n}const _hoisted_1$e={class:"logo"},_hoisted_2$7={class:"green"},_hoisted_3$6={class:"subtitle"},_sfc_main$s=defineComponent({__name:"Logo",props:{title:null,subtitle:null},setup(n){return(e,t)=>(openBlock(),createElementBlock("div",_hoisted_1$e,[createBaseVNode("h1",_hoisted_2$7,toDisplayString(n.title),1),createBaseVNode("h3",_hoisted_3$6,toDisplayString(n.subtitle),1)]))}}),Logo_vue_vue_type_style_index_0_scoped_691d2f3f_lang="",_export_sfc=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},Logo=_export_sfc(_sfc_main$s,[["__scopeId","data-v-691d2f3f"]]),getDiffDelt=(n,e)=>({x:n.x-e.x,y:n.y-e.y}),setPosition=(n,e,t="")=>{n.style.transform=`translateX(${e.x}px) translateY(${e.y}px) ${t}`},setDomOnCenter=n=>{let e=(document.body.clientWidth-n.offsetWidth)/2,t=(document.body.clientHeight-n.offsetHeight)/2;n.style.left=`${e}px`,n.style.top=`${t}px`},setOpacity=(n,e)=>{n.style.opacity=`${e}`},setTransition=(n,e)=>{n.style.transition=`${e}`},setTransform=(n,e)=>{n.style.transform=`${e}`},setScrollTop=(n,e)=>{n.scrollTop=`${e}`},initPosition=(n,e)=>{const t={x:e.offsetWidth/2,y:-e.offsetHeight},r={x:n==null?void 0:n.offsetLeft,y:n==null?void 0:n.offsetTop},s=getDiffDelt(t,r);setPosition(n,s)},home=[{name:"收藏",link:"favour",status:""},{name:"应用",link:"application",status:"active"},{name:"设置",link:"setting",status:""},{name:"网络",link:"network",status:""}],menuList={"/":[...home]},menu$2=reactive({list:[...home],link:"/",active:"",init(){this.list=home},setActive(n){this.active=n},getActive(){let n=this.list.find(e=>e.name!="<"&&e.status=="active");return!n&&(this.list[1].status="active"),n||this.list[1]},setMenu(n){this.list=n},setLink(n){this.link=n},update:()=>{},open:()=>{},close:()=>{}}),appList=reactive({list:[{name:"时空葫芦.TV",cover:"./assets/logo.svg",link:"/application/tv"},{name:"时空葫芦.KTV",cover:"./assets/logo.svg",link:"/application/ktv?go=hot"},{name:"时空葫芦.Tools",cover:"./assets/logo.svg",link:"/application/tools"},{name:"时空葫芦.软件库",cover:"./assets/logo.svg",link:"/application/software"},{name:"时空葫芦.上网导航",cover:"./assets/logo.svg",link:"/application/nav"},{name:"优酷",cover:"",url:"https://www.youku.com"},{name:"爱奇艺",cover:"",url:"https://www.iqiyi.com"},{name:"腾讯视频",cover:"",url:"https://v.qq.com"},{name:"芒果TV",cover:"",url:"https://www.mgtv.com"},{name:"B站",cover:"",url:"https://www.bilibili.com"},{name:"Acfun",cover:"https://ali-imgs.acfun.cn/kos/nlav10360/static/common/widget/header/img/acfunlogo.11a9841251f31e1a3316.svg",url:"http://www.acfun.cn/"},{name:"西瓜视频",cover:"",url:"http://www.ixigua.com/"},{name:"好看视频",cover:"",url:"http://haokan.baidu.com/"},{name:"梨视频",cover:"",url:"http://www.pearvideo.com/"},{name:"1905视频",cover:"",url:"http://www.1905.com/"},{name:"CCTV",cover:"",url:"http://tv.cctv.com/live"},{name:"小红书",cover:"",url:"http://www.xiaohongshu.com/"},{name:"风直播",cover:"",url:"http://flive.ifeng.com/"},{name:"搜狐视频",cover:"",url:"http://tv.sohu.com/"},{name:"网易视频",cover:"",url:"http://v.163.com/"},{name:"虎牙直播",cover:"",url:"http://www.huya.com/"},{name:"斗鱼直播",cover:"",url:"http://www.douyu.com/"},{name:"淘宝直播",cover:"",url:"http://taolive.taobao.com/explore/index.html"},{name:"豆瓣FM",cover:"",url:"http://fm.douban.com/"},{name:"抖音",cover:"",url:"https://live.douyin.com/"},{name:"快手",cover:"",url:"http://www.kuaishou.com/new-reco"},{name:"Freeok",cover:"",url:"https://www.freeok.vip/"},{name:"MX动漫",cover:"",url:"http://www.mxdm8.com/"},{name:"YouTube",cover:"",url:"http://www.YouTube.com/"},{name:"Instagram",cover:"",url:"http://www.Instagram.com/"},{name:"Vimeo",cover:"",url:"http://www.Vimeo.com/"},{name:"Dailymotion",cover:"",url:"http://www.Dailymotion.com/"},{name:"QQ音乐",cover:"",url:"http://y.qq.com/"},{name:"酷狗",cover:"",url:"http://www.kugou.com/"},{name:"酷我",cover:"",url:"http://www.kuwo.cn/"},{name:"喜马拉雅",cover:"",url:"http://www.ximalaya.com/"},{name:"网易云",cover:"",url:"http://music.163.com/"}]}),$dialog=reactive({show:!0,showDialog(){this.show=!0},hideDialog(){this.show=!1,this.autoCloseSec=-1,clearInterval(this.secID)},title:"标题",body:"内容",footer:"",showFooter:!0,init(){this.title="标题",this.body="内容",this.footer="",this.showFooter=!0,this.show=!0},open({title:n="",body:e="",footer:t="",showFooter:r=!0,show:s=!0}){n&&(this.title=n||"标题"),e&&(this.body=e||"内容"),this.showFooter=r,this.show=s,this.footer=t},setCloseSec(n=10){this.autoCloseSec=n,n&&this.autoClose()},autoCloseSec:-1,secID:-1,autoClose(){clearInterval(this.secID),this.secID=setInterval(()=>{if(!this.autoCloseSec||!this.show)return this.hideDialog();--this.autoCloseSec&&this.autoClose()},1e3)}}),logoItem=reactive({title:"MPBugTV",subtitle:"时空魔法葫芦电视",setTitle(n=""){this.title=n,document.title=n},setSubTitle(n=""){this.subtitle=n}}),_hoisted_1$d=["onMouseenter","onKeydown","onClick","tabindex"],_sfc_main$r=defineComponent({__name:"index",setup(n){logoItem.setTitle("MPBugTV"),logoItem.setSubTitle("时空魔法葫芦电视");const e=ref([]),t=ref(null),r=ref(!0),s=y=>{e.value.push(y)},a=y=>{t.value=y},i=(y,E=0)=>{if(!r.value)return;const{key:_,keyCode:T}=y;let S=e.value.length,x=o(),b=E-x;b=b<0?0:b;let A=E+x;A=A>=S?S-1:A;let R=E+1;R=R>=S?0:R;let C=E-1;C=C<0?S-1:C;let w=E;console.log("onKeydown",{len:S,index:E,key:_,keyCode:T,$event:y}),T==39&&(w=R),T==37&&(w=C),T==40&&(w=A),T==38&&(w=b),u(w,x)},o=()=>{var S;let y=t.value.getClientRects()[0],E=(S=e.value[0])==null?void 0:S.getClientRects()[0];const _=16;let T=Math.floor(y.width/(E.width+_));return console.log("onKeydown",{numOfCardInline:T,containerRect:y,card:E}),T},u=(y,E=o())=>{var _;if(r.value==!0){(_=e.value[y])==null||_.focus();for(const T of e.value)setTransition(T,"transform 0.5s cubic-bezier(.64,-0.74,.2,1.55), opacity 0.5s"),setTransform(T,""),setOpacity(T,1);e.value[y+1]&&setTransform(e.value[y+1],"perspective(100px) rotateY(-25deg)"),e.value[y-1]&&setTransform(e.value[y-1],"perspective(100px) rotateY(25deg)"),E&&e.value[y+E]&&setTransform(e.value[y+E],"perspective(100px) rotateX(25deg)"),E&&e.value[y-E]&&setTransform(e.value[y-E],"perspective(100px) rotateX(-25deg)")}},l=()=>{let y=0;for(const E of e.value){let _=Math.floor(Math.random()*50+10)*.1;y=Math.max(y,_),setTransition(E,`transform ${_}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${_}s`),setPosition(E,{x:0,y:0}),setOpacity(E,1)}setTimeout(()=>{r.value=!0},y*1e3)},c=(y=null)=>{let E=e.value.length,_=t.value,T=0,S=5e3,x=0,b=[];for(const A of e.value){if(!r.value){let R=Math.floor(Math.random()*50+10)*.1;b=[...b,R],setTransition(A,`transform ${R}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${R}s`)}initPosition(A,_),setOpacity(A,0)}return r.value=!1,x=b.reduce((A,R)=>A+R,0)/E,T=Math.max(...b),S=Math.min(...b),console.log("animationClose",{arr:b,max:T,min:S,avg:x}),y&&setTimeout(y,S*1e3),x},d=()=>{let y=t.value;setTransition(y,""),c(),setTimeout(()=>{l()},100)},f=()=>{var y;(y=e.value[0])==null||y.focus()},g=y=>y.cover?y.cover:y.url?`https://api.iowen.cn/favicon/${new URL(y.url).hostname}.png`:"/assets/logo.svg",m=(y,E="_blank")=>{let _=`?ref=${window.location.origin}`,T=E=="_blank"?y+_:"#"+y;y&&window.open(T,E)},v=y=>{y!=null&&y.link?($dialog.hideDialog(),menu$2.close(),r.value=!1,c(()=>{$dialog.open({title:y.name,body:"正在启动应用程序...",showFooter:!1,show:!0}),setTimeout(()=>{menu$2.setLink(y==null?void 0:y.link),m(y==null?void 0:y.link,"_self"),menu$2.open(),$dialog.show=!1},3e3)})):y!=null&&y.url&&m(y==null?void 0:y.url)};return onMounted(()=>{nextTick(()=>{d(),console.log("nextTick",{cards:e,cardsRef:s})})}),(y,E)=>(openBlock(),createElementBlock("div",{class:"wrapper",onClick:f},[createBaseVNode("div",{class:"container",ref:a},[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(unref(appList).list,(_,T)=>(openBlock(),createElementBlock("div",{class:"card-box",onMouseenter:S=>u(T),onKeydown:[S=>i(S,T),withKeys(S=>v(_),["enter"])],onClick:withModifiers(S=>v(_),["stop"]),key:T,tabindex:T+5,ref_for:!0,ref:s},[createBaseVNode("span",{class:normalizeClass(["card",{bg:g(_)}]),style:normalizeStyle({background:`url(${g(_)}) center center / contain no-repeat`})},null,6),createBaseVNode("span",{class:normalizeClass({link:_.url})},toDisplayString(_.name),3)],40,_hoisted_1$d))),128))])]))}}),index_vue_vue_type_style_index_0_scoped_0709a409_lang="",Application=_export_sfc(_sfc_main$r,[["__scopeId","data-v-0709a409"]]),_sfc_main$q=defineComponent({__name:"Wrapper",setup(n){const e=ref(null),t=s=>{e.value=s},r=()=>{};return(s,a)=>(openBlock(),createElementBlock("div",{class:"wrapper",onClick:r},[createBaseVNode("div",{class:"container",ref:t},[renderSlot(s.$slots,"container",{},void 0,!0)])]))}}),Wrapper_vue_vue_type_style_index_0_scoped_50f5c100_lang="",Wrapper=_export_sfc(_sfc_main$q,[["__scopeId","data-v-50f5c100"]]),_sfc_main$p=defineComponent({__name:"index",setup(n){return(e,t)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createTextVNode(" network... ")]),_:1}))}}),_sfc_main$o=defineComponent({__name:"index",setup(n){return(e,t)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createTextVNode(" setting... ")]),_:1}))}}),_sfc_main$n=defineComponent({__name:"index",setup(n){const e=ref(null),t=s=>{e.value=s},r=()=>{};return(s,a)=>(openBlock(),createElementBlock("div",{class:"wrapper",onClick:r},[createBaseVNode("div",{class:"container",ref:t}," signal... ")]))}}),index_vue_vue_type_style_index_0_scoped_fc4e12a3_lang="",Signal=_export_sfc(_sfc_main$n,[["__scopeId","data-v-fc4e12a3"]]),_sfc_main$m=defineComponent({__name:"index",setup(n){return(e,t)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createTextVNode(" Favour... ")]),_:1}))}}),proxyList={wp:{config:(n,e={})=>({server:"http://100.86.47.115/wp-admin/get-proxy-api.php",method:"POST",param:{url:encodeURIComponent(n),resHeader:"Y",...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded; charset=UTF-8"}],responseCallback:t=>{var s,a,i,o,u;let r=(s=t==null?void 0:t.response)==null?void 0:s.error;try{let l=(i=(a=t.response)==null?void 0:a.data)==null?void 0:i.result,c=(u=(o=t.response)==null?void 0:o.data)==null?void 0:u.header;return{xhr:l,response:l,responseHeader:c}}catch(l){console.log("~responseCallback~error",{error:l,err:r})}return null}})},wp2:{config:(n,e={})=>({server:"http://100.98.202.49/wp-admin/get-proxy-api.php",method:"POST",param:{url:encodeURIComponent(n),resHeader:"Y",...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded; charset=UTF-8"}],responseCallback:t=>{var s,a,i,o,u;let r=(s=t==null?void 0:t.response)==null?void 0:s.error;try{let l=(i=(a=t.response)==null?void 0:a.data)==null?void 0:i.result,c=(u=(o=t.response)==null?void 0:o.data)==null?void 0:u.header;return{xhr:l,response:l,responseHeader:c}}catch(l){console.log("~responseCallback~error",{error:l,err:r})}return null}})},"uutool.cn":{config:(n,e={})=>({server:"https://api.uutool.cn/network/html/",method:"POST",param:{url:encodeURIComponent(n),...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded; charset=UTF-8"}],responseCallback:t=>{var s,a,i,o;let r=(s=t==null?void 0:t.response)==null?void 0:s.error;try{let u=(i=(a=t.response)==null?void 0:a.data)==null?void 0:i.html,l=(o=t.response)==null?void 0:o.responseHeader,c=u.replace(/\'/gi,'"');return{xhr:u,response:c,responseHeader:l}}catch(u){console.log("~responseCallback~error",{error:u,err:r})}return null}})},"toolhelper.cn":{config:(n,e={})=>{let t=new URL(n),r=`GET ${t.pathname}${t.search} HTTP/1.1
Host: ${t.host}
Connection: close
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="96", "Google Chrome";v="96"
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36
sec-ch-ua-platform: "Windows"
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7`;return{server:"https://www.toolhelper.cn/Http/HttpTest",method:"POST",param:{Source:encodeURIComponent(r),...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded; charset=UTF-8"},{name:"Origin",value:"*"},{name:"Referer",value:"*"}],responseCallback:s=>{var i,o,u;let a=(i=s==null?void 0:s.response)==null?void 0:i.error;try{let l=(o=s.response)==null?void 0:o.Data,c=(u=s.response)==null?void 0:u.responseHeader,d=l.replace(/\'/gi,'"');return{xhr:l,response:d,responseHeader:c}}catch(l){console.log("~responseCallback~error",{error:l,err:a})}return null}}}},"jsonin.com":{config:(n,e={})=>({server:"https://post.jsonin.com/httpapi.php",method:"POST",param:{tourl:n,header:"Content-Type:application/x-www-form-urlencoded",seltype:"GET",code:"utf8",...e},requestType:"json",headers:[{name:"content-type",value:"application/json"},{name:"Origin",value:"*"},{name:"Referer",value:"*"}],responseCallback:t=>{var r,s;console.log("~~responseCallback:ret",{ret:t.response});try{let a=(r=t.response)==null?void 0:r.body,i=(s=t.response)==null?void 0:s.header,o=a.replace(/\'/gi,'"');return{xhr:a,response:o,responseHeader:i}}catch(a){console.log("~responseCallback~error",{error:a})}return null}})},"sojson.com":{config:(n,e={})=>{let t=new URL(n);return e={url:t.host+t.pathname,hts:t.protocol+"//",type:"Post",charset:"UTF-8",cookies:"",params_box:!0,header_box:!0,cookie_box:!1,parms_tab:"tab_batch",batchParms:encodeURIComponent(t.search.replace("?","")),kvHeads:'[{"key":"Content-Type","value":"application/x-www-form-urlencoded;charset=UTF-8"}]',...e},{server:`https://www.sojson.com/auth_v_1_0/http/httprequest.shtml?v=${Math.random()}`,method:"POST",param:e,responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded; charset=UTF-8"},{name:"Origin",value:"*"},{name:"Referer",value:"*"}],responseCallback:r=>{var s,a;console.log("~~responseCallback:ret",{ret:r.response});try{let i=(s=r.response)==null?void 0:s.result,o=(a=r.response)==null?void 0:a.responseHeader,u=i.replace(/\'/gi,'"');return{xhr:i,response:u,responseHeader:o}}catch(i){console.log("~responseCallback~error",{error:i})}return null}}}},"reqbin.com":{config:(n,e={})=>({server:"https://apius.reqbin.com/api/v1/requests",method:"POST",param:{deviceId:"579ef537-3412-445f-9208-e1e667148b3eR",errors:"",id:"0",json:`{"method":"POST","url":"${n}","apiNode":"US","contentType":"JSON","content":"","headers":"Accept: application/json","errors":"","curlCmd":"","codeCmd":"","jsonCmd":"","xmlCmd":"","lang":"","auth":{"auth":"noAuth","bearerToken":"","basicUsername":"","basicPassword":"","customHeader":"","encrypted":""},"compare":false,"idnUrl":"${n}/"}`,name:"",sessionId:1680725138116,...e},responseType:"json",requestType:"json",headers:[{name:"content-type",value:"application/json; charset=UTF-8"}],responseCallback:t=>{var r,s;console.log("~~responseCallback:ret",{ret:t,response:t.response});try{let a=(r=t.response)==null?void 0:r.Content,i=(s=t.response)==null?void 0:s.Headers;return{xhr:a,response:a,responseHeader:i}}catch(a){console.log("~responseCallback~error",{error:a})}return null}})},"toolscat.com":{config:(n,e={})=>({server:"https://www.toolscat.com/send",method:"POST",param:{url:n,type:"GET",rawType:"",rawValue:"",headers:{"":""},formData:{},...e},responseType:"json",requestType:"json",headers:[{name:"content-type",value:"application/json; charset=UTF-8"}],responseCallback:t=>{var r,s,a,i;console.log("~~responseCallback:ret",{ret:t,response:t.response});try{let o=(s=(r=t.response)==null?void 0:r.obj)==null?void 0:s.content,u=(i=(a=t.response)==null?void 0:a.obj)==null?void 0:i.resheader;return{xhr:o,response:o,responseHeader:u}}catch(o){console.log("~responseCallback~error",{error:o})}return null}})},"coolaf.com":{config:(n,e={})=>({server:"http://coolaf.com/tool/ajaxpost",method:"POST",param:{url:n,seltype:"post",ck:"",header:"",parms:"",proxy:"",code:"utf8",cy:1,ct:"",j:"",...e},responseType:"json",requestType:"json",headers:[{name:"content-type",value:"multipart/form-data;"}],responseCallback:t=>{var r,s,a,i;console.log("~~responseCallback:ret",{ret:t,response:t.response});try{let o=(s=(r=t.response)==null?void 0:r.data)==null?void 0:s.response,u=(i=(a=t.response)==null?void 0:a.data)==null?void 0:i.resheader;return{xhr:o,response:o,responseHeader:u}}catch(o){console.log("~responseCallback~error",{error:o})}return null}})},"bejson.com":{config:(n,e={})=>{let[t,r]=n.split("//");return{server:"https://www.bejson.com/Bejson/Api/HttpRequest/curl_request",method:"POST",param:{protocol:encodeURIComponent(t+"//"),url:encodeURIComponent(r),type:"POST",code:"utf-8",contentType:"application/json;charset=utf-8",cookie:"","checked[httpOptionBox]":!0,"checked[httpHeaderBox]":!0,"checked[httpCookieBox]":!1,"checked[httpProxyBox]":!1,"paramSwitch[]":!1,"proxy[proxy]":"",...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded;charset=utf-8"}],responseCallback:s=>{var a,i,o,u;console.log("~~responseCallback:ret",{ret:s,response:s.response});try{let l=(i=(a=s.response)==null?void 0:a.data)==null?void 0:i.result,c=(u=(o=s.response)==null?void 0:o.data)==null?void 0:u.hearder;return{xhr:l,response:l,responseHeader:c}}catch(l){console.log("~responseCallback~error",{error:l})}return null}}}},"aicesu.cn":{config:(n,e={})=>({server:"https://www.aicesu.cn/tool/http/ajax_http?debug=1",method:"POST",param:{txt_url:encodeURIComponent(n),txt_httptype:"GET",txt_code:"",txt_httpver:0,txt_outtime:15,txt_contype:"text/html",txt_host:"",txt_useragent:"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)",txt_setuseragent:"",txt_referer:"",txt_dlip:"",txt_header:"",txt_postdata:"",txt_cookie:"",...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded;charset=utf-8"}],responseCallback:t=>{var r,s,a;console.log("~~responseCallback:ret",{ret:t,response:t.response});try{let i=(r=t.response)==null?void 0:r.result,o=(s=t.response)==null?void 0:s.responseHeader,u=(a=t.response)==null?void 0:a.requestHeader;return{xhr:i,response:i,responseHeader:o}}catch(i){console.log("~responseCallback~error",{error:i})}return null}})},"onlinetool.app":{config:(n,e={})=>({server:"https://onlinetool.app/run/curl",method:"POST",param:{url:encodeURIComponent(n),action:"get",...e},responseType:"json",headers:[{name:"content-type",value:"application/x-www-form-urlencoded;charset=utf-8"}],responseCallback:t=>{var r,s,a,i;console.log("~~responseCallback:ret",{ret:t,response:t.response});try{let o=(s=(r=t.response)==null?void 0:r.raw[0])==null?void 0:s.Body,u=(i=(a=t.response)==null?void 0:a.raw[0])==null?void 0:i.Headers;return{xhr:o,response:o,responseHeader:u}}catch(o){console.log("~responseCallback~error",{error:o})}return null}})}};function isInFilterKeyword(n){var e=["福利","伦理","倫理"],t=e.join("|"),r=new RegExp(`(${t})`,"gi");for(const s of n)if(s.match(r)!=null)return!0;return!1}function formateSecToHourMin(n){if(!n)return"";const e=parseInt(n/3600),t=parseInt(n/60%60),r=Math.ceil(n%60),s=e<10?"0"+e:e,a=r>59?59:r;return`${s>0?`${s}:`:""}${t<10?"0"+t:t}:${a<10?"0"+a:a}`}function escape2Html(n){if(!n)return"";var e={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',"#40":"(","#41":")","#39":"'",apos:"-"};return n.replace(/&(lt|gt|nbsp|amp|quot|#40|#41|#39|apos);/ig,function(t,r){return e[r]})}function xmlToJson(n){var e={};if(n.nodeType==1){if(n.attributes.length>0){e["@attributes"]={};for(var t=0;t<n.attributes.length;t++){var r=n.attributes.item(t);e["@attributes"][r.nodeName]=r.nodeValue}}}else(n.nodeType==3||n.nodeType==4)&&(e=n.nodeValue);if(n.hasChildNodes())for(var s=0;s<n.childNodes.length;s++){var a=n.childNodes.item(s),i=a.nodeName;if(typeof e[i]>"u")e[i]=xmlToJson(a);else{if(typeof e[i].length>"u"){var o=e[i];e[i]=[],e[i].push(o)}try{e[i].push(xmlToJson(a))}catch(u){console.log({nodeName:i,item:a,error:u})}}}return e}function parseToJSON$1(n){let e=`${n}`,t={},r=3;for(;r--;)try{t=JSON.parse(e);break}catch(s){let a=s.message.match(/\d+/gi),i=~~a;a&&(e=e.slice(0,i-1)+e.slice(i))}return t}function parseToJSON(n){let e=`${n}`,t={},r=3;for(;r--;)try{t=JSON.parse(e);break}catch(s){let a=s.message.match(/\d+/gi),i=~~a;a&&(e=e.slice(0,i-1)+e.slice(i))}return t}const getNumber=function(n){return`${n}`.replace(/[^\d]/gi,"")},has=function(n,e){return n&&e&&n.hasOwnProperty(e)},isNull=function(n,e){return!n[e]},guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=Math.random()*16|0,t=n=="x"?e:e&3|8;return t.toString(16)})},api_kuwo=function(){const n={getMusicURLById:{url:({id:c,music_id:d,type:f="song",br:g="320kmp3"})=>(c&&(c=getNumber(c)),d&&(d=getNumber(d)),`https://www.kuwo.cn/api/v1/www/music/playUrl?mid=${c||d}&type=${f}&httpsStatus=1&br=${g}&reqId=${guid()}`),processRequestHeaders:t},getListByKeyword:{url:({keyword:c="",page:d=1,rows:f=20})=>`https://search.kuwo.cn/r.s?client=kt&all=${encodeURIComponent(c)}&pn=${d-1}&rn=${f}&ft=music&plat=pc&cluster=1&result=json&rformat=json&ver=mbox&show_copyright_off=1&vipver=MUSIC_8.1.2.0_W4&encoding=utf8`},getLyricById:{url:({id:c,music_id:d})=>(c&&(c=getNumber(c)),d&&(d=getNumber(d)),`https://m.kuwo.cn/newh5/singles/songinfoandlrc?musicId=${c||d}`)},getPicById:{url:({id:c,music_id:d,size:f="128"})=>(c&&(c=getNumber(c)),d&&(d=getNumber(d)),`http://artistpicserver.kuwo.cn/pic.web?corp=kuwo&type=rid_pic&pictype=url&content=list&size=${f}&rid=${c||d}`)},getAlbumPic:{url:({web_albumpic:c=""})=>c?`https://img1.kuwo.cn/star/albumcover/${c}`:""},getHotListHTML:{url:()=>"https://www.kuwo.cn/playlists"},getHotListDetailHTML:{url:({tid:c,id:d})=>`http://www.kuwo.cn/playlist_detail/${c||d}`}},e={method:"get",async:!0,responseType:"",headers:{"Content-Type":"application/json"}};function t({headers:c,config:d}){return c}function r(c){let d=null,f=!1;try{d=new URL(c),f=/kuwo/gi.test(d.host)}catch{}if(!c||!d||!f)return null;let[g,m]=s(d.pathname);return g=a(g),!g||!m?null:{platform:"kuwo",key:g,value:m}}function s(c){let d=c.split("/");d=d.filter(v=>v);let f=d.length;if(f<2)return[null,null];let[g,m]=[d[f-2],d[f-1]];return[g,m]}function a(c){return c&&{playlist_detail:"playlist_id",play_detail:"music_id",singer_detail:"singer_id",singers:"singer_id",album_detail:"album_id"}[c.toLowerCase()]||""}function i(c){let d=c.response||c.responseText;try{let f=parseToJSON(d),{songinfo:g={},lrclist:m=null,url:v=""}=f.data;return console.log("~~toJSON",{songinfo:g,url:v,lrclist:m,jsonObj:f}),v&&!g.url&&(g.url=v),g}catch{}return null}function o(c){let d=i(c);if(!d)return{};let f={};const g={id:"music_id",songName:"song",album:"album",albumId:"albumId_id",artist:"artist",artistId:"artist_id",duration:"duration",pic:"picture",hash:"hash",url:"url"};for(const[m,v]of Object.entries(d))g[m]&&(f[g[m]]=v);return f}function u(c,d,f="music_id"){if(console.log("~~parseHTML",{DOMParser:d}),!c)return null;var g=null;try{g=d}catch{}try{g=new d}catch{}var m=null;try{m=g(c,"text/html")}catch{}try{m=g.parseFromString(c,"text/html")}catch{}return console.log("~~parseHTML:oDOM",{oDOM:m,oParser:g}),m}return{init:function(c){if(!c||!has(c,"name")||isNull(c,"name"))return{...c};const d=n[c.name],f=d.url(c.data),g=has(d,"method")?d.method:e.method,m=has(d,"async")?d.async:e.async,v=has(c,"responseType")?c.responseType:has(d,"responseType")?d.responseType:e.responseType;let y=has(c,"headers")?c.headers:e.headers,E={url:f,method:g,async:m,headers:y,responseType:v};return has(d,"processRequestHeaders")&&(y=d.processRequestHeaders({headers:y,config:c}),E.headers=y),E},parseURL:r,mapperSongInfo:o,parseHTML:u}};/*!
 * md5js v1.0.7
 * (c) 2017-2018 penyuying
 * Released under the MIT License.
 */function md5$1(n,e){var t=n;function r(ae,W){return ae<<W|ae>>>32-W}function s(ae,W){var B,V,X,ne,ce;return X=ae&2147483648,ne=W&2147483648,B=ae&1073741824,V=W&1073741824,ce=(ae&1073741823)+(W&1073741823),B&V?ce^2147483648^X^ne:B|V?ce&1073741824?ce^3221225472^X^ne:ce^1073741824^X^ne:ce^X^ne}function a(ae,W,B){return ae&W|~ae&B}function i(ae,W,B){return ae&B|W&~B}function o(ae,W,B){return ae^W^B}function u(ae,W,B){return W^(ae|~B)}function l(ae,W,B,V,X,ne,ce){return ae=s(ae,s(s(a(W,B,V),X),ce)),s(r(ae,ne),W)}function c(ae,W,B,V,X,ne,ce){return ae=s(ae,s(s(i(W,B,V),X),ce)),s(r(ae,ne),W)}function d(ae,W,B,V,X,ne,ce){return ae=s(ae,s(s(o(W,B,V),X),ce)),s(r(ae,ne),W)}function f(ae,W,B,V,X,ne,ce){return ae=s(ae,s(s(u(W,B,V),X),ce)),s(r(ae,ne),W)}function g(ae){for(var W,B=ae.length,V=B+8,X=(V-V%64)/64,ne=(X+1)*16,ce=Array(ne-1),k=0,P=0;P<B;)W=(P-P%4)/4,k=P%4*8,ce[W]=ce[W]|ae.charCodeAt(P)<<k,P++;return W=(P-P%4)/4,k=P%4*8,ce[W]=ce[W]|128<<k,ce[ne-2]=B<<3,ce[ne-1]=B>>>29,ce}function m(ae){var W="",B="",V,X;for(X=0;X<=3;X++)V=ae>>>X*8&255,B="0"+V.toString(16),W=W+B.substr(B.length-2,2);return W}var v=Array(),y,E,_,T,S,x,b,A,R,C=7,w=12,I=17,L=22,D=5,O=9,N=14,F=20,H=4,j=11,q=16,Q=23,U=6,$=10,K=15,G=21;for(v=g(t),x=1732584193,b=4023233417,A=2562383102,R=271733878,y=0;y<v.length;y+=16)E=x,_=b,T=A,S=R,x=l(x,b,A,R,v[y+0],C,3614090360),R=l(R,x,b,A,v[y+1],w,3905402710),A=l(A,R,x,b,v[y+2],I,606105819),b=l(b,A,R,x,v[y+3],L,3250441966),x=l(x,b,A,R,v[y+4],C,4118548399),R=l(R,x,b,A,v[y+5],w,1200080426),A=l(A,R,x,b,v[y+6],I,2821735955),b=l(b,A,R,x,v[y+7],L,4249261313),x=l(x,b,A,R,v[y+8],C,1770035416),R=l(R,x,b,A,v[y+9],w,2336552879),A=l(A,R,x,b,v[y+10],I,4294925233),b=l(b,A,R,x,v[y+11],L,2304563134),x=l(x,b,A,R,v[y+12],C,1804603682),R=l(R,x,b,A,v[y+13],w,4254626195),A=l(A,R,x,b,v[y+14],I,2792965006),b=l(b,A,R,x,v[y+15],L,1236535329),x=c(x,b,A,R,v[y+1],D,4129170786),R=c(R,x,b,A,v[y+6],O,3225465664),A=c(A,R,x,b,v[y+11],N,643717713),b=c(b,A,R,x,v[y+0],F,3921069994),x=c(x,b,A,R,v[y+5],D,3593408605),R=c(R,x,b,A,v[y+10],O,38016083),A=c(A,R,x,b,v[y+15],N,3634488961),b=c(b,A,R,x,v[y+4],F,3889429448),x=c(x,b,A,R,v[y+9],D,568446438),R=c(R,x,b,A,v[y+14],O,3275163606),A=c(A,R,x,b,v[y+3],N,4107603335),b=c(b,A,R,x,v[y+8],F,1163531501),x=c(x,b,A,R,v[y+13],D,2850285829),R=c(R,x,b,A,v[y+2],O,4243563512),A=c(A,R,x,b,v[y+7],N,1735328473),b=c(b,A,R,x,v[y+12],F,2368359562),x=d(x,b,A,R,v[y+5],H,4294588738),R=d(R,x,b,A,v[y+8],j,2272392833),A=d(A,R,x,b,v[y+11],q,1839030562),b=d(b,A,R,x,v[y+14],Q,4259657740),x=d(x,b,A,R,v[y+1],H,2763975236),R=d(R,x,b,A,v[y+4],j,1272893353),A=d(A,R,x,b,v[y+7],q,4139469664),b=d(b,A,R,x,v[y+10],Q,3200236656),x=d(x,b,A,R,v[y+13],H,681279174),R=d(R,x,b,A,v[y+0],j,3936430074),A=d(A,R,x,b,v[y+3],q,3572445317),b=d(b,A,R,x,v[y+6],Q,76029189),x=d(x,b,A,R,v[y+9],H,3654602809),R=d(R,x,b,A,v[y+12],j,3873151461),A=d(A,R,x,b,v[y+15],q,530742520),b=d(b,A,R,x,v[y+2],Q,3299628645),x=f(x,b,A,R,v[y+0],U,4096336452),R=f(R,x,b,A,v[y+7],$,1126891415),A=f(A,R,x,b,v[y+14],K,2878612391),b=f(b,A,R,x,v[y+5],G,4237533241),x=f(x,b,A,R,v[y+12],U,1700485571),R=f(R,x,b,A,v[y+3],$,2399980690),A=f(A,R,x,b,v[y+10],K,4293915773),b=f(b,A,R,x,v[y+1],G,2240044497),x=f(x,b,A,R,v[y+8],U,1873313359),R=f(R,x,b,A,v[y+15],$,4264355552),A=f(A,R,x,b,v[y+6],K,2734768916),b=f(b,A,R,x,v[y+13],G,1309151649),x=f(x,b,A,R,v[y+4],U,4149444226),R=f(R,x,b,A,v[y+11],$,3174756917),A=f(A,R,x,b,v[y+2],K,718787259),b=f(b,A,R,x,v[y+9],G,3951481745),x=s(x,E),b=s(b,_),A=s(A,T),R=s(R,S);return e==32?m(x)+m(b)+m(A)+m(R):m(b)+m(A)}const api_kugou=function(){const n={getMusicURLById:{url:({hash:f})=>(md5$1(f+"kgcloud"),`https://m.kugou.com/app/i/getSongInfo.php?cmd=playInfo&hash=${f}`),processRequestHeaders:t},getListByKeyword:{url:({keyword:f="",page:g=1,rows:m=20})=>`http://mobilecdn.kugou.com/api/v3/search/song?keyword=${encodeURIComponent(f)}&page=${g}&pagesize=${m}`},getLyricById:{url:({hash:f})=>`https://wwwapi.kugou.com/yy/index.php?r=play/getdata&hash=${f}`},getPicById:{url:({hash:f})=>`https://www.kugou.com/yy/index.php?r=play/getdata&hash=${f}`},getAlbumPic:{url:({hash:f})=>`https://www.kugou.com/yy/index.php?r=play/getdata&hash=${f}`}},e={method:"get",async:!0,responseType:"",headers:{"Content-Type":"application/json"}};function t({headers:f,config:g}){return f}function r(f){let g=null,m=!1;try{g=new URL(f),m=/kugou/gi.test(g.host)}catch{}if(!f||!g||!m)return null;let[v,y]=s(g.pathname);return v=a(v),!v||!y?null:{platform:"kugou",key:v,value:y}}function s(f){let g=f.split("/");g=g.filter(E=>E);let m=g.length;if(m<2)return[null,null];let[v,y]=[g[0],g[m-1]];return y=y.replace(/\.(html|htm)/gi,""),[v,y]}function a(f){return f&&{songlist:"playlist_id",mixsong:"music_id",kgmixsong:"music_id",singer:"singer_id",album_detail:"album_id"}[f.toLowerCase()]||""}function i(f){let g=f.response||f.responseText;try{let m=parseToJSON(g);return console.log("-->toJSON",{jsonObj:m}),m}catch{}return null}function o(f){let g=i(f);return g?u(g):{}}function u(f){let g={};const m={mixsongid:"music_id",song_name:"song",album:"album",albumid:"albumId_id",album_img:"album_img",author_name:"artist",singerName:"artist",singerId:"artist_id",timelength:"duration",imgUrl:"picture",hash:"hash",url:"url"};for(const[v,y]of Object.entries(f))m[v]&&(g[m[v]]=y);return g}function l(f,g,m="music_id"){if(console.log("~~parseHTML",{DOMParser:g}),!f)return null;var v=null;try{v=g}catch{}try{v=new g}catch{}var y=null;try{y=v(f,"text/html")}catch{}try{y=v.parseFromString(f,"text/html")}catch{}return console.log("~~parseHTML:oDOM",{oDOM:y,oParser:v}),{music_id:()=>c(y)}[m]()}function c(f){try{let m=[...f.scripts].filter(E=>/dataFromSmarty/gi.test(E.innerText))[0].innerText.match(/\{.*\}/gi),v=JSON.parse(m),y=u(v);return console.log("~~parseHTML:dataFromSmarty",{info:v,songinfo:y}),y}catch{}}return{init:function(f){if(!f||!has(f,"name")||isNull(f,"name"))return{...f};const g=n[f.name];if(!g)return{};const m=g.url(f.data),v=has(g,"method")?g.method:e.method,y=has(g,"async")?g.async:e.async,E=has(f,"responseType")?f.responseType:has(g,"responseType")?g.responseType:e.responseType;let _=has(f,"headers")?f.headers:e.headers,T={url:m,method:v,async:y,headers:_,responseType:E};return has(g,"processRequestHeaders")&&(_=g.processRequestHeaders({headers:_,config:f}),T.headers=_),T},parseURL:r,mapperSongInfo:o,parseHTML:l}};class MUSIC_API{constructor(e){this.platform=(e==null?void 0:e.platform)||"kuwo",this.apiInstance=this.getInstance()}static init(e){return this.platform=(e==null?void 0:e.platform)||"kuwo",this.apiInstance=this.getInstance(),(this.apiInstance||this.getInstance())().init(e)}static parseURL(e){let t=null;for(const[r,s]of Object.entries(this.APIs)){const a=s().parseURL(e);if(a&&(t=a),a)break}return this.platform=t?t.platform:null,this.apiInstance=this.getInstance(),t}static parseHTML(e,t){return!e||!t?null:(this.apiInstance||this.getInstance())().parseHTML(e,t)}static getInstance(e=""){return e&&(this.platform=e),this.platform||(this.platform="kuwo"),this.APIs[`api_${e||this.platform}`]||null}static mapperSongInfo(e){return(this.apiInstance||this.getInstance())().mapperSongInfo(e)}}we(MUSIC_API,"platform","kuwo"),we(MUSIC_API,"APIs",{api_kuwo,api_kugou}),we(MUSIC_API,"apiInstance",null);function awaitFunc(n){return n.then(e=>[null,e]).catch(e=>[e,null])}function getProxyConfig(n,e="uutool.cn",t=!0){return t?proxyList[e].config(n):{url:n}}function urlObjToForm(n){let e=[];for(const t in n){let r=n[t];e.push(t+"="+r)}return e.join("&")}async function proxyRequest(n,e=null,t=!0){let r={url:(n==null?void 0:n.url)||""};e&&(r=e().init(n),console.log("请求配置包:kgReq",{kgReq:r}));let s=(r==null?void 0:r.url)||(e==null?void 0:e.url),a=getProxyConfig(s,n.proxy||"wp");console.log("请求配置包:proxyConfig",{proxyConfig:a});let[i,o]=await awaitFunc(xhrProxySend(a));return o}async function xhrProxySend(n){let e={url:n.server,body:n.hasOwnProperty("param")?(n==null?void 0:n.requestType)=="json"?n.param:urlObjToForm(n.param):"",...n};const[t,r]=await awaitFunc(xhrSend(e));return console.log("~~~xhrProxySend:err, data",{err:t,data:r}),new Promise((s,a)=>{r&&n.responseCallback&&s(n.responseCallback(r)),r&&!n.responseCallback&&s(r),t&&a(t)})}async function xhrSend(n){var{xhr:e=new XMLHttpRequest,url:t="",method:r="GET",async:s=!0,responseType:a="",requestType:i="",username:o=null,password:u=null,done:l=null,error:c=null,progress:d=null,headers:f=[],body:g=null}=n;return console.log("xhrSend: ",{config:n}),new Promise((m,v)=>{if(e.responseType=a||"",e.open(r,t,s,o,u),f&&f.constructor.name=="Array"&&f&&f.length>0&&f.forEach(E=>{E.value=="application/json"&&(i="json"),e.setRequestHeader(E.name,E.value)}),f&&f.constructor.name=="Object")for(let[E,_]of Object.entries(f))e.setRequestHeader(E,_);e.onload=function(){e.readyState===4&&(e.status===200?(l&&l({xhr:e,response:this.response}),m(e)):(console.error("ERROR",e.statusText),c&&c(e),v(e)))},e.onerror=function(){console.log("ERROR",e.status,e,n),c&&c(e),v(e)},e.onprogress=function(E){d&&d({xhr:e,event:E}),d&&m(e)};let y=i=="json"?JSON.stringify(g):g;e.send(y)})}var apiUrl="https://api.1080zyku.com/inc/ldg_api_all.php";class ZYXML{constructor(e){this.groupList=[],this.videoList=[],this.resultText="",this.searchValue="",this.currentPage=1,this.totalItems=0,this.pageCount=1,this.showPageSize=6,this.itemsPerPage=20,this.vInfo={},this.PLATFORM=(e==null?void 0:e.PLATFORM)||"ZYK1080",this.filterENABLE=(e==null?void 0:e.filterENABLE)||!1,this.proxyENABLE=(e==null?void 0:e.proxyENABLE)||!1,apiUrl=(e==null?void 0:e.apiUrl)||"https://api.1080zyku.com/inc/ldg_api_all.php",console.log(`~~~~${this.PLATFORM}`,{config:e,apiUrl,PLATFORM:this.PLATFORM})}getURLByTId(e,t=1){return`${apiUrl}?ac=list&t=${e}&pg=${t}`}getURLById(e){return`${apiUrl}?ac=videolist&ids=${e}`}getURLByKeyword(e="",t=1){return`${apiUrl}?wd=${e}&pg=${t}`}getProxyConfig(e,t="uutool.cn"){return this.proxyENABLE?proxyList[t].config(e):{url:e}}async searchByKeywordDetail({keyword:e,tid:t=""}){return this.searchByKeyword({keyword:e,tid:t})}async searchByKeyword({keyword:e="",tid:t="",retryNum:r=3,callback:s=null}){var E,_,T,S,x,b;const a=this;this.resultText="";let i=t==""?e:t,o=t==""?this.getURLByKeyword(i,this.currentPage):this.getURLByTId(i,this.currentPage),u=this.getProxyConfig(o);const[l,c]=await awaitFunc(xhrProxySend(u));if(console.log("~~searchByKeyword~awaitFunc:",{err:l,data:c,proxyConfig:u}),!c||l||(c==null?void 0:c.response)==null)return this.resultText="结果:空",{};const d=c.response;console.log("~~searchByKeyword~xmlResponse:",{xmlResponse:d,proxyConfig:u});var f=new DOMParser,g=f.parseFromString(d,"application/xml");const m=xmlToJson(g);let v=(_=(E=m==null?void 0:m.rss)==null?void 0:E.class)==null?void 0:_.ty,y=(S=(T=m==null?void 0:m.rss)==null?void 0:T.list)==null?void 0:S.video;if(!this.resultText&&v&&v.length>0&&(this.groupList=[],v.forEach(A=>{let R=A["@attributes"].id,C=A["#text"];(this.filterENABLE&&!isInFilterKeyword([C])||!this.filterENABLE)&&a.groupList.push({tid:R,name:C})})),!y)return this.videoList=[],this.resultText="结果:空",{videoList:this.videoList,groupList:this.groupList};try{let A=(x=m==null?void 0:m.rss)==null?void 0:x.list["@attributes"],{page:R,pagecount:C,total:w,limit:I,pagesize:L,recordcount:D}=A;a.currentPage=R,a.totalItems=D||w,a.pageCount=C,a.itemsPerPage=I}catch{}if(y&&((b=y==null?void 0:y.constructor)==null?void 0:b.name)!="Array"){let A=JSON.parse(JSON.stringify(y));y=[],y.push(A)}return console.log({xmlObj:m,groupList:v,videoList:y}),this.videoList=[],y&&y.forEach((A,R,C)=>{let w="",I="",L="",D="",O="",N="",F="",H="";try{w=A==null?void 0:A.name["#cdata-section"]}catch{}try{I=(A==null?void 0:A.des["#cdata-section"])||"",I=I.trim()}catch{}try{L=A==null?void 0:A.note["#cdata-section"]}catch{}try{D=A==null?void 0:A.last["#text"]}catch{}try{N=A==null?void 0:A.pic["#text"]}catch{}try{H=A==null?void 0:A.year["#text"]}catch{}try{F=A==null?void 0:A.type["#text"]}catch{}try{O=`${w}
${L}
${H||D}
来源:${a.PLATFORM.NAME}
${I}`}catch{}(this.filterENABLE&&!isInFilterKeyword([F])||!this.filterENABLE)&&a.videoList.push({des:I,note:L,info:O,pic:N,year:H,name:A==null?void 0:A.name["#cdata-section"],id:A==null?void 0:A.id["#text"],tid:A==null?void 0:A.tid["#text"],type:A==null?void 0:A.type["#text"],last:A==null?void 0:A.last["#text"],url:`${apiUrl}?ac=videolist&ids=${A==null?void 0:A.id["#text"]}`})}),console.log({videoList:this.videoList,groupList:this.groupList}),{videoList:this.videoList,groupList:this.groupList,currentPage:this.currentPage,totalItems:a.totalItems,pageCount:a.pageCount,itemsPerPage:a.itemsPerPage}}async searchByGroupID(e){let{tid:t}=e;t&&this.searchByKeyword({keyword:"",tid:t})}async searchByVideoID({id:e,retryNum:t=3,callback:r=null,currentChannel:s=null}){var T,S,x,b,A;let a=this.getURLById(e),i=this.getProxyConfig(a);const[o,u]=await awaitFunc(xhrProxySend(i));if(o||!u)return;const l=u.response;var c=new DOMParser,d=c.parseFromString(l,"application/xml");const f=xmlToJson(d);let g=(S=(T=f==null?void 0:f.rss)==null?void 0:T.class)==null?void 0:S.ty,m=(b=(x=f==null?void 0:f.rss)==null?void 0:x.list)==null?void 0:b.video;if(console.log({xmlObj:f,groupList:g,video:m}),!g&&!m)return{newGroup:null};let v=(A=m==null?void 0:m.dl)==null?void 0:A.dd,y="";v.constructor.name=="Array"&&v.length>0&&v.forEach((R,C,w)=>{y=R["#cdata-section"]}),v.constructor.name=="Object"&&Object.keys(v).length>0&&(y=v["#cdata-section"]);let E={name:m==null?void 0:m.name["#cdata-section"],id:m==null?void 0:m.id["#text"],tid:m==null?void 0:m.tid["#text"],type:m==null?void 0:m.type["#text"],last:m==null?void 0:m.last["#text"],url:this.getURLById(m==null?void 0:m.id["#text"])},_={group:E.type,channel:{}};if(_.channel[E.name]=[],y){let R=y.split("#"),{id:C,tid:w,type:I}=E;R.forEach((L,D,O)=>{let[N,F,...H]=L.split("$");!F||F.indexOf("/share/")!=-1||F.indexOf(".m3u8")==-1||_.channel[E.name].push({name:N,value:F,search:{id:C,tid:w,type:I,line:H.join(),from:this.PLATFORM}})})}return{newGroup:_}}async searchDetailByVideoID(e){var R,C,w,I;const t=this;let r=this.getURLById(e),s=this.getProxyConfig(r);const[a,i]=await awaitFunc(xhrProxySend(s));if(a||!i)return;const o=i.response;var u=new DOMParser,l=u.parseFromString(o,"application/xml");const c=xmlToJson(l);(C=(R=c==null?void 0:c.rss)==null?void 0:R.class)==null||C.ty;let d=(I=(w=c==null?void 0:c.rss)==null?void 0:w.list)==null?void 0:I.video,f="",g="",m="",v="",y="",E="",_="",T="",S="",x="",b="";try{f=d==null?void 0:d.name["#cdata-section"]}catch{}try{g=(d==null?void 0:d.des["#cdata-section"])||"",g=g.trim()}catch{}try{m=d==null?void 0:d.note["#cdata-section"]}catch{}try{T=d==null?void 0:d.actor["#cdata-section"]}catch{}try{S=d==null?void 0:d.area["#text"]}catch{}try{x=d==null?void 0:d.director["#cdata-section"]}catch{}try{b=d==null?void 0:d.lang["#text"]}catch{}try{v=d==null?void 0:d.last["#text"]}catch{}try{E=d==null?void 0:d.pic["#text"]}catch{}try{_=d==null?void 0:d.year["#text"]}catch{}try{y=`${f}
${m}
${_||v}
来源:${t.PLATFORM.NAME}
${g}`}catch{}let A={des:g,note:m,info:y,pic:E,year:_,actor:T,area:S,director:x,lang:b,name:d==null?void 0:d.name["#cdata-section"],id:d==null?void 0:d.id["#text"],tid:d==null?void 0:d.tid["#text"],type:d==null?void 0:d.type["#text"],last:d==null?void 0:d.last["#text"],url:this.getURLById(d==null?void 0:d.id["#text"])};for(const L in A)if(Object.hasOwnProperty.call(A,L)){let D=A[L]||"";A[L]=D,this.vInfo[L]=D}return console.log({xmlObj:c,video:d,vInfo:A}),{vInfo:A}}}const htmlStatusCode={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",444:"Connection Closed Without Response",451:"Unavailable For Legal Reasons",499:"Client Closed Request",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required",599:"Network Connect Timeout Error","1××":"Informational","2××":"Success","3××":"Redirection","4××":"Client Error","5××":"Server Error"},INFO$1={URL:"https://api.yparse.com/api/json/",PLATFORM:"ZYJSON"};class ZYJSON{constructor(e){this.groupList=[],this.videoList=[],this.audioList=[],this.resultText="",this.searchValue="",this.currentPage=1,this.totalItems=0,this.pageCount=1,this.showPageSize=6,this.itemsPerPage=20,this.mediaInfo={},this.playfrom=(e==null?void 0:e.playfrom)||"",this.iframe=(e==null?void 0:e.iframe)||!1,this.filterENABLE=(e==null?void 0:e.filterENABLE)||!1,this.proxyENABLE=(e==null?void 0:e.proxyENABLE)||!1,this.API={getURL_ByID:t=>`${this.getFullURL()}?ac=detail&ids=${t}`,getURL_ByKeyword:(t="",r=1)=>`${this.getFullURL()}?wd=${t}&pg=${r}`,getURL_ByTypeId:(t,r=1)=>`${this.getFullURL()}?ac=list&t=${t}&pg=${r}`,getURL_ByKeywordDetail:(t="",r=1)=>`${this.getFullURL()}?ac=detail&wd=${t}&pg=${r}`,getURL_ByTypeIdDetail:(t,r=1)=>`${this.getFullURL()}?ac=detail&t=${t}&pg=${r}`},INFO$1.PLATFORM=(e==null?void 0:e.PLATFORM)||INFO$1.PLATFORM,INFO$1.URL=(e==null?void 0:e.apiUrl)||INFO$1.URL,console.log(`~~~~${INFO$1.PLATFORM}`,{config:e,apiUrl:INFO$1.URL})}getFullURL(){return INFO$1.URL+this.playfrom}awaitFunc(e){return e.then(t=>[null,t]).catch(t=>[t,null])}getProxyConfig(e,t="uutool.cn"){return this.proxyENABLE?proxyList[t].config(e):{url:e}}async searchByKeywordDetail({keyword:e="",tid:t="",retryNum:r=3,callback:s=null}){this.resultText="";let a=t==""?e:t,i=t==""?this.API.getURL_ByKeywordDetail(a,this.currentPage):this.API.getURL_ByTypeIdDetail(a,this.currentPage),o=this.getProxyConfig(i);const[u,l]=await this.awaitFunc(xhrProxySend(o));console.log("~~searchByKeyword~awaitFunc:",{err:u,data:l}),l&&this.handle_keywordDetail().success(l,s),u&&this.handle_keywordDetail().error(u,s)}async searchByKeyword({keyword:e="",tid:t="",retryNum:r=3,callback:s=null}){this.resultText="";let a=t==""?e:t,i=t==""?this.API.getURL_ByKeyword(a,this.currentPage):this.API.getURL_ByTypeId(a,this.currentPage),o=this.getProxyConfig(i);const[u,l]=await this.awaitFunc(xhrProxySend(o));console.log("~~searchByKeyword~awaitFunc:",{err:u,data:l}),l&&this.handle_keyword().success(l,s),u&&this.handle_keyword().error(u,s)}async searchByGroupID(e){let{tid:t}=e;t&&this.searchByKeyword({keyword:"",tid:t})}async searchByVideoID({id:e,retryNum:t=3,callback:r=null,currentChannel:s=null}){this.resultText="";let a=this.API.getURL_ByID(e),i=this.getProxyConfig(a);const[o,u]=await this.awaitFunc(xhrProxySend(i));u&&this.handle_id().success(u,r),o&&this.handle_id().error(o,r)}async searchDetailByVideoID(e,t=3){let r=this.API.getURL_ByID(e),s=this.getProxyConfig(r);const[a,i]=await this.awaitFunc(xhrProxySend(s));if(a)return this.handle_detail().error(a);if(i)return this.handle_detail().success(i)}handle_detail(){const e=this;return{error:(t,r=null)=>(console.log("~~!!handle_detail::error",{error:t}),e.resultText="结果:空",null),success:(t,r=null)=>{let s=t.response;console.log("~~jsonResponse",{data:t,responseText:s});let a=null;try{typeof s=="object"&&(a=s),typeof s=="string"&&(a=JSON.parse(s))}catch(i){console.error(i)}return console.log("~~jsonResponse:response",{response:a}),!a||!a.list||(a==null?void 0:a.list.length)==0?(e.resultText="结果:空",null):e.handle_detail().handle(a)},handle:t=>{let r=t==null?void 0:t.list[0];console.log("~~jsonResponse:video",{video:r});let s={des:r==null?void 0:r.vod_blurb,note:r==null?void 0:r.vod_sub,info:r==null?void 0:r.vod_content,pic:r==null?void 0:r.vod_pic,year:r==null?void 0:r.vod_year,actor:r==null?void 0:r.vod_actor,area:r==null?void 0:r.vod_area,director:r==null?void 0:r.vod_director,lang:r==null?void 0:r.vod_lang,name:r==null?void 0:r.vod_name,id:r==null?void 0:r.vod_id,tid:r==null?void 0:r.type_id,type:r==null?void 0:r.type_name,last:r==null?void 0:r.vod_time,url:e.API.getURL_ByID(r==null?void 0:r.vod_id)};console.log("~~jsonResponse:vInfo",{vInfo:s});for(const a in s)if(Object.hasOwnProperty.call(s,a)){const i=s[a]||"";s[a]=i}return console.log({response:t,video:r,vInfo:s}),{vInfo:s}}}}handle_keyword(){const e=this;return{error:(t,r=null)=>{console.log("~~!!handle_keyword::error",{error:t});let{status:s}=t;return e.resultText=`错误: Code: ${s} ${htmlStatusCode[s]||""}，该资源服务端(跨域限制)，请开启浏览器插件允许跨域或开启代理网络后重试。`,r&&r(null),null},success:(t,r=null)=>{console.log("~~!!handle_keyword::success",{data:t}),setTimeout(()=>{let s=t==null?void 0:t.response;console.log("~~jsonResponse",{data:t,responseText:s});let a=null;try{typeof s=="object"&&(a=s),typeof s=="string"&&(a=JSON.parse(s))}catch(i){console.error(i)}if(console.log("~~jsonResponse:response",{response:a}),a){let i=e.handle_keyword().handle(a);r&&r(i)}else return e.resultText="结果:空",r&&r(null),null},500)},handle:t=>{let r=t==null?void 0:t.class,s=t==null?void 0:t.list;if(!e.resultText&&r&&r.length>0&&(e.groupList=[],r.forEach(a=>{let i=a.type_id,o=a.type_name;(this.filterENABLE&&!isInFilterKeyword([o])||!this.filterENABLE)&&e.groupList.push({tid:i,name:o})})),!s)return e.videoList=[],e.resultText="结果:空",{videoList:e.videoList,groupList:e.groupList};try{let{page:a,pagecount:i,total:o,limit:u,pagesize:l,recordcount:c}=t;e.currentPage=a,e.totalItems=o,e.pageCount=i,e.itemsPerPage=u}catch{}return e.videoList=[],s&&s.forEach((a,i,o)=>{let u="",l="",c="",d="",f="",g="",m="",v="";try{u=a==null?void 0:a.vod_name}catch{}try{l=(a==null?void 0:a.vod_blurb)||"",l=l.trim()}catch{}try{c=a==null?void 0:a.vod_remarks}catch{}try{d=a==null?void 0:a.vod_time}catch{}try{g=a==null?void 0:a.vod_pic}catch{}try{v=a==null?void 0:a.vod_year}catch{}try{m=a==null?void 0:a.type_name}catch{}try{f=`${u}
${c}
${v||d}
来源:${e.playfrom}
${l}`}catch{}(this.filterENABLE&&!isInFilterKeyword([m])||!this.filterENABLE)&&e.videoList.push({des:l,note:c,info:f,pic:g,year:v,name:a==null?void 0:a.vod_name,id:a==null?void 0:a.vod_id,tid:a==null?void 0:a.type_id,type:a==null?void 0:a.type_name,last:a==null?void 0:a.vod_time,url:e.API.getURL_ByID(a==null?void 0:a.vod_id)})}),console.log("结果：",{videoList:e.videoList,groupList:e.groupList}),{videoList:e.videoList,groupList:e.groupList,currentPage:e.currentPage,totalItems:e.totalItems,pageCount:e.pageCount,itemsPerPage:e.itemsPerPage}}}}optimizeJSONFormat(e){var a,i;let t=null,r=!0,s=10;for(;r&&--s>0;)try{typeof e=="object"&&(t=e),typeof e=="string"&&(t=JSON.parse(e)),r=!1;break}catch(o){let u=~~((i=(a=o==null?void 0:o.message)==null?void 0:a.match(/\d/gi))==null?void 0:i.join("")),l=e[u];if(console.log({autofixNum:s,autofixJSON:r},{position:u,chat:l,error:o}),u>0){let c=e.slice(0,u-2),d=e.slice(u,e.length);e=c+d,console.log({content:e,begin:c,end:d})}else break}return t}handle_keywordDetail(){const e=this;return{error:(t,r=null)=>{console.log("~~!!handle_keywordDetail::error",{error:t});let{status:s}=t;return e.resultText=`错误: Code: ${s} ${htmlStatusCode[s]||""}，该资源服务端(跨域限制)，请开启浏览器插件允许跨域或开启代理网络后重试。`,r&&r(null),null},success:(t,r=null)=>{console.log("~~!!handle_keywordDetail::success",{data:t}),setTimeout(()=>{let s=t==null?void 0:t.response;console.log("~~jsonResponse",{data:t,responseText:s});let a=this.optimizeJSONFormat(s);if(console.log("~~jsonResponse:response",{response:a}),a){let i=e.handle_keywordDetail().handle(a);r&&r(i)}else return e.resultText="结果:空",r&&r(null),null},500)},handle:t=>{let r=t==null?void 0:t.class,s=t==null?void 0:t.list;if(!e.resultText&&r&&r.length>0&&(e.groupList=[],r.forEach(a=>{let i=a.type_id,o=a.type_name;(this.filterENABLE&&!isInFilterKeyword([o])||!this.filterENABLE)&&e.groupList.push({tid:i,name:o})})),!s)return e.videoList=[],e.resultText="结果:空",{videoList:e.videoList,groupList:e.groupList};try{let{page:a,pagecount:i,total:o,limit:u,pagesize:l,recordcount:c}=t;e.currentPage=a,e.totalItems=o,e.pageCount=i,e.itemsPerPage=u}catch{}return e.videoList=[],s&&s.forEach((a,i,o)=>{let u="",l="",c="",d="",f="",g="",m="",v="";try{u=a==null?void 0:a.vod_name}catch{}try{l=(a==null?void 0:a.vod_blurb)||"",l=l.trim()}catch{}try{c=a==null?void 0:a.vod_remarks}catch{}try{d=a==null?void 0:a.vod_time}catch{}try{g=a==null?void 0:a.vod_pic}catch{}try{v=a==null?void 0:a.vod_year}catch{}try{m=a==null?void 0:a.type_name}catch{}try{f=`${u}
${c}
${v||d}
来源:${e.playfrom}
${l}`}catch{}if(this.filterENABLE&&!isInFilterKeyword([m])||!this.filterENABLE){let y={des:l,note:c,info:f,pic:g,year:v,name:a==null?void 0:a.vod_name,id:a==null?void 0:a.vod_id,tid:a==null?void 0:a.type_id,type:a==null?void 0:a.type_name,last:a==null?void 0:a.vod_time,playUrl:a==null?void 0:a.vod_play_url,url:e.API.getURL_ByID(a==null?void 0:a.vod_id)};y={...y,newGroup:this.parseM3U8Text(y)},e.videoList.push(y)}}),console.log("结果：",{videoList:e.videoList,groupList:e.groupList}),{videoList:e.videoList,groupList:e.groupList,currentPage:e.currentPage,totalItems:e.totalItems,pageCount:e.pageCount,itemsPerPage:e.itemsPerPage}}}}parseM3U8Text({playUrl:e,id:t,tid:r,type:s,name:a}){const i=this;if(!e)return{newGroup:null};let o=e==null?void 0:e.split("$$$").join("#"),u={group:s,channel:{[a]:[]}};return o?o.split("#").forEach((c,d,f)=>{if(c){let[g,m,...v]=c.split("$");if(!i.iframe&&(!m||m.indexOf("/share/")!=-1||m.indexOf(".m3u8")==-1))return;u.channel[a].push({name:g,value:m,iframe:i.iframe,search:{id:t,tid:r,type:s,line:v.join(),from:INFO$1.PLATFORM,playfrom:this.playfrom}})}}):u.channel[a].push({name:"空",value:"空",iframe:i.iframe,search:{id:t,tid:r,type:s,from:INFO$1.PLATFORM,playfrom:this.playfrom}}),u}handle_id(){const e=this;return{error:t=>(console.log("~~!!handle_id::error",{error:t}),e.resultText="错误:请求被中断，请查看是否有请求跨域限制。",null),success:(t,r=null)=>{console.log("~~!!handle_id::success",{data:t});let s=t==null?void 0:t.response;console.log("~~jsonResponse",{data:t,responseText:s});let a=null;try{typeof s=="object"&&(a=s),typeof s=="string"&&(a=JSON.parse(s))}catch(i){console.error(i)}if(console.log("~~jsonResponse:response",{response:a}),a){let i=e.handle_id().handle(a);r&&r(i)}else return e.resultText="结果:空",null},handle:t=>{let r=t==null?void 0:t.class,s=t==null?void 0:t.list;if(console.log({response:t,groupList:r,videoList:s}),!r&&!s&&s.length==0)return{newGroup:null};let a=s[0],i={des:a==null?void 0:a.vod_blurb,note:a==null?void 0:a.vod_sub,info:a==null?void 0:a.vod_content,pic:a==null?void 0:a.vod_pic,year:a==null?void 0:a.vod_year,actor:a==null?void 0:a.vod_actor,area:a==null?void 0:a.vod_area,director:a==null?void 0:a.vod_director,lang:a==null?void 0:a.vod_lang,name:a==null?void 0:a.vod_name,id:a==null?void 0:a.vod_id,tid:a==null?void 0:a.type_id,type:a==null?void 0:a.type_name,last:a==null?void 0:a.vod_time,playUrl:a==null?void 0:a.vod_play_url,url:e.API.getURL_ByID(a==null?void 0:a.vod_id)};return{newGroup:this.parseM3U8Text(i)}}}}}const iptv_api=function(){const n={getListByKeyword:{url:({keyword:s="",page:a=1})=>s?`http://tonkiang.us/?page=${a}&s=${encodeURIComponent(s)}`:"http://tonkiang.us/"}},e={method:"get",async:!0,responseType:"",headers:{}};return{init:function(s){if(!s||!has(s,"name")||isNull(s,"name"))return null;const a=n[s.name],i=a.url(s.data),o=has(a,"method")?a.method:e.method,u=has(a,"async")?a.async:e.async,l=has(s,"responseType")?s.responseType:has(a,"responseType")?a.responseType:e.responseType;let c=has(s,"headers")?s.headers:e.headers,d={url:i,method:o,async:u,headers:c,responseType:l};return has(a,"processRequestHeaders")&&(c=a.processRequestHeaders({headers:c,config:s}),d.headers=c),d},processResponseBody:function(s,a){if(console.log("~~processResponseBody",has(s,"responseText"),{DOMParser:a}),!s||!s.responseText)return null;var i=null;try{i=a}catch{}try{i=new a}catch{}var o=null;try{o=i(s.responseText,"text/html")}catch{}try{o=i.parseFromString(s.responseText,"text/html")}catch{}console.log("~~processResponseBody:oDOM",{oDOM:o,oParser:i});var u=1,l=20,c=1,d=0;const f=o.querySelectorAll('a[href*="?page"]'),g=f[f.length-1];if(g){let x=g==null?void 0:g.href;try{const b=new URLSearchParams(new URL(x).search);b&&(c=getNumber(b.get("page")))}catch{x&&(c=getNumber(x))}}const m=o.querySelector('div[style*="margin: 0 auto; max-width: 900px"]');m&&(d=getNumber(m.childNodes[0].textContent));const v=o.querySelector('div.sh[style*="background"]');v&&(u=getNumber(v.textContent));var y=o.getElementsByTagName("tr");y&&(l=y.length);let E=o.querySelectorAll("span.sh>a"),_=[];E&&(_=[...E].reduce((x,b)=>[...x,b==null?void 0:b.textContent.trim()],[])),console.log("~~hotKeywords",{hotKeywords:E,hotKeys:_});var T={currentPage:u,itemsPerPage:l,pageCount:c,totalItems:d,data:[],hotKeys:_};if(y&&y.length>0)for(let x of y){var S=[...x.getElementsByTagName("td")];let[b,A,R]=[...S],[C,...w]=b.textContent.split("	");C&&R&&T.data.push({name:C.trim(),value:R==null?void 0:R.textContent.trim(),note:w.join("").trim()})}return T}}};let ZYIPTV$1=class{constructor(e){this.groupList=[],this.videoList=[],this.audioList=[],this.resultText="",this.searchValue="",this.currentPage=1,this.totalItems=0,this.pageCount=1,this.showPageSize=6,this.itemsPerPage=20,this.mediaInfo={},this.currentChannel=null,this.playfrom=e==null?void 0:e.PLATFORM,this.iframe=(e==null?void 0:e.iframe)||!1,this.filterENABLE=(e==null?void 0:e.filterENABLE)||!1,this.proxyENABLE=(e==null?void 0:e.proxyENABLE)||!1,console.log(`~~~~${this.playfrom}`,{config:e})}async searchByKeywordDetail({keyword:e,tid:t="",retryNum:r=3,callback:s=null}){return this.searchByKeyword({keyword:e,tid:t,retryNum:r,callback:s})}async searchByGroupID(e){let{tid:t,name:r}=e;t&&this.searchByKeyword({keyword:r,tid:t})}async searchByVideoID({id:e,retryNum:t=3,callback:r=null,currentChannel:s=null}){}async searchDetailByVideoID(e,t=3){}async searchByKeyword({keyword:e="",tid:t="",retryNum:r=3,callback:s=null}){if(t!=""&&this.groupList)try{e=this.searchValue||this.groupList[~~t].name}catch{}this.searchValue=e;let a=null;return this.searchValue?a=await this.request({name:"getListByKeyword",data:{keyword:e,page:this.currentPage}}):a={currentPage:1,itemsPerPage:0,pageCount:0,totalItems:0,data:[],hotKeys:this.getHotKeys()},console.log("~~searchByKeyword",{result:a}),this.handler(a)}getHotKeys(){return["samsung","cdn","douyincdn","amazonaws","cztvcloud","unreel.me","wurl.tv","gsn-cinevault","rakuten","xiaomi.wurl.tv","video","tv","tx.hls.huya","liveplay","qcloud","vodcdn.video.taobao.com","cloud.video.taobao.com","bcovlive-a.akamaihd.net","121.51.249.48","38.64.72.148","50.7.220.74","210.210.155.35"]}getProxyConfig(e,t="uutool.cn"){var r;return this.proxyENABLE?(r=proxyList[t])==null?void 0:r.config(e):{url:e}}async request(e){const t=this;let r=iptv_api().init(e);console.log("请求配置包",e.name,{kgReq:r});let s=this.getProxyConfig(r.url);const[a,i]=await awaitFunc(xhrProxySend(s));if(console.log("~Response:xhrSend~",e.name,{err:a,data:i}),!i)return t.resultText="结果:空",null;i.responseText||(i.responseText=i.response);let o=i!=null?iptv_api().processResponseBody(i,DOMParser):null;return console.log("~Response~",e.name,{result:o}),o}handler(e){const t=this;if(!e)return t.resultText="结果:空",null;let{currentPage:r,itemsPerPage:s,pageCount:a,totalItems:i,data:o,hotKeys:u}=e;u=this.getHotKeys();try{t.currentPage=r,t.totalItems=i,t.pageCount=a,t.itemsPerPage=s}catch{}if(console.log("~handler~",t.resultText,{result:e,data:o}),!o)return null;if(u&&u.length>0){t.groupList=[];for(const c in u){const d=u[c];(this.filterENABLE&&!isInFilterKeyword([d])||!this.filterENABLE)&&t.groupList.push({tid:c,name:d})}}this.videoList=[];var l=1;r=~~r;for(const c of o){(!c||!(c!=null&&c.name))&&(c.name="无名");let f=s*(r-1)+l++-(r-1),g="",m="",v="",y="",E="",_="",T="",S=[];try{g=(c==null?void 0:c.name)+"_"+f}catch{}try{m=(c==null?void 0:c.vod_blurb)||"",m=m.trim()}catch{}try{v=(c==null?void 0:c.note)||""}catch{}try{y=(c==null?void 0:c.vod_time)||""}catch{}try{_=c==null?void 0:c.image}catch{}try{T=(c==null?void 0:c.vod_year)||""}catch{}try{E=c==null?void 0:c.value}catch{}S.push(`${g}$${c==null?void 0:c.value}`);let x={des:m,note:v,info:E,pic:_,year:T,name:g,last:y,id:c==null?void 0:c.contentId,tid:c==null?void 0:c.tid,type:t.searchValue,playUrl:S.join("#"),url:c==null?void 0:c.value};x={...x,newGroup:this.parseM3U8Text(x)},c!=null&&c.name&&t.videoList.push(x)}return console.log("结果：",{videoList:t.videoList,groupList:t.groupList}),{videoList:t.videoList,groupList:t.groupList,currentPage:t.currentPage,totalItems:t.totalItems,pageCount:t.pageCount,itemsPerPage:t.itemsPerPage}}parseM3U8Text({playUrl:e,id:t,tid:r,type:s,name:a}){const i=this,o=(s||a)+"_P"+i.currentPage;if(!e)return{newGroup:null};let u=e==null?void 0:e.split("$$$").join("#"),l={group:s,channel:{[o]:[]}};return u?u.split("#").forEach((d,f,g)=>{if(d){let[m,v,...y]=d.split("$");l.channel[o].push({name:m,value:v,iframe:i.iframe,search:{id:t,tid:r,type:s,line:y.join(),from:this.playfrom,playfrom:""}})}}):l.channel[o].push({name:"空",value:"空",iframe:i.iframe,search:{id:t,tid:r,type:s,from:this.playfrom,playfrom:""}}),l}};const INFO={URL:"https://search.kuwo.cn/",PLATFORM:"ZYMUSIC"};let ZYMUSIC$1=class{constructor(n){this.groupList=[],this.videoList=[],this.audioList=[],this.resultText="",this.searchValue="",this.currentPage=1,this.totalItems=0,this.pageCount=1,this.showPageSize=1,this.itemsPerPage=20,this.mediaInfo={},this.currentChannel=null,this.playfrom=n==null?void 0:n.PLATFORM,this.iframe=(n==null?void 0:n.iframe)||!1,this.filterENABLE=(n==null?void 0:n.filterENABLE)||!1,this.proxyENABLE=(n==null?void 0:n.proxyENABLE)||!1,this.proxyName=(n==null?void 0:n.proxyName)||"",this.API={getURL_ByID:(e,t="song",r="320kmp3")=>`https://www.kuwo.cn/api/v1/www/music/playUrl?mid=${e}&type=${t}&httpsStatus=1&br=${r}&reqId=${this.guid()}`,getURL_ByKeyword:(e="",t=1,r=this.itemsPerPage)=>`https://search.kuwo.cn/r.s?client=kt&all=${encodeURIComponent(e)}&pn=${t-1}&rn=${r}&ft=music&plat=pc&cluster=1&result=json&rformat=json&ver=mbox&show_copyright_off=1&vipver=MUSIC_8.1.2.0_W4&encoding=utf8`,getURL_LyricById:e=>`https://m.kuwo.cn/newh5/singles/songinfoandlrc?musicId=${e}`,getURL_PicById(e,t="128"){return`http://artistpicserver.kuwo.cn/pic.web?corp=kuwo&type=rid_pic&pictype=url&content=list&size=${t}&rid=${e}`},getURL_albumpic(e){return e?`https://img1.kuwo.cn/star/albumcover/${e}`:""}},INFO.PLATFORM=(n==null?void 0:n.PLATFORM)||INFO.PLATFORM,INFO.URL=(n==null?void 0:n.apiUrl)||INFO.URL,console.log(`~~~~${INFO.PLATFORM}`,{config:n,apiUrl:INFO.URL})}guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=Math.random()*16|0,t=n=="x"?e:e&3|8;return t.toString(16)})}getFullURL(){return INFO.URL+this.playfrom}awaitFunc(n){return n.then(e=>[null,e]).catch(e=>[e,null])}getProxyConfig(n,e="uutool.cn"){return this.proxyENABLE?proxyList[e].config(n):{url:n}}async getLyric(n){let e=n.match(/\d+/gi),t=this.API.getURL_LyricById(e),r=this.getProxyConfig(t);const[s,a]=await this.awaitFunc(xhrProxySend(r));return console.log("~~getLyric~awaitFunc~Lyric:",{err:s,data:a}),{err:s,data:a}}async getMV(n){var u;let e=n.match(/\d+/gi),t=this.API.getURL_ByID(e,"mv"),r=this.getProxyConfig(t);const[s,a]=await this.awaitFunc(xhrProxySend(r));let i=null,o="";try{i=parseToJSON$1(a.response),o=(u=i==null?void 0:i.data)==null?void 0:u.url}catch{}return console.log("~~getMV~awaitFunc~Lyric:",{err:s,data:a,mvData:i,mvURL:o}),{mvURL:o}}async getHotListDetailHTML({tid,channelName}){let result=await proxyRequest({name:"getHotListDetailHTML",proxy:this.proxyName,data:{tid}},MUSIC_API.getInstance(MUSIC_API.platform));if(console.log("getHotListDetailHTML",{result,responseText:result==null?void 0:result.responseText}),result&&result.response){let scriptInfo=result.response.match(/<script>window\.__NUXT__([\w\W]*?)<\/script>/gi)[0].replace(/(\<script\>|\<\/script\>)/gi,"")||"";eval(scriptInfo);let songInfo=window.__NUXT__.data[0].songInfo||window.__NUXT__.data[0].songinfo||null,musicList=[];try{musicList=window.__NUXT__.data[0].playListInfo.musicList}catch(n){}try{musicList=window.__NUXT__.data[0].albumInfo.musicList}catch(n){}return console.log("queryHTMLPage::",{n:window.__NUXT__,scriptInfo,musicList,songInfo}),this.createNewGroupChannels({musicList,channelName})}return null}createNewGroupChannels(n){let e={group:this.playfrom,channel:{}};for(let t of n.musicList)e.channel[n.channelName]||(e.channel[n.channelName]=[]),e.channel[n.channelName].push({name:t.artist+"-"+t.name,value:"update",iframe:this.iframe,search:{id:t.rid||t.musicrid.replace(/[^\d]/gi,""),tid:"",from:this.playfrom}});return console.log("~~newGroup:",{newGroup:e}),{newGroup:e}}async getHotListHTML(){let result=await proxyRequest({name:"getHotListHTML",proxy:this.proxyName},MUSIC_API.getInstance(MUSIC_API.platform));if(console.log("getHotListHTML",{result,responseText:result==null?void 0:result.responseText,pform:MUSIC_API.platform,MUSIC_API}),result&&result.response){let scriptInfo=result.response.match(/<script>window\.__NUXT__([\w\W]*?)<\/script>/gi)[0].replace(/(\<script\>|\<\/script\>)/gi,"")||"";eval(scriptInfo);let songInfo=window.__NUXT__.data[0].songInfo||window.__NUXT__.data[0].songinfo||null,musicList=[];try{musicList=window.__NUXT__.data[0].playList}catch(n){}return console.log("queryHTMLPage::",{n:window.__NUXT__,scriptInfo,musicList,songInfo}),console.log("~~~parseHTML:scriptInfo",{musicList,scriptInfo}),!musicList||musicList&&musicList.length==0?null:this.createNewGroup(musicList)}}createNewGroup(n){let e={group:this.playfrom,channel:{}};for(let t of n)e.channel[t.name]||(e.channel[t.name]=[]),e.channel[t.name].push({name:"loading",value:"update",iframe:this.iframe,search:{name:"getHotListDetailHTML",tid:t.id||t.tid,from:this.playfrom}});return console.log("~~newGroup:",{newGroup:e}),e}async searchByKeywordDetail({keyword:n,tid:e="",retryNum:t=3,callback:r=null}){return this.searchByKeyword({keyword:n,tid:e,retryNum:t,callback:r})}async searchByKeyword({keyword:n="",tid:e="",retryNum:t=3,callback:r=null}){if(!n)return;this.resultText=n,this.searchValue=n;let s=e==""?n:e,a=e==""?this.API.getURL_ByKeyword(s,this.currentPage):this.API.getURL_ByKeyword(s,this.currentPage),i=this.getProxyConfig(a);const[o,u]=await this.awaitFunc(xhrProxySend(i));console.log("~~searchByKeyword~awaitFunc:",{err:o,data:u,callback:r}),u&&this.handle_keyword().success(u,r),o&&this.handle_keyword().error(o,r)}async searchByGroupID(n){let{tid:e}=n;e&&this.searchByKeyword({keyword:"",tid:e})}async searchByVideoID({id:n,retryNum:e=3,callback:t=null,currentChannel:r=null}){const s=this;r!=null&&(s.currentChannel=r),n=`${n}`.match(/\d/gi).join("");let a=this.API.getURL_ByID(n),i=this.getProxyConfig(a);const[o,u]=await this.awaitFunc(xhrProxySend(i));console.log("~~searchByVideoID~awaitFunc:",{err:o,data:u,id:n,currentChannel:r}),u&&(u.id=n);let l=null;return u!=null&&(l=await this.handle_id().success(u,t)),o&&(l=this.handle_id().error(o,t)),console.log("~~~~searchByVideoID:[err, data]",{err:o,data:u,result:l}),l}async searchDetailByVideoID(n,e=3){let t=n.match(/\d+/gi);t&&(t=t[0]);let r=this.API.getURL_LyricById(t);console.log("~~~searchDetailByVideoID",{id:n,mid:t,url:r});let s=this.getProxyConfig(r);const[a,i]=await this.awaitFunc(xhrProxySend(s));if(console.log("~~searchDetailByVideoID~awaitFunc:",{err:a,data:i}),a)return this.handle_detail().error(a);if(i)return this.handle_detail().success(i)}handle_detail(){const n=this;return{error:(e,t=null)=>(console.log("~~!!handle_detail::error",{error:e}),n.resultText="结果:空",null),success:(e,t=null)=>{let r=e.response;console.log("~~jsonResponse",{data:e,responseText:r});let s=null;try{s=parseToJSON$1(r)}catch(a){console.error(a)}return console.log("~~jsonResponse:response",{response:s}),!s||!(s!=null&&s.data)||!(s!=null&&s.data.songinfo)?(n.resultText="结果:空",null):n.handle_detail().handle(s)},handle:e=>{var s,a;let t=e==null?void 0:e.data.songinfo;console.log("~~handle_detail:song",{song:t});let r={des:t==null?void 0:t.blurb,note:t==null?void 0:t.sub,info:t==null?void 0:t.content,year:t==null?void 0:t.year,area:t==null?void 0:t.area,director:t==null?void 0:t.artist,lang:t==null?void 0:t.lang,pic:t==null?void 0:t.pic,artist:t==null?void 0:t.artist,actor:t==null?void 0:t.artist,name:t==null?void 0:t.songName,id:t==null?void 0:t.id,tid:t==null?void 0:t.albumId,type:escape2Html(t==null?void 0:t.album),last:t==null?void 0:t.songTimeMinutes,lyric:(s=e==null?void 0:e.data)==null?void 0:s.lrclist,url:n.API.getURL_ByID((a=t==null?void 0:t.id)==null?void 0:a.match(/\d/gi).join(""))};console.log("~~jsonResponse:vInfo",{vInfo:r});for(const i in r)if(Object.hasOwnProperty.call(r,i)){const o=r[i]||"";r[i]=o}return console.log({response:e,song:t,vInfo:r}),{vInfo:r}}}}handle_keyword(){const n=this;return{error:(e,t=null)=>{console.log("~~!!handle_keyword::error",{error:e});let{status:r}=e;return n.resultText=`错误: Code: ${r} ${htmlStatusCode[r]||""}，请稍后重试。`,t&&t(null),null},success:(e,t=null)=>{console.log("~~!!handle_keyword::success",{data:e}),setTimeout(()=>{let r=e==null?void 0:e.response;r=r.replace(/\'/gi,'"'),console.log("~~jsonResponse",{data:e,responseText:r});let s=null;try{s=parseToJSON$1(r)}catch(a){console.error(a)}if(console.log("~~jsonResponse:response",{response:s}),s){let a=n.handle_keyword().handle(s);console.log("~~handle_keyword:newItem",{newItem:a,callback:t}),t&&t(a)}else return n.resultText="结果:空",t&&t(null),null},500)},handle:e=>{console.log("~~handle_keyword:handle",{response:e});let t=e==null?void 0:e.abslist,r=e==null?void 0:e.abslist;if(!n.resultText&&t&&t.length>0&&(n.groupList=[],t.forEach(s=>{n.groupList.push({tid:s.ALBUMID,name:s.ALBUM})})),!r||r&&t&&r.length==0&&t.length==0)return n.videoList=[],n.resultText="结果:空",{videoList:n.videoList,groupList:n.groupList};try{let{PN:s,SHOW:a,TOTAL:i,RN:o,pagesize:u,recordcount:l}=e;n.currentPage=~~s+1,n.totalItems=i,n.pageCount=a,n.itemsPerPage=o}catch{}return n.videoList=[],r&&r.forEach((s,a,i)=>{var{ALBUM:o,ALBUMID:u,ARTISTID:l,ARTIST:c,MUSICRID:d,hts_MVPIC:f,NAME:g,SONGNAME:m,DURATION:v}=s;let y="",E="",_="",T="",S="",x="",b="",A=n.API.getURL_albumpic(s==null?void 0:s.web_albumpic_short);try{y=s==null?void 0:s.NAME}catch{}try{E=(s==null?void 0:s.vod_blurb)||"",E=E.trim()}catch{}try{_=(s==null?void 0:s.vod_remarks)||""}catch{}try{T=(s==null?void 0:s.vod_time)||""}catch{}try{x=(s==null?void 0:s.hts_MVPIC)||A}catch{}try{b=(s==null?void 0:s.vod_year)||""}catch{}try{S=`歌名:${y}
歌手:${c}
时长:${formateSecToHourMin(v)}
来源:${n.playfrom}
专辑:${o}`}catch{}n.videoList.push({des:E,note:_,info:S,pic:x,year:b,name:escape2Html(s==null?void 0:s.NAME)+"-"+c,artist:c,id:s==null?void 0:s.MUSICRID,tid:s==null?void 0:s.ALBUMID,type:escape2Html(s==null?void 0:s.ALBUM),last:s==null?void 0:s.vod_time,url:n.API.getURL_ByID(s==null?void 0:s.MUSICRID)})}),console.log("结果：",{videoList:n.videoList,groupList:n.groupList}),{videoList:n.videoList,groupList:n.groupList,currentPage:n.currentPage,totalItems:n.totalItems,pageCount:n.pageCount,itemsPerPage:n.itemsPerPage}}}}handle_id(){const n=this;return{error:e=>(console.log("~~!!handle_id::error",{error:e}),n.resultText="错误:请求被中断，请查看是否有请求跨域限制。",null),success:async(e,t=null)=>{console.log("~~!!handle_id::success",{data:e});let r=e==null?void 0:e.response,s=e==null?void 0:e.id;console.log("~~jsonResponse",{data:e,responseText:r});let a=null;try{a=parseToJSON$1(r)}catch(i){console.error(i)}if(console.log("~~jsonResponse:response",{response:a}),a){let i=await n.handle_id().handle({response:a,musicid:s});return t&&t(i),i}else return n.resultText="结果:空",null},handle:async e=>{var S;console.log("~~handle_id:handle",{ret:e,videoList:n.videoList});let{response:t,musicid:r}=e,s={},a=this.resultText||this.searchValue,i="",o="",{err:u,data:l}=await n.getLyric(r);console.log("~~getLyric:handle",{err:u,data:l});try{let x=parseToJSON$1(l.response),{songinfo:b,lrclist:A=null}=x.data;s={pic:b==null?void 0:b.pic,artist:b==null?void 0:b.artist,actor:b==null?void 0:b.artist,name:b==null?void 0:b.songName,id:b==null?void 0:b.id,tid:b==null?void 0:b.albumId,type:escape2Html(b==null?void 0:b.album),last:b==null?void 0:b.songTimeMinutes,lyric:A},console.log("~~~songinfo:video",{songObj:x,video:s,songinfo:b,lrclist:A})}catch(x){console.error(x),s=n.videoList.filter(b=>b.id==r),console.log("~~~error",{error:x,data:l,video:s})}if(console.log("~~jsonResponse:video",{video:s,videoList:n.videoList,grouplName:a,channelName:i,musicid:r,currentChannel:n.currentChannel}),s&&s.length>0&&(s=s[0],i=s==null?void 0:s.name),s==null)return null;if(n.currentChannel!=null)try{let{_channel:x,_groupName:b,_channelName:A}=n.currentChannel,R=x==null?void 0:x.search;a=b,i=A,o=x.name,console.log("~~oldItem:video",{video:s,currentChannel:n.currentChannel})}catch(x){console.log("~~oldItem:error",{error:x})}let c={...s,url:(S=t==null?void 0:t.data)==null?void 0:S.url},{id:d=r,tid:f,type:g="默认",artist:m,name:v,url:y,lyric:E=null}=c;a=a||m||n.resultText,i=i||v||m||`《${g}》`,o=o||(g?`《${g}》`:"mp3"),a=escape2Html(a),i=escape2Html(i),o=escape2Html(o);let _={group:a||g,channel:{[i]:[]}},T={name:o,value:y,poster:s==null?void 0:s.pic,iframe:n.iframe,search:{id:d,tid:f,type:g,from:INFO.PLATFORM,playfrom:this.playfrom},lyric:E};return _.channel[i].push(T),console.log("newGroup",_),{newGroup:_}}}}};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var a=Function.bind.apply(e,s);return new a}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var cryptoJs={exports:{}};function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var core={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(n,e){(function(t,r){n.exports=r()})(commonjsGlobal,function(){var t=t||function(r,s){var a;if(typeof window<"u"&&window.crypto&&(a=window.crypto),typeof self<"u"&&self.crypto&&(a=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window<"u"&&window.msCrypto&&(a=window.msCrypto),!a&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(a=commonjsGlobal.crypto),!a&&typeof commonjsRequire=="function")try{a=require$$0}catch{}var i=function(){if(a){if(typeof a.getRandomValues=="function")try{return a.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof a.randomBytes=="function")try{return a.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function _(){}return function(T){var S;return _.prototype=T,S=new _,_.prototype=null,S}}(),u={},l=u.lib={},c=l.Base=function(){return{extend:function(_){var T=o(this);return _&&T.mixIn(_),(!T.hasOwnProperty("init")||this.init===T.init)&&(T.init=function(){T.$super.init.apply(this,arguments)}),T.init.prototype=T,T.$super=this,T},create:function(){var _=this.extend();return _.init.apply(_,arguments),_},init:function(){},mixIn:function(_){for(var T in _)_.hasOwnProperty(T)&&(this[T]=_[T]);_.hasOwnProperty("toString")&&(this.toString=_.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=l.WordArray=c.extend({init:function(_,T){_=this.words=_||[],T!=s?this.sigBytes=T:this.sigBytes=_.length*4},toString:function(_){return(_||g).stringify(this)},concat:function(_){var T=this.words,S=_.words,x=this.sigBytes,b=_.sigBytes;if(this.clamp(),x%4)for(var A=0;A<b;A++){var R=S[A>>>2]>>>24-A%4*8&255;T[x+A>>>2]|=R<<24-(x+A)%4*8}else for(var C=0;C<b;C+=4)T[x+C>>>2]=S[C>>>2];return this.sigBytes+=b,this},clamp:function(){var _=this.words,T=this.sigBytes;_[T>>>2]&=4294967295<<32-T%4*8,_.length=r.ceil(T/4)},clone:function(){var _=c.clone.call(this);return _.words=this.words.slice(0),_},random:function(_){for(var T=[],S=0;S<_;S+=4)T.push(i());return new d.init(T,_)}}),f=u.enc={},g=f.Hex={stringify:function(_){for(var T=_.words,S=_.sigBytes,x=[],b=0;b<S;b++){var A=T[b>>>2]>>>24-b%4*8&255;x.push((A>>>4).toString(16)),x.push((A&15).toString(16))}return x.join("")},parse:function(_){for(var T=_.length,S=[],x=0;x<T;x+=2)S[x>>>3]|=parseInt(_.substr(x,2),16)<<24-x%8*4;return new d.init(S,T/2)}},m=f.Latin1={stringify:function(_){for(var T=_.words,S=_.sigBytes,x=[],b=0;b<S;b++){var A=T[b>>>2]>>>24-b%4*8&255;x.push(String.fromCharCode(A))}return x.join("")},parse:function(_){for(var T=_.length,S=[],x=0;x<T;x++)S[x>>>2]|=(_.charCodeAt(x)&255)<<24-x%4*8;return new d.init(S,T)}},v=f.Utf8={stringify:function(_){try{return decodeURIComponent(escape(m.stringify(_)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(_){return m.parse(unescape(encodeURIComponent(_)))}},y=l.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(_){typeof _=="string"&&(_=v.parse(_)),this._data.concat(_),this._nDataBytes+=_.sigBytes},_process:function(_){var T,S=this._data,x=S.words,b=S.sigBytes,A=this.blockSize,R=A*4,C=b/R;_?C=r.ceil(C):C=r.max((C|0)-this._minBufferSize,0);var w=C*A,I=r.min(w*4,b);if(w){for(var L=0;L<w;L+=A)this._doProcessBlock(x,L);T=x.splice(0,w),S.sigBytes-=I}return new d.init(T,I)},clone:function(){var _=c.clone.call(this);return _._data=this._data.clone(),_},_minBufferSize:0});l.Hasher=y.extend({cfg:c.extend(),init:function(_){this.cfg=this.cfg.extend(_),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(_){return this._append(_),this._process(),this},finalize:function(_){_&&this._append(_);var T=this._doFinalize();return T},blockSize:16,_createHelper:function(_){return function(T,S){return new _.init(S).finalize(T)}},_createHmacHelper:function(_){return function(T,S){return new E.HMAC.init(_,S).finalize(T)}}});var E=u.algo={};return u}(Math);return t})}(core)),core.exports}var x64Core={exports:{}},hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(r){var s=t,a=s.lib,i=a.Base,o=a.WordArray,u=s.x64={};u.Word=i.extend({init:function(l,c){this.high=l,this.low=c}}),u.WordArray=i.extend({init:function(l,c){l=this.words=l||[],c!=r?this.sigBytes=c:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,c=l.length,d=[],f=0;f<c;f++){var g=l[f];d.push(g.high),d.push(g.low)}return o.create(d,this.sigBytes)},clone:function(){for(var l=i.clone.call(this),c=l.words=this.words.slice(0),d=c.length,f=0;f<d;f++)c[f]=c[f].clone();return l}})}(),t})}(x64Core)),x64Core.exports}var libTypedarrays={exports:{}},hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,s=r.lib,a=s.WordArray,i=a.init,o=a.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var l=u.byteLength,c=[],d=0;d<l;d++)c[d>>>2]|=u[d]<<24-d%4*8;i.call(this,c,l)}else i.apply(this,arguments)};o.prototype=a}}(),t.lib.WordArray})}(libTypedarrays)),libTypedarrays.exports}var encUtf16={exports:{}},hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=r.enc;i.Utf16=i.Utf16BE={stringify:function(u){for(var l=u.words,c=u.sigBytes,d=[],f=0;f<c;f+=2){var g=l[f>>>2]>>>16-f%4*8&65535;d.push(String.fromCharCode(g))}return d.join("")},parse:function(u){for(var l=u.length,c=[],d=0;d<l;d++)c[d>>>1]|=u.charCodeAt(d)<<16-d%2*16;return a.create(c,l*2)}},i.Utf16LE={stringify:function(u){for(var l=u.words,c=u.sigBytes,d=[],f=0;f<c;f+=2){var g=o(l[f>>>2]>>>16-f%4*8&65535);d.push(String.fromCharCode(g))}return d.join("")},parse:function(u){for(var l=u.length,c=[],d=0;d<l;d++)c[d>>>1]|=o(u.charCodeAt(d)<<16-d%2*16);return a.create(c,l*2)}};function o(u){return u<<8&4278255360|u>>>8&16711935}}(),t.enc.Utf16})}(encUtf16)),encUtf16.exports}var encBase64={exports:{}},hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=r.enc;i.Base64={stringify:function(u){var l=u.words,c=u.sigBytes,d=this._map;u.clamp();for(var f=[],g=0;g<c;g+=3)for(var m=l[g>>>2]>>>24-g%4*8&255,v=l[g+1>>>2]>>>24-(g+1)%4*8&255,y=l[g+2>>>2]>>>24-(g+2)%4*8&255,E=m<<16|v<<8|y,_=0;_<4&&g+_*.75<c;_++)f.push(d.charAt(E>>>6*(3-_)&63));var T=d.charAt(64);if(T)for(;f.length%4;)f.push(T);return f.join("")},parse:function(u){var l=u.length,c=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<c.length;f++)d[c.charCodeAt(f)]=f}var g=c.charAt(64);if(g){var m=u.indexOf(g);m!==-1&&(l=m)}return o(u,l,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(u,l,c){for(var d=[],f=0,g=0;g<l;g++)if(g%4){var m=c[u.charCodeAt(g-1)]<<g%4*2,v=c[u.charCodeAt(g)]>>>6-g%4*2,y=m|v;d[f>>>2]|=y<<24-f%4*8,f++}return a.create(d,f)}}(),t.enc.Base64})}(encBase64)),encBase64.exports}var encBase64url={exports:{}},hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=r.enc;i.Base64url={stringify:function(u,l=!0){var c=u.words,d=u.sigBytes,f=l?this._safe_map:this._map;u.clamp();for(var g=[],m=0;m<d;m+=3)for(var v=c[m>>>2]>>>24-m%4*8&255,y=c[m+1>>>2]>>>24-(m+1)%4*8&255,E=c[m+2>>>2]>>>24-(m+2)%4*8&255,_=v<<16|y<<8|E,T=0;T<4&&m+T*.75<d;T++)g.push(f.charAt(_>>>6*(3-T)&63));var S=f.charAt(64);if(S)for(;g.length%4;)g.push(S);return g.join("")},parse:function(u,l=!0){var c=u.length,d=l?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var g=0;g<d.length;g++)f[d.charCodeAt(g)]=g}var m=d.charAt(64);if(m){var v=u.indexOf(m);v!==-1&&(c=v)}return o(u,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(u,l,c){for(var d=[],f=0,g=0;g<l;g++)if(g%4){var m=c[u.charCodeAt(g-1)]<<g%4*2,v=c[u.charCodeAt(g)]>>>6-g%4*2,y=m|v;d[f>>>2]|=y<<24-f%4*8,f++}return a.create(d,f)}}(),t.enc.Base64url})}(encBase64url)),encBase64url.exports}var md5={exports:{}},hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(r){var s=t,a=s.lib,i=a.WordArray,o=a.Hasher,u=s.algo,l=[];(function(){for(var v=0;v<64;v++)l[v]=r.abs(r.sin(v+1))*4294967296|0})();var c=u.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,y){for(var E=0;E<16;E++){var _=y+E,T=v[_];v[_]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var S=this._hash.words,x=v[y+0],b=v[y+1],A=v[y+2],R=v[y+3],C=v[y+4],w=v[y+5],I=v[y+6],L=v[y+7],D=v[y+8],O=v[y+9],N=v[y+10],F=v[y+11],H=v[y+12],j=v[y+13],q=v[y+14],Q=v[y+15],U=S[0],$=S[1],K=S[2],G=S[3];U=d(U,$,K,G,x,7,l[0]),G=d(G,U,$,K,b,12,l[1]),K=d(K,G,U,$,A,17,l[2]),$=d($,K,G,U,R,22,l[3]),U=d(U,$,K,G,C,7,l[4]),G=d(G,U,$,K,w,12,l[5]),K=d(K,G,U,$,I,17,l[6]),$=d($,K,G,U,L,22,l[7]),U=d(U,$,K,G,D,7,l[8]),G=d(G,U,$,K,O,12,l[9]),K=d(K,G,U,$,N,17,l[10]),$=d($,K,G,U,F,22,l[11]),U=d(U,$,K,G,H,7,l[12]),G=d(G,U,$,K,j,12,l[13]),K=d(K,G,U,$,q,17,l[14]),$=d($,K,G,U,Q,22,l[15]),U=f(U,$,K,G,b,5,l[16]),G=f(G,U,$,K,I,9,l[17]),K=f(K,G,U,$,F,14,l[18]),$=f($,K,G,U,x,20,l[19]),U=f(U,$,K,G,w,5,l[20]),G=f(G,U,$,K,N,9,l[21]),K=f(K,G,U,$,Q,14,l[22]),$=f($,K,G,U,C,20,l[23]),U=f(U,$,K,G,O,5,l[24]),G=f(G,U,$,K,q,9,l[25]),K=f(K,G,U,$,R,14,l[26]),$=f($,K,G,U,D,20,l[27]),U=f(U,$,K,G,j,5,l[28]),G=f(G,U,$,K,A,9,l[29]),K=f(K,G,U,$,L,14,l[30]),$=f($,K,G,U,H,20,l[31]),U=g(U,$,K,G,w,4,l[32]),G=g(G,U,$,K,D,11,l[33]),K=g(K,G,U,$,F,16,l[34]),$=g($,K,G,U,q,23,l[35]),U=g(U,$,K,G,b,4,l[36]),G=g(G,U,$,K,C,11,l[37]),K=g(K,G,U,$,L,16,l[38]),$=g($,K,G,U,N,23,l[39]),U=g(U,$,K,G,j,4,l[40]),G=g(G,U,$,K,x,11,l[41]),K=g(K,G,U,$,R,16,l[42]),$=g($,K,G,U,I,23,l[43]),U=g(U,$,K,G,O,4,l[44]),G=g(G,U,$,K,H,11,l[45]),K=g(K,G,U,$,Q,16,l[46]),$=g($,K,G,U,A,23,l[47]),U=m(U,$,K,G,x,6,l[48]),G=m(G,U,$,K,L,10,l[49]),K=m(K,G,U,$,q,15,l[50]),$=m($,K,G,U,w,21,l[51]),U=m(U,$,K,G,H,6,l[52]),G=m(G,U,$,K,R,10,l[53]),K=m(K,G,U,$,N,15,l[54]),$=m($,K,G,U,b,21,l[55]),U=m(U,$,K,G,D,6,l[56]),G=m(G,U,$,K,Q,10,l[57]),K=m(K,G,U,$,I,15,l[58]),$=m($,K,G,U,j,21,l[59]),U=m(U,$,K,G,C,6,l[60]),G=m(G,U,$,K,F,10,l[61]),K=m(K,G,U,$,A,15,l[62]),$=m($,K,G,U,O,21,l[63]),S[0]=S[0]+U|0,S[1]=S[1]+$|0,S[2]=S[2]+K|0,S[3]=S[3]+G|0},_doFinalize:function(){var v=this._data,y=v.words,E=this._nDataBytes*8,_=v.sigBytes*8;y[_>>>5]|=128<<24-_%32;var T=r.floor(E/4294967296),S=E;y[(_+64>>>9<<4)+15]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,y[(_+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,v.sigBytes=(y.length+1)*4,this._process();for(var x=this._hash,b=x.words,A=0;A<4;A++){var R=b[A];b[A]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}return x},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v}});function d(v,y,E,_,T,S,x){var b=v+(y&E|~y&_)+T+x;return(b<<S|b>>>32-S)+y}function f(v,y,E,_,T,S,x){var b=v+(y&_|E&~_)+T+x;return(b<<S|b>>>32-S)+y}function g(v,y,E,_,T,S,x){var b=v+(y^E^_)+T+x;return(b<<S|b>>>32-S)+y}function m(v,y,E,_,T,S,x){var b=v+(E^(y|~_))+T+x;return(b<<S|b>>>32-S)+y}s.MD5=o._createHelper(c),s.HmacMD5=o._createHmacHelper(c)}(Math),t.MD5})}(md5)),md5.exports}var sha1={exports:{}},hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=s.Hasher,o=r.algo,u=[],l=o.SHA1=i.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,d){for(var f=this._hash.words,g=f[0],m=f[1],v=f[2],y=f[3],E=f[4],_=0;_<80;_++){if(_<16)u[_]=c[d+_]|0;else{var T=u[_-3]^u[_-8]^u[_-14]^u[_-16];u[_]=T<<1|T>>>31}var S=(g<<5|g>>>27)+E+u[_];_<20?S+=(m&v|~m&y)+1518500249:_<40?S+=(m^v^y)+1859775393:_<60?S+=(m&v|m&y|v&y)-1894007588:S+=(m^v^y)-899497514,E=y,y=v,v=m<<30|m>>>2,m=g,g=S}f[0]=f[0]+g|0,f[1]=f[1]+m|0,f[2]=f[2]+v|0,f[3]=f[3]+y|0,f[4]=f[4]+E|0},_doFinalize:function(){var c=this._data,d=c.words,f=this._nDataBytes*8,g=c.sigBytes*8;return d[g>>>5]|=128<<24-g%32,d[(g+64>>>9<<4)+14]=Math.floor(f/4294967296),d[(g+64>>>9<<4)+15]=f,c.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var c=i.clone.call(this);return c._hash=this._hash.clone(),c}});r.SHA1=i._createHelper(l),r.HmacSHA1=i._createHmacHelper(l)}(),t.SHA1})}(sha1)),sha1.exports}var sha256={exports:{}},hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){return function(r){var s=t,a=s.lib,i=a.WordArray,o=a.Hasher,u=s.algo,l=[],c=[];(function(){function g(E){for(var _=r.sqrt(E),T=2;T<=_;T++)if(!(E%T))return!1;return!0}function m(E){return(E-(E|0))*4294967296|0}for(var v=2,y=0;y<64;)g(v)&&(y<8&&(l[y]=m(r.pow(v,1/2))),c[y]=m(r.pow(v,1/3)),y++),v++})();var d=[],f=u.SHA256=o.extend({_doReset:function(){this._hash=new i.init(l.slice(0))},_doProcessBlock:function(g,m){for(var v=this._hash.words,y=v[0],E=v[1],_=v[2],T=v[3],S=v[4],x=v[5],b=v[6],A=v[7],R=0;R<64;R++){if(R<16)d[R]=g[m+R]|0;else{var C=d[R-15],w=(C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3,I=d[R-2],L=(I<<15|I>>>17)^(I<<13|I>>>19)^I>>>10;d[R]=w+d[R-7]+L+d[R-16]}var D=S&x^~S&b,O=y&E^y&_^E&_,N=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),F=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),H=A+F+D+c[R]+d[R],j=N+O;A=b,b=x,x=S,S=T+H|0,T=_,_=E,E=y,y=H+j|0}v[0]=v[0]+y|0,v[1]=v[1]+E|0,v[2]=v[2]+_|0,v[3]=v[3]+T|0,v[4]=v[4]+S|0,v[5]=v[5]+x|0,v[6]=v[6]+b|0,v[7]=v[7]+A|0},_doFinalize:function(){var g=this._data,m=g.words,v=this._nDataBytes*8,y=g.sigBytes*8;return m[y>>>5]|=128<<24-y%32,m[(y+64>>>9<<4)+14]=r.floor(v/4294967296),m[(y+64>>>9<<4)+15]=v,g.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var g=o.clone.call(this);return g._hash=this._hash.clone(),g}});s.SHA256=o._createHelper(f),s.HmacSHA256=o._createHmacHelper(f)}(Math),t.SHA256})}(sha256)),sha256.exports}var sha224={exports:{}},hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireSha256())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=r.algo,o=i.SHA256,u=i.SHA224=o.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var l=o._doFinalize.call(this);return l.sigBytes-=4,l}});r.SHA224=o._createHelper(u),r.HmacSHA224=o._createHmacHelper(u)}(),t.SHA224})}(sha224)),sha224.exports}var sha512={exports:{}},hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireX64Core())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.Hasher,i=r.x64,o=i.Word,u=i.WordArray,l=r.algo;function c(){return o.create.apply(o,arguments)}var d=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],f=[];(function(){for(var m=0;m<80;m++)f[m]=c()})();var g=l.SHA512=a.extend({_doReset:function(){this._hash=new u.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(m,v){for(var y=this._hash.words,E=y[0],_=y[1],T=y[2],S=y[3],x=y[4],b=y[5],A=y[6],R=y[7],C=E.high,w=E.low,I=_.high,L=_.low,D=T.high,O=T.low,N=S.high,F=S.low,H=x.high,j=x.low,q=b.high,Q=b.low,U=A.high,$=A.low,K=R.high,G=R.low,ae=C,W=w,B=I,V=L,X=D,ne=O,ce=N,k=F,P=H,M=j,Y=q,Z=Q,ee=U,oe=$,re=K,se=G,J=0;J<80;J++){var le,ue,de=f[J];if(J<16)ue=de.high=m[v+J*2]|0,le=de.low=m[v+J*2+1]|0;else{var pe=f[J-15],ge=pe.high,ye=pe.low,ve=(ge>>>1|ye<<31)^(ge>>>8|ye<<24)^ge>>>7,xe=(ye>>>1|ge<<31)^(ye>>>8|ge<<24)^(ye>>>7|ge<<25),z=f[J-2],te=z.high,ie=z.low,he=(te>>>19|ie<<13)^(te<<3|ie>>>29)^te>>>6,me=(ie>>>19|te<<13)^(ie<<3|te>>>29)^(ie>>>6|te<<26),fe=f[J-7],_e=fe.high,Te=fe.low,be=f[J-16],Re=be.high,Ae=be.low;le=xe+Te,ue=ve+_e+(le>>>0<xe>>>0?1:0),le=le+me,ue=ue+he+(le>>>0<me>>>0?1:0),le=le+Ae,ue=ue+Re+(le>>>0<Ae>>>0?1:0),de.high=ue,de.low=le}var ke=P&Y^~P&ee,Le=M&Z^~M&oe,Oe=ae&B^ae&X^B&X,Fe=W&V^W&ne^V&ne,Be=(ae>>>28|W<<4)^(ae<<30|W>>>2)^(ae<<25|W>>>7),Ie=(W>>>28|ae<<4)^(W<<30|ae>>>2)^(W<<25|ae>>>7),Me=(P>>>14|M<<18)^(P>>>18|M<<14)^(P<<23|M>>>9),Ne=(M>>>14|P<<18)^(M>>>18|P<<14)^(M<<23|P>>>9),Ce=d[J],Ue=Ce.high,De=Ce.low,Ee=se+Ne,Se=re+Me+(Ee>>>0<se>>>0?1:0),Ee=Ee+Le,Se=Se+ke+(Ee>>>0<Le>>>0?1:0),Ee=Ee+De,Se=Se+Ue+(Ee>>>0<De>>>0?1:0),Ee=Ee+le,Se=Se+ue+(Ee>>>0<le>>>0?1:0),Pe=Ie+Fe,je=Be+Oe+(Pe>>>0<Ie>>>0?1:0);re=ee,se=oe,ee=Y,oe=Z,Y=P,Z=M,M=k+Ee|0,P=ce+Se+(M>>>0<k>>>0?1:0)|0,ce=X,k=ne,X=B,ne=V,B=ae,V=W,W=Ee+Pe|0,ae=Se+je+(W>>>0<Ee>>>0?1:0)|0}w=E.low=w+W,E.high=C+ae+(w>>>0<W>>>0?1:0),L=_.low=L+V,_.high=I+B+(L>>>0<V>>>0?1:0),O=T.low=O+ne,T.high=D+X+(O>>>0<ne>>>0?1:0),F=S.low=F+k,S.high=N+ce+(F>>>0<k>>>0?1:0),j=x.low=j+M,x.high=H+P+(j>>>0<M>>>0?1:0),Q=b.low=Q+Z,b.high=q+Y+(Q>>>0<Z>>>0?1:0),$=A.low=$+oe,A.high=U+ee+($>>>0<oe>>>0?1:0),G=R.low=G+se,R.high=K+re+(G>>>0<se>>>0?1:0)},_doFinalize:function(){var m=this._data,v=m.words,y=this._nDataBytes*8,E=m.sigBytes*8;v[E>>>5]|=128<<24-E%32,v[(E+128>>>10<<5)+30]=Math.floor(y/4294967296),v[(E+128>>>10<<5)+31]=y,m.sigBytes=v.length*4,this._process();var _=this._hash.toX32();return _},clone:function(){var m=a.clone.call(this);return m._hash=this._hash.clone(),m},blockSize:1024/32});r.SHA512=a._createHelper(g),r.HmacSHA512=a._createHmacHelper(g)}(),t.SHA512})}(sha512)),sha512.exports}var sha384={exports:{}},hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireX64Core(),requireSha512())})(commonjsGlobal,function(t){return function(){var r=t,s=r.x64,a=s.Word,i=s.WordArray,o=r.algo,u=o.SHA512,l=o.SHA384=u.extend({_doReset:function(){this._hash=new i.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var c=u._doFinalize.call(this);return c.sigBytes-=16,c}});r.SHA384=u._createHelper(l),r.HmacSHA384=u._createHmacHelper(l)}(),t.SHA384})}(sha384)),sha384.exports}var sha3={exports:{}},hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireX64Core())})(commonjsGlobal,function(t){return function(r){var s=t,a=s.lib,i=a.WordArray,o=a.Hasher,u=s.x64,l=u.Word,c=s.algo,d=[],f=[],g=[];(function(){for(var y=1,E=0,_=0;_<24;_++){d[y+5*E]=(_+1)*(_+2)/2%64;var T=E%5,S=(2*y+3*E)%5;y=T,E=S}for(var y=0;y<5;y++)for(var E=0;E<5;E++)f[y+5*E]=E+(2*y+3*E)%5*5;for(var x=1,b=0;b<24;b++){for(var A=0,R=0,C=0;C<7;C++){if(x&1){var w=(1<<C)-1;w<32?R^=1<<w:A^=1<<w-32}x&128?x=x<<1^113:x<<=1}g[b]=l.create(A,R)}})();var m=[];(function(){for(var y=0;y<25;y++)m[y]=l.create()})();var v=c.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],E=0;E<25;E++)y[E]=new l.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,E){for(var _=this._state,T=this.blockSize/2,S=0;S<T;S++){var x=y[E+2*S],b=y[E+2*S+1];x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;var A=_[S];A.high^=b,A.low^=x}for(var R=0;R<24;R++){for(var C=0;C<5;C++){for(var w=0,I=0,L=0;L<5;L++){var A=_[C+5*L];w^=A.high,I^=A.low}var D=m[C];D.high=w,D.low=I}for(var C=0;C<5;C++)for(var O=m[(C+4)%5],N=m[(C+1)%5],F=N.high,H=N.low,w=O.high^(F<<1|H>>>31),I=O.low^(H<<1|F>>>31),L=0;L<5;L++){var A=_[C+5*L];A.high^=w,A.low^=I}for(var j=1;j<25;j++){var w,I,A=_[j],q=A.high,Q=A.low,U=d[j];U<32?(w=q<<U|Q>>>32-U,I=Q<<U|q>>>32-U):(w=Q<<U-32|q>>>64-U,I=q<<U-32|Q>>>64-U);var $=m[f[j]];$.high=w,$.low=I}var K=m[0],G=_[0];K.high=G.high,K.low=G.low;for(var C=0;C<5;C++)for(var L=0;L<5;L++){var j=C+5*L,A=_[j],ae=m[j],W=m[(C+1)%5+5*L],B=m[(C+2)%5+5*L];A.high=ae.high^~W.high&B.high,A.low=ae.low^~W.low&B.low}var A=_[0],V=g[R];A.high^=V.high,A.low^=V.low}},_doFinalize:function(){var y=this._data,E=y.words;this._nDataBytes*8;var _=y.sigBytes*8,T=this.blockSize*32;E[_>>>5]|=1<<24-_%32,E[(r.ceil((_+1)/T)*T>>>5)-1]|=128,y.sigBytes=E.length*4,this._process();for(var S=this._state,x=this.cfg.outputLength/8,b=x/8,A=[],R=0;R<b;R++){var C=S[R],w=C.high,I=C.low;w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,A.push(I),A.push(w)}return new i.init(A,x)},clone:function(){for(var y=o.clone.call(this),E=y._state=this._state.slice(0),_=0;_<25;_++)E[_]=E[_].clone();return y}});s.SHA3=o._createHelper(v),s.HmacSHA3=o._createHmacHelper(v)}(Math),t.SHA3})}(sha3)),sha3.exports}var ripemd160={exports:{}},hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var s=t,a=s.lib,i=a.WordArray,o=a.Hasher,u=s.algo,l=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),g=i.create([0,1518500249,1859775393,2400959708,2840853838]),m=i.create([1352829926,1548603684,1836072691,2053994217,0]),v=u.RIPEMD160=o.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(b,A){for(var R=0;R<16;R++){var C=A+R,w=b[C];b[C]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var I=this._hash.words,L=g.words,D=m.words,O=l.words,N=c.words,F=d.words,H=f.words,j,q,Q,U,$,K,G,ae,W,B;K=j=I[0],G=q=I[1],ae=Q=I[2],W=U=I[3],B=$=I[4];for(var V,R=0;R<80;R+=1)V=j+b[A+O[R]]|0,R<16?V+=y(q,Q,U)+L[0]:R<32?V+=E(q,Q,U)+L[1]:R<48?V+=_(q,Q,U)+L[2]:R<64?V+=T(q,Q,U)+L[3]:V+=S(q,Q,U)+L[4],V=V|0,V=x(V,F[R]),V=V+$|0,j=$,$=U,U=x(Q,10),Q=q,q=V,V=K+b[A+N[R]]|0,R<16?V+=S(G,ae,W)+D[0]:R<32?V+=T(G,ae,W)+D[1]:R<48?V+=_(G,ae,W)+D[2]:R<64?V+=E(G,ae,W)+D[3]:V+=y(G,ae,W)+D[4],V=V|0,V=x(V,H[R]),V=V+B|0,K=B,B=W,W=x(ae,10),ae=G,G=V;V=I[1]+Q+W|0,I[1]=I[2]+U+B|0,I[2]=I[3]+$+K|0,I[3]=I[4]+j+G|0,I[4]=I[0]+q+ae|0,I[0]=V},_doFinalize:function(){var b=this._data,A=b.words,R=this._nDataBytes*8,C=b.sigBytes*8;A[C>>>5]|=128<<24-C%32,A[(C+64>>>9<<4)+14]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,b.sigBytes=(A.length+1)*4,this._process();for(var w=this._hash,I=w.words,L=0;L<5;L++){var D=I[L];I[L]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}return w},clone:function(){var b=o.clone.call(this);return b._hash=this._hash.clone(),b}});function y(b,A,R){return b^A^R}function E(b,A,R){return b&A|~b&R}function _(b,A,R){return(b|~A)^R}function T(b,A,R){return b&R|A&~R}function S(b,A,R){return b^(A|~R)}function x(b,A){return b<<A|b>>>32-A}s.RIPEMD160=o._createHelper(v),s.HmacRIPEMD160=o._createHmacHelper(v)}(),t.RIPEMD160})}(ripemd160)),ripemd160.exports}var hmac={exports:{}},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,function(n,e){(function(t,r){n.exports=r(requireCore())})(commonjsGlobal,function(t){(function(){var r=t,s=r.lib,a=s.Base,i=r.enc,o=i.Utf8,u=r.algo;u.HMAC=a.extend({init:function(l,c){l=this._hasher=new l.init,typeof c=="string"&&(c=o.parse(c));var d=l.blockSize,f=d*4;c.sigBytes>f&&(c=l.finalize(c)),c.clamp();for(var g=this._oKey=c.clone(),m=this._iKey=c.clone(),v=g.words,y=m.words,E=0;E<d;E++)v[E]^=1549556828,y[E]^=909522486;g.sigBytes=m.sigBytes=f,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var c=this._hasher,d=c.finalize(l);c.reset();var f=c.finalize(this._oKey.clone().concat(d));return f}})})()})}(hmac)),hmac.exports}var pbkdf2={exports:{}},hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireSha1(),requireHmac())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.Base,i=s.WordArray,o=r.algo,u=o.SHA1,l=o.HMAC,c=o.PBKDF2=a.extend({cfg:a.extend({keySize:128/32,hasher:u,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var g=this.cfg,m=l.create(g.hasher,d),v=i.create(),y=i.create([1]),E=v.words,_=y.words,T=g.keySize,S=g.iterations;E.length<T;){var x=m.update(f).finalize(y);m.reset();for(var b=x.words,A=b.length,R=x,C=1;C<S;C++){R=m.finalize(R),m.reset();for(var w=R.words,I=0;I<A;I++)b[I]^=w[I]}v.concat(x),_[0]++}return v.sigBytes=T*4,v}});r.PBKDF2=function(d,f,g){return c.create(g).compute(d,f)}}(),t.PBKDF2})}(pbkdf2)),pbkdf2.exports}var evpkdf={exports:{}},hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireSha1(),requireHmac())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.Base,i=s.WordArray,o=r.algo,u=o.MD5,l=o.EvpKDF=a.extend({cfg:a.extend({keySize:128/32,hasher:u,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,d){for(var f,g=this.cfg,m=g.hasher.create(),v=i.create(),y=v.words,E=g.keySize,_=g.iterations;y.length<E;){f&&m.update(f),f=m.update(c).finalize(d),m.reset();for(var T=1;T<_;T++)f=m.finalize(f),m.reset();v.concat(f)}return v.sigBytes=E*4,v}});r.EvpKDF=function(c,d,f){return l.create(f).compute(c,d)}}(),t.EvpKDF})}(evpkdf)),evpkdf.exports}var cipherCore={exports:{}},hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEvpkdf())})(commonjsGlobal,function(t){t.lib.Cipher||function(r){var s=t,a=s.lib,i=a.Base,o=a.WordArray,u=a.BufferedBlockAlgorithm,l=s.enc;l.Utf8;var c=l.Base64,d=s.algo,f=d.EvpKDF,g=a.Cipher=u.extend({cfg:i.extend(),createEncryptor:function(w,I){return this.create(this._ENC_XFORM_MODE,w,I)},createDecryptor:function(w,I){return this.create(this._DEC_XFORM_MODE,w,I)},init:function(w,I,L){this.cfg=this.cfg.extend(L),this._xformMode=w,this._key=I,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(w){return this._append(w),this._process()},finalize:function(w){w&&this._append(w);var I=this._doFinalize();return I},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function w(I){return typeof I=="string"?C:b}return function(I){return{encrypt:function(L,D,O){return w(D).encrypt(I,L,D,O)},decrypt:function(L,D,O){return w(D).decrypt(I,L,D,O)}}}}()});a.StreamCipher=g.extend({_doFinalize:function(){var w=this._process(!0);return w},blockSize:1});var m=s.mode={},v=a.BlockCipherMode=i.extend({createEncryptor:function(w,I){return this.Encryptor.create(w,I)},createDecryptor:function(w,I){return this.Decryptor.create(w,I)},init:function(w,I){this._cipher=w,this._iv=I}}),y=m.CBC=function(){var w=v.extend();w.Encryptor=w.extend({processBlock:function(L,D){var O=this._cipher,N=O.blockSize;I.call(this,L,D,N),O.encryptBlock(L,D),this._prevBlock=L.slice(D,D+N)}}),w.Decryptor=w.extend({processBlock:function(L,D){var O=this._cipher,N=O.blockSize,F=L.slice(D,D+N);O.decryptBlock(L,D),I.call(this,L,D,N),this._prevBlock=F}});function I(L,D,O){var N,F=this._iv;F?(N=F,this._iv=r):N=this._prevBlock;for(var H=0;H<O;H++)L[D+H]^=N[H]}return w}(),E=s.pad={},_=E.Pkcs7={pad:function(w,I){for(var L=I*4,D=L-w.sigBytes%L,O=D<<24|D<<16|D<<8|D,N=[],F=0;F<D;F+=4)N.push(O);var H=o.create(N,D);w.concat(H)},unpad:function(w){var I=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=I}};a.BlockCipher=g.extend({cfg:g.cfg.extend({mode:y,padding:_}),reset:function(){var w;g.reset.call(this);var I=this.cfg,L=I.iv,D=I.mode;this._xformMode==this._ENC_XFORM_MODE?w=D.createEncryptor:(w=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==w?this._mode.init(this,L&&L.words):(this._mode=w.call(D,this,L&&L.words),this._mode.__creator=w)},_doProcessBlock:function(w,I){this._mode.processBlock(w,I)},_doFinalize:function(){var w,I=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(I.pad(this._data,this.blockSize),w=this._process(!0)):(w=this._process(!0),I.unpad(w)),w},blockSize:128/32});var T=a.CipherParams=i.extend({init:function(w){this.mixIn(w)},toString:function(w){return(w||this.formatter).stringify(this)}}),S=s.format={},x=S.OpenSSL={stringify:function(w){var I,L=w.ciphertext,D=w.salt;return D?I=o.create([1398893684,1701076831]).concat(D).concat(L):I=L,I.toString(c)},parse:function(w){var I,L=c.parse(w),D=L.words;return D[0]==1398893684&&D[1]==1701076831&&(I=o.create(D.slice(2,4)),D.splice(0,4),L.sigBytes-=16),T.create({ciphertext:L,salt:I})}},b=a.SerializableCipher=i.extend({cfg:i.extend({format:x}),encrypt:function(w,I,L,D){D=this.cfg.extend(D);var O=w.createEncryptor(L,D),N=O.finalize(I),F=O.cfg;return T.create({ciphertext:N,key:L,iv:F.iv,algorithm:w,mode:F.mode,padding:F.padding,blockSize:w.blockSize,formatter:D.format})},decrypt:function(w,I,L,D){D=this.cfg.extend(D),I=this._parse(I,D.format);var O=w.createDecryptor(L,D).finalize(I.ciphertext);return O},_parse:function(w,I){return typeof w=="string"?I.parse(w,this):w}}),A=s.kdf={},R=A.OpenSSL={execute:function(w,I,L,D){D||(D=o.random(64/8));var O=f.create({keySize:I+L}).compute(w,D),N=o.create(O.words.slice(I),L*4);return O.sigBytes=I*4,T.create({key:O,iv:N,salt:D})}},C=a.PasswordBasedCipher=b.extend({cfg:b.cfg.extend({kdf:R}),encrypt:function(w,I,L,D){D=this.cfg.extend(D);var O=D.kdf.execute(L,w.keySize,w.ivSize);D.iv=O.iv;var N=b.encrypt.call(this,w,I,O.key,D);return N.mixIn(O),N},decrypt:function(w,I,L,D){D=this.cfg.extend(D),I=this._parse(I,D.format);var O=D.kdf.execute(L,w.keySize,w.ivSize,I.salt);D.iv=O.iv;var N=b.decrypt.call(this,w,I,O.key,D);return N}})}()})}(cipherCore)),cipherCore.exports}var modeCfb={exports:{}},hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(a,i){var o=this._cipher,u=o.blockSize;s.call(this,a,i,u,o),this._prevBlock=a.slice(i,i+u)}}),r.Decryptor=r.extend({processBlock:function(a,i){var o=this._cipher,u=o.blockSize,l=a.slice(i,i+u);s.call(this,a,i,u,o),this._prevBlock=l}});function s(a,i,o,u){var l,c=this._iv;c?(l=c.slice(0),this._iv=void 0):l=this._prevBlock,u.encryptBlock(l,0);for(var d=0;d<o;d++)a[i+d]^=l[d]}return r}(),t.mode.CFB})}(modeCfb)),modeCfb.exports}var modeCtr={exports:{}},hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(a,i){var o=this._cipher,u=o.blockSize,l=this._iv,c=this._counter;l&&(c=this._counter=l.slice(0),this._iv=void 0);var d=c.slice(0);o.encryptBlock(d,0),c[u-1]=c[u-1]+1|0;for(var f=0;f<u;f++)a[i+f]^=d[f]}});return r.Decryptor=s,r}(),t.mode.CTR})}(modeCtr)),modeCtr.exports}var modeCtrGladman={exports:{}},hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var u=o>>16&255,l=o>>8&255,c=o&255;u===255?(u=0,l===255?(l=0,c===255?c=0:++c):++l):++u,o=0,o+=u<<16,o+=l<<8,o+=c}else o+=1<<24;return o}function a(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var i=r.Encryptor=r.extend({processBlock:function(o,u){var l=this._cipher,c=l.blockSize,d=this._iv,f=this._counter;d&&(f=this._counter=d.slice(0),this._iv=void 0),a(f);var g=f.slice(0);l.encryptBlock(g,0);for(var m=0;m<c;m++)o[u+m]^=g[m]}});return r.Decryptor=i,r}(),t.mode.CTRGladman})}(modeCtrGladman)),modeCtrGladman.exports}var modeOfb={exports:{}},hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(a,i){var o=this._cipher,u=o.blockSize,l=this._iv,c=this._keystream;l&&(c=this._keystream=l.slice(0),this._iv=void 0),o.encryptBlock(c,0);for(var d=0;d<u;d++)a[i+d]^=c[d]}});return r.Decryptor=s,r}(),t.mode.OFB})}(modeOfb)),modeOfb.exports}var modeEcb={exports:{}},hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(s,a){this._cipher.encryptBlock(s,a)}}),r.Decryptor=r.extend({processBlock:function(s,a){this._cipher.decryptBlock(s,a)}}),r}(),t.mode.ECB})}(modeEcb)),modeEcb.exports}var padAnsix923={exports:{}},hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.pad.AnsiX923={pad:function(r,s){var a=r.sigBytes,i=s*4,o=i-a%i,u=a+o-1;r.clamp(),r.words[u>>>2]|=o<<24-u%4*8,r.sigBytes+=o},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Ansix923})}(padAnsix923)),padAnsix923.exports}var padIso10126={exports:{}},hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.pad.Iso10126={pad:function(r,s){var a=s*4,i=a-r.sigBytes%a;r.concat(t.lib.WordArray.random(i-1)).concat(t.lib.WordArray.create([i<<24],1))},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Iso10126})}(padIso10126)),padIso10126.exports}var padIso97971={exports:{}},hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.pad.Iso97971={pad:function(r,s){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,s)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(padIso97971)),padIso97971.exports}var padZeropadding={exports:{}},hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.pad.ZeroPadding={pad:function(r,s){var a=s*4;r.clamp(),r.sigBytes+=a-(r.sigBytes%a||a)},unpad:function(r){for(var s=r.words,a=r.sigBytes-1,a=r.sigBytes-1;a>=0;a--)if(s[a>>>2]>>>24-a%4*8&255){r.sigBytes=a+1;break}}},t.pad.ZeroPadding})}(padZeropadding)),padZeropadding.exports}var padNopadding={exports:{}},hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(padNopadding)),padNopadding.exports}var formatHex={exports:{}},hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireCipherCore())})(commonjsGlobal,function(t){return function(r){var s=t,a=s.lib,i=a.CipherParams,o=s.enc,u=o.Hex,l=s.format;l.Hex={stringify:function(c){return c.ciphertext.toString(u)},parse:function(c){var d=u.parse(c);return i.create({ciphertext:d})}}}(),t.format.Hex})}(formatHex)),formatHex.exports}var aes={exports:{}},hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.BlockCipher,i=r.algo,o=[],u=[],l=[],c=[],d=[],f=[],g=[],m=[],v=[],y=[];(function(){for(var T=[],S=0;S<256;S++)S<128?T[S]=S<<1:T[S]=S<<1^283;for(var x=0,b=0,S=0;S<256;S++){var A=b^b<<1^b<<2^b<<3^b<<4;A=A>>>8^A&255^99,o[x]=A,u[A]=x;var R=T[x],C=T[R],w=T[C],I=T[A]*257^A*16843008;l[x]=I<<24|I>>>8,c[x]=I<<16|I>>>16,d[x]=I<<8|I>>>24,f[x]=I;var I=w*16843009^C*65537^R*257^x*16843008;g[A]=I<<24|I>>>8,m[A]=I<<16|I>>>16,v[A]=I<<8|I>>>24,y[A]=I,x?(x=R^T[T[T[w^R]]],b^=T[T[b]]):x=b=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],_=i.AES=a.extend({_doReset:function(){var T;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,x=S.words,b=S.sigBytes/4,A=this._nRounds=b+6,R=(A+1)*4,C=this._keySchedule=[],w=0;w<R;w++)w<b?C[w]=x[w]:(T=C[w-1],w%b?b>6&&w%b==4&&(T=o[T>>>24]<<24|o[T>>>16&255]<<16|o[T>>>8&255]<<8|o[T&255]):(T=T<<8|T>>>24,T=o[T>>>24]<<24|o[T>>>16&255]<<16|o[T>>>8&255]<<8|o[T&255],T^=E[w/b|0]<<24),C[w]=C[w-b]^T);for(var I=this._invKeySchedule=[],L=0;L<R;L++){var w=R-L;if(L%4)var T=C[w];else var T=C[w-4];L<4||w<=4?I[L]=T:I[L]=g[o[T>>>24]]^m[o[T>>>16&255]]^v[o[T>>>8&255]]^y[o[T&255]]}}},encryptBlock:function(T,S){this._doCryptBlock(T,S,this._keySchedule,l,c,d,f,o)},decryptBlock:function(T,S){var x=T[S+1];T[S+1]=T[S+3],T[S+3]=x,this._doCryptBlock(T,S,this._invKeySchedule,g,m,v,y,u);var x=T[S+1];T[S+1]=T[S+3],T[S+3]=x},_doCryptBlock:function(T,S,x,b,A,R,C,w){for(var I=this._nRounds,L=T[S]^x[0],D=T[S+1]^x[1],O=T[S+2]^x[2],N=T[S+3]^x[3],F=4,H=1;H<I;H++){var j=b[L>>>24]^A[D>>>16&255]^R[O>>>8&255]^C[N&255]^x[F++],q=b[D>>>24]^A[O>>>16&255]^R[N>>>8&255]^C[L&255]^x[F++],Q=b[O>>>24]^A[N>>>16&255]^R[L>>>8&255]^C[D&255]^x[F++],U=b[N>>>24]^A[L>>>16&255]^R[D>>>8&255]^C[O&255]^x[F++];L=j,D=q,O=Q,N=U}var j=(w[L>>>24]<<24|w[D>>>16&255]<<16|w[O>>>8&255]<<8|w[N&255])^x[F++],q=(w[D>>>24]<<24|w[O>>>16&255]<<16|w[N>>>8&255]<<8|w[L&255])^x[F++],Q=(w[O>>>24]<<24|w[N>>>16&255]<<16|w[L>>>8&255]<<8|w[D&255])^x[F++],U=(w[N>>>24]<<24|w[L>>>16&255]<<16|w[D>>>8&255]<<8|w[O&255])^x[F++];T[S]=j,T[S+1]=q,T[S+2]=Q,T[S+3]=U},keySize:256/32});r.AES=a._createHelper(_)}(),t.AES})}(aes)),aes.exports}var tripledes={exports:{}},hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.WordArray,i=s.BlockCipher,o=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],g=o.DES=i.extend({_doReset:function(){for(var E=this._key,_=E.words,T=[],S=0;S<56;S++){var x=u[S]-1;T[S]=_[x>>>5]>>>31-x%32&1}for(var b=this._subKeys=[],A=0;A<16;A++){for(var R=b[A]=[],C=c[A],S=0;S<24;S++)R[S/6|0]|=T[(l[S]-1+C)%28]<<31-S%6,R[4+(S/6|0)]|=T[28+(l[S+24]-1+C)%28]<<31-S%6;R[0]=R[0]<<1|R[0]>>>31;for(var S=1;S<7;S++)R[S]=R[S]>>>(S-1)*4+3;R[7]=R[7]<<5|R[7]>>>27}for(var w=this._invSubKeys=[],S=0;S<16;S++)w[S]=b[15-S]},encryptBlock:function(E,_){this._doCryptBlock(E,_,this._subKeys)},decryptBlock:function(E,_){this._doCryptBlock(E,_,this._invSubKeys)},_doCryptBlock:function(E,_,T){this._lBlock=E[_],this._rBlock=E[_+1],m.call(this,4,252645135),m.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),m.call(this,1,1431655765);for(var S=0;S<16;S++){for(var x=T[S],b=this._lBlock,A=this._rBlock,R=0,C=0;C<8;C++)R|=d[C][((A^x[C])&f[C])>>>0];this._lBlock=A,this._rBlock=b^R}var w=this._lBlock;this._lBlock=this._rBlock,this._rBlock=w,m.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),E[_]=this._lBlock,E[_+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function m(E,_){var T=(this._lBlock>>>E^this._rBlock)&_;this._rBlock^=T,this._lBlock^=T<<E}function v(E,_){var T=(this._rBlock>>>E^this._lBlock)&_;this._lBlock^=T,this._rBlock^=T<<E}r.DES=i._createHelper(g);var y=o.TripleDES=i.extend({_doReset:function(){var E=this._key,_=E.words;if(_.length!==2&&_.length!==4&&_.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var T=_.slice(0,2),S=_.length<4?_.slice(0,2):_.slice(2,4),x=_.length<6?_.slice(0,2):_.slice(4,6);this._des1=g.createEncryptor(a.create(T)),this._des2=g.createEncryptor(a.create(S)),this._des3=g.createEncryptor(a.create(x))},encryptBlock:function(E,_){this._des1.encryptBlock(E,_),this._des2.decryptBlock(E,_),this._des3.encryptBlock(E,_)},decryptBlock:function(E,_){this._des3.decryptBlock(E,_),this._des2.encryptBlock(E,_),this._des1.decryptBlock(E,_)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=i._createHelper(y)}(),t.TripleDES})}(tripledes)),tripledes.exports}var rc4={exports:{}},hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.StreamCipher,i=r.algo,o=i.RC4=a.extend({_doReset:function(){for(var c=this._key,d=c.words,f=c.sigBytes,g=this._S=[],m=0;m<256;m++)g[m]=m;for(var m=0,v=0;m<256;m++){var y=m%f,E=d[y>>>2]>>>24-y%4*8&255;v=(v+g[m]+E)%256;var _=g[m];g[m]=g[v],g[v]=_}this._i=this._j=0},_doProcessBlock:function(c,d){c[d]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var c=this._S,d=this._i,f=this._j,g=0,m=0;m<4;m++){d=(d+1)%256,f=(f+c[d])%256;var v=c[d];c[d]=c[f],c[f]=v,g|=c[(c[d]+c[f])%256]<<24-m*8}return this._i=d,this._j=f,g}r.RC4=a._createHelper(o);var l=i.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)u.call(this)}});r.RC4Drop=a._createHelper(l)}(),t.RC4})}(rc4)),rc4.exports}var rabbit={exports:{}},hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.StreamCipher,i=r.algo,o=[],u=[],l=[],c=i.Rabbit=a.extend({_doReset:function(){for(var f=this._key.words,g=this.cfg.iv,m=0;m<4;m++)f[m]=(f[m]<<8|f[m]>>>24)&16711935|(f[m]<<24|f[m]>>>8)&4278255360;var v=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],y=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var m=0;m<4;m++)d.call(this);for(var m=0;m<8;m++)y[m]^=v[m+4&7];if(g){var E=g.words,_=E[0],T=E[1],S=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,x=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,b=S>>>16|x&4294901760,A=x<<16|S&65535;y[0]^=S,y[1]^=b,y[2]^=x,y[3]^=A,y[4]^=S,y[5]^=b,y[6]^=x,y[7]^=A;for(var m=0;m<4;m++)d.call(this)}},_doProcessBlock:function(f,g){var m=this._X;d.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,f[g+v]^=o[v]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,g=this._C,m=0;m<8;m++)u[m]=g[m];g[0]=g[0]+1295307597+this._b|0,g[1]=g[1]+3545052371+(g[0]>>>0<u[0]>>>0?1:0)|0,g[2]=g[2]+886263092+(g[1]>>>0<u[1]>>>0?1:0)|0,g[3]=g[3]+1295307597+(g[2]>>>0<u[2]>>>0?1:0)|0,g[4]=g[4]+3545052371+(g[3]>>>0<u[3]>>>0?1:0)|0,g[5]=g[5]+886263092+(g[4]>>>0<u[4]>>>0?1:0)|0,g[6]=g[6]+1295307597+(g[5]>>>0<u[5]>>>0?1:0)|0,g[7]=g[7]+3545052371+(g[6]>>>0<u[6]>>>0?1:0)|0,this._b=g[7]>>>0<u[7]>>>0?1:0;for(var m=0;m<8;m++){var v=f[m]+g[m],y=v&65535,E=v>>>16,_=((y*y>>>17)+y*E>>>15)+E*E,T=((v&4294901760)*v|0)+((v&65535)*v|0);l[m]=_^T}f[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,f[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,f[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,f[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,f[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,f[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,f[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,f[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}r.Rabbit=a._createHelper(c)}(),t.Rabbit})}(rabbit)),rabbit.exports}var rabbitLegacy={exports:{}},hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(t){return function(){var r=t,s=r.lib,a=s.StreamCipher,i=r.algo,o=[],u=[],l=[],c=i.RabbitLegacy=a.extend({_doReset:function(){var f=this._key.words,g=this.cfg.iv,m=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],v=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var y=0;y<4;y++)d.call(this);for(var y=0;y<8;y++)v[y]^=m[y+4&7];if(g){var E=g.words,_=E[0],T=E[1],S=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,x=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,b=S>>>16|x&4294901760,A=x<<16|S&65535;v[0]^=S,v[1]^=b,v[2]^=x,v[3]^=A,v[4]^=S,v[5]^=b,v[6]^=x,v[7]^=A;for(var y=0;y<4;y++)d.call(this)}},_doProcessBlock:function(f,g){var m=this._X;d.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,f[g+v]^=o[v]},blockSize:128/32,ivSize:64/32});function d(){for(var f=this._X,g=this._C,m=0;m<8;m++)u[m]=g[m];g[0]=g[0]+1295307597+this._b|0,g[1]=g[1]+3545052371+(g[0]>>>0<u[0]>>>0?1:0)|0,g[2]=g[2]+886263092+(g[1]>>>0<u[1]>>>0?1:0)|0,g[3]=g[3]+1295307597+(g[2]>>>0<u[2]>>>0?1:0)|0,g[4]=g[4]+3545052371+(g[3]>>>0<u[3]>>>0?1:0)|0,g[5]=g[5]+886263092+(g[4]>>>0<u[4]>>>0?1:0)|0,g[6]=g[6]+1295307597+(g[5]>>>0<u[5]>>>0?1:0)|0,g[7]=g[7]+3545052371+(g[6]>>>0<u[6]>>>0?1:0)|0,this._b=g[7]>>>0<u[7]>>>0?1:0;for(var m=0;m<8;m++){var v=f[m]+g[m],y=v&65535,E=v>>>16,_=((y*y>>>17)+y*E>>>15)+E*E,T=((v&4294901760)*v|0)+((v&65535)*v|0);l[m]=_^T}f[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,f[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,f[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,f[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,f[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,f[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,f[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,f[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}r.RabbitLegacy=a._createHelper(c)}(),t.RabbitLegacy})}(rabbitLegacy)),rabbitLegacy.exports}(function(n,e){(function(t,r,s){n.exports=r(requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy())})(commonjsGlobal,function(t){return t})})(cryptoJs);var cryptoJsExports=cryptoJs.exports;const CryptoJS=getDefaultExportFromCjs$1(cryptoJsExports),YT_API=()=>{var n="f0fc4c668392f9f9a447e48584c214ee",e=function(o){return CryptoJS.MD5(o).toString().toUpperCase()},t={msTsApi:"https://mstsout.radio.cn",msApi:"https://ytmsout.radio.cn",msHeader:{"Content-Type":"application/json",equipmentId:"0000",platformCode:"WEB"},ssTsApi:"https://yuntingoltest.radio.cn/ytsrv/srv",ssApi:"https://ytapi.radio.cn/ytsrv/srv",ssHeader:{"Content-Type":"application/x-www-form-urlencoded",version:"4.0.0",providerCode:"25010",equipmentSource:"WEB"}},r={getStaticData:{url:"/web/interactive/getInterface",method:"get"},getRadioProvinceList:{url:"/web/appProvince/list/all",method:"get"},getRadioCategoryList:{url:"/web/appCategory/list/all",method:"get"},getRadioList:{url:"/web/appBroadcast/list",method:"get"},getListenBackList:{url:"/web/appBroadcast/listenbackList",method:"get"},getProgramList:{url:"/web/appProgram/listByDate",method:"get"},getPageByColumn:{url:"/web/appProgram/pageByColumn",method:"get"},getAlbumDetail:{url:"/web/appAlbum/detail",method:"get"},pageByAlbum:{url:"/web/appSingle/pageByAlbum",method:"get"}},s=function(o,u){if(u||(u="get"),u=u.toUpperCase(),u==="POST")return JSON.stringify(o);var l=Object.keys(o).sort(),c=[],d="";if(l.length)for(var f=0;f<l.length;f++)d=l[f],c.push(d+"="+o[d]);return c.join("&")},a=function(o){let u=[];for(const l in o){let c=o[l];u.push(l+"="+c)}return u.join("&")},i=function(o){if(!o.name)return;var u=r[o.name].url,l=r[o.name].uType||0;o.name==="getStaticData"&&(o.data={id:o.data[0]});var c=t[(l?"ss":"ms")+"Api"],d={url:c+u+"?"+a(o.data),method:r[o.name].method,async:r[o.name].async!==1};if(d.headers=t[(l===1?"ss":"ms")+"Header"],!l){var f=new Date().getTime();o.name!=="getStaticData"&&o.data&&Object.keys(o.data)&&Object.keys(o.data).length===1&&(d.url+="/"+o.data[Object.keys(o.data)[0]]);var g=(o.data?s(o.data,r[o.name].method)+"&":"")+"timestamp="+f+"&key="+n;d.headers.timestamp=f,d.headers.sign=e(g)}o.name==="uploadImg"&&(d.processData=!1,d.contentType=!1);let m=d.headers,v=[];for(let[y,E]of Object.entries(m))v.push({name:y,value:E});return d.headers=v,console.log("~~~ajaxOpts",{ajaxOpts:d}),d};return{request:i}};let ZYYT$1=class{constructor(e){this.groupList=[],this.videoList=[],this.audioList=[],this.resultText="",this.searchValue="",this.currentPage=1,this.totalItems=0,this.pageCount=1,this.showPageSize=6,this.itemsPerPage=20,this.mediaInfo={},this.currentChannel=null,this.playfrom=e==null?void 0:e.PLATFORM,this.iframe=(e==null?void 0:e.iframe)||!1,this.filterENABLE=(e==null?void 0:e.filterENABLE)||!1,this.proxyENABLE=(e==null?void 0:e.proxyENABLE)||!1,console.log(`~~~~${this.playfrom}`,{config:e}),this.provinceList={groupName:"广播电台"}}getProxyConfig(e,t="uutool.cn"){return this.proxyENABLE?proxyList[t].config(e):{url:e}}async getRadioProvinceList(e=null){let t={name:"getRadioProvinceList"},r=YT_API().request(t),[s,a]=await awaitFunc(xhrSend(r));console.log("~~ProvinceList:",{err:s,data:a});let i=null;if(a&&(i=this.handle_keyword().success(a)),s&&this.handle_keyword().error(s),s)return null;let{groupList:o}=i;if(e){let u=o.filter(l=>l.tid==~~e);return u&&u.length>0?u=u[0]:u={},this.provinceList={...this.provinceList,...i,...u},console.log("~~provinceData:",{groupList:o,provinceData:this.provinceList}),null}return o=o.filter(u=>u.tid!="0"),this.createNewGroup(o)}createNewGroup(e){let t={group:this.playfrom,channel:{}};for(let r of e)t.channel[r.name]||(t.channel[r.name]=[]),t.channel[r.name].push({name:"loading",value:"update",iframe:this.iframe,search:{name:"getRadioList",tid:r.tid,from:this.playfrom}});return console.log("~~newGroup:",{newGroup:t}),t}async getRadioList({categoryId:e=0,provinceCode:t=0,tid:r=0,channelName:s="",callback:a=null}){let i={name:"getRadioList",data:{categoryId:e||"0",provinceCode:r||t||"0"}},o={name:"getRadioCategoryList"},u=YT_API().request(i);YT_API().request(o);let[l,c]=await awaitFunc(xhrSend(u));console.log("~~RadioList:",{err:l,data:c,callback:a});let d=null;if(c&&(d=this.handle_keyword().success(c,a)),l&&this.handle_keyword().error(l,a),d&&d.videoList){console.log("~~newItems",d);let f={group:this.playfrom,channel:{}};for(let g of d.videoList){let{channel:m}=g.newGroup;if(s){f.channel[s]||(f.channel[s]=[]);for(const v in m)f.channel[s]=[...f.channel[s],...m[v]]}else f.channel={...f.channel,...m}}return{newGroup:f}}}async searchByKeywordDetail({keyword:e,tid:t="",retryNum:r=3,callback:s=null}){return this.searchByKeyword({keyword:e,tid:t,retryNum:r,callback:s})}async searchByKeyword({keyword:e="",tid:t="",retryNum:r=3,callback:s=null}){this.resultText=e;let a=0,i=t;await this.getRadioProvinceList(t||"0"),await this.getRadioList({categoryId:a,provinceCode:i,callback:s})}async searchByGroupID(e){let{tid:t}=e;t&&this.searchByKeyword({keyword:"",tid:t})}async searchByVideoID({id:e,retryNum:t=3,callback:r=null,currentChannel:s=null}){var f,g;const a=this;s!=null&&(a.currentChannel=s),console.log("~~searchByVideoID~awaitFunc:",{currentChannel:s,id:e});let o={name:"getRadioList",data:{categoryId:"0",provinceCode:((g=(f=s==null?void 0:s._channel)==null?void 0:f.search)==null?void 0:g.tid)||"0"}},u=YT_API().request(o),[l,c]=await awaitFunc(xhrSend(u));console.log("~~ProvinceList:",{err:l,data:c,callback:r}),c&&(c.id=e);let d=null;return c!=null&&(d=await this.handle_id().success(c,r)),l&&(d=this.handle_id().error(l,r)),console.log("~~~~searchByVideoID:[err, data]",{err:l,data:c,result:d}),d}async searchDetailByVideoID(e,t=3){let r=e.match(/\d+/gi);r&&(r=r[0]);var s=new Date,a,i;s.getMonth()+1<10?a="0"+(s.getMonth()+1):a=s.getMonth()+1,s.getDate()<10?i="0"+s.getDate():i=s.getDate();let u={name:"getProgramList",data:{date:1900+s.getYear()+"-"+a+"-"+i,broadcastId:r}},l=YT_API().request(u);const[c,d]=await awaitFunc(xhrProxySend(l));if(console.log("~~searchDetailByVideoID~awaitFunc:",{err:c,data:d}),c)return this.handle_detail().error(c);if(d)return this.handle_detail().success(d)}handle_detail(){const e=this;return{error:(t,r=null)=>(console.log("~~!!handle_detail::error",{error:t}),e.resultText="结果:空",null),success:(t,r=null)=>{let s=t.response;console.log("~~handle_detail",{data:t,responseText:s});let a=null;try{a=JSON.parse(s)}catch(i){console.error(i)}return console.log("~~handle_detail:response",{response:a}),!a||!(a!=null&&a.data)?(e.resultText="结果:空",null):e.handle_detail().handle(a)},handle:t=>{var u;let r=t==null?void 0:t.data;console.log("~~handle_detail:progms",{progms:r});let s=new Date().getTime(),a=r.filter(l=>s>=l.startTime&&s<=l.endTime);a&&a.length>0&&(a=a[0]),console.log("~~handle_detail:progms",{progms:r,nowTime:s,nowProgm:a});let i=a==null?void 0:a.programDate;i&&(i=new Date(i).toLocaleString());let o={des:a==null?void 0:a.des,note:a==null?void 0:a.sub,info:a==null?void 0:a.content,year:i,area:a==null?void 0:a.area,director:a==null?void 0:a.artist,lang:a==null?void 0:a.lang,pic:a==null?void 0:a.image,artist:a==null?void 0:a.artist,actor:a==null?void 0:a.artist,name:a==null?void 0:a.programName,id:a==null?void 0:a.id,tid:a==null?void 0:a.columnId,type:escape2Html(a==null?void 0:a.album),last:a==null?void 0:a.songTimeMinutes,lyric:(u=t==null?void 0:t.data)==null?void 0:u.lrclist,url:""};console.log("~~jsonResponse:vInfo",{vInfo:o});for(const l in o)if(Object.hasOwnProperty.call(o,l)){const c=o[l]||"";o[l]=c}return console.log({response:t,nowProgm:a,vInfo:o}),{vInfo:o}}}}handle_keyword(){const e=this;return{error:(t,r=null)=>{console.log("~~!!handle_keyword::error",{error:t});let{status:s}=t;return e.resultText=`错误: Code: ${s}，请稍后重试。`,r&&r(null),null},success:(t,r=null)=>{console.log("~~!!handle_keyword::success",{data:t});let s=null,a=t==null?void 0:t.response;a=a.replace(/\'/gi,'"'),console.log("~~jsonResponse",{data:t,responseText:a,callback:r});let i=null;try{i=JSON.parse(a)}catch(o){console.error(o)}return console.log("~~jsonResponse:success",{response:i,callback:r}),i?(s=e.handle_keyword().handle(i),r&&r(s)):(e.resultText="结果:空",r&&r(null)),console.log("~~jsonResponse:newItem",{newItem:s,callback:r}),s},handle:t=>{var a,i,o,u;console.log("~~handle_keyword:handle",{response:t,provinceList:this.provinceList});let r=t==null?void 0:t.data,s=t==null?void 0:t.data;if(!e.resultText&&r&&r.length>0&&e.groupList.length==0&&(e.groupList=((a=e.provinceList)==null?void 0:a.groupList)||[],r.forEach(l=>{l.provinceName&&e.groupList.push({tid:l.provinceCode,name:l.provinceName})})),((i=e.groupList)==null?void 0:i.length)==0&&((o=e.provinceList)!=null&&o.groupList)&&(e.groupList=((u=e.provinceList)==null?void 0:u.groupList)||[]),!s)return e.videoList=[],e.resultText="结果:空",{videoList:e.videoList,groupList:e.groupList};try{let{PN:l,SHOW:c,TOTAL:d,RN:f,pagesize:g,recordcount:m}=t;e.currentPage=l,e.totalItems=d,e.pageCount=c,e.itemsPerPage=f}catch{}return e.videoList=[],s&&s.forEach((l,c,d)=>{if(!l||!(l!=null&&l.title))return;let f="",g="",m="",v="",y="",E="",_="",T=[];try{f=l==null?void 0:l.title}catch{}try{g=(l==null?void 0:l.vod_blurb)||"",g=g.trim()}catch{}try{m=(l==null?void 0:l.subtitle)||""}catch{}try{v=(l==null?void 0:l.vod_time)||""}catch{}try{E=l==null?void 0:l.image}catch{}try{_=(l==null?void 0:l.vod_year)||""}catch{}try{y=l==null?void 0:l.subtitle}catch{}l!=null&&l.mp3PlayUrlHigh&&T.push(`${f}.H$${l==null?void 0:l.mp3PlayUrlHigh}`),l!=null&&l.mp3PlayUrlLow&&T.push(`${f}.L$${l==null?void 0:l.mp3PlayUrlLow}`);let S={des:g,note:m,info:y,pic:E,year:_,name:f,artist:l==null?void 0:l.ARTIST,id:l==null?void 0:l.contentId,tid:e.provinceList.tid,type:escape2Html(e.provinceList.name||""),last:l==null?void 0:l.vod_time,playUrl:T.join("#"),url:l==null?void 0:l.mp3PlayUrlHigh};S={...S,newGroup:this.parseM3U8Text(S)},l!=null&&l.title&&e.videoList.push(S)}),console.log("结果：",{videoList:e.videoList,groupList:e.groupList}),{videoList:e.videoList,groupList:e.groupList,currentPage:e.currentPage,totalItems:e.totalItems,pageCount:e.pageCount,itemsPerPage:e.itemsPerPage}}}}parseM3U8Text({playUrl:e,id:t,tid:r,type:s,name:a}){const i=this;let o=i.provinceList.groupName||s;const u=s||a;if(!e)return{newGroup:null};let l=e==null?void 0:e.split("$$$").join("#"),c={group:o,channel:{[u]:[]}};return l?l.split("#").forEach((f,g,m)=>{if(f){let[v,y,...E]=f.split("$");c.channel[u].push({name:v,value:y,iframe:i.iframe,search:{id:t,tid:r,type:s,line:E.join(),from:this.playfrom,playfrom:""}})}}):c.channel[u].push({name:"空",value:"空",iframe:i.iframe,search:{id:t,tid:r,type:s,from:this.playfrom,playfrom:""}}),c}handle_id(){const e=this;return{error:t=>(console.log("~~!!handle_id::error",{error:t}),e.resultText="错误:请求被中断，请查看是否有请求跨域限制。",null),success:async(t,r=null)=>{console.log("~~!!handle_id::success",{data:t});let s=t==null?void 0:t.response,a=t==null?void 0:t.id;console.log("~~jsonResponse",{data:t,responseText:s});let i=null;try{i=JSON.parse(s)}catch(o){console.error(o)}if(console.log("~~jsonResponse:response",{response:i}),i){let o=await e.handle_id().handle({response:i,musicid:a});r&&r(o)}else return e.resultText="结果:空",null},handle:async t=>{console.log("~~handle_id:handle",{ret:t,videoList:e.videoList,provinceList:this.provinceList});let{response:r,musicid:s}=t,a=r==null?void 0:r.data,i=this.resultText||e.provinceList.groupName||e.provinceList.name,o=this.resultText,u="mp3",l=2,c=a.filter(x=>x.contentId==s);if(c&&c.length>0&&(c=c[0],o=c==null?void 0:c.name),console.log("~~jsonResponse:video",{video:c,videoList:a,grouplName:i,musicid:s}),c==null)return null;if(e.currentChannel!=null)try{let{_activePLTab:x,_channel:b,_groupName:A,_channelName:R}=e.currentChannel,C=b==null?void 0:b.search;l=x,i=A,o=R,u=b==null?void 0:b.name,c={...c,...b},console.log("~~oldItem:video",{video:c,currentChannel:e.currentChannel})}catch(x){console.log("~~oldItem:error",{error:x})}let d={note:c==null?void 0:c.subtitle,pic:c==null?void 0:c.image,id:s||(c==null?void 0:c.contentId),...c,url:c==null?void 0:c.mp3PlayUrlHigh},{id:f,tid:g,type:m,artist:v,name:y,url:E,pic:_,lyric:T=null}=d;i=i||v||e.resultText,o=o||y||v||`《${m}》`,i=escape2Html(i),o=escape2Html(o),u=escape2Html(u);let S={group:i||m,channel:{[o]:[]}};return S.channel[o]=[],S.channel[o].push({name:u||"mp3",value:E,poster:_,iframe:e.iframe,search:{id:f,tid:g,type:m,playListTab:l,from:this.playfrom,playfrom:this.playfrom}}),console.log("newGroup",S),{newGroup:S}}}}};const ZYMUSIC={text:"云音乐资源",value:"ZYMUSIC",ref:"ZYMUSIC",children:[{text:"酷我",value:"kuwo"},{text:"酷狗",value:"kugou"},{text:"QQ",value:"qq"},{text:"B站",value:"bilibili"},{text:"咪咕",value:"migu"},{text:"网易云",value:"163"},{text:"千千",value:"taihe"},{text:"一听",value:"1ting"},{text:"荔枝",value:"lizhi"},{text:"蜻蜓",value:"qingting"},{text:"喜马拉雅",value:"taihe"},{text:"全民K歌",value:"kg"}]},ZYYPARSE={text:"云解析资源",value:"ZYYPARSE",ref:"ZYJSON",children:[{text:"腾讯",value:"qq"},{text:"奇艺",value:"qiyi"},{text:"优酷",value:"youku"},{text:"芒果",value:"mgtv"},{text:"乐视",value:"letv"},{text:"PPTV",value:"pptv"},{text:"电影网",value:"m1905"},{text:"CNTV高清",value:"cntv"},{text:"搜狐",value:"sohu"},{text:"华数",value:"wasu"},{text:"新闻娱乐",value:"news"},{text:"云播",value:"m3u8"}],iframe:!0,apiUrl:"https://api.yparse.com/api/json/"},ZYYT={text:"云听广播",value:"ZYYT",ref:"ZYYT",apiUrl:"https://api.1080zyku.com/inc/api_mac10.php"},ZYIPTV={text:"IPTV",value:"ZYIPTV",ref:"ZYIPTV",apiUrl:""},ZYK1080SON={text:"优质资源库",value:"ZYK1080SON",ref:"ZYJSON",apiUrl:"https://api.1080zyku.com/inc/api_mac10.php"},ZYKUK={text:"U酷资源",value:"ZYKUK",ref:"ZYJSON",apiUrl:"https://api.ukuapi.com/api.php/provide/vod/"},ZYK8J={text:"八戒资源库",value:"ZYK8J",ref:"ZYXML",apiUrl:"http://cj.bajiecaiji.com/inc/bjm3u8.php"},ZYBD={text:"百度资源库",value:"ZYBD",ref:"ZYJSON",apiUrl:"https://api.apibdzy.com/api.php/provide/vod/"},ZYXL={text:"新浪资源库",value:"ZYXL",ref:"ZYJSON",apiUrl:"https://api.xinlangapi.com/xinlangapi.php/provide/vod/"},ZYHN={text:"红牛资源库",value:"ZYHN",ref:"ZYJSON",apiUrl:"https://www.hongniuzy2.com/api.php/provide/vod/"},ZYTIANKONG={text:"天空资源网",value:"ZYTIANKONG",ref:"ZYJSON",apiUrl:"https://api.tiankongapi.com/api.php/provide/vod/"},ZYWJ={text:"无尽资源网",value:"ZYWJ",ref:"ZYJSON",apiUrl:"https://api.wujinapi.me/api.php/provide/vod/"},ZYSD={text:"闪电资源网",value:"ZYSD",ref:"ZYJSON",apiUrl:"https://sdzyapi.com/api.php/provide/vod/from/sdm3u8"},ZYKC={text:"快车资源网",value:"ZYKC",ref:"ZYJSON",apiUrl:"https://caiji.kczyapi.com/api.php/provide/vod/from/kcm3u8"},ZYKBY={text:"快播资源网",value:"ZYKBY",ref:"ZYJSON",apiUrl:"http://www.kuaibozy.com/api.php/provide/vod/"},ZYKTP={text:"淘片资源网",value:"ZYKTP",ref:"ZYJSON",apiUrl:"https://taopianapi.com/home/cjapi/as/mc10/vod/json"},ZYKFS={text:"飞速资源网",value:"ZYKFS",ref:"ZYJSON",apiUrl:"https://www.feisuzyapi.com/api.php/provide/vod/"},ZYGS={text:"光速资源档",value:"ZYGS",ref:"ZYJSON",apiUrl:"https://api.guangsuapi.com/api.php/provide/vod/",filterENABLE:!0},ZYLB={text:"乐播资源档",value:"ZYLB",ref:"ZYJSON",apiUrl:"https://lbapi9.com/api.php/provide/vod/",filterENABLE:!0},ZYSY={text:"鲨鱼资源档",value:"ZYSY",ref:"ZYXML",apiUrl:"https://shayuapi.com/api.php/Seacms/vod/",filterENABLE:!0},ZYDD={text:"大地资源档",value:"ZYDD",ref:"ZYXML",apiUrl:"https://dadiapi.com/api.php",filterENABLE:!0},ZYHY={text:"环亚资源档",value:"ZYHY",ref:"ZYXML",apiUrl:"https://wmcj8.com/inc/sapi.php",filterENABLE:!0},ZYSW={text:"Sewo资源档",value:"ZYSW",ref:"ZYJSON",apiUrl:"https://sewozyapi.com/api.php/provide/vod/",filterENABLE:!0},ZYLY={text:"Laoya资源档",value:"ZYLY",ref:"ZYJSON",apiUrl:"https://api.apilyzy.com/api.php/provide/vod/",filterENABLE:!0},ZYPT={text:"葡萄资源档",value:"ZYPT",ref:"ZYJSON",apiUrl:"https://caiji.putaozy.net/inc/apijson_vod.php",filterENABLE:!0},platformJSON={ZYMUSIC,ZYYPARSE,ZYYT,ZYIPTV,ZYK1080SON,ZYKUK,ZYK8J,ZYBD,ZYXL,ZYHN,ZYTIANKONG,ZYWJ,ZYSD,ZYKC,ZYKBY,ZYKTP,ZYKFS,ZYGS,ZYLB,ZYSY,ZYDD,ZYHY,ZYSW,ZYLY,ZYPT},JSONobj2arr=n=>{let e=[];for(let[t,r]of Object.entries(n))e.push(r);return e};JSONobj2arr(platformJSON);const searchEngines={ZYXML,ZYJSON,ZYMUSIC:ZYMUSIC$1,ZYYT:ZYYT$1,ZYIPTV:ZYIPTV$1};class SearchEngineFactory{static create(e){let{name:t,filterENABLE:r,proxyENABLE:s,proxyName:a=""}=e;const i=platformJSON[t];if(!i)return null;let o=t;const u={apiUrl:i==null?void 0:i.apiUrl,iframe:(i==null?void 0:i.iframe)||!1,PLATFORM:t,filterENABLE:r,proxyENABLE:s,proxyName:a};i.hasOwnProperty("ref")&&i.ref&&(o=i.ref);let l=searchEngines[o];return l?new l(u):null}}const searchEngine=function(n){return console.log("~~searchEngine",{...n}),SearchEngineFactory.create(n)};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var urlToolkit={exports:{}};(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(u,l,c){if(c=c||{},u=u.trim(),l=l.trim(),!l){if(!c.alwaysNormalize)return u;var d=o.parseURL(u);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return c.alwaysNormalize?(f.path=o.normalizePath(f.path),o.buildURLFromParts(f)):l;var g=o.parseURL(u);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var m=s.exec(g.path);g.netLoc=m[1],g.path=m[2]}g.netLoc&&!g.path&&(g.path="/");var v={scheme:g.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(v.netLoc=g.netLoc,f.path[0]!=="/"))if(!f.path)v.path=g.path,f.params||(v.params=g.params,f.query||(v.query=g.query));else{var y=g.path,E=y.substring(0,y.lastIndexOf("/")+1)+f.path;v.path=o.normalizePath(E)}return v.path===null&&(v.path=c.alwaysNormalize?o.normalizePath(f.path):f.path),o.buildURLFromParts(v)},parseURL:function(u){var l=r.exec(u);return l?{scheme:l[1]||"",netLoc:l[2]||"",path:l[3]||"",params:l[4]||"",query:l[5]||"",fragment:l[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(a,"");u.length!==(u=u.replace(i,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};n.exports=o})()})(urlToolkit);var urlToolkitExports=urlToolkit.exports;function ownKeys(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function _objectSpread2(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _defineProperty(n,e,t){return e=_toPropertyKey(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(this,arguments)}function _toPrimitive(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _toPropertyKey(n){var e=_toPrimitive(n,"string");return typeof e=="symbol"?e:String(e)}const isFiniteNumber=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};let Events=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n}({}),ErrorTypes=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),ErrorDetails=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const noop$1=function n(){},fakeLogger={trace:noop$1,debug:noop$1,log:noop$1,warn:noop$1,info:noop$1,error:noop$1};let exportedLogger=fakeLogger;function consolePrintFn(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):noop$1}function exportLoggerFunctions(n,...e){e.forEach(function(t){exportedLogger[t]=n[t]?n[t].bind(n):consolePrintFn(t)})}function enableLogs(n,e){if(self.console&&n===!0||typeof n=="object"){exportLoggerFunctions(n,"debug","log","info","warn","error");try{exportedLogger.log(`Debug logs enabled for "${e}" in hls.js version 1.4.3`)}catch{exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}const logger=exportedLogger,DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(e){typeof e=="string"&&(e=AttrList.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&(t.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=DECIMAL_RESOLUTION_REGEX.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const r={},s='"';for(ATTR_LIST_REGEX.lastIndex=0;(t=ATTR_LIST_REGEX.exec(e))!==null;){let a=t[2];a.indexOf(s)===0&&a.lastIndexOf(s)===a.length-1&&(a=a.slice(1,-1));const i=t[1].trim();r[i]=a}return r}}function isDateRangeCueAttribute(n){return n!=="ID"&&n!=="CLASS"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function isSCTE35Attribute(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"}class DateRange{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const r=t.attr;for(const s in r)if(Object.prototype.hasOwnProperty.call(e,s)&&e[s]!==r[s]){logger.warn(`DATERANGE tag attribute: "${s}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=s;break}e=_extends(new AttrList({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=new Date(this.attr["END-DATE"]);isFiniteNumber(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const r=e.split("@",2),s=[];r.length===1?s[0]=t?t.byteRangeEndOffset:0:s[0]=parseInt(r[1]),s[1]=parseInt(r[0])+s[0],this._byteRange=s}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Fragment extends BaseSegment{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new LoadStats,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!isFiniteNumber(this.programDateTime))return null;const e=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,a,i=!1){const{elementaryStreams:o}=this,u=o[e];if(!u){o[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:a,partial:i};return}u.startPTS=Math.min(u.startPTS,t),u.endPTS=Math.max(u.endPTS,r),u.startDTS=Math.min(u.startDTS,s),u.endDTS=Math.max(u.endDTS,a)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ElementaryStreamTypes.AUDIO]=null,e[ElementaryStreamTypes.VIDEO]=null,e[ElementaryStreamTypes.AUDIOVIDEO]=null}}class Part extends BaseSegment{constructor(e,t,r,s,a){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new LoadStats,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const i=e.enumeratedString("BYTERANGE");i&&this.setByteRange(i,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function base64Decode(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function getKeyIdBytes(n){const e=strToUtf8array(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function changeEndianness(n){const e=function(r,s,a){const i=r[s];r[s]=r[a],r[a]=i};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function convertDataUriToArrayBytes(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const a=s[0]==="base64",i=s[1];a?(r.splice(-1,1),t=base64Decode(i)):t=getKeyIdBytes(i)}}return t}function strToUtf8array(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(n){switch(n){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}var KeySystemIds={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function keySystemIdToKeySystemDomain(n){if(n===KeySystemIds.WIDEVINE)return KeySystems.WIDEVINE}function keySystemDomainToKeySystemFormat(n){switch(n){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(s=>!!e[s]):[];return!r[KeySystems.WIDEVINE]&&t&&r.push(KeySystems.WIDEVINE),r}const requestMediaKeySystemAccess=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(n,e,t,r){let s;switch(n){case KeySystems.FAIRPLAY:s=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:s=["cenc"];break;case KeySystems.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return createMediaKeySystemConfigurations(s,e,t,r)}function createMediaKeySystemConfigurations(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"not-allowed",distinctiveIdentifier:r.distinctiveIdentifier||"not-allowed",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(a=>({contentType:`audio/mp4; codecs="${a}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(a=>({contentType:`video/mp4; codecs="${a}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function sliceUint8(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const isHeader$2=(n,e)=>e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,isFooter=(n,e)=>e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,getID3Data=(n,e)=>{const t=e;let r=0;for(;isHeader$2(n,e);){r+=10;const s=readSize(n,e+6);r+=s,isFooter(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)},readSize=(n,e)=>{let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t},canParse$2=(n,e)=>isHeader$2(n,e)&&readSize(n,e+6)+10<=n.length-e,getTimeStamp=n=>{const e=getID3Frames(n);for(let t=0;t<e.length;t++){const r=e[t];if(isTimeStampFrame(r))return readTimeStamp(r)}},isTimeStampFrame=n=>n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp",getFrameData=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=readSize(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}},getID3Frames=n=>{let e=0;const t=[];for(;isHeader$2(n,e);){const r=readSize(n,e+6);e+=10;const s=e+r;for(;e+8<s;){const a=getFrameData(n.subarray(e)),i=decodeFrame(a);i&&t.push(i),e+=a.size+10}isFooter(n,e)&&(e+=10)}return t},decodeFrame=n=>n.type==="PRIV"?decodePrivFrame(n):n.type[0]==="W"?decodeURLFrame(n):decodeTextFrame(n),decodePrivFrame=n=>{if(n.size<2)return;const e=utf8ArrayToStr(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},decodeTextFrame=n=>{if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=utf8ArrayToStr(n.data.subarray(t),!0);t+=r.length+1;const s=utf8ArrayToStr(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=utf8ArrayToStr(n.data.subarray(1));return{key:n.type,data:e}},decodeURLFrame=n=>{if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=utf8ArrayToStr(n.data.subarray(t),!0);t+=r.length+1;const s=utf8ArrayToStr(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=utf8ArrayToStr(n.data);return{key:n.type,data:e}},readTimeStamp=n=>{if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}},utf8ArrayToStr=(n,e=!1)=>{const t=getTextDecoder();if(t){const l=t.decode(n);if(e){const c=l.indexOf("\0");return c!==-1?l.substring(0,c):l}return l.replace(/\0/g,"")}const r=n.length;let s,a,i,o="",u=0;for(;u<r;){if(s=n[u++],s===0&&e)return o;if(s===0||s===3)continue;switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(s);break;case 12:case 13:a=n[u++],o+=String.fromCharCode((s&31)<<6|a&63);break;case 14:a=n[u++],i=n[u++],o+=String.fromCharCode((s&15)<<12|(a&63)<<6|(i&63)<<0);break}}return o};let decoder;function getTextDecoder(){return!decoder&&typeof self.TextDecoder<"u"&&(decoder=new self.TextDecoder("utf-8")),decoder}const Hex={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}},UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(n){return String.fromCharCode.apply(null,n)}function readUint16(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function readUint32(n,e){const t=readSint32(n,e);return t<0?4294967296+t:t}function readSint32(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function writeUint32(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function findBox(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const a=readUint32(n,s),i=bin2str(n.subarray(s+4,s+8)),o=a>1?s+a:r;if(i===e[0])if(e.length===1)t.push(n.subarray(s+8,o));else{const u=findBox(n.subarray(s+8,o),e.slice(1));u.length&&push.apply(t,u)}s=o}return t}function parseSegmentIndex(n){const e=[],t=n[0];let r=8;const s=readUint32(n,r);r+=4;const a=0,i=0;t===0?r+=8:r+=16,r+=2;let o=n.length+i;const u=readUint16(n,r);r+=2;for(let l=0;l<u;l++){let c=r;const d=readUint32(n,c);c+=4;const f=d&2147483647;if((d&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const m=readUint32(n,c);c+=4,e.push({referenceSize:f,subsegmentDuration:m,info:{duration:m/s,start:o,end:o+f-1}}),o+=f,c+=4,r=c}return{earliestPresentationTime:a,timescale:s,version:t,referencesCount:u,references:e}}function parseInitSegment(n){const e=[],t=findBox(n,["moov","trak"]);for(let s=0;s<t.length;s++){const a=t[s],i=findBox(a,["tkhd"])[0];if(i){let o=i[0],u=o===0?12:20;const l=readUint32(i,u),c=findBox(a,["mdia","mdhd"])[0];if(c){o=c[0],u=o===0?12:20;const d=readUint32(c,u),f=findBox(a,["mdia","hdlr"])[0];if(f){const g=bin2str(f.subarray(8,12)),m={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[g];if(m){const v=findBox(a,["mdia","minf","stbl","stsd"])[0];let y;v&&(y=bin2str(v.subarray(12,16))),e[l]={timescale:d,type:m},e[m]={timescale:d,id:l,codec:y}}}}}}return findBox(n,["moov","mvex","trex"]).forEach(s=>{const a=readUint32(s,4),i=e[a];i&&(i.default={duration:readUint32(s,12),flags:readUint32(s,20)})}),e}function patchEncyptionData(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&findBox(n,["moov","trak"]).forEach(s=>{const i=findBox(s,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=findBox(i,["enca"]);const u=o.length>0;u||(o=findBox(i,["encv"])),o.forEach(l=>{const c=u?l.subarray(28):l.subarray(78);findBox(c,["sinf"]).forEach(f=>{const g=parseSinf(f);if(g){const m=g.subarray(8,24);m.some(v=>v!==0)||(logger.log(`[eme] Patching keyId in 'enc${u?"a":"v"}>sinf>>tenc' box: ${Hex.hexDump(m)} -> ${Hex.hexDump(t)}`),g.set(t,8))}})})}),n}function parseSinf(n){const e=findBox(n,["schm"])[0];if(e){const t=bin2str(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return findBox(n,["schi","tenc"])[0]}return logger.error("[eme] missing 'schm' box"),null}function getStartDTS(n,e){return findBox(e,["moof","traf"]).reduce((t,r)=>{const s=findBox(r,["tfdt"])[0],a=s[0],i=findBox(r,["tfhd"]).reduce((o,u)=>{const l=readUint32(u,4),c=n[l];if(c){let d=readUint32(s,4);if(a===1){if(d===UINT32_MAX$1)return logger.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;d*=UINT32_MAX$1+1,d+=readUint32(s,8)}const f=c.timescale||9e4,g=d/f;if(isFinite(g)&&(o===null||g<o))return g}return o},null);return i!==null&&isFinite(i)&&(t===null||i<t)?i:t},null)}function getDuration(n,e){let t=0,r=0,s=0;const a=findBox(n,["moof","traf"]);for(let i=0;i<a.length;i++){const o=a[i],u=findBox(o,["tfhd"])[0],l=readUint32(u,4),c=e[l];if(!c)continue;const d=c.default,f=readUint32(u,0)|(d==null?void 0:d.flags);let g=d==null?void 0:d.duration;f&8&&(f&2?g=readUint32(u,12):g=readUint32(u,8));const m=c.timescale||9e4,v=findBox(o,["trun"]);for(let y=0;y<v.length;y++){if(t=computeRawDurationFromSamples(v[y]),!t&&g){const E=readUint32(v[y],4);t=g*E}c.type===ElementaryStreamTypes.VIDEO?r+=t/m:c.type===ElementaryStreamTypes.AUDIO&&(s+=t/m)}}if(r===0&&s===0){let i=0;const o=findBox(n,["sidx"]);for(let u=0;u<o.length;u++){const l=parseSegmentIndex(o[u]);l!=null&&l.references&&(i+=l.references.reduce((c,d)=>c+d.info.duration||0,0))}return i}return r||s}function computeRawDurationFromSamples(n){const e=readUint32(n,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let r=0;const s=readUint32(n,4);for(let a=0;a<s;a++){if(e&256){const i=readUint32(n,t);r+=i,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return r}function offsetStartDTS(n,e,t){findBox(e,["moof","traf"]).forEach(r=>{findBox(r,["tfhd"]).forEach(s=>{const a=readUint32(s,4),i=n[a];if(!i)return;const o=i.timescale||9e4;findBox(r,["tfdt"]).forEach(u=>{const l=u[0];let c=readUint32(u,4);if(l===0)c-=t*o,c=Math.max(c,0),writeUint32(u,4,c);else{c*=Math.pow(2,32),c+=readUint32(u,8),c-=t*o,c=Math.max(c,0);const d=Math.floor(c/(UINT32_MAX$1+1)),f=Math.floor(c%(UINT32_MAX$1+1));writeUint32(u,4,d),writeUint32(u,8,f)}})})})}function segmentValidRange(n){const e={valid:null,remainder:null},t=findBox(n,["moof"]);if(t){if(t.length<2)return e.remainder=n,e}else return e;const r=t[t.length-1];return e.valid=sliceUint8(n,0,r.byteOffset-8),e.remainder=sliceUint8(n,r.byteOffset-8),e}function appendUint8Array(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function parseSamples(n,e){const t=[],r=e.samples,s=e.timescale,a=e.id;let i=!1;return findBox(r,["moof"]).map(u=>{const l=u.byteOffset-8;findBox(u,["traf"]).map(d=>{const f=findBox(d,["tfdt"]).map(g=>{const m=g[0];let v=readUint32(g,4);return m===1&&(v*=Math.pow(2,32),v+=readUint32(g,8)),v/s})[0];return f!==void 0&&(n=f),findBox(d,["tfhd"]).map(g=>{const m=readUint32(g,4),v=readUint32(g,0)&16777215,y=(v&1)!==0,E=(v&2)!==0,_=(v&8)!==0;let T=0;const S=(v&16)!==0;let x=0;const b=(v&32)!==0;let A=8;m===a&&(y&&(A+=8),E&&(A+=4),_&&(T=readUint32(g,A),A+=4),S&&(x=readUint32(g,A),A+=4),b&&(A+=4),e.type==="video"&&(i=isHEVC(e.codec)),findBox(d,["trun"]).map(R=>{const C=R[0],w=readUint32(R,0)&16777215,I=(w&1)!==0;let L=0;const D=(w&4)!==0,O=(w&256)!==0;let N=0;const F=(w&512)!==0;let H=0;const j=(w&1024)!==0,q=(w&2048)!==0;let Q=0;const U=readUint32(R,4);let $=8;I&&(L=readUint32(R,$),$+=4),D&&($+=4);let K=L+l;for(let G=0;G<U;G++){if(O?(N=readUint32(R,$),$+=4):N=T,F?(H=readUint32(R,$),$+=4):H=x,j&&($+=4),q&&(C===0?Q=readUint32(R,$):Q=readSint32(R,$),$+=4),e.type===ElementaryStreamTypes.VIDEO){let ae=0;for(;ae<H;){const W=readUint32(r,K);if(K+=4,isSEIMessage(i,r[K])){const B=r.subarray(K,K+W);parseSEIMessageFromNALu(B,i?2:1,n+Q/s,t)}K+=W,ae+=W+4}}n+=N/s}}))})})}),t}function isHEVC(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function isSEIMessage(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function parseSEIMessageFromNALu(n,e,t,r){const s=discardEPB(n);let a=0;a+=e;let i=0,o=0,u=!1,l=0;for(;a<s.length;){i=0;do{if(a>=s.length)break;l=s[a++],i+=l}while(l===255);o=0;do{if(a>=s.length)break;l=s[a++],o+=l}while(l===255);const c=s.length-a;if(!u&&i===4&&a<s.length){if(u=!0,s[a++]===181){const f=readUint16(s,a);if(a+=2,f===49){const g=readUint32(s,a);if(a+=4,g===1195456820){const m=s[a++];if(m===3){const v=s[a++],y=31&v,E=64&v,_=E?2+y*3:0,T=new Uint8Array(_);if(E){T[0]=v;for(let S=1;S<_;S++)T[S]=s[a++]}r.push({type:m,payloadType:i,pts:t,bytes:T})}}}}}else if(i===5&&o<c){if(u=!0,o>16){const d=[];for(let m=0;m<16;m++){const v=s[a++].toString(16);d.push(v.length==1?"0"+v:v),(m===3||m===5||m===7||m===9)&&d.push("-")}const f=o-16,g=new Uint8Array(f);for(let m=0;m<f;m++)g[m]=s[a++];r.push({payloadType:i,pts:t,uuid:d.join(""),userData:utf8ArrayToStr(g),userDataBytes:g})}}else if(o<c)a+=o;else if(o>c)break}}function discardEPB(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,a=new Uint8Array(s);let i=0;for(r=0;r<s;i++,r++)i===t[0]&&(i++,t.shift()),a[r]=n[i];return a}function parseEmsg(n){const e=n[0];let t="",r="",s=0,a=0,i=0,o=0,u=0,l=0;if(e===0){for(;bin2str(n.subarray(l,l+1))!=="\0";)t+=bin2str(n.subarray(l,l+1)),l+=1;for(t+=bin2str(n.subarray(l,l+1)),l+=1;bin2str(n.subarray(l,l+1))!=="\0";)r+=bin2str(n.subarray(l,l+1)),l+=1;r+=bin2str(n.subarray(l,l+1)),l+=1,s=readUint32(n,12),a=readUint32(n,16),o=readUint32(n,20),u=readUint32(n,24),l=28}else if(e===1){l+=4,s=readUint32(n,l),l+=4;const d=readUint32(n,l);l+=4;const f=readUint32(n,l);for(l+=4,i=2**32*d+f,Number.isSafeInteger(i)||(i=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=readUint32(n,l),l+=4,u=readUint32(n,l),l+=4;bin2str(n.subarray(l,l+1))!=="\0";)t+=bin2str(n.subarray(l,l+1)),l+=1;for(t+=bin2str(n.subarray(l,l+1)),l+=1;bin2str(n.subarray(l,l+1))!=="\0";)r+=bin2str(n.subarray(l,l+1)),l+=1;r+=bin2str(n.subarray(l,l+1)),l+=1}const c=n.subarray(l,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:i,presentationTimeDelta:a,eventDuration:o,id:u,payload:c}}function mp4Box(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(n,4),s=0,r=8;s<t;s++)a.set(e[s],r),r+=e[s].byteLength;return a}function mp4pssh(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;if(e){r=1,s=new Uint8Array(e.length*16);for(let o=0;o<e.length;o++){const u=e[o];if(u.byteLength!==16)throw new RangeError("Invalid key");s.set(u,o*16)}}else r=0,s=new Uint8Array;let a;r>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const i=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(i.buffer).setUint32(0,t.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([r,0,0,0]),n,a,s,i,t||new Uint8Array)}function parsePssh(n){if(!(n instanceof ArrayBuffer)||n.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(n),r=t.getUint32(0);if(n.byteLength!==r&&r>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=Hex.hexDump(new Uint8Array(n,12,16));const a=t.getUint32(28);if(e.version===0){if(r-32<a)return null;e.data=new Uint8Array(n,32,a)}else if(e.version===1){e.kids=[];for(let i=0;i<a;i++)e.kids.push(new Uint8Array(n,32+i*16,16))}return e}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}constructor(e,t,r,s=[1],a=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=createInitializationVector(e);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=convertDataUriToArrayBytes(this.uri);if(t)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case KeySystemFormats.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(r,null,t);const s=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),a=String.fromCharCode.apply(null,Array.from(s)),i=a.substring(a.indexOf("<"),a.length),l=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(l){const c=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(c){const d=base64Decode(c).subarray(0,16);changeEndianness(d),this.keyId=d}}break}default:{let r=t.subarray(0,16);if(r.length!==16){const s=new Uint8Array(16);s.set(r,16-r.length),r=s}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=keyUriToKeyIdMap[this.uri];if(!r){const s=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,s),keyUriToKeyIdMap[this.uri]=r}this.keyId=r}return this}}function createInitializationVector(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(n){return VARIABLE_REPLACEMENT_REGEX.test(n)}function substituteVariablesInAttributes(n,e,t){if(n.variableList!==null||n.hasVariableRefs)for(let r=t.length;r--;){const s=t[r],a=e[s];a&&(e[s]=substituteVariables(n,a))}}function substituteVariables(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(VARIABLE_REPLACEMENT_REGEX,r=>{const s=r.substring(2,r.length-1),a=t==null?void 0:t[s];return a===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):a})}return e}function addVariableDefinition(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,a;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const i=new self.URL(t).searchParams;if(i.has(s))a=i.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(i){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${i.message}`))}}else s=e.NAME,a=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=a||""}function importVariableDefinition(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}function getMediaSource(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const sampleEntryCodesISO={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},MediaSource$2=getMediaSource();function isCodecType(n,e){const t=sampleEntryCodesISO[e];return!!t&&t[n.slice(0,4)]===!0}function isCodecSupportedInMp4(n,e){var t;return(t=MediaSource$2==null?void 0:MediaSource$2.isTypeSupported(`${e||"video"}/mp4;codecs="${n}"`))!=null?t:!1}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let r=t.shift()+".";return r+=parseInt(t.shift()).toString(16),r+=("000"+parseInt(t.shift()).toString(16)).slice(-4),r}return e}static resolve(e,t){return urlToolkitExports.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return IS_MEDIA_PLAYLIST.test(e)}static parseMasterPlaylist(e,t){const r=hasVariableReferences(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},a=[];MASTER_PLAYLIST_REGEX.lastIndex=0;let i;for(;(i=MASTER_PLAYLIST_REGEX.exec(e))!=null;)if(i[1]){var o;const l=new AttrList(i[1]);substituteVariablesInAttributes(s,l,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=substituteVariables(s,i[2]),d={attrs:l,bitrate:l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),name:l.NAME,url:M3U8Parser.resolve(c,t)},f=l.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),setCodecs((l.CODECS||"").split(/[ ,]+/).filter(g=>g),d),d.videoCodec&&d.videoCodec.indexOf("avc1")!==-1&&(d.videoCodec=M3U8Parser.convertAVC1ToAVCOTI(d.videoCodec)),(o=d.unknownCodecs)!=null&&o.length||a.push(d),s.levels.push(d)}else if(i[3]){const l=i[3],c=i[4];switch(l){case"SESSION-DATA":{const d=new AttrList(c);substituteVariablesInAttributes(s,d,["DATA-ID","LANGUAGE","VALUE","URI"]);const f=d["DATA-ID"];f&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[f]=d);break}case"SESSION-KEY":{const d=parseKey(c,t,s);d.encrypted&&d.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(d)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const d=new AttrList(c);substituteVariablesInAttributes(s,d,["NAME","VALUE","QUERYPARAM"]),addVariableDefinition(s,d,t)}break}case"CONTENT-STEERING":{const d=new AttrList(c);substituteVariablesInAttributes(s,d,["SERVER-URI","PATHWAY-ID"]),s.contentSteering={uri:M3U8Parser.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=parseStartTimeOffset(c);break}}}const u=a.length>0&&a.length<s.levels.length;return s.levels=u?a:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const a={},i=r.levels,o={AUDIO:i.map(l=>({id:l.attrs.AUDIO,audioCodec:l.audioCodec})),SUBTITLES:i.map(l=>({id:l.attrs.SUBTITLES,textCodec:l.textCodec})),"CLOSED-CAPTIONS":[]};let u=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(s=MASTER_PLAYLIST_MEDIA_REGEX.exec(e))!==null;){const l=new AttrList(s[1]),c=l.TYPE;if(c){const d=o[c],f=a[c]||[];a[c]=f,substituteVariablesInAttributes(r,l,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const g={attrs:l,bitrate:0,id:u++,groupId:l["GROUP-ID"]||"",instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE||"",type:c,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:l.LANGUAGE,url:l.URI?M3U8Parser.resolve(l.URI,t):""};if(d!=null&&d.length){const m=M3U8Parser.findGroup(d,g.groupId)||d[0];assignCodec(g,m,"audioCodec"),assignCodec(g,m,"textCodec")}f.push(g)}}return a}static parseLevelPlaylist(e,t,r,s,a,i){const o=new LevelDetails(t),u=o.fragments;let l=null,c=0,d=0,f=0,g=0,m=null,v=new Fragment(s,t),y,E,_,T=-1,S=!1;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,o.m3u8=e,o.hasVariableRefs=hasVariableReferences(e);(y=LEVEL_PLAYLIST_REGEX_FAST.exec(e))!==null;){S&&(S=!1,v=new Fragment(s,t),v.start=f,v.sn=c,v.cc=g,v.level=r,l&&(v.initSegment=l,v.rawProgramDateTime=l.rawProgramDateTime,l.rawProgramDateTime=null));const R=y[1];if(R){v.duration=parseFloat(R);const C=(" "+y[2]).slice(1);v.title=C||null,v.tagList.push(C?["INF",R,C]:["INF",R])}else if(y[3]){if(isFiniteNumber(v.duration)){v.start=f,_&&setFragLevelKeys(v,_,o),v.sn=c,v.level=r,v.cc=g,v.urlId=a,u.push(v);const C=(" "+y[3]).slice(1);v.relurl=substituteVariables(o,C),assignProgramDateTime(v,m),m=v,f+=v.duration,c++,d=0,S=!0}}else if(y[4]){const C=(" "+y[4]).slice(1);m?v.setByteRange(C,m):v.setByteRange(C)}else if(y[5])v.rawProgramDateTime=(" "+y[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]),T===-1&&(T=u.length);else{if(y=y[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!y){logger.warn("No matches on slow regex match for level playlist!");continue}for(E=1;E<y.length&&!(typeof y[E]<"u");E++);const C=(" "+y[E]).slice(1),w=(" "+y[E+1]).slice(1),I=y[E+2]?(" "+y[E+2]).slice(1):"";switch(C){case"PLAYLIST-TYPE":o.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":c=o.startSN=parseInt(w);break;case"SKIP":{const L=new AttrList(w);substituteVariablesInAttributes(o,L,["RECENTLY-REMOVED-DATERANGES"]);const D=L.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(D)){o.skippedSegments=D;for(let N=D;N--;)u.unshift(null);c+=D}const O=L.enumeratedString("RECENTLY-REMOVED-DATERANGES");O&&(o.recentlyRemovedDateranges=O.split("	"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(w),1);break;case"VERSION":o.version=parseInt(w);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(w||I)&&v.tagList.push(I?[w,I]:[w]);break;case"DISCONTINUITY":g++,v.tagList.push(["DIS"]);break;case"GAP":v.gap=!0,v.tagList.push([C]);break;case"BITRATE":v.tagList.push([C,w]);break;case"DATERANGE":{const L=new AttrList(w);substituteVariablesInAttributes(o,L,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),substituteVariablesInAttributes(o,L,L.clientAttrs);const D=new DateRange(L,o.dateRanges[L.ID]);D.isValid||o.skippedSegments?o.dateRanges[D.id]=D:logger.warn(`Ignoring invalid DATERANGE tag: "${w}"`),v.tagList.push(["EXT-X-DATERANGE",w]);break}case"DEFINE":{{const L=new AttrList(w);substituteVariablesInAttributes(o,L,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in L?importVariableDefinition(o,L,i):addVariableDefinition(o,L,t)}break}case"DISCONTINUITY-SEQUENCE":g=parseInt(w);break;case"KEY":{const L=parseKey(w,t,o);if(L.isSupported()){if(L.method==="NONE"){_=void 0;break}_||(_={}),_[L.keyFormat]&&(_=_extends({},_)),_[L.keyFormat]=L}else logger.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${w}"`);break}case"START":o.startTimeOffset=parseStartTimeOffset(w);break;case"MAP":{const L=new AttrList(w);if(substituteVariablesInAttributes(o,L,["BYTERANGE","URI"]),v.duration){const D=new Fragment(s,t);setInitSegment(D,L,r,_),l=D,v.initSegment=l,l.rawProgramDateTime&&!v.rawProgramDateTime&&(v.rawProgramDateTime=l.rawProgramDateTime)}else setInitSegment(v,L,r,_),l=v,S=!0;break}case"SERVER-CONTROL":{const L=new AttrList(w);o.canBlockReload=L.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=L.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&L.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=L.optionalFloat("PART-HOLD-BACK",0),o.holdBack=L.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const L=new AttrList(w);o.partTarget=L.decimalFloatingPoint("PART-TARGET");break}case"PART":{let L=o.partList;L||(L=o.partList=[]);const D=d>0?L[L.length-1]:void 0,O=d++,N=new AttrList(w);substituteVariablesInAttributes(o,N,["BYTERANGE","URI"]);const F=new Part(N,v,t,O,D);L.push(F),v.duration+=F.duration;break}case"PRELOAD-HINT":{const L=new AttrList(w);substituteVariablesInAttributes(o,L,["URI"]),o.preloadHint=L;break}case"RENDITION-REPORT":{const L=new AttrList(w);substituteVariablesInAttributes(o,L,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(L);break}default:logger.warn(`line parsed but not handled: ${y}`);break}}}m&&!m.relurl?(u.pop(),f-=m.duration,o.partList&&(o.fragmentHint=m)):o.partList&&(assignProgramDateTime(v,m),v.cc=g,o.fragmentHint=v,_&&setFragLevelKeys(v,_,o));const x=u.length,b=u[0],A=u[x-1];if(f+=o.skippedSegments*o.targetduration,f>0&&x&&A){o.averagetargetduration=f/x;const R=A.sn;o.endSN=R!=="initSegment"?R:0,o.live||(A.endList=!0),b&&(o.startCC=b.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(f+=o.fragmentHint.duration),o.totalduration=f,o.endCC=g,T>0&&backfillProgramDateTimes(u,T),o}}function parseKey(n,e,t){var r,s;const a=new AttrList(n);substituteVariablesInAttributes(t,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const i=(r=a.METHOD)!=null?r:"",o=a.URI,u=a.hexadecimalInteger("IV"),l=a.KEYFORMATVERSIONS,c=(s=a.KEYFORMAT)!=null?s:"identity";o&&a.IV&&!u&&logger.error(`Invalid IV: ${a.IV}`);const d=o?M3U8Parser.resolve(o,e):"",f=(l||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(i,d,c,f,u)}function parseStartTimeOffset(n){const t=new AttrList(n).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(t)?t:null}function setCodecs(n,e){["video","audio","text"].forEach(t=>{const r=n.filter(s=>isCodecType(s,t));if(r.length){const s=r.filter(a=>a.lastIndexOf("avc1",0)===0||a.lastIndexOf("mp4a",0)===0);e[`${t}Codec`]=s.length>0?s[0]:r[0],n=n.filter(a=>r.indexOf(a)===-1)}}),e.unknownCodecs=n}function assignCodec(n,e,t){const r=e[t];r&&(n[t]=r)}function backfillProgramDateTimes(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function assignProgramDateTime(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),isFiniteNumber(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function setInitSegment(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function setFragLevelKeys(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function mapContextToLevelType(n){const{type:e}=n;switch(e){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class PlaylistLoader{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,a=r||s,i=new a(t);return this.loaders[e.type]=i,i}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:r,deliveryDirectives:null})}onLevelLoading(e,t){const{id:r,level:s,url:a,deliveryDirectives:i}=t;this.load({id:r,level:s,responseType:"text",type:PlaylistContextType.LEVEL,url:a,deliveryDirectives:i})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:a,deliveryDirectives:i}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:a,deliveryDirectives:i})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:a,deliveryDirectives:i}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:a,deliveryDirectives:i})}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const l=s.context;if(l&&l.url===e.url){logger.trace("[playlist-loader]: playlist request ongoing");return}logger.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let a;if(e.type===PlaylistContextType.MANIFEST?a=r.manifestLoadPolicy.default:a=_extends({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let l;if(e.type===PlaylistContextType.LEVEL&&e.level!==null?l=this.hls.levels[e.level].details:e.type===PlaylistContextType.AUDIO_TRACK&&e.id!==null?l=this.hls.audioTracks[e.id].details:e.type===PlaylistContextType.SUBTITLE_TRACK&&e.id!==null&&(l=this.hls.subtitleTracks[e.id].details),l){const c=l.partTarget,d=l.targetduration;if(c&&d){const f=Math.max(c*3,d*.8)*1e3;a=_extends({},a,{maxTimeToFirstByteMs:Math.min(f,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,a.maxTimeToFirstByteMs)})}}}const i=a.errorRetry||a.timeoutRetry||{},o={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:i.maxNumRetry||0,retryDelay:i.retryDelayMs||0,maxRetryDelay:i.maxRetryDelayMs||0},u={onSuccess:(l,c,d,f)=>{const g=this.getInternalLoader(d);this.resetInternalLoader(d.type);const m=l.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(l,d,new Error("no EXTM3U delimiter"),f||null,c);return}c.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(m)?this.handleTrackOrLevelPlaylist(l,c,d,f||null,g):this.handleMasterPlaylist(l,c,d,f)},onError:(l,c,d,f)=>{this.handleNetworkError(c,d,!1,l,f)},onTimeout:(l,c,d)=>{this.handleNetworkError(c,d,!0,void 0,l)}};s.load(e,o,u)}handleMasterPlaylist(e,t,r,s){const a=this.hls,i=e.data,o=getResponseUrl(e,r),u=M3U8Parser.parseMasterPlaylist(i,o);if(u.playlistParsingError){this.handleManifestParsingError(e,r,u.playlistParsingError,s,t);return}const{contentSteering:l,levels:c,sessionData:d,sessionKeys:f,startTimeOffset:g,variableList:m}=u;this.variableList=m;const{AUDIO:v=[],SUBTITLES:y,"CLOSED-CAPTIONS":E}=M3U8Parser.parseMasterPlaylistMedia(i,o,u);v.length&&!v.some(T=>!T.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),a.trigger(Events.MANIFEST_LOADED,{levels:c,audioTracks:v,subtitles:y,captions:E,contentSteering:l,url:o,stats:t,networkDetails:s,sessionData:d,sessionKeys:f,startTimeOffset:g,variableList:m})}handleTrackOrLevelPlaylist(e,t,r,s,a){const i=this.hls,{id:o,level:u,type:l}=r,c=getResponseUrl(e,r),d=isFiniteNumber(o)?o:0,f=isFiniteNumber(u)?u:d,g=mapContextToLevelType(r),m=M3U8Parser.parseLevelPlaylist(e.data,c,f,g,d,this.variableList);if(l===PlaylistContextType.MANIFEST){const v={attrs:new AttrList({}),bitrate:0,details:m,name:"",url:c};i.trigger(Events.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:c,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=m,this.handlePlaylistLoaded(m,e,t,r,s,a)}handleManifestParsingError(e,t,r,s,a){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===PlaylistContextType.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:a})}handleNetworkError(e,t,r=!1,s,a){let i=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===PlaylistContextType.LEVEL?i+=`: ${e.level} id: ${e.id}`:(e.type===PlaylistContextType.AUDIO_TRACK||e.type===PlaylistContextType.SUBTITLE_TRACK)&&(i+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(i);logger.warn(`[playlist-loader]: ${i}`);let u=ErrorDetails.UNKNOWN,l=!1;const c=this.getInternalLoader(e);switch(e.type){case PlaylistContextType.MANIFEST:u=r?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,l=!0;break;case PlaylistContextType.LEVEL:u=r?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,l=!1;break;case PlaylistContextType.AUDIO_TRACK:u=r?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case PlaylistContextType.SUBTITLE_TRACK:u=r?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,l=!1;break}c&&this.resetInternalLoader(e.type);const d={type:ErrorTypes.NETWORK_ERROR,details:u,fatal:l,url:e.url,loader:c,context:e,error:o,networkDetails:t,stats:a};if(s){const f=(t==null?void 0:t.url)||e.url;d.response=_objectSpread2({url:f,data:void 0},s)}this.hls.trigger(Events.ERROR,d)}handlePlaylistLoaded(e,t,r,s,a,i){const o=this.hls,{type:u,level:l,id:c,groupId:d,deliveryDirectives:f}=s,g=getResponseUrl(t,s),m=mapContextToLevelType(s),v=typeof s.level=="number"&&m===PlaylistLevelType.MAIN?l:void 0;if(!e.fragments.length){const E=new Error("No Segments found in Playlist");o.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:E,reason:E.message,response:t,context:s,level:v,parent:m,networkDetails:a,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const y=e.playlistParsingError;if(y){o.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:y,reason:y.message,response:t,context:s,level:v,parent:m,networkDetails:a,stats:r});return}switch(e.live&&i&&(i.getCacheAge&&(e.ageHeader=i.getCacheAge()||0),(!i.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),u){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:o.trigger(Events.LEVEL_LOADED,{details:e,level:v||0,id:c||0,stats:r,networkDetails:a,deliveryDirectives:f});break;case PlaylistContextType.AUDIO_TRACK:o.trigger(Events.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:r,networkDetails:a,deliveryDirectives:f});break;case PlaylistContextType.SUBTITLE_TRACK:o.trigger(Events.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:r,networkDetails:a,deliveryDirectives:f});break}}}function sendAddTrackEvent(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function addCueToTrack(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){logger.debug(`[texttrack-utils]: ${r}`);const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}t==="disabled"&&(n.mode=t)}function clearCurrentCues(n){const e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);e==="disabled"&&(n.mode=e)}function removeCuesInRange(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const a=getCuesInRange(n.cues,e,t);for(let i=0;i<a.length;i++)(!r||r(a[i]))&&n.removeCue(a[i])}s==="disabled"&&(n.mode=s)}function getFirstCueIndexAfterTime(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t;for(;r<=s;){const a=Math.floor((s+r)/2);if(e<n[a].startTime)s=a-1;else if(e>n[a].startTime&&r<t)r=a+1;else return a}return n[r].startTime-e<e-n[s].startTime?r:s}function getCuesInRange(n,e,t){const r=[],s=getFirstCueIndexAfterTime(n,e);if(s>-1)for(let a=s,i=n.length;a<i;a++){const o=n[a];if(o.startTime>=e&&o.endTime<=t)r.push(o);else if(o.startTime>t)return r}return r}var MetadataSchema={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const MAX_CUE_ENDTIME=(()=>{const n=getCueClass();try{new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function dateRangeDateToTimelineSeconds(n,e){return n.getTime()/1e3-e}function hexToArrayBuffer(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ID3TrackController{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(clearCurrentCues(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:s}}}=this;if(!r&&!s)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const i=getCueClass();for(let o=0;o<a.length;o++){const u=a[o].type;if(u===MetadataSchema.emsg&&!r||!s)continue;const l=getID3Frames(a[o].data);if(l){const c=a[o].pts;let d=c+a[o].duration;d>MAX_CUE_ENDTIME&&(d=MAX_CUE_ENDTIME),d-c<=0&&(d=c+MIN_CUE_DURATION);for(let g=0;g<l.length;g++){const m=l[g];if(!isTimeStampFrame(m)){this.updateId3CueEnds(c);const v=new i(c,d,"");v.value=m,u&&(v.type=u),this.id3Track.addCue(v)}}}}}updateId3CueEnds(e){var t;const r=(t=this.id3Track)==null?void 0:t.cues;if(r)for(let s=r.length;s--;){const a=r[s];a.startTime<e&&a.endTime===MAX_CUE_ENDTIME&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:a,hls:i}=this;if(!i)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:u}}=i;if(a&&(o||u)){let l;s==="audio"?l=c=>c.type===MetadataSchema.audioId3&&u:s==="video"?l=c=>c.type===MetadataSchema.emsg&&o:l=c=>c.type===MetadataSchema.audioId3&&u||c.type===MetadataSchema.emsg&&o,removeCuesInRange(a,t,r,l)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:r,id3Track:s}=this,{dateRanges:a}=t,i=Object.keys(a);if(s){const c=Object.keys(r).filter(d=>!i.includes(d));for(let d=c.length;d--;){const f=c[d];Object.keys(r[f].cues).forEach(g=>{s.removeCue(r[f].cues[g])}),delete r[f]}}const o=t.fragments[t.fragments.length-1];if(i.length===0||!isFiniteNumber(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=o.programDateTime/1e3-o.start,l=getCueClass();for(let c=0;c<i.length;c++){const d=i[c],f=a[d],g=r[d],m=(g==null?void 0:g.cues)||{};let v=(g==null?void 0:g.durationKnown)||!1;const y=dateRangeDateToTimelineSeconds(f.startDate,u);let E=MAX_CUE_ENDTIME;const _=f.endDate;if(_)E=dateRangeDateToTimelineSeconds(_,u),v=!0;else if(f.endOnNext&&!v){const S=i.reduce((x,b)=>{const A=a[b];return A.class===f.class&&A.id!==b&&A.startDate>f.startDate&&x.push(A),x},[]).sort((x,b)=>x.startDate.getTime()-b.startDate.getTime())[0];S&&(E=dateRangeDateToTimelineSeconds(S.startDate,u),v=!0)}const T=Object.keys(f.attr);for(let S=0;S<T.length;S++){const x=T[S];if(!isDateRangeCueAttribute(x))continue;let b=m[x];if(b)v&&!g.durationKnown&&(b.endTime=E);else{let A=f.attr[x];b=new l(y,E,""),isSCTE35Attribute(x)&&(A=hexToArrayBuffer(A)),b.value={key:x,data:A},b.type=MetadataSchema.dateRange,b.id=d,this.id3Track.addCue(b),m[x]=b}}r[d]={cues:m,dateRange:f,durationKnown:v}}}}class LatencyController{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:a,liveSyncDurationCount:i,lowLatencyMode:o}=this.config,u=this.hls.userConfig;let l=o&&r||t;(u.liveSyncDuration||u.liveSyncDurationCount||l===0)&&(l=a!==void 0?a:i*s);const c=s,d=1;return l+Math.min(this.stallCount*d,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(e===null||t===null||r===null)return null;const s=r.edge,a=e-t-this.edgeStalled,i=s-r.totalduration,o=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(i,a),o)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Events.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var r;t.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,(r=this.levelDetails)!=null&&r.live&&logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||a===1)return;const i=this.targetLatency;if(i===null)return;const o=r-i,u=Math.min(this.maxLatency,i+t.targetduration),l=o<u;if(t.live&&l&&o>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,a)),d=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(n,e){const{canSkipUntil:t,canSkipDateRanges:r,endSN:s}=n,a=e!==void 0?e-s:0;return t&&a<t?r?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Level{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function updateFromToPTS(n,e){const t=e.startPTS;if(isFiniteNumber(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&(s.duration=r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.start=n.start+(n.minEndPTS-n.start):e.start=n.start+n.duration:e.start=Math.max(n.start-e.duration,0)}function updateFragPTSDTS(n,e,t,r,s,a){r-t<=0&&(logger.warn("Fragment should have a positive duration",e),r=t+e.duration,a=s+e.duration);let o=t,u=r;const l=e.startPTS,c=e.endPTS;if(isFiniteNumber(l)){const y=Math.abs(l-t);isFiniteNumber(e.deltaPTS)?e.deltaPTS=Math.max(y,e.deltaPTS):e.deltaPTS=y,o=Math.max(t,l),t=Math.min(t,l),s=Math.min(s,e.startDTS),u=Math.min(r,c),r=Math.max(r,c),a=Math.max(a,e.endDTS)}const d=t-e.start;e.start!==0&&(e.start=t),e.duration=r-e.start,e.startPTS=t,e.maxStartPTS=o,e.startDTS=s,e.endPTS=r,e.minEndPTS=u,e.endDTS=a;const f=e.sn;if(!n||f<n.startSN||f>n.endSN)return 0;let g;const m=f-n.startSN,v=n.fragments;for(v[m]=e,g=m;g>0;g--)updateFromToPTS(v[g],v[g-1]);for(g=m;g<v.length-1;g++)updateFromToPTS(v[g],v[g+1]);return n.fragmentHint&&updateFromToPTS(v[v.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,d}function mergeDetails(n,e){let t=null;const r=n.fragments;for(let u=r.length-1;u>=0;u--){const l=r[u].initSegment;if(l){t=l;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let s=0,a;if(mapFragmentIntersection(n,e,(u,l)=>{u.relurl&&(s=u.cc-l.cc),isFiniteNumber(u.startPTS)&&isFiniteNumber(u.endPTS)&&(l.start=l.startPTS=u.startPTS,l.startDTS=u.startDTS,l.maxStartPTS=u.maxStartPTS,l.endPTS=u.endPTS,l.endDTS=u.endDTS,l.minEndPTS=u.minEndPTS,l.duration=u.endPTS-u.startPTS,l.duration&&(a=l),e.PTSKnown=e.alignedSliding=!0),l.elementaryStreams=u.elementaryStreams,l.loader=u.loader,l.stats=u.stats,l.urlId=u.urlId,u.initSegment&&(l.initSegment=u.initSegment,t=u.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(l=>{var c;(!l.initSegment||l.initSegment.relurl===((c=t)==null?void 0:c.relurl))&&(l.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(u=>!u),e.deltaUpdateFailed){logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=mergeDateRanges(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const i=e.fragments;if(s){logger.warn("discontinuity sliding from playlist, take drift into account");for(let u=0;u<i.length;u++)i[u].cc+=s}e.skippedSegments&&(e.startCC=e.fragments[0].cc),mapPartIntersection(n.partList,e.partList,(u,l)=>{l.elementaryStreams=u.elementaryStreams,l.stats=u.stats}),a?updateFragPTSDTS(e,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):adjustSliding(n,e),i.length&&(e.totalduration=e.edge-i[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const u=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=u),e.driftEndTime=o,e.driftEnd=u}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}function mergeDateRanges(n,e,t){const r=_extends({},n);return t&&t.forEach(s=>{delete r[s]}),Object.keys(e).forEach(s=>{const a=new DateRange(e[s].attr,r[s]);a.isValid?r[s]=a:logger.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[s].attr)}"`)}),r}function mapPartIntersection(n,e,t){if(n&&e){let r=0;for(let s=0,a=n.length;s<=a;s++){const i=n[s],o=e[s+r];i&&o&&i.index===o.index&&i.fragment.sn===o.fragment.sn?t(i,o):r--}}}function mapFragmentIntersection(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,a=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,i=e.startSN-n.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let l=s;l<=a;l++){const c=u[i+l];let d=o[l];r&&!d&&l<r&&(d=e.fragments[l]=c),c&&d&&t(c,d)}}function adjustSliding(n,e){const t=e.startSN+e.skippedSegments-n.startSN,r=n.fragments;t<0||t>=r.length||addSliding(e,r[t].start)}function addSliding(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function computeReloadInterval(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments,s=4;if(r.length&&t*s>e){const a=r[r.length-1].duration*1e3;a<t&&(t=a)}}else t/=2;return Math.round(t)}function getFragmentWithSN(n,e,t){if(!(n!=null&&n.details))return null;const r=n.details;let s=r.fragments[e-r.startSN];return s||(s=r.fragmentHint,s&&s.sn===e)?s:e<r.startSN&&t&&t.sn===e?t:null}function getPartWith(n,e,t){var r;return n!=null&&n.details?findPart((r=n.details)==null?void 0:r.partList,e,t):null}function findPart(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function isTimeoutError(n){switch(n.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function getRetryConfig(n,e){const t=isTimeoutError(e);return n.default[`${t?"timeout":"error"}Retry`]}function getRetryDelay(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function getLoaderConfigWithoutReties(n){return _objectSpread2(_objectSpread2({},n),{errorRetry:null,timeoutRetry:null})}function shouldRetry(n,e,t,r){return!!n&&e<n.maxNumRetry&&(retryForHttpStatus(r)||!!t)}function retryForHttpStatus(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}const BinarySearch={search:function(n,e){let t=0,r=n.length-1,s=null,a=null;for(;t<=r;){s=(t+r)/2|0,a=n[s];const i=e(a);if(i>0)t=s+1;else if(i<0)r=s-1;else return a}return null}};function findFragmentByPDT(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!isFiniteNumber(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;t=t||0;for(let a=0;a<n.length;++a){const i=n[a];if(pdtWithinToleranceTest(e,t,i))return i}return null}function findFragmentByPTS(n,e,t=0,r=0){let s=null;if(n?s=e[n.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(s=e[0]),s&&fragmentWithinToleranceTest(t,r,s)===0)return s;const a=BinarySearch.search(e,fragmentWithinToleranceTest.bind(null,t,r));return a&&(a!==n||!s)?a:s}function fragmentWithinToleranceTest(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function pdtWithinToleranceTest(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function findFragWithCC(n,e){return BinarySearch.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}const RENDITION_PENALTY_DURATION_MS=3e5;var NetworkErrorAction={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class ErrorController{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=logger.log.bind(logger,"[info]:"),this.warn=logger.warn.bind(logger,"[warning]:"),this.error=logger.error.bind(logger,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.ERROR,this.onError,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.ERROR,this.onError,this),e.off(Events.ERROR,this.onErrorOut,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===PlaylistLevelType.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onError(e,t){var r;if(t.fatal)return;const s=this.hls,a=t.context;switch(t.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var i,o;const u=t.parent===PlaylistLevelType.MAIN?t.level:s.loadLevel;t.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((i=t.context)!=null&&(o=i.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const u=s.levels[s.loadLevel];if(u&&(a.type===PlaylistContextType.AUDIO_TRACK&&a.groupId===u.audioGroupId||a.type===PlaylistContextType.SUBTITLE_TRACK&&a.groupId===u.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,t.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],l=u==null?void 0:u.attrs["HDCP-LEVEL"];l&&(t.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP,hdcpLevel:l})}return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:t.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}if(t.type===ErrorTypes.KEY_SYSTEM_ERROR){const u=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u);return}}getPlaylistRetryOrSwitchAction(e,t){var r;const s=this.hls,a=getRetryConfig(s.config.playlistLoadPolicy,e),i=this.playlistError++,o=(r=e.response)==null?void 0:r.code;if(shouldRetry(a,i,isTimeoutError(e),o))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:a,retryCount:i};const l=this.getLevelSwitchAction(e,t);return a&&(l.retryConfig=a,l.retryCount=i),l}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:a,keyLoadPolicy:i}=t.config,o=getRetryConfig(e.details.startsWith("key")?i:a,e),u=t.levels.reduce((d,f)=>d+f.fragmentError,0);if(s){var l;e.details!==ErrorDetails.FRAG_GAP&&s.fragmentError++;const d=(l=e.response)==null?void 0:l.code;if(shouldRetry(o,u,isTimeoutError(e),d))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:o,retryCount:u}}const c=this.getLevelSwitchAction(e,r);return o&&(c.retryConfig=o,c.retryCount=u),c}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s&&(s.loadError++,r.autoLevelEnabled)){var a,i;let o=-1;const u=r.levels,l=(a=e.frag)==null?void 0:a.type,{type:c,groupId:d}=(i=e.context)!=null?i:{};for(let f=u.length;f--;){const g=(f+r.loadLevel)%u.length;if(g!==r.loadLevel&&u[g].loadError===0){const m=u[g];if(e.details===ErrorDetails.FRAG_GAP&&e.frag){const v=u[g].details;if(v){const y=findFragmentByPTS(e.frag,v.fragments,e.frag.start);if(y!=null&&y.gap)continue}}else{if(c===PlaylistContextType.AUDIO_TRACK&&d===m.audioGroupId||c===PlaylistContextType.SUBTITLE_TRACK&&d===m.textGroupId)continue;if(l===PlaylistLevelType.AUDIO&&s.audioGroupId===m.audioGroupId||l===PlaylistLevelType.SUBTITLE&&s.textGroupId===m.textGroupId)continue}o=g;break}}if(o>-1&&r.loadLevel!==o)return e.levelRetry=!0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:o}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==ErrorDetails.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s,hdcpLevel:a,nextAutoLevel:i}=r;switch(s){case ErrorActionFlags.None:this.switchLevel(e,i);break;case ErrorActionFlags.MoveAllAlternatesMatchingHost:r.resolved||(r.resolved=this.redundantFailover(e));break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:a&&(t.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(a)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,i)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:r}=this,s=e.parent===PlaylistLevelType.MAIN?e.level:t.loadLevel,a=t.levels[s],i=a.url.length,o=e.frag?e.frag.urlId:a.urlId;a.urlId===o&&(!e.frag||a.details)&&this.penalizeRendition(a,e);for(let u=1;u<i;u++){const l=(o+u)%i,c=r[l];if(!c||checkExpired(c,e,r[o]))return this.warn(`Switching to Redundant Stream ${l+1}/${i}: "${a.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(d=>{d.urlId=l}),t.nextLoadLevel=s,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:r}=this,s=r[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};s.lastErrorPerfMs=performance.now(),s.errors.push(t),s.details=e.details,r[e.urlId]=s}}function checkExpired(n,e,t){if(performance.now()-n.lastErrorPerfMs>RENDITION_PENALTY_DURATION_MS)return!0;const r=n.details;if(e.details===ErrorDetails.FRAG_GAP&&r&&e.frag){const s=e.frag.start,a=findFragmentByPTS(null,r.fragments,s);if(a&&!a.gap)return!0}if(t&&n.errors.length<t.errors.length){const s=n.errors[n.errors.length-1];if(r&&s.frag&&e.frag&&Math.abs(s.frag.start-e.frag.start)>r.targetduration*3)return!0}return!1}class BasePlaylistController{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=logger.log.bind(logger,`${t}:`),this.warn=logger.warn.bind(logger,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let a=0;a<r.length;a++){const i=r[a];let o;try{o=new self.URL(i.URI,t.url).href}catch(u){logger.warn(`Could not construct new URL for Rendition Report: ${u}`),o=i.URI||""}if(o===e){s=a;break}else o===e.substring(0,o.length)&&(s=a)}if(s!==-1){const a=r[s],i=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let o=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const u=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&u>t.partTarget&&(o+=1)}return new HlsUrlParameters(i,o>=0?o:void 0,HlsSkip.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,r){const{details:s,stats:a}=t,i=self.performance.now(),o=a.loading.first?Math.max(0,i-a.loading.first):0;if(s.advancedDateTime=Date.now()-o,s.live||r!=null&&r.live){if(s.reloaded(r),r&&this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:"MISSED"}`),r&&s.fragments.length>0&&mergeDetails(r,s),!this.canLoad||!s.live)return;let u,l,c;if(s.canBlockReload&&s.endSN&&s.advanced){const y=this.hls.config.lowLatencyMode,E=s.lastPartSn,_=s.endSN,T=s.lastPartIndex,S=T!==-1,x=E===_,b=y?0:T;S?(l=x?_+1:E,c=x?b:T+1):l=_+1;const A=s.age,R=A+s.ageHeader;let C=Math.min(R-s.partTarget,s.targetduration*1.5);if(C>0){if(r&&C>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${C} with playlist age: ${s.age}`),C=0;else{const w=Math.floor(C/s.targetduration);if(l+=w,c!==void 0){const I=Math.round(C%s.targetduration/s.partTarget);c+=I}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${A.toFixed(2)}s goal: ${C} skip sn ${w} to part ${c}`)}s.tuneInGoal=C}if(u=this.getDeliveryDirectives(s,t.deliveryDirectives,l,c),y||!x){this.loadPlaylist(u);return}}else s.canBlockReload&&(u=this.getDeliveryDirectives(s,t.deliveryDirectives,l,c));const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,g=(s.edge-f)*1e3,m=computeReloadInterval(s,g);s.updated&&i>this.requestScheduled+m&&(this.requestScheduled=a.loading.start),l!==void 0&&s.canBlockReload?this.requestScheduled=a.loading.first+m-(s.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+m<i?this.requestScheduled=i:this.requestScheduled-i<=0&&(this.requestScheduled+=m);let v=this.requestScheduled-i;v=Math.max(0,v),this.log(`reload live playlist ${e} in ${Math.round(v)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(u),v)}else this.clearTimer()}getDeliveryDirectives(e,t,r,s){let a=getSkipValue(e,r);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,a=HlsSkip.No),new HlsUrlParameters(r,s,a)}checkRetry(e){const t=e.details,r=isTimeoutError(e),s=e.errorAction,{action:a,retryCount:i=0,retryConfig:o}=s||{},u=!!s&&!!o&&(a===NetworkErrorAction.RetryRequest||!s.resolved&&a===NetworkErrorAction.SendAlternateToPenaltyBox);if(u){var l;if(this.requestScheduled=-1,r&&(l=e.context)!=null&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${i+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=getRetryDelay(o,i);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${i+1}/${o.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,s.resolved=!0}return u}}let chromeOrFirefox;class LevelController extends BasePlaylistController{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=[],s={};let a;t.levels.forEach(i=>{var o;const u=i.attrs;((o=i.audioCodec)==null?void 0:o.indexOf("mp4a.40.34"))!==-1&&(chromeOrFirefox||(chromeOrFirefox=/chrome|firefox/i.test(navigator.userAgent)),chromeOrFirefox&&(i.audioCodec=void 0));const{AUDIO:l,CODECS:c,"FRAME-RATE":d,"PATHWAY-ID":f,RESOLUTION:g,SUBTITLES:m}=u,y=`${`${f||"."}-`}${i.bitrate}-${g}-${d}-${c}`;a=s[y],a?a.addFallback(i):(a=new Level(i),s[y]=a,r.push(a)),addGroupId(a,"audio",l),addGroupId(a,"text",m)}),this.filterAndSortMediaOptions(r,t)}filterAndSortMediaOptions(e,t){let r=[],s=[],a=!1,i=!1,o=!1,u=e.filter(({audioCodec:g,videoCodec:m,width:v,height:y,unknownCodecs:E})=>(a||(a=!!(v&&y)),i||(i=!!m),o||(o=!!g),!(E!=null&&E.length)&&(!g||isCodecSupportedInMp4(g,"audio"))&&(!m||isCodecSupportedInMp4(m,"video"))));if((a||i)&&o&&(u=u.filter(({videoCodec:g,width:m,height:v})=>!!g||!!(m&&v))),u.length===0){Promise.resolve().then(()=>{if(this.hls){const g=new Error("no level with compatible codecs found in manifest");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:g,reason:g.message})}});return}t.audioTracks&&(r=t.audioTracks.filter(g=>!g.audioCodec||isCodecSupportedInMp4(g.audioCodec,"audio")),assignTrackIdsByGroup(r)),t.subtitles&&(s=t.subtitles,assignTrackIdsByGroup(s));const l=u.slice(0);u.sort((g,m)=>g.attrs["HDCP-LEVEL"]!==m.attrs["HDCP-LEVEL"]?(g.attrs["HDCP-LEVEL"]||"")>(m.attrs["HDCP-LEVEL"]||"")?1:-1:g.bitrate!==m.bitrate?g.bitrate-m.bitrate:g.attrs["FRAME-RATE"]!==m.attrs["FRAME-RATE"]?g.attrs.decimalFloatingPoint("FRAME-RATE")-m.attrs.decimalFloatingPoint("FRAME-RATE"):g.attrs.SCORE!==m.attrs.SCORE?g.attrs.decimalFloatingPoint("SCORE")-m.attrs.decimalFloatingPoint("SCORE"):a&&g.height!==m.height?g.height-m.height:0);let c=l[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==l.length)){for(let g=0;g<l.length;g++)if(l[g].pathwayId===u[0].pathwayId){c=l[g];break}}this._levels=u;for(let g=0;g<u.length;g++)if(u[g]===c){this._firstLevel=g,this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${c.bitrate}`);break}const d=o&&!i,f={levels:u,audioTracks:r,subtitleTracks:s,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:i,altAudio:!d&&r.some(g=>!!g.url)};this.hls.trigger(Events.MANIFEST_PARSED,f),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:c,reason:c.message}),d)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,a=s?s.attrs["PATHWAY-ID"]:void 0,i=t[e],o=i.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=i,r===e&&i.details&&s&&a===o)return;this.log(`Switching to level ${e}${o?" with Pathway "+o:""} from level ${r}${a?" with Pathway "+a:""}`);const u=_extends({},i,{level:e,maxBitrate:i.maxBitrate,attrs:i.attrs,uri:i.uri,urlId:i.urlId});delete u._attrs,delete u._urlId,this.hls.trigger(Events.LEVEL_SWITCHING,u);const l=i.details;if(!l||l.live){const c=this.switchParams(i.uri,s==null?void 0:s.details);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===PlaylistLevelType.MAIN){const r=this._levels[t.level];r!==void 0&&(r.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:a}=t,i=this._levels[s];if(!i){var o;this.warn(`Invalid level index ${s}`),(o=t.deliveryDirectives)!=null&&o.skip&&(a.deltaUpdateFailed=!0);return}s===this.currentLevelIndex?(i.fragmentError===0&&(i.loadError=0),this.playlistLoaded(s,t,i.details)):(r=t.deliveryDirectives)!=null&&r.skip&&(a.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const r=this.currentLevel;if(!r)return;const s=this.hls.audioTracks[t.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==s){let a=-1;for(let i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===s){a=i;break}a!==-1&&a!==r.urlId&&(r.urlId=a,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,r=this.currentLevel;if(r&&this.shouldLoadPlaylist(r)){const s=r.urlId;let a=r.uri;if(e)try{a=e.addDirectives(a)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const i=r.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${i?" Pathway "+i:""} URI ${s+1}/${r.url.length} ${a}`),this.clearTimer(),this.hls.trigger(Events.LEVEL_LOADING,{url:a,level:t,id:s,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const r=(a,i)=>i!==t,s=this._levels.filter((a,i)=>i!==e?!0:a.url.length>1&&t!==void 0?(a.url=a.url.filter(r),a.audioGroupIds&&(a.audioGroupIds=a.audioGroupIds.filter(r)),a.textGroupIds&&(a.textGroupIds=a.textGroupIds.filter(r)),a.urlId=0,!0):(this.steering&&this.steering.removeLevel(a),!1));this.hls.trigger(Events.LEVELS_UPDATED,{levels:s})}onLevelsUpdated(e,{levels:t}){t.forEach((r,s)=>{const{details:a}=r;a!=null&&a.fragments&&a.fragments.forEach(i=>{i.level=s})}),this._levels=t}}function addGroupId(n,e,t){t&&(e==="audio"?(n.audioGroupIds||(n.audioGroupIds=[]),n.audioGroupIds[n.url.length-1]=t):e==="text"&&(n.textGroupIds||(n.textGroupIds=[]),n.textGroupIds[n.url.length-1]=t))}function assignTrackIdsByGroup(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const a=r[s];if(!a)break;const i=a.end;if(a.start<=e&&i!==null&&e<=i)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:r}=this,s=Object.keys(r);for(let a=s.length;a--;){const i=r[s[a]];if((i==null?void 0:i.body.type)===t&&i.buffered){const o=i.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,t,r,s){this.timeRanges&&(this.timeRanges[e]=t);const a=(s==null?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const o=this.fragments[i];if(!o||a>=o.body.sn)return;if(!o.buffered&&!o.loaded){o.body.type===r&&this.removeFragment(o.body);return}const u=o.range[e];u&&u.time.some(l=>{const c=!this.isTimeBuffered(l.startPTS,l.endPTS,t);return c&&this.removeFragment(o.body),c})})}detectPartialFragments(e){const t=this.timeRanges,{frag:r,part:s}=e;if(!t||r.sn==="initSegment")return;const a=getFragmentKey(r),i=this.fragments[a];if(!i)return;const o=!r.relurl;Object.keys(t).forEach(u=>{const l=r.elementaryStreams[u];if(!l)return;const c=t[u],d=o||l.partial===!0;i.range[u]=this.getBufferedTimes(r,s,d,c)}),i.loaded=null,Object.keys(i.range).length?(i.buffered=!0,i.body.endList&&(this.endListFragments[i.body.type]=i),isPartial(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter(s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=getFragmentKey(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,r,s){const a={time:[],partial:r},i=e.start,o=e.end,u=e.minEndPTS||o,l=e.maxStartPTS||i;for(let c=0;c<s.length;c++){const d=s.start(c)-this.bufferPadding,f=s.end(c)+this.bufferPadding;if(l>=d&&u<=f){a.time.push({startPTS:Math.max(i,s.start(c)),endPTS:Math.min(o,s.end(c))});break}else if(i<f&&o>d)a.partial=!0,a.time.push({startPTS:Math.max(i,s.start(c)),endPTS:Math.min(o,s.end(c))});else if(o<=d)break}return a}getPartialFragment(e){let t=null,r,s,a,i=0;const{bufferPadding:o,fragments:u}=this;return Object.keys(u).forEach(l=>{const c=u[l];c&&isPartial(c)&&(s=c.body.start-o,a=c.body.end+o,e>=s&&e<=a&&(r=Math.min(e-s,a-e),i<=r&&(t=c.body,i=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||isPartial(t))}getState(e){const t=getFragmentKey(e),r=this.fragments[t];return r?r.buffered?isPartial(r)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(e,t,r){let s,a;for(let i=0;i<r.length;i++){if(s=r.start(i)-this.bufferPadding,a=r.end(i)+this.bufferPadding,e>=s&&t<=a)return!0;if(t<=s)return!1}return!1}onFragLoaded(e,t){const{frag:r,part:s}=t;if(r.sn==="initSegment"||r.bitrateTest)return;const a=s?null:t,i=getFragmentKey(r);this.fragments[i]={body:r,appendedPTS:null,loaded:a,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:a}=t;if(r.sn==="initSegment")return;const i=r.type;if(s){let o=this.activePartLists[i];o||(this.activePartLists[i]=o=[]),o.push(s)}this.timeRanges=a,Object.keys(a).forEach(o=>{const u=a[o];this.detectEvictedFragments(o,u,i,s)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=getFragmentKey(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,a){s&&!this.hasGaps||Object.keys(this.fragments).forEach(i=>{const o=this.fragments[i];if(!o)return;const u=o.body;u.type!==r||s&&!u.gap||u.start<t&&u.end>e&&(o.buffered||a)&&this.removeFragment(u)})}removeFragment(e){const t=getFragmentKey(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=r.filter(a=>a.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function isPartial(n){var e,t,r;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((r=n.range.audiovideo)==null?void 0:r.partial))}function getFragmentKey(n){return`${n.type}_${n.level}_${n.urlId}_${n.sn}`}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,a=s.fLoader,i=s.loader;return new Promise((o,u)=>{if(this.loader&&this.loader.destroy(),e.gap){u(createGapLoadError(e));return}const l=this.loader=e.loader=a?new a(s):new i(s),c=createLoaderContext(e),d=getLoaderConfigWithoutReties(s.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};e.stats=l.stats,l.load(c,f,{onSuccess:(g,m,v,y)=>{this.resetLoader(e,l);let E=g.data;v.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(E.slice(0,16)),E=E.slice(16)),o({frag:e,part:null,payload:E,networkDetails:y})},onError:(g,m,v,y)=>{this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:_objectSpread2({url:r,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:v,stats:y}))},onAbort:(g,m,v)=>{this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:v,stats:g}))},onTimeout:(g,m,v)=>{this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:v,stats:g}))},onProgress:(g,m,v,y)=>{t&&t({frag:e,part:null,payload:v,networkDetails:y})}})})}loadPart(e,t,r){this.abort();const s=this.config,a=s.fLoader,i=s.loader;return new Promise((o,u)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){u(createGapLoadError(e,t));return}const l=this.loader=e.loader=a?new a(s):new i(s),c=createLoaderContext(e,t),d=getLoaderConfigWithoutReties(s.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};t.stats=l.stats,l.load(c,f,{onSuccess:(g,m,v,y)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const E={frag:e,part:t,payload:g.data,networkDetails:y};r(E),o(E)},onError:(g,m,v,y)=>{this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:_objectSpread2({url:c.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:v,stats:y}))},onAbort:(g,m,v)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:v,stats:g}))},onTimeout:(g,m,v)=>{this.resetLoader(e,l),u(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:v,stats:g}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,a=s.total;if(r.loaded+=s.loaded,a){const u=Math.round(e.duration/t.duration),l=Math.min(Math.round(r.loaded/a),u),d=(u-l)*Math.round(r.loaded/l);r.total=r.loaded+d}else r.total=Math.max(r.loaded,r.total);const i=r.loading,o=s.loading;i.start?i.first+=o.first-o.start:(i.start=o.start,i.first=o.first),i.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function createLoaderContext(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(isFiniteNumber(s)&&isFiniteNumber(a)){var i;let o=s,u=a;if(n.sn==="initSegment"&&((i=n.decryptdata)==null?void 0:i.method)==="AES-128"){const l=a-s;l%16&&(u=a+(16-l%16)),s!==0&&(r.resetIV=!0,o=s-16)}r.rangeStart=o,r.rangeEnd=u}return r}function createGapLoadError(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new LoadError(r)}class LoadError extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class KeyLoader{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[t].loader;if(r){if(e&&e!==r.context.frag.type)return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=ErrorDetails.KEY_LOAD_ERROR,r,s,a){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:r,networkDetails:s})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:r,cc:s}=e;for(let a=0;a<t.length;a++){const i=t[a];if(s<=i.cc&&(r==="initSegment"||i.sn==="initSegment"||r<i.sn)){this.emeController.selectKeySystemFormat(i).then(o=>{i.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const l=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,l))}const i=a.uri;if(!i)return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${i}"`)));let o=this.keyUriToKeyInfo[i];if((r=o)!=null&&r.decryptdata.key)return a.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((s=o)!=null&&s.keyLoadPromise){var u;switch((u=o.mediaKeySessionContext)==null?void 0:u.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(l=>(a.key=l.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[i]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const s=this.emeController.loadKey(r);if(s)return(e.keyLoadPromise=s.then(a=>(e.mediaKeySessionContext=a,r))).catch(a=>{throw e.keyLoadPromise=null,a})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,a=new s(r);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((i,o)=>{const u={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=r.keyLoadPolicy.default,c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,g,m,v)=>{const{frag:y,keyInfo:E,url:_}=m;if(!y.decryptdata||E!==this.keyUriToKeyInfo[_])return o(this.createKeyLoadError(y,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),v));E.decryptdata.key=y.decryptdata.key=new Uint8Array(f.data),y.keyLoader=null,E.loader=null,i({frag:y,keyInfo:E})},onError:(f,g,m,v)=>{this.resetLoader(g),o(this.createKeyLoadError(t,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),m,_objectSpread2({url:u.url,data:void 0},f)))},onTimeout:(f,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(f,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};a.load(u,c,d)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,a=r.loader;t.keyLoader===a&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[s],a&&a.destroy()}}class TaskLoop{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(e,t){try{if(e){const r=BufferHelper.getBuffered(e);for(let s=0;s<r.length;s++)if(t>=r.start(s)&&t<=r.end(s))return!0}}catch{}return!1}static bufferInfo(e,t,r){try{if(e){const s=BufferHelper.getBuffered(e),a=[];let i;for(i=0;i<s.length;i++)a.push({start:s.start(i),end:s.end(i)});return this.bufferedInfo(a,t,r)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.sort(function(l,c){const d=l.start-c.start;return d||c.end-l.end});let s=[];if(r)for(let l=0;l<e.length;l++){const c=s.length;if(c){const d=s[c-1].end;e[l].start-d<r?e[l].end>d&&(s[c-1].end=e[l].end):s.push(e[l])}else s.push(e[l])}else s=e;let a=0,i,o=t,u=t;for(let l=0;l<s.length;l++){const c=s[l].start,d=s[l].end;if(t+r>=c&&t<d)o=c,u=d,a=u-t;else if(t+r<c){i=c;break}}return{len:a,start:o||0,end:u||0,nextStart:i}}static getBuffered(e){try{return e.buffered}catch(t){return logger.log("failed to get media.buffered",t),noopBuffered}}}class ChunkMetadata{constructor(e,t,r,s=0,a=-1,i=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=a,this.partial=i}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}function findFirstFragWithCC(n,e){let t=null;for(let r=0,s=n.length;r<s;r++){const a=n[r];if(a&&a.cc===e){t=a;break}}return t}function shouldAlignOnDiscontinuities(n,e,t){return!!(e.details&&(t.endCC>t.startCC||n&&n.cc<t.startCC))}function findDiscontinuousReferenceFrag(n,e,t=0){const r=n.fragments,s=e.fragments;if(!s.length||!r.length){logger.log("No fragments to align");return}const a=findFirstFragWithCC(r,s[0].cc);if(!a||a&&!a.startPTS){logger.log("No frag in previous level to align on");return}return a}function adjustFragmentStart(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function adjustSlidingStart(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)adjustFragmentStart(t[r],n);e.fragmentHint&&adjustFragmentStart(e.fragmentHint,n),e.alignedSliding=!0}function alignStream(n,e,t){e&&(alignDiscontinuities(n,t,e),!t.alignedSliding&&e.details&&alignPDT(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&adjustSliding(e.details,t))}function alignDiscontinuities(n,e,t){if(shouldAlignOnDiscontinuities(n,t,e)){const r=findDiscontinuousReferenceFrag(t.details,e);r&&isFiniteNumber(r.start)&&(logger.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),adjustSlidingStart(r.start,e))}}function alignPDT(n,e){if(!e.fragments.length||!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,r=n.fragments[0].programDateTime,s=(r-t)/1e3+e.fragments[0].start;s&&isFiniteNumber(s)&&(logger.log(`Adjusting PTS using programDateTime delta ${r-t}ms, sliding:${s.toFixed(3)} ${n.url} `),adjustSlidingStart(s,n))}function alignMediaPlaylistByPDT(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;const s=Math.round(r.length/2)-1,a=r[s],i=findFirstFragWithCC(t,a.cc)||t[Math.round(t.length/2)-1],o=a.programDateTime,u=i.programDateTime;if(o===null||u===null)return;const l=(u-o)/1e3-(i.start-a.start);adjustSlidingStart(l,n)}class AESCrypto{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class FastAESKey{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function removePadding(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?sliceUint8(n,0,e-t):n}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],a=r[1],i=r[2],o=r[3],u=this.invSubMix,l=u[0],c=u[1],d=u[2],f=u[3],g=new Uint32Array(256);let m=0,v=0,y=0;for(y=0;y<256;y++)y<128?g[y]=y<<1:g[y]=y<<1^283;for(y=0;y<256;y++){let E=v^v<<1^v<<2^v<<3^v<<4;E=E>>>8^E&255^99,e[m]=E,t[E]=m;const _=g[m],T=g[_],S=g[T];let x=g[E]*257^E*16843008;s[m]=x<<24|x>>>8,a[m]=x<<16|x>>>16,i[m]=x<<8|x>>>24,o[m]=x,x=S*16843009^T*65537^_*257^m*16843008,l[E]=x<<24|x>>>8,c[E]=x<<16|x>>>16,d[E]=x<<8|x>>>24,f[E]=x,m?(m=_^g[g[g[S^_]]],v^=g[g[v]]):m=v=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const i=this.ksRows=(a+6+1)*4;let o,u;const l=this.keySchedule=new Uint32Array(i),c=this.invKeySchedule=new Uint32Array(i),d=this.sBox,f=this.rcon,g=this.invSubMix,m=g[0],v=g[1],y=g[2],E=g[3];let _,T;for(o=0;o<i;o++){if(o<a){_=l[o]=t[o];continue}T=_,o%a===0?(T=T<<8|T>>>24,T=d[T>>>24]<<24|d[T>>>16&255]<<16|d[T>>>8&255]<<8|d[T&255],T^=f[o/a|0]<<24):a>6&&o%a===4&&(T=d[T>>>24]<<24|d[T>>>16&255]<<16|d[T>>>8&255]<<8|d[T&255]),l[o]=_=(l[o-a]^T)>>>0}for(u=0;u<i;u++)o=i-u,u&3?T=l[o]:T=l[o-4],u<4||o<=4?c[u]=T:c[u]=m[d[T>>>24]]^v[d[T>>>16&255]]^y[d[T>>>8&255]]^E[d[T&255]],c[u]=c[u]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,a=this.invKeySchedule,i=this.invSBox,o=this.invSubMix,u=o[0],l=o[1],c=o[2],d=o[3],f=this.uint8ArrayToUint32Array_(r);let g=f[0],m=f[1],v=f[2],y=f[3];const E=new Int32Array(e),_=new Int32Array(E.length);let T,S,x,b,A,R,C,w,I,L,D,O,N,F;const H=this.networkToHostOrderSwap;for(;t<E.length;){for(I=H(E[t]),L=H(E[t+1]),D=H(E[t+2]),O=H(E[t+3]),A=I^a[0],R=O^a[1],C=D^a[2],w=L^a[3],N=4,F=1;F<s;F++)T=u[A>>>24]^l[R>>16&255]^c[C>>8&255]^d[w&255]^a[N],S=u[R>>>24]^l[C>>16&255]^c[w>>8&255]^d[A&255]^a[N+1],x=u[C>>>24]^l[w>>16&255]^c[A>>8&255]^d[R&255]^a[N+2],b=u[w>>>24]^l[A>>16&255]^c[R>>8&255]^d[C&255]^a[N+3],A=T,R=S,C=x,w=b,N=N+4;T=i[A>>>24]<<24^i[R>>16&255]<<16^i[C>>8&255]<<8^i[w&255]^a[N],S=i[R>>>24]<<24^i[C>>16&255]<<16^i[w>>8&255]<<8^i[A&255]^a[N+1],x=i[C>>>24]<<24^i[w>>16&255]<<16^i[A>>8&255]<<8^i[R&255]^a[N+2],b=i[w>>>24]<<24^i[A>>16&255]<<16^i[R>>8&255]<<8^i[C&255]^a[N+3],_[t]=H(T^g),_[t+1]=H(b^m),_[t+2]=H(x^v),_[t+3]=H(S^y),g=I,m=L,v=D,y=O,t=t+4}return _.buffer}}const CHUNK_SIZE=16;class Decrypter{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?removePadding(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r){return this.useSoftware?new Promise((s,a)=>{this.softwareDecrypt(new Uint8Array(e),t,r);const i=this.flush();i?s(i.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r)}softwareDecrypt(e,t,r){const{currentIV:s,currentResult:a,remainderData:i}=this;this.logOnce("JS AES decrypt"),i&&(e=appendUint8Array(i,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;s&&(r=s);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new AESDecryptor),u.expandKey(t);const l=a;return this.currentResult=u.decrypt(o.buffer,0,r),this.currentIV=sliceUint8(o,-16).buffer,l||null}webCryptoDecrypt(e,t,r){const s=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new FastAESKey(s,t)),this.fastAesKey.expandKey().then(a=>s?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(s,new Uint8Array(r)).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,r)))}onWebCryptoError(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);const s=this.flush();if(s)return s.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%CHUNK_SIZE;return r!==e.length&&(t=sliceUint8(e,0,r),this.remainderData=sliceUint8(e,r)),t}logOnce(e){this.logEnabled&&(logger.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const TimeRanges={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(e,t,r,s,a){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=a,this.logPrefix=s,this.log=logger.log.bind(logger,`${s}:`),this.warn=logger.warn.bind(logger,`${s}:`),this.hls=e,this.fragmentLoader=new FragmentLoader(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Decrypter(e.config),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const r=t.partList;if(r!=null&&r.length){const a=r[r.length-1];return BufferHelper.isBuffered(this.media,a.start+a.duration/2)}const s=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(s)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);const s=this.config;this.levels&&s.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:r,mediaBuffer:s,state:a}=this,i=r?r.currentTime:0,o=BufferHelper.bufferInfo(s||r,i,e.maxBufferHole);if(this.log(`media seeking to ${isFiniteNumber(i)?i.toFixed(3):i}, state: ${a}`),this.state===State.ENDED)this.resetLoadingState();else if(t){const u=e.maxFragLookUpTolerance,l=t.start-u,c=t.start+t.duration+u;if(!o.len||c<o.start||l>o.end){const d=i>c;(i<l||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(i,1/0,this.playlistType,!0),this.lastCurrentTime=i),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=i),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=a=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${a.part?" p: "+a.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,r,s).then(a=>{if(!a)return;const i=this.state;if(this.fragContextChanged(e)){(i===State.FRAG_LOADING||!this.fragCurrent&&i===State.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=State.IDLE);return}"payload"in a&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(Events.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(a),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===FragmentState.APPENDING){const a=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,a),o=Math.max(e.duration,i?i.len:this.config.maxBufferLength);this.reduceMaxBufferLength(o)&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===FragmentState.PARTIAL&&r.removeFragment(e))}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(Events.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{if(!r||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{payload:a}=r,i=e.decryptdata;if(a&&a.byteLength>0&&i&&i.key&&i.iv&&i.method==="AES-128"){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),i.key.buffer,i.iv.buffer).catch(u=>{throw s.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:e}),u}).then(u=>{const l=self.performance.now();return s.trigger(Events.FRAG_DECRYPTED,{frag:e,payload:u,stats:{tstart:o,tdecrypt:l}}),r.payload=u,r})}return r}).then(r=>{const{fragCurrent:s,hls:a,levels:i}=this;if(!i)throw new Error("init load aborted, missing levels");const o=e.stats;this.state=State.IDLE,t.fragmentError=0,e.data=new Uint8Array(r.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),r.frag===s&&a.trigger(Events.FRAG_BUFFERED,{stats:o,frag:s,part:null,id:e.type}),this.tick()}).catch(r=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var r,s,a,i;const o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===PlaylistLevelType.MAIN?"level":"track"} ${e.level} (frag:[${((r=e.startPTS)!=null?r:NaN).toFixed(3)}-${((s=e.endPTS)!=null?s:NaN).toFixed(3)}] > buffer:${o?TimeRanges.toString(BufferHelper.getBuffered(o)):"(detached)"})`),this.state=State.IDLE,o&&(!this.loadedmetadata&&e.type==PlaylistLevelType.MAIN&&o.buffered.length&&((a=this.fragCurrent)==null?void 0:a.sn)===((i=this.fragPrevious)==null?void 0:i.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:a}=e,i=!a||a.length===0||a.some(u=>!u),o=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!i);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var a;const i=t==null?void 0:t.details;if(!this.levels||!i)throw new Error(`frag load aborted, missing level${i?"":" detail"}s`);let o=null;if(e.encrypted&&!((a=e.decryptdata)!=null&&a.key)?(this.log(`Loading key for ${e.sn} of [${i.startSN}-${i.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=State.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(Events.KEY_LOADED,c),this.state===State.KEY_LOADING&&(this.state=State.IDLE),c}),this.hls.trigger(Events.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&i.encryptedFragments.length&&this.keyLoader.loadClear(e,i.encryptedFragments),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=i.partList;if(c&&s){r>e.end&&i.fragmentHint&&(e=i.fragmentHint);const d=this.getNextPart(c,e,r);if(d>-1){const f=c[d];this.log(`Loading part sn: ${e.sn} p: ${f.index} cc: ${e.cc} of playlist [${i.startSN}-${i.endSN}] parts [0-${d}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=f.start+f.duration,this.state=State.FRAG_LOADING;let g;return o?g=o.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(e,f,t,s)).catch(m=>this.handleFragLoadError(m)):g=this.doFragPartsLoad(e,f,t,s).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,part:f,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}else if(!e.url||this.loadedEndOfParts(c,r))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${i?"of ["+i.startSN+"-"+i.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),isFiniteNumber(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=State.FRAG_LOADING;const u=this.config.progressive;let l;return u&&o?l=o.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,s)).catch(c=>this.handleFragLoadError(c)):l=Promise.all([this.fragmentLoader.load(e,u?s:void 0),o]).then(([c])=>(!u&&c&&s&&s(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,r,s){return new Promise((a,i)=>{var o;const u=[],l=(o=r.details)==null?void 0:o.partList,c=d=>{this.fragmentLoader.loadPart(e,d,s).then(f=>{u[d.index]=f;const g=f.part;this.hls.trigger(Events.FRAG_LOADED,f);const m=getPartWith(r,e.sn,d.index+1)||findPart(l,e.sn,d.index+1);if(m)c(m);else return a({frag:e,part:g,partsLoaded:u})}).catch(i)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(Events.ERROR,t)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:r,part:s,level:a}=t,i=self.performance.now();r.stats.parsing.end=i,s&&(s.stats.parsing.end=i),this.updateLevelTiming(r,s,a,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:a,part:i}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${a} of level ${s}. The current chunk will not be buffered.`),null;const o=t[s],u=i>-1?getPartWith(o,a,i):null,l=u?u.fragment:getFragmentWithSN(o,a,r);return l?(r&&r!==l&&(l.stats=r.stats),{frag:l,part:u,level:o}):null}bufferFragmentData(e,t,r,s){var a;if(!e||this.state!==State.PARSING)return;const{data1:i,data2:o}=e;let u=i;if(i&&o&&(u=appendUint8Array(i,o)),!((a=u)!=null&&a.length))return;const l={type:e.type,frag:t,part:r,chunkMeta:s,parent:t.type,data:u};this.hls.trigger(Events.BUFFER_APPENDING,l),e.dropped&&e.independent&&!r&&this.flushBufferGap(t)}flushBufferGap(e){const t=this.media;if(!t)return;if(!BufferHelper.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=BufferHelper.bufferInfo(t,r,0),a=e.duration,i=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),o=Math.max(Math.min(e.start-i,s.end-i),r+i);e.start-o>i&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const r=this.getLoadPosition();return isFiniteNumber(r)?this.getFwdBufferInfoAtPos(e,r,t):null}getFwdBufferInfoAtPos(e,t,r){const{config:{maxBufferHole:s}}=this,a=BufferHelper.bufferInfo(e,t,s);if(a.len===0&&a.nextStart!==void 0){const i=this.fragmentTracker.getBufferedFrag(t,r);if(i&&a.nextStart<i.end)return BufferHelper.bufferInfo(e,t,Math.max(a.nextStart,s))}return a}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=PlaylistLevelType.MAIN){const r=this.fragmentTracker.getAppendedFrag(e,PlaylistLevelType.MAIN);return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:a}=this,i=r[0].start;let o;if(t.live){const u=a.initialLiveManifestSize;if(s<u)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${u})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(o=this.getInitialLiveFragment(t,r),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=i&&(o=r[0]);if(!o){const u=a.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,u,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===FragmentState.OK||r===FragmentState.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,a){const i=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,i&&e&&!e.gap&&r.nextStart){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s);if(u!==null&&r.len+u.len>=a)return this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,a=!1,i=!0;for(let o=0,u=e.length;o<u;o++){const l=e[o];if(i=i&&!l.independent,s>-1&&r<l.start)break;const c=l.loaded;c?s=-1:(a||l.independent||i)&&l.fragment===t&&(s=o),a=c}return s}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e,t){const r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=findFragmentByPDT(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const a=r.sn+1;if(a>=e.startSN&&a<=e.endSN){const i=t[a-e.startSN];r.cc===i.cc&&(s=i,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=findFragWithCC(t,r.cc),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(s=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:a}=this,{fragments:i,endSN:o}=r;const{fragmentHint:u}=r,l=s.maxFragLookUpTolerance,c=r.partList,d=!!(s.lowLatencyMode&&c!=null&&c.length&&u);d&&u&&!this.bitrateTest&&(i=i.concat(u),o=u.sn);let f;if(e<t){const g=e>t-l?0:l;f=findFragmentByPTS(a,i,e,g)}else f=i[i.length-1];if(f){const g=f.sn-r.startSN,m=this.fragmentTracker.getState(f);if((m===FragmentState.OK||m===FragmentState.PARTIAL&&f.gap)&&(a=f),a&&f.sn===a.sn&&(!d||c[0].fragment.sn>f.sn)&&a&&f.level===a.level){const y=i[g+1];f.sn<o&&this.fragmentTracker.getState(y)!==FragmentState.OK?f=y:f=null}}return f}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,a=r.currentTime,i=e.fragments[0].start,o=e.edge,u=a>=i-t.maxFragLookUpTolerance&&a<=o;if(s!==null&&r.duration>s&&(a<s||!u)){const l=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!u&&r.readyState<4||a<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=s),r.readyState&&(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${s.toFixed(3)}`),r.currentTime=s))}}alignPlaylists(e,t){const{levels:r,levelLastLoaded:s,fragPrevious:a}=this,i=s!==null?r[s]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const u=e.fragments[0].start,l=!t,c=e.alignedSliding&&isFiniteNumber(u);if(l||!c&&!u){alignStream(a,i,e);const d=e.fragments[0].start;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${a?a.sn:"na"} fragments: ${o}`),d}return u}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;if(r<t&&(r=-1),r===-1||this.lastCurrentTime===-1){const s=this.startTimeOffset!==null,a=s?this.startTimeOffset:e.startTimeOffset;a!==null&&isFiniteNumber(a)?(r=t+a,a<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Start time offset ${a} found in ${s?"multivariant":"media"} playlist, adjust startPosition to ${r}`),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const c=this.getCurrentContext(t.chunkMeta);c&&(t.frag=c.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var s;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}const a=t.details===ErrorDetails.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(r,!0);const i=t.errorAction,{action:o,retryCount:u=0,retryConfig:l}=i||{};if(i&&o===NetworkErrorAction.RetryRequest&&l){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);const c=getRetryDelay(l,u);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${u+1}/${l.maxNumRetry} in ${c}ms`),i.resolved=!0,this.retryDate=self.performance.now()+c,this.state=State.FRAG_LOADING_WAITING_RETRY}else l&&i?(this.resetFragmentErrors(e),u<l.maxNumRetry?a||(i.resolved=!0):logger.warn(`${t.details} reached or exceeded max retry (${u})`)):this.state=State.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===State.PARSING||this.state===State.PARSED){const t=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,t),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=State.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){var a;const i=r.details;if(!i){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((u,l)=>{const c=e.elementaryStreams[l];if(c){const d=c.endPTS-c.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${l} duration reliably (${d})`),u||!1;const f=s?0:updateFragPTSDTS(i,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:i,level:r,drift:f,type:l,frag:e,start:c.startPTS,end:c.endPTS}),!0}return u},!1))r.fragmentError=0;else if(((a=this.transmuxer)==null?void 0:a.error)===null){const u=new Error(`Found no media in fragment ${e.sn} of level ${r.id} resetting transmuxer to fallback to playlist timing`);if(this.warn(u.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:`Found no media in msn ${e.sn} of level "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=State.PARSED,this.hls.trigger(Events.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.resetTransmuxer(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isSupported(){const n=getMediaSource();if(!n)return!1;const e=getSourceBuffer(),t=n&&typeof n.isTypeSupported=="function"&&n.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!r}function changeTypeSupported(){var n;const e=getSourceBuffer();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}function loadWorker(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function dummyTrack(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=appendUint8Array(this.cachedData,e),this.cachedData=null);let r=getID3Data(e,0),s=r?r.length:0,a;const i=this._audioTrack,o=this._id3Track,u=r?getTimeStamp(r):void 0,l=e.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(u))&&(this.basePTS=initPTSFn(u,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});s<l;){if(this.canParse(e,s)){const c=this.appendFrame(i,e,s);c?(this.frameIndex++,this.lastPTS=c.sample.pts,s+=c.length,a=s):s=l}else canParse$2(e,s)?(r=getID3Data(e,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,a=s):s++;if(s===l&&a!==l){const c=sliceUint8(e,a);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,c):this.cachedData=c}}return{audioTrack:i,videoTrack:dummyTrack(),id3Track:o,textTrack:dummyTrack()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){}}const initPTSFn=(n,e,t)=>{if(isFiniteNumber(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};function getAudioConfig(n,e,t,r){let s,a,i,o;const u=navigator.userAgent.toLowerCase(),l=r,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((e[t+2]&192)>>>6)+1;const d=(e[t+2]&60)>>>2;if(d>c.length-1){n.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${d}`});return}return i=(e[t+2]&1)<<2,i|=(e[t+3]&192)>>>6,logger.log(`manifest codec:${r}, ADTS type:${s}, samplingIndex:${d}`),/firefox/i.test(u)?d>=6?(s=5,o=new Array(4),a=d-3):(s=2,o=new Array(2),a=d):u.indexOf("android")!==-1?(s=2,o=new Array(2),a=d):(s=5,o=new Array(4),r&&(r.indexOf("mp4a.40.29")!==-1||r.indexOf("mp4a.40.5")!==-1)||!r&&d>=6?a=d-3:((r&&r.indexOf("mp4a.40.2")!==-1&&(d>=6&&i===1||/vivaldi/i.test(u))||!r&&i===1)&&(s=2,o=new Array(2)),a=d)),o[0]=s<<3,o[0]|=(d&14)>>1,o[1]|=(d&1)<<7,o[1]|=i<<3,s===5&&(o[1]|=(a&14)>>1,o[2]=(a&1)<<7,o[2]|=2<<2,o[3]=0),{config:o,samplerate:c[d],channelCount:i,codec:"mp4a.40."+s,manifestCodec:l}}function isHeaderPattern$1(n,e){return n[e]===255&&(n[e+1]&246)===240}function getHeaderLength(n,e){return n[e+1]&1?7:9}function getFullFrameLength(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function canGetFrameLength(n,e){return e+5<n.length}function isHeader$1(n,e){return e+1<n.length&&isHeaderPattern$1(n,e)}function canParse$1(n,e){return canGetFrameLength(n,e)&&isHeaderPattern$1(n,e)&&getFullFrameLength(n,e)<=n.length-e}function probe$1(n,e){if(isHeader$1(n,e)){const t=getHeaderLength(n,e);if(e+t>=n.length)return!1;const r=getFullFrameLength(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||isHeader$1(n,s)}return!1}function initTrackConfig(n,e,t,r,s){if(!n.samplerate){const a=getAudioConfig(e,t,r,s);if(!a)return;n.config=a.config,n.samplerate=a.samplerate,n.channelCount=a.channelCount,n.codec=a.codec,n.manifestCodec=a.manifestCodec,logger.log(`parsed codec:${n.codec}, rate:${a.samplerate}, channels:${a.channelCount}`)}}function getFrameDuration(n){return 1024*9e4/n}function parseFrameHeader(n,e){const t=getHeaderLength(n,e);if(e+t<=n.length){const r=getFullFrameLength(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function appendFrame$1(n,e,t,r,s){const a=getFrameDuration(n.samplerate),i=r+s*a,o=parseFrameHeader(e,t);let u;if(o){const{frameLength:d,headerLength:f}=o,g=f+d,m=Math.max(0,t+g-e.length);m?(u=new Uint8Array(g-f),u.set(e.subarray(t+f,e.length),0)):u=e.subarray(t+f,t+g);const v={unit:u,pts:i};return m||n.samples.push(v),{sample:v,length:g,missing:m}}const l=e.length-t;return u=new Uint8Array(l),u.set(e.subarray(t,e.length),0),{sample:{unit:u,pts:i},length:l,missing:-1}}class AACDemuxer extends BaseAudioDemuxer{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let r=(getID3Data(e,0)||[]).length;for(let s=e.length;r<s;r++)if(probe$1(e,r))return logger.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return canParse$1(e,t)}appendFrame(e,t,r){initTrackConfig(e,this.observer,t,r,e.manifestCodec);const s=appendFrame$1(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const a=this.videoTrack=dummyTrack("video",1),i=this.audioTrack=dummyTrack("audio",1),o=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const u=parseInitSegment(e);if(u.video){const{id:l,timescale:c,codec:d}=u.video;a.id=l,a.timescale=o.timescale=c,a.codec=d}if(u.audio){const{id:l,timescale:c,codec:d}=u.audio;i.id=l,i.timescale=c,i.codec=d}o.id=RemuxerTrackIdConfig.text,a.sampleDuration=0,a.duration=i.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,findBox(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=appendUint8Array(this.remainderData,e));const o=segmentValidRange(r);this.remainderData=o.remainder,s.samples=o.valid||new Uint8Array}else s.samples=r;const i=this.extractID3Track(s,t);return a.samples=parseSamples(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:i,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=parseSamples(e,t),{videoTrack:t,audioTrack:dummyTrack(),id3Track:s,textTrack:dummyTrack()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=findBox(e.samples,["emsg"]);s&&s.forEach(a=>{const i=parseEmsg(a);if(emsgSchemePattern.test(i.schemeIdUri)){const o=isFiniteNumber(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale;let u=i.eventDuration===4294967295?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);const l=i.payload;r.samples.push({data:l,len:l.byteLength,dts:o,pts:o,type:MetadataSchema.emsg,duration:u})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame(n,e,t,r,s){if(t+24>e.length)return;const a=parseHeader(e,t);if(a&&t+a.frameLength<=e.length){const i=a.samplesPerFrame*9e4/a.sampleRate,o=r+s*i,u={unit:e.subarray(t,t+a.frameLength),pts:o,dts:o};return n.config=[],n.channelCount=a.channelCount,n.samplerate=a.sampleRate,n.samples.push(u),{sample:u,length:a.frameLength,missing:0}}}function parseHeader(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,a=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&a!==3){const i=n[e+2]>>1&1,o=n[e+3]>>6,u=t===3?3-r:r===3?3:4,l=BitratesMap[u*14+s-1]*1e3,d=SamplingRateMap[(t===3?0:t===2?1:2)*3+a],f=o===3?1:2,g=SamplesCoefficients[t][r],m=BytesInSlot[r],v=g*8*m,y=Math.floor(g*l/d+i)*m;if(chromeVersion$1===null){const T=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=T?parseInt(T[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&r===2&&l>=224e3&&o===0&&(n[e+3]=n[e+3]|128),{sampleRate:d,channelCount:f,frameLength:y,samplesPerFrame:v}}}function isHeaderPattern(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function isHeader(n,e){return e+1<n.length&&isHeaderPattern(n,e)}function canParse(n,e){return isHeaderPattern(n,e)&&4<=n.length-e}function probe(n,e){if(e+1<n.length&&isHeaderPattern(n,e)){const r=parseHeader(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const a=e+s;return a===n.length||isHeader(n,a)}return!1}class ExpGolomb{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");s.set(e.subarray(r,r+a)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,r=8,s;for(let a=0;a<e;a++)r!==0&&(s=this.readEG(),r=(t+s+256)%256),t=r===0?t:r}readSPS(){let e=0,t=0,r=0,s=0,a,i,o;const u=this.readUByte.bind(this),l=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),f=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);u();const y=u();if(l(5),f(3),u(),m(),y===100||y===110||y===122||y===244||y===44||y===83||y===86||y===118||y===128){const b=c();if(b===3&&f(1),m(),m(),f(1),d())for(i=b!==3?8:12,o=0;o<i;o++)d()&&(o<6?v(16):v(64))}m();const E=c();if(E===0)c();else if(E===1)for(f(1),g(),g(),a=c(),o=0;o<a;o++)g();m(),f(1);const _=c(),T=c(),S=l(1);S===0&&f(1),f(1),d()&&(e=c(),t=c(),r=c(),s=c());let x=[1,1];if(d()&&d())switch(u()){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:{x=[u()<<8|u(),u()<<8|u()];break}}return{width:Math.ceil((_+1)*16-e*2-t*2),height:(2-S)*(T+1)*16-(S?2:4)*(r+s),pixelRatio:x}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class SampleAesDecrypter{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Decrypter(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const a=s.subarray(16,s.length-s.length%16),i=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(i).then(o=>{const u=new Uint8Array(o);s.set(u,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let a=32;a<e.length-16;a+=160,s+=16)r.set(e.subarray(a,a+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let a=32;a<e.length-16;a+=160,s+=16)e.set(r.subarray(s,s+16),a);return e}decryptAvcSample(e,t,r,s,a){const i=discardEPB(a.data),o=this.getAvcEncryptedData(i);this.decryptBuffer(o.buffer).then(u=>{a.data=this.getAvcDecryptedUnit(i,u),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)})}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const a=e[t].units;for(;!(r>=a.length);r++){const i=a[r];if(!(i.data.length<=48||i.type!==1&&i.type!==5)&&(this.decryptAvcSample(e,t,r,s,i),!this.decrypter.isSync()))return}}}}const PACKET_LENGTH=188;class TSDemuxer{constructor(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=r}static probe(e){const t=TSDemuxer.syncOffset(e);return t>0&&logger.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length,r=Math.min(PACKET_LENGTH*5,e.length-PACKET_LENGTH)+1;let s=0;for(;s<r;){let a=!1;for(let i=s;i<t&&e[i]===71;i+=PACKET_LENGTH)if(!a&&parsePID(e,i)===0&&(a=!0),a&&i+PACKET_LENGTH>r)return s;s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",s),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r,this._duration=s}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let a;const i=this._avcTrack,o=this._audioTrack,u=this._id3Track,l=this._txtTrack;let c=i.pid,d=i.pesData,f=o.pid,g=u.pid,m=o.pesData,v=u.pesData,y=null,E=this.pmtParsed,_=this._pmtId,T=e.length;if(this.remainderData&&(e=appendUint8Array(this.remainderData,e),T=e.length,this.remainderData=null),T<PACKET_LENGTH&&!s)return this.remainderData=e,{audioTrack:o,videoTrack:i,id3Track:u,textTrack:l};const S=Math.max(0,TSDemuxer.syncOffset(e));T-=(T-S)%PACKET_LENGTH,T<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,T,e.buffer.byteLength-T));let x=0;for(let A=S;A<T;A+=PACKET_LENGTH)if(e[A]===71){const R=!!(e[A+1]&64),C=parsePID(e,A),w=(e[A+3]&48)>>4;let I;if(w>1){if(I=A+5+e[A+4],I===A+PACKET_LENGTH)continue}else I=A+4;switch(C){case c:R&&(d&&(a=parsePES(d))&&this.parseAVCPES(i,l,a,!1),d={data:[],size:0}),d&&(d.data.push(e.subarray(I,A+PACKET_LENGTH)),d.size+=A+PACKET_LENGTH-I);break;case f:if(R){if(m&&(a=parsePES(m)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,a);break;case"mp3":this.parseMPEGPES(o,a);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(I,A+PACKET_LENGTH)),m.size+=A+PACKET_LENGTH-I);break;case g:R&&(v&&(a=parsePES(v))&&this.parseID3PES(u,a),v={data:[],size:0}),v&&(v.data.push(e.subarray(I,A+PACKET_LENGTH)),v.size+=A+PACKET_LENGTH-I);break;case 0:R&&(I+=e[I]+1),_=this._pmtId=parsePAT(e,I);break;case _:{R&&(I+=e[I]+1);const L=parsePMT(e,I,this.typeSupported,r);c=L.avc,c>0&&(i.pid=c),f=L.audio,f>0&&(o.pid=f,o.segmentCodec=L.segmentCodec),g=L.id3,g>0&&(u.pid=g),y!==null&&!E&&(logger.warn(`MPEG-TS PMT found at ${A} after unknown PID '${y}'. Backtracking to sync byte @${S} to parse all TS packets.`),y=null,A=S-188),E=this.pmtParsed=!0;break}case 17:case 8191:break;default:y=C;break}}else x++;if(x>0){const A=new Error(`Found ${x} TS packet/s that do not start with 0x47`);this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:A,reason:A.message})}i.pesData=d,o.pesData=m,u.pesData=v;const b={audioTrack:o,videoTrack:i,id3Track:u,textTrack:l};return s&&this.extractRemainingSamples(b),b}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:a}=e,i=r.pesData,o=t.pesData,u=s.pesData;let l;if(i&&(l=parsePES(i))?(this.parseAVCPES(r,a,l,!0),r.pesData=null):r.pesData=i,o&&(l=parsePES(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break}t.pesData=null}else o!=null&&o.size&&logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;u&&(l=parsePES(u))?(this.parseID3PES(s,l),s.pesData=null):s.pesData=u}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,t);return this.decrypt(s,a)}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:a}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{r(e)}):r(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{r(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,r,s){const a=this.parseAVCNALu(e,r.data);let i=this.avcSample,o,u=!1;r.data=null,i&&a.length&&!e.audFound&&(pushAccessUnit(i,e),i=this.avcSample=createAVCSample(!1,r.pts,r.dts,"")),a.forEach(l=>{switch(l.type){case 1:{o=!0,i||(i=this.avcSample=createAVCSample(!0,r.pts,r.dts,"")),i.frame=!0;const c=l.data;if(u&&c.length>4){const d=new ExpGolomb(c).readSliceType();(d===2||d===4||d===7||d===9)&&(i.key=!0)}break}case 5:o=!0,i||(i=this.avcSample=createAVCSample(!0,r.pts,r.dts,"")),i.key=!0,i.frame=!0;break;case 6:{o=!0,parseSEIMessageFromNALu(l.data,1,r.pts,t.samples);break}case 7:if(o=!0,u=!0,!e.sps){const c=l.data,f=new ExpGolomb(c).readSPS();e.width=f.width,e.height=f.height,e.pixelRatio=f.pixelRatio,e.sps=[c],e.duration=this._duration;const g=c.subarray(1,4);let m="avc1.";for(let v=0;v<3;v++){let y=g[v].toString(16);y.length<2&&(y="0"+y),m+=y}e.codec=m}break;case 8:o=!0,e.pps||(e.pps=[l.data]);break;case 9:o=!1,e.audFound=!0,i&&pushAccessUnit(i,e),i=this.avcSample=createAVCSample(!1,r.pts,r.dts,"");break;case 12:o=!0;break;default:o=!1,i&&(i.debug+="unknown NAL "+l.type+" ");break}i&&o&&i.units.push(l)}),s&&i&&(pushAccessUnit(i,e),this.avcSample=null)}getLastNalUnit(e){var t;let r=this.avcSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const a=r.units;s=a[a.length-1]}return s}parseAVCNALu(e,t){const r=t.byteLength;let s=e.naluState||0;const a=s,i=[];let o=0,u,l,c,d=-1,f=0;for(s===-1&&(d=0,f=t[0]&31,s=0,o=1);o<r;){if(u=t[o++],!s){s=u?0:1;continue}if(s===1){s=u?0:2;continue}if(!u)s=3;else if(u===1){if(d>=0){const g={data:t.subarray(d,o-s-1),type:f};i.push(g)}else{const g=this.getLastNalUnit(e.samples);if(g&&(a&&o<=4-a&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-a)),l=o-s-1,l>0)){const m=new Uint8Array(g.data.byteLength+l);m.set(g.data,0),m.set(t.subarray(0,l),g.data.byteLength),g.data=m,g.state=0}}o<r?(c=t[o]&31,d=o,f=c,s=0):s=-1}else s=0}if(d>=0&&s>=0){const g={data:t.subarray(d,r),type:f,state:s};i.push(g)}if(i.length===0){const g=this.getLastNalUnit(e.samples);if(g){const m=new Uint8Array(g.data.byteLength+t.byteLength);m.set(g.data,0),m.set(t,g.data.byteLength),g.data=m}}return e.naluState=s,i}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let a=t.data;if(s){this.aacOverFlow=null;const d=s.missing,f=s.sample.unit.byteLength;if(d===-1){const g=new Uint8Array(f+a.byteLength);g.set(s.sample.unit,0),g.set(a,f),a=g}else{const g=f-d;s.sample.unit.set(a.subarray(0,d),g),e.samples.push(s.sample),r=s.missing}}let i,o;for(i=r,o=a.length;i<o-1&&!isHeader$1(a,i);i++);if(i!==r){let d;const f=i<o-1;f?d=`AAC PES did not start with ADTS header,offset:${i}`:d="No ADTS header found in AAC PES";const g=new Error(d);if(logger.warn(`parsing error: ${d}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:f,error:g,reason:d}),!f)return}initTrackConfig(e,this.observer,a,i,this.audioCodec);let u;if(t.pts!==void 0)u=t.pts;else if(s){const d=getFrameDuration(e.samplerate);u=s.sample.pts+d}else{logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let l=0,c;for(;i<o;)if(c=appendFrame$1(e,a,i,u,l),i+=c.length,c.missing){this.aacOverFlow=c;break}else for(l++;i<o-1&&!isHeader$1(a,i);i++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let a=0,i=0;const o=t.pts;if(o===void 0){logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;i<s;)if(isHeader(r,i)){const u=appendFrame(e,r,i,o,a);if(u)i+=u.length,a++;else break}else i++}parseID3PES(e,t){if(t.pts===void 0){logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=_extends({},t,{type:this._avcTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function createAVCSample(n,e,t,r){return{key:n,frame:!1,pts:e,dts:t,units:[],debug:r,length:0}}function parsePID(n,e){return((n[e+1]&31)<<8)+n[e+2]}function parsePAT(n,e){return(n[e+10]&31)<<8|n[e+11]}function parsePMT(n,e,t,r){const s={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},a=(n[e+1]&15)<<8|n[e+2],i=e+3+a-4,o=(n[e+10]&15)<<8|n[e+11];for(e+=12+o;e<i;){const u=parsePID(n,e);switch(n[e]){case 207:if(!r){logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:s.audio===-1&&(s.audio=u);break;case 21:s.id3===-1&&(s.id3=u);break;case 219:if(!r){logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:s.avc===-1&&(s.avc=u);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?logger.log("MPEG audio found, not supported in this browser"):s.audio===-1&&(s.audio=u,s.segmentCodec="mp3");break;case 36:logger.warn("Unsupported HEVC stream type found");break}e+=((n[e+3]&15)<<8|n[e+4])+5}return s}function parsePES(n){let e=0,t,r,s,a,i;const o=n.data;if(!n||n.size===0)return null;for(;o[0].length<19&&o.length>1;){const l=new Uint8Array(o[0].length+o[1].length);l.set(o[0]),l.set(o[1],o[0].length),o[0]=l,o.splice(1,1)}if(t=o[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(r=(t[4]<<8)+t[5],r&&r>n.size-6)return null;const l=t[7];l&192&&(a=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,l&64?(i=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,a-i>60*9e4&&(logger.warn(`${Math.round((a-i)/9e4)}s delta between PTS and DTS, align them`),a=i)):i=a),s=t[8];let c=s+9;if(n.size<=c)return null;n.size-=c;const d=new Uint8Array(n.size);for(let f=0,g=o.length;f<g;f++){t=o[f];let m=t.byteLength;if(c)if(c>m){c-=m;continue}else t=t.subarray(c),m-=c,c=0;d.set(t,e),e+=m}return r&&(r-=s+3),{data:d,pts:a,dts:i,len:r}}return null}function pushAccessUnit(n,e){if(n.units.length&&n.frame){if(n.pts===void 0){const t=e.samples,r=t.length;if(r){const s=t[r-1];n.pts=s.pts,n.dts=s.dts}else{e.dropped++;return}}e.samples.push(n)}n.debug.length&&logger.log(n.pts+"/"+n.dts+":"+n.debug)}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let r=(getID3Data(e,0)||[]).length;for(let s=e.length;r<s;r++)if(probe(e,r))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return canParse(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return appendFrame(e,t,r,this.basePTS,this.frameIndex)}}class AAC{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in MP4.types)MP4.types.hasOwnProperty(e)&&(MP4.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=a,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const i=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,i,u,i,o),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,s))}static box(e,...t){let r=8,s=t.length;const a=s;for(;s--;)r+=t[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(e,4),s=0,r=8;s<a;s++)i.set(t[s],r),r+=t[s].byteLength;return i}static hdlr(e){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[e])}static mdat(e){return MP4.box(MP4.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(UINT32_MAX+1)),s=Math.floor(t%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return MP4.box(MP4.types.mdia,MP4.mdhd(e.timescale,e.duration),MP4.hdlr(e.type),MP4.minf(e))}static mfhd(e){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(e)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(e))}static moof(e,t,r){return MP4.box(MP4.types.moof,MP4.mfhd(e),MP4.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=MP4.trak(e[t]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(MP4.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=MP4.trex(e[t]);return MP4.box.apply(null,[MP4.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(UINT32_MAX+1)),s=Math.floor(t%(UINT32_MAX+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,a)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,a;for(s=0;s<t.length;s++)a=t[s].flags,r[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return MP4.box(MP4.types.sdtp,r)}static stbl(e){return MP4.box(MP4.types.stbl,MP4.stsd(e),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(e){let t=[],r=[],s,a,i;for(s=0;s<e.sps.length;s++)a=e.sps[s],i=a.byteLength,t.push(i>>>8&255),t.push(i&255),t=t.concat(Array.prototype.slice.call(a));for(s=0;s<e.pps.length;s++)a=e.pps[s],i=a.byteLength,r.push(i>>>8&255),r.push(i&255),r=r.concat(Array.prototype.slice.call(a));const o=MP4.box(MP4.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),u=e.width,l=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,l>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return MP4.box(MP4.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),MP4.box(MP4.types.esds,MP4.esds(e)))}static mp3(e){const t=e.samplerate;return MP4.box(MP4.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(e))}static tkhd(e){const t=e.id,r=e.duration*e.timescale,s=e.width,a=e.height,i=Math.floor(r/(UINT32_MAX+1)),o=Math.floor(r%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const r=MP4.sdtp(e),s=e.id,a=Math.floor(t/(UINT32_MAX+1)),i=Math.floor(t%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,i>>24,i>>16&255,i>>8&255,i&255])),MP4.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(e),MP4.mdia(e))}static trex(e){const t=e.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,a=12+16*s,i=new Uint8Array(a);let o,u,l,c,d,f;for(t+=8+a,i.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<s;o++)u=r[o],l=u.duration,c=u.size,d=u.flags,f=u.cts,i.set([l>>>24&255,l>>>16&255,l>>>8&255,l&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&240<<8,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*o);return MP4.box(MP4.types.trun,i)}static initSegment(e){MP4.types||MP4.init();const t=MP4.moov(e),r=new Uint8Array(MP4.FTYP.byteLength+t.byteLength);return r.set(MP4.FTYP),r.set(t,MP4.FTYP.byteLength),r}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function toTimescaleFromScale(n,e,t=1,r=!1){return toTimescaleFromBase(n,e,1/t,r)}function toMsFromMpegTsClock(n,e=!1){return toTimescaleFromBase(n,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,e)}function toMpegTsClockFromTimescale(n,e=1){return toTimescaleFromBase(n,MPEG_TS_CLOCK_FREQ_HZ,1/e)}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152;let chromeVersion=null,safariWebkitVersion=null;class MP4Remuxer{constructor(e,t,r,s=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,chromeVersion===null){const i=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=i?parseInt(i[1]):0}if(safariWebkitVersion===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=a?parseInt(a[1]):0}}destroy(){}resetTimeStamp(e){logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const r=e.reduce((s,a)=>{const i=a.pts-s;return i<-4294967296?(t=!0,normalizePts(s,a.pts)):i>0?s:a.pts},e[0].pts);return t&&logger.debug("PTS rollover detected"),r}remux(e,t,r,s,a,i,o,u){let l,c,d,f,g,m,v=a,y=a;const E=e.pid>-1,_=t.pid>-1,T=t.samples.length,S=e.samples.length>0,x=o&&T>0||T>1;if((!E||S)&&(!_||x)||this.ISGenerated||o){this.ISGenerated||(d=this.generateIS(e,t,a,i));const A=this.isVideoContiguous;let R=-1,C;if(x&&(R=findKeyframeIndex(t.samples),!A&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,R>0){logger.warn(`[mp4-remuxer]: Dropped ${R} out of ${T} video samples due to a missing keyframe`);const w=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(R),t.dropped+=R,y+=(t.samples[0].pts-w)/t.inputTimeScale,C=y}else R===-1&&(logger.warn(`[mp4-remuxer]: No keyframe found out of ${T} video samples`),m=!1);if(this.ISGenerated){if(S&&x){const w=this.getVideoStartPts(t.samples),L=(normalizePts(e.samples[0].pts,w)-w)/t.inputTimeScale;v+=Math.max(0,L),y+=Math.max(0,-L)}if(S){if(e.samplerate||(logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,a,i)),c=this.remuxAudio(e,v,this.isAudioContiguous,i,_||x||u===PlaylistLevelType.AUDIO?y:void 0),x){const w=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,a,i)),l=this.remuxVideo(t,y,A,w)}}else x&&(l=this.remuxVideo(t,y,A,0));l&&(l.firstKeyFrame=R,l.independent=R!==-1,l.firstKeyFramePTS=C)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(g=flushTextTrackMetadataCueSamples(r,a,this._initPTS,this._initDTS)),s.samples.length&&(f=flushTextTrackUserdataCueSamples(s,a,this._initPTS))),{audio:c,video:l,initSegment:d,independent:m,text:f,id3:g}}generateIS(e,t,r,s){const a=e.samples,i=t.samples,o=this.typeSupported,u={},l=this._initPTS;let c=!l||s,d="audio/mp4",f,g,m;if(c&&(f=g=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break}u.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):MP4.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(m=e.inputTimeScale,!l||m!==l.timescale?f=g=a[0].pts-Math.round(m*r):c=!1)}if(t.sps&&t.pps&&i.length&&(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:MP4.initSegment([t]),metadata:{width:t.width,height:t.height}},c))if(m=t.inputTimeScale,!l||m!==l.timescale){const v=this.getVideoStartPts(i),y=Math.round(m*r);g=Math.min(g,normalizePts(i[0].dts,v)-y),f=Math.min(f,v-y)}else c=!1;if(Object.keys(u).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:f,timescale:m},this._initDTS={baseTime:g,timescale:m}):f=m=void 0,{tracks:u,initPTS:f,timescale:m}}remuxVideo(e,t,r,s){const a=e.inputTimeScale,i=e.samples,o=[],u=i.length,l=this._initPTS;let c=this.nextAvcDts,d=8,f=this.videoSampleDuration,g,m,v=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,E=!1;if(!r||c===null){const j=t*a,q=i[0].pts-normalizePts(i[0].dts,i[0].pts);c=j-q}const _=l.baseTime*a/l.timescale;for(let j=0;j<u;j++){const q=i[j];q.pts=normalizePts(q.pts-_,c),q.dts=normalizePts(q.dts-_,c),q.dts<i[j>0?j-1:j].dts&&(E=!0)}E&&i.sort(function(j,q){const Q=j.dts-q.dts,U=j.pts-q.pts;return Q||U}),g=i[0].dts,m=i[i.length-1].dts;const T=m-g,S=T?Math.round(T/(u-1)):f||e.inputTimeScale/30;if(r){const j=g-c,q=j>S,Q=j<-1;if((q||Q)&&(q?logger.warn(`AVC: ${toMsFromMpegTsClock(j,!0)} ms (${j}dts) hole between fragments detected, filling it`):logger.warn(`AVC: ${toMsFromMpegTsClock(-j,!0)} ms (${j}dts) overlapping between fragments detected`),!Q||c>i[0].pts)){g=c;const U=i[0].pts-j;i[0].dts=g,i[0].pts=U,logger.log(`Video: First PTS/DTS adjusted: ${toMsFromMpegTsClock(U,!0)}/${toMsFromMpegTsClock(g,!0)}, delta: ${toMsFromMpegTsClock(j,!0)} ms`)}}g=Math.max(0,g);let x=0,b=0;for(let j=0;j<u;j++){const q=i[j],Q=q.units,U=Q.length;let $=0;for(let K=0;K<U;K++)$+=Q[K].data.length;b+=$,x+=U,q.length=$,q.dts=Math.max(q.dts,g),v=Math.min(q.pts,v),y=Math.max(q.pts,y)}m=i[u-1].dts;const A=b+4*x+8;let R;try{R=new Uint8Array(A)}catch(j){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:j,bytes:A,reason:`fail allocating video mdat ${A}`});return}const C=new DataView(R.buffer);C.setUint32(0,A),R.set(MP4.types.mdat,4);let w=!1,I=Number.POSITIVE_INFINITY,L=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let j=0;j<u;j++){const q=i[j],Q=q.units;let U=0;for(let G=0,ae=Q.length;G<ae;G++){const W=Q[G],B=W.data,V=W.data.byteLength;C.setUint32(d,V),d+=4,R.set(B,d),d+=V,U+=4+V}let $;if(j<u-1)f=i[j+1].dts-q.dts,$=i[j+1].pts-q.pts;else{const G=this.config,ae=j>0?q.dts-i[j-1].dts:S;if($=j>0?q.pts-i[j-1].pts:S,G.stretchShortVideoTrack&&this.nextAudioPts!==null){const W=Math.floor(G.maxBufferHole*a),B=(s?v+s*a:this.nextAudioPts)-q.pts;B>W?(f=B-ae,f<0?f=ae:w=!0,logger.log(`[mp4-remuxer]: It is approximately ${B/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=ae}else f=ae}const K=Math.round(q.pts-q.dts);I=Math.min(I,f),D=Math.max(D,f),L=Math.min(L,$),O=Math.max(O,$),o.push(new Mp4Sample(q.key,f,U,K))}if(o.length){if(chromeVersion){if(chromeVersion<70){const j=o[0].flags;j.dependsOn=2,j.isNonSync=0}}else if(safariWebkitVersion&&O-L<D-I&&S/D<.025&&o[0].cts===0){logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let j=g;for(let q=0,Q=o.length;q<Q;q++){const U=j+o[q].duration,$=j+o[q].cts;if(q<Q-1){const K=U+o[q+1].cts;o[q].duration=K-$}else o[q].duration=q?o[q-1].duration:S;o[q].cts=0,j=U}}}f=w||!f?S:f,this.nextAvcDts=c=m+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const N=MP4.moof(e.sequenceNumber++,g,_extends({},e,{samples:o})),F="video",H={data1:N,data2:R,startPTS:v/a,endPTS:(y+f)/a,startDTS:g/a,endDTS:c/a,type:F,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,H}remuxAudio(e,t,r,s,a){const i=e.inputTimeScale,o=e.samplerate?e.samplerate:i,u=i/o,l=e.segmentCodec==="aac"?AAC_SAMPLES_PER_FRAME:MPEG_AUDIO_SAMPLE_PER_FRAME,c=l*u,d=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],m=a!==void 0;let v=e.samples,y=f?0:8,E=this.nextAudioPts||-1;const _=t*i,T=d.baseTime*i/d.timescale;if(this.isAudioContiguous=r=r||v.length&&E>0&&(s&&Math.abs(_-E)<9e3||Math.abs(normalizePts(v[0].pts-T,_)-E)<20*c),v.forEach(function(F){F.pts=normalizePts(F.pts-T,_)}),!r||E<0){if(v=v.filter(F=>F.pts>=0),!v.length)return;a===0?E=0:s&&!m?E=Math.max(0,_):E=v[0].pts}if(e.segmentCodec==="aac"){const F=this.config.maxAudioFramesDrift;for(let H=0,j=E;H<v.length;H++){const q=v[H],Q=q.pts,U=Q-j,$=Math.abs(1e3*U/i);if(U<=-F*c&&m)H===0&&(logger.warn(`Audio frame @ ${(Q/i).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*U/i)} ms.`),this.nextAudioPts=E=j=Q);else if(U>=F*c&&$<MAX_SILENT_FRAME_DURATION&&m){let K=Math.round(U/c);j=Q-K*c,j<0&&(K--,j+=c),H===0&&(this.nextAudioPts=E=j),logger.warn(`[mp4-remuxer]: Injecting ${K} audio frame @ ${(j/i).toFixed(3)}s due to ${Math.round(1e3*U/i)} ms gap.`);for(let G=0;G<K;G++){const ae=Math.max(j,0);let W=AAC.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);W||(logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),W=q.unit.subarray()),v.splice(H,0,{unit:W,pts:ae}),j+=c,H++}}q.pts=j,j+=c}}let S=null,x=null,b,A=0,R=v.length;for(;R--;)A+=v[R].unit.byteLength;for(let F=0,H=v.length;F<H;F++){const j=v[F],q=j.unit;let Q=j.pts;if(x!==null){const $=g[F-1];$.duration=Math.round((Q-x)/u)}else if(r&&e.segmentCodec==="aac"&&(Q=E),S=Q,A>0){A+=y;try{b=new Uint8Array(A)}catch($){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:A,reason:`fail allocating audio mdat ${A}`});return}f||(new DataView(b.buffer).setUint32(0,A),b.set(MP4.types.mdat,4))}else return;b.set(q,y);const U=q.byteLength;y+=U,g.push(new Mp4Sample(!0,l,U,0)),x=Q}const C=g.length;if(!C)return;const w=g[g.length-1];this.nextAudioPts=E=x+u*w.duration;const I=f?new Uint8Array(0):MP4.moof(e.sequenceNumber++,S/u,_extends({},e,{samples:g}));e.samples=[];const L=S/i,D=E/i,N={data1:I,data2:b,startPTS:L,endPTS:D,startDTS:L,endDTS:D,type:"audio",hasAudio:!0,hasVideo:!1,nb:C};return this.isAudioContiguous=!0,N}remuxEmptyAudio(e,t,r,s){const a=e.inputTimeScale,i=e.samplerate?e.samplerate:a,o=a/i,u=this.nextAudioPts,l=this._initDTS,c=l.baseTime*9e4/l.timescale,d=(u!==null?u:s.startDTS*a)+c,f=s.endDTS*a+c,g=o*AAC_SAMPLES_PER_FRAME,m=Math.ceil((f-d)/g),v=AAC.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(logger.warn("[mp4-remuxer]: remux empty Audio"),!v){logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const y=[];for(let E=0;E<m;E++){const _=d+E*g;y.push({unit:v,pts:_,dts:_})}return e.samples=y,this.remuxAudio(e,t,r,!1)}}function normalizePts(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function findKeyframeIndex(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function flushTextTrackMetadataCueSamples(n,e,t,r){const s=n.samples.length;if(!s)return;const a=n.inputTimeScale;for(let o=0;o<s;o++){const u=n.samples[o];u.pts=normalizePts(u.pts-t.baseTime*9e4/t.timescale,e*a)/a,u.dts=normalizePts(u.dts-r.baseTime*9e4/r.timescale,e*a)/a}const i=n.samples;return n.samples=[],{samples:i}}function flushTextTrackUserdataCueSamples(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let i=0;i<r;i++){const o=n.samples[i];o.pts=normalizePts(o.pts-t.baseTime*9e4/t.timescale,e*s)/s}n.samples.sort((i,o)=>i.pts-o.pts);const a=n.samples;return n.samples=[],{samples:a}}class Mp4Sample{constructor(e,t,r,s){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=s,this.flags=new Mp4SampleFlags(e)}}class Mp4SampleFlags{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}class PassThroughRemuxer{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(patchEncyptionData(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const s=this.initData=parseInitSegment(e);t||(t=getParsedTrackCodec(s.audio,ElementaryStreamTypes.AUDIO)),r||(r=getParsedTrackCodec(s.video,ElementaryStreamTypes.VIDEO));const a={};s.audio&&s.video?a.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:s.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?a.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,r,s,a,i){var o,u;let{initPTS:l,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};isFiniteNumber(c)||(c=this.lastEndTime=a||0);const f=t.samples;if(!(f!=null&&f.length))return d;const g={initPTS:void 0,timescale:1};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(f),m=this.initData),!((u=m)!=null&&u.length))return logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const v=getDuration(f,m),y=getStartDTS(m,f),E=y===null?a:y;(isInvalidInitPts(l,E,a,v)||g.timescale!==l.timescale&&i)&&(g.initPTS=E-a,l&&l.timescale===1&&logger.warn(`Adjusting initPTS by ${g.initPTS-l.baseTime}`),this.initPTS=l={baseTime:g.initPTS,timescale:1});const _=e?E-l.baseTime/l.timescale:c,T=_+v;offsetStartDTS(m,f,l.baseTime/l.timescale),v>0?this.lastEndTime=T:(logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const S=!!m.audio,x=!!m.video;let b="";S&&(b+="audio"),x&&(b+="video");const A={data1:f,startPTS:_,startDTS:_,endPTS:T,endDTS:T,type:b,hasAudio:S,hasVideo:x,nb:1,dropped:0};return d.audio=A.type==="audio"?A:void 0,d.video=A.type!=="audio"?A:void 0,d.initSegment=g,d.id3=flushTextTrackMetadataCueSamples(r,a,l,l),s.samples.length&&(d.text=flushTextTrackUserdataCueSamples(s,a,l)),d}}function isInvalidInitPts(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),a=e-n.baseTime/n.timescale;return Math.abs(a-t)>s}function getParsedTrackCodec(n,e){const t=n==null?void 0:n.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}let now;try{now=self.performance.now.bind(self.performance)}catch(n){logger.debug("Unable to use Performance API on this environment"),now=typeof self<"u"&&self.Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];class Transmuxer{constructor(e,t,r,s,a){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=s,this.id=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const a=r.transmuxing;a.executeStart=now();let i=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:u}=this;s&&(this.currentTransmuxState=s);const{contiguous:l,discontinuity:c,trackSwitch:d,accurateTimeOffset:f,timeOffset:g,initSegmentChange:m}=s||o,{audioCodec:v,videoCodec:y,defaultInitPts:E,duration:_,initSegmentData:T}=u,S=getEncryptionType(i,t);if(S&&S.method==="AES-128"){const R=this.getDecrypter();if(R.isSync()){let C=R.softwareDecrypt(i,S.key.buffer,S.iv.buffer);if(r.part>-1&&(C=R.flush()),!C)return a.executeEnd=now(),emptyResult(r);i=new Uint8Array(C)}else return this.decryptionPromise=R.webCryptoDecrypt(i,S.key.buffer,S.iv.buffer).then(C=>{const w=this.push(C,null,r);return this.decryptionPromise=null,w}),this.decryptionPromise}const x=this.needsProbing(c,d);if(x){const R=this.configureTransmuxer(i);if(R)return logger.warn(`[transmuxer] ${R.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:R,reason:R.message}),a.executeEnd=now(),emptyResult(r)}(c||d||m||x)&&this.resetInitSegment(T,v,y,_,t),(c||m||x)&&this.resetInitialTimestamp(E),l||this.resetContiguity();const b=this.transmux(i,S,g,f,r),A=this.currentTransmuxState;return A.contiguous=!0,A.discontinuity=!1,A.trackSwitch=!1,a.executeEnd=now(),b}flush(e){const t=e.transmuxing;t.executeStart=now();const{decrypter:r,currentTransmuxState:s,decryptionPromise:a}=this;if(a)return a.then(()=>this.flush(e));const i=[],{timeOffset:o}=s;if(r){const d=r.flush();d&&i.push(this.push(d,null,e))}const{demuxer:u,remuxer:l}=this;if(!u||!l)return t.executeEnd=now(),[emptyResult(e)];const c=u.flush(o);return isPromise(c)?c.then(d=>(this.flushRemux(i,d,e),i)):(this.flushRemux(i,c,e),i)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:a,id3Track:i,textTrack:o}=t,{accurateTimeOffset:u,timeOffset:l}=this.currentTransmuxState;logger.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${r.part>-1?" p: "+r.part:""} of level ${r.level}`);const c=this.remuxer.remux(s,a,i,o,l,u,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=now()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,a){const{demuxer:i,remuxer:o}=this;!i||!o||(i.resetInitSegment(e,t,r,s),o.resetInitSegment(e,t,r,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,a){let i;return t&&t.method==="SAMPLE-AES"?i=this.transmuxSampleAes(e,t,r,s,a):i=this.transmuxUnencrypted(e,r,s,a),i}transmuxUnencrypted(e,t,r,s){const{audioTrack:a,videoTrack:i,id3Track:o,textTrack:u}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,i,o,u,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,a){return this.demuxer.demuxSampleAes(e,t,r).then(i=>({remuxResult:this.remuxer.remux(i.audioTrack,i.videoTrack,i.id3Track,i.textTrack,r,s,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s,vendor:a}=this;let i;for(let d=0,f=muxConfig.length;d<f;d++)if(muxConfig[d].demux.probe(e)){i=muxConfig[d];break}if(!i)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,u=this.remuxer,l=i.remux,c=i.demux;(!u||!(u instanceof l))&&(this.remuxer=new l(r,t,s,a)),(!o||!(o instanceof c))&&(this.demuxer=new c(r,t,s),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Decrypter(this.config)),e}}function getEncryptionType(n,e){let t=null;return n.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const emptyResult=n=>({remuxResult:{},chunkMeta:n});function isPromise(n){return"then"in n&&n.then instanceof Function}class TransmuxConfig{constructor(e,t,r,s,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=a||null}}class TransmuxState{constructor(e,t,r,s,a,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=a,this.initSegmentChange=i}}var eventemitter3={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var g=new s(c,d||u,f),m=t?t+l:l;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],g]:u._events[m].push(g):(u._events[m]=g,u._eventsCount++),u}function i(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,d;if(this._eventsCount===0)return l;for(d in c=this._events)e.call(c,d)&&l.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=t?t+l:l,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,g=d.length,m=new Array(g);f<g;f++)m[f]=d[f].fn;return m},o.prototype.listenerCount=function(l){var c=t?t+l:l,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(l,c,d,f,g,m){var v=t?t+l:l;if(!this._events[v])return!1;var y=this._events[v],E=arguments.length,_,T;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),E){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,d),!0;case 4:return y.fn.call(y.context,c,d,f),!0;case 5:return y.fn.call(y.context,c,d,f,g),!0;case 6:return y.fn.call(y.context,c,d,f,g,m),!0}for(T=1,_=new Array(E-1);T<E;T++)_[T-1]=arguments[T];y.fn.apply(y.context,_)}else{var S=y.length,x;for(T=0;T<S;T++)switch(y[T].once&&this.removeListener(l,y[T].fn,void 0,!0),E){case 1:y[T].fn.call(y[T].context);break;case 2:y[T].fn.call(y[T].context,c);break;case 3:y[T].fn.call(y[T].context,c,d);break;case 4:y[T].fn.call(y[T].context,c,d,f);break;default:if(!_)for(x=1,_=new Array(E-1);x<E;x++)_[x-1]=arguments[x];y[T].fn.apply(y[T].context,_)}}return!0},o.prototype.on=function(l,c,d){return a(this,l,c,d,!1)},o.prototype.once=function(l,c,d){return a(this,l,c,d,!0)},o.prototype.removeListener=function(l,c,d,f){var g=t?t+l:l;if(!this._events[g])return this;if(!c)return i(this,g),this;var m=this._events[g];if(m.fn)m.fn===c&&(!f||m.once)&&(!d||m.context===d)&&i(this,g);else{for(var v=0,y=[],E=m.length;v<E;v++)(m[v].fn!==c||f&&!m[v].once||d&&m[v].context!==d)&&y.push(m[v]);y.length?this._events[g]=y.length===1?y[0]:y:i(this,g)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=t?t+l:l,this._events[c]&&i(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);const MediaSource$1=getMediaSource()||{isTypeSupported:()=>!1};class TransmuxerInterface{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const i=(l,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,l===Events.ERROR&&(this.error=c.error),this.hls.trigger(l,c)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,i),this.observer.on(Events.ERROR,i);const o={mp4:MediaSource$1.isTypeSupported("video/mp4"),mpeg:MediaSource$1.isTypeSupported("audio/mpeg"),mp3:MediaSource$1.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(a.workerPath||hasUMDWorker())){try{a.workerPath?(logger.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=loadWorker(a.workerPath)):(logger.log(`injecting Web Worker for "${t}"`),this.workerContext=injectWorker()),this.onwmsg=d=>this.onWorkerMessage(d);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=d=>{const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);a.enableWorker=!1,logger.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})},c.postMessage({cmd:"init",typeSupported:o,vendor:u,id:t,config:JSON.stringify(a)})}catch(c){logger.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,o,a,u,t)}return}this.transmuxer=new Transmuxer(this.observer,o,a,u,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,r,s,a,i,o,u,l,c){var d,f;l.transmuxing.start=self.performance.now();const{transmuxer:g}=this,m=i?i.start:a.start,v=a.decryptdata,y=this.frag,E=!(y&&a.cc===y.cc),_=!(y&&l.level===y.level),T=y?l.sn-y.sn:-1,S=this.part?l.part-this.part.index:-1,x=T===0&&l.id>1&&l.id===(y==null?void 0:y.stats.chunkCount),b=!_&&(T===1||T===0&&(S===1||x&&S<=0)),A=self.performance.now();(_||T||a.stats.parsing.start===0)&&(a.stats.parsing.start=A),i&&(S||!b)&&(i.stats.parsing.start=A);const R=!(y&&((d=a.initSegment)==null?void 0:d.url)===((f=y.initSegment)==null?void 0:f.url)),C=new TransmuxState(E,b,u,_,m,R);if(!b||E||R){logger.log(`[transmuxer-interface, ${a.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}
        discontinuity: ${E}
        trackSwitch: ${_}
        contiguous: ${b}
        accurateTimeOffset: ${u}
        timeOffset: ${m}
        initSegmentChange: ${R}`);const w=new TransmuxConfig(r,s,t,o,c);this.configureTransmuxer(w)}if(this.frag=a,this.part=i,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:v,chunkMeta:l,state:C},e instanceof ArrayBuffer?[e]:[]);else if(g){const w=g.push(e,v,l,C);isPromise(w)?(g.async=!0,w.then(I=>{this.handleTransmuxComplete(I)}).catch(I=>{this.transmuxerError(I,l,"transmuxer-interface push error")})):(g.async=!1,this.handleTransmuxComplete(w))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let r=t.flush(e);isPromise(r)||t.async?(isPromise(r)||(r=Promise.resolve(r)),r.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")})):this.handleFlushResult(r,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,r=this.hls;switch(t.event){case"init":{var s;const a=(s=this.workerContext)==null?void 0:s.objectURL;a&&self.URL.revokeObjectURL(a);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":logger[t.data.logType]&&logger[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const STALL_MINIMUM_DURATION_MS=250,MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05;class GapController{constructor(e,t,r,s){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=s}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:r,media:s,stalled:a}=this;if(s===null)return;const{currentTime:i,seeking:o}=s,u=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,i!==e){if(this.moved=!0,a!==null){if(this.stallReported){const E=self.performance.now()-a;logger.warn(`playback not stuck anymore @${i}, after ${Math.round(E)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||u){this.stalled=null;return}if(s.paused&&!o||s.ended||s.playbackRate===0||!BufferHelper.getBuffered(s).length)return;const c=BufferHelper.bufferInfo(s,i,0),d=c.len>0,f=c.nextStart||0;if(!d&&!f)return;if(o){const E=c.len>MAX_START_GAP_JUMP,_=!f||t&&t.start<=i||f-i>MAX_START_GAP_JUMP&&!this.fragmentTracker.getPartialFragment(i);if(E||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var g;const E=Math.max(f,c.start||0)-i,_=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,S=(_==null||(g=_.details)==null?void 0:g.live)?_.details.targetduration*2:MAX_START_GAP_JUMP,x=this.fragmentTracker.getPartialFragment(i);if(E>0&&(E<=S||x)){this._trySkipBufferHole(x);return}}const m=self.performance.now();if(a===null){this.stalled=m;return}const v=m-a;if(!o&&v>=STALL_MINIMUM_DURATION_MS&&(this._reportStall(c),!this.media))return;const y=BufferHelper.bufferInfo(s,i,r.maxBufferHole);this._tryFixBufferStall(y,v)}_tryFixBufferStall(e,t){const{config:r,fragmentTracker:s,media:a}=this;if(a===null)return;const i=a.currentTime,o=s.getPartialFragment(i);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-i<r.maxBufferHole)&&t>r.highBufferWatchdogPeriod*1e3&&(logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:r,stallReported:s}=this;if(!s&&r){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(e)})`);logger.warn(a.message),t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:r,media:s}=this;if(s===null)return 0;const a=s.currentTime,i=BufferHelper.bufferInfo(s,a,0),o=a<i.start?i.start:i.nextStart;if(o){const u=i.len<=t.maxBufferHole,l=i.len>0&&i.len<1&&s.readyState<3,c=o-a;if(c>0&&(u||l)){if(c>t.maxBufferHole){const{fragmentTracker:f}=this;let g=!1;if(a===0){const m=f.getAppendedFrag(0,PlaylistLevelType.MAIN);m&&o<m.end&&(g=!0)}if(!g){const m=e||f.getAppendedFrag(a,PlaylistLevelType.MAIN);if(m){let v=!1,y=m.end;for(;y<o;){const E=f.getPartialFragment(y);if(E)y+=E.duration;else{v=!0;break}}if(v)return 0}}}const d=Math.max(o+SKIP_BUFFER_RANGE_START,a+SKIP_BUFFER_HOLE_STEP_SECONDS);if(logger.warn(`skipping hole, adjusting currentTime from ${a} to ${d}`),this.moved=!0,this.stalled=null,s.currentTime=d,e&&!e.gap){const f=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${d}`);r.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:r,nudgeRetry:s}=this;if(r===null)return;const a=r.currentTime;if(this.nudgeRetry++,s<e.nudgeMaxRetry){const i=a+(s+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${a} to ${i}`);logger.warn(o.message),r.currentTime=i,t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const i=new Error(`Playhead still not moving while enough data buffered @${a} after ${e.nudgeMaxRetry} nudges`);logger.error(i.message),t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:i,fatal:!0})}}}const TICK_INTERVAL$2=100;class StreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[stream-controller]",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Events.ERROR,this.onError,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Events.ERROR,this.onError,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:r}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL$2),this.level=-1,!this.startFragRequested){let s=r.startLevel;s===-1&&(r.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=r.nextAutoLevel),this.level=r.nextLoadLevel=s,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{var e;const{levels:r,level:s}=this,a=r==null||(e=r[s])==null?void 0:e.details;if(a&&(!a.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(a))break;this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:{var t;const r=self.performance.now(),s=this.retryDate;(!s||r>=s||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=State.IDLE)}break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this,{config:a,nextLoadLevel:i}=e;if(t===null||!s&&(this.startFragRequested||!a.startFragPrefetch)||this.altAudio&&this.audioOnly||!(r!=null&&r[i]))return;const o=r[i],u=this.getMainFwdBufferInfo();if(u===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(u,l)){const y={};this.altAudio&&(y.type="video"),this.hls.trigger(Events.BUFFER_EOS,y),this.state=State.ENDED;return}e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const c=o.details;if(!c||this.state===State.WAITING_LEVEL||c.live&&this.levelLastLoaded!==i){this.level=i,this.state=State.WAITING_LEVEL;return}const d=u.len,f=this.getMaxBufferLength(o.maxBitrate);if(d>=f)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:u.end;let m=this.getNextFragment(g,c);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==FragmentState.OK){var v;const E=((v=this.backtrackFragment)!=null?v:m).sn-c.startSN,_=c.fragments[E-1];_&&m.cc===_.cc&&(m=_,this.fragmentTracker.removeFragment(_))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,g)){if(!m.gap){const E=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,_=(E===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;_&&this.afterBufferFlushed(_,E,PlaylistLevelType.MAIN)}m=this.getNextFragmentLoopLoading(m,c,u,PlaylistLevelType.MAIN,f)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,g))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);this.fragCurrent=e,s===FragmentState.NOT_LOADED||s===FragmentState.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,r)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,PlaylistLevelType.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<a.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,u=e[o],l=this.fragLastKbps;l&&this.fragCurrent?r=this.fragCurrent.duration*u.maxBitrate/(1e3*l)+1:r=0}else r=0;const i=this.getBufferedFrag(t.currentTime+r);if(i){const o=this.followingBufferedFrag(i);if(o){this.abortCurrentFrag();const u=o.maxStartPTS?o.maxStartPTS:o.start,l=o.duration,c=Math.max(i.end,u+Math.min(Math.max(l-this.config.maxFragLookUpTolerance,l*.5),l*.75));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new GapController(this.config,r,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;isFiniteNumber(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const r=this.getMainFwdBufferInfo();if(r===null||r.len===0){this.warn(`Main forward buffer length on "seeked" event ${r?r.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1,a;t.levels.forEach(i=>{a=i.audioCodec,a&&(a.indexOf("mp4a.40.2")!==-1&&(r=!0),a.indexOf("mp4a.40.5")!==-1&&(s=!0))}),this.audioCodecSwitch=r&&s&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==State.IDLE)return;const s=r[t.level];(!s.details||s.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(s.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s}=this,a=t.level,i=t.details,o=i.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""}, cc [${i.startCC}, ${i.endCC}] duration:${o}`);const u=s[a],l=this.fragCurrent;l&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&(l.level!==t.level||l.urlId!==u.urlId)&&l.loader&&this.abortCurrentFrag();let c=0;if(i.live||(r=u.details)!=null&&r.live){if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed)return;c=this.alignPlaylists(i,u.details)}if(u.details=i,this.levelLastLoaded=a,this.hls.trigger(Events.LEVEL_UPDATED,{details:i,level:a}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(i))return;this.state=State.IDLE}this.startFragRequested?i.live&&this.synchronizeToLiveEdge(i):this.setStartPosition(i,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:s,payload:a}=e,{levels:i}=this;if(!i){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const o=i[r.level],u=o.details;if(!u){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const l=o.videoCodec,c=u.PTSKnown||!u.live,d=(t=r.initSegment)==null?void 0:t.data,f=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=s?s.index:-1,v=m!==-1,y=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount,a.byteLength,m,v),E=this.initPTS[r.cc];g.push(a,d,f,l,r,s,u.totalduration,c,y,E)}onAudioTrackSwitching(e,t){const r=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const i=this.fragCurrent;i&&(this.log("Switching to main audio track, cancel main fragment load"),i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const a=this.hls;r&&(a.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),a.trigger(Events.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=t.id,s=!!this.hls.audioTracks[r].url;if(s){const a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=s,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,a,i=!1;for(const o in r){const u=r[o];if(u.id==="main"){if(a=o,s=u,o==="video"){const l=r[o];l&&(this.videoBuffer=l.buffer)}}else i=!0}i&&s?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r&&r.type!==PlaylistLevelType.MAIN)return;if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const a=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),r.sn!=="initSegment"&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}onError(e,t){var r;if(t.fatal){this.state=State.ERROR;return}switch(t.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,t);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===State.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!BufferHelper.getBuffered(e).length){const r=this.state!==State.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){const r=(t===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,t,PlaylistLevelType.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=BufferHelper.getBuffered(e),i=(s.length?s.start(0):0)-r;i>0&&(i<this.config.maxBufferHole||i<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${i} to match buffer start`),r+=i,this.startPosition=r),this.log(`seek to target start position ${r} from current time ${t}`),e.currentTime=r}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this;if(!r||this.fragContextChanged(e))return;t.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=e.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(Events.FRAG_LOADED,r),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r="main",{hls:s}=this,{remuxResult:a,chunkMeta:i}=e,o=this.getCurrentContext(i);if(!o){this.resetWhenMissingContext(i);return}const{frag:u,part:l,level:c}=o,{video:d,text:f,id3:g,initSegment:m}=a,{details:v}=c,y=this.altAudio?void 0:a.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=State.PARSING,m){if(m!=null&&m.tracks){const T=u.initSegment||u;this._bufferInitSegment(c,m.tracks,T,i),s.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:r,tracks:m.tracks})}const E=m.initPTS,_=m.timescale;isFiniteNumber(E)&&(this.initPTS[u.cc]={baseTime:E,timescale:_},s.trigger(Events.INIT_PTS_FOUND,{frag:u,id:r,initPTS:E,timescale:_}))}if(d&&a.independent!==!1){if(v){const{startPTS:E,endPTS:_,startDTS:T,endDTS:S}=d;if(l)l.elementaryStreams[d.type]={startPTS:E,endPTS:_,startDTS:T,endDTS:S};else if(d.firstKeyFrame&&d.independent&&i.id===1&&(this.couldBacktrack=!0),d.dropped&&d.independent){const x=this.getMainFwdBufferInfo(),b=(x?x.end:this.getLoadPosition())+this.config.maxBufferHole,A=d.firstKeyFramePTS?d.firstKeyFramePTS:E;if(b<A-this.config.maxBufferHole){this.backtrack(u);return}u.setElementaryStreamInfo(d.type,u.start,_,u.start,S,!0)}u.setElementaryStreamInfo(d.type,E,_,T,S),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(d,u,l,i)}}else if(a.independent===!1){this.backtrack(u);return}if(y){const{startPTS:E,endPTS:_,startDTS:T,endDTS:S}=y;l&&(l.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:E,endPTS:_,startDTS:T,endDTS:S}),u.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,E,_,T,S),this.bufferFragmentData(y,u,l,i)}if(v&&g!=null&&(t=g.samples)!=null&&t.length){const E={id:r,frag:u,details:v,samples:g.samples};s.trigger(Events.FRAG_PARSING_METADATA,E)}if(v&&f){const E={id:r,frag:u,details:v,samples:f.samples};s.trigger(Events.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,r,s){if(this.state!==State.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:a,video:i,audiovideo:o}=t;if(a){let u=e.audioCodec;const l=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5"),a.metadata.channelCount!==1&&l.indexOf("firefox")===-1&&(u="mp4a.40.5")),l.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),e.audioCodec&&e.audioCodec!==u&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${u}"`),a.levelCodec=u,a.id="main",this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${u||""}/${e.audioCodec||""}/${a.codec}]`)}i&&(i.levelCodec=e.videoCodec,i.id="main",this.log(`Init video buffer, container:${i.container}, codecs[level/parsed]=[${e.videoCodec||""}/${i.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${o.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,t),Object.keys(t).forEach(u=>{const c=t[u].initSegment;c!=null&&c.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:u,data:c,frag:r,part:null,chunkMeta:s,parent:r.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,PlaylistLevelType.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=State.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(BufferHelper.isBuffered(e,r)?t=this.getAppendedFrag(r):BufferHelper.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,a=t.level;(!s||t.sn!==s.sn||s.level!==a||t.urlId!==s.urlId)&&(this.fragPlaying=t,this.hls.trigger(Events.FRAG_CHANGED,{frag:t}),(!s||s.level!==a)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,r=this.currentFrag;if(r&&isFiniteNumber(t)&&isFiniteNumber(r.programDateTime)){const s=r.programDateTime+(t-r.start)*1e3;return new Date(s)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class EWMA{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class EwmaBandWidthEstimator{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(e),this.fast_=new EWMA(t),this.defaultTTFB_=s,this.ttfb_=new EWMA(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:a}=this;r.halfLife!==e&&(this.slow_=new EWMA(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new EWMA(t,s.getEstimate(),s.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new EWMA(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,a=r/s;this.fast_.sample(s,a),this.slow_.sample(s,a)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class AbrController{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new EwmaBandWidthEstimator(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var r;const s=t.frag;this.ignoreFragment(s)||(this.fragCurrent=s,this.partCurrent=(r=t.part)!=null?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,r,s){const a=e+r/t,i=s?this.lastLevelLoadSec:0;return a+i}onLevelLoaded(e,t){const r=this.hls.config,{total:s,bwEstimate:a}=t.stats;isFiniteNumber(s)&&isFiniteNumber(a)&&(this.lastLevelLoadSec=8*s/a),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!e||!a)return;const i=performance.now(),o=t?t.stats:e.stats,u=t?t.duration:e.duration,l=i-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||a.paused||!a.playbackRate||!a.readyState)return;const c=r.mainForwardBufferInfo;if(c===null)return;const d=this.bwEstimator.getEstimateTTFB(),f=Math.abs(a.playbackRate);if(l<=Math.max(d,1e3*(u/(f*2))))return;const g=c.len/f;if(g>=2*u/f)return;const m=o.loading.first?o.loading.first-o.loading.start:-1,v=o.loaded&&m>-1,y=this.bwEstimator.getEstimate(),{levels:E,minAutoLevel:_}=r,T=E[e.level],S=o.total||Math.max(o.loaded,Math.round(u*T.maxBitrate/8));let x=l-m;x<1&&v&&(x=Math.min(l,o.loaded*8/y));const b=v?o.loaded*1e3/x:0,A=b?(S-o.loaded)/b:S*8/y+d/1e3;if(A<=g)return;const R=b?b*8:y;let C=Number.POSITIVE_INFINITY,w;for(w=e.level-1;w>_;w--){const I=E[w].maxBitrate;if(C=this.getTimeToLoadFrag(d/1e3,R,u*I,!E[w].details),C<g)break}C>=A||C>u*10||(r.nextLoadLevel=w,v?this.bwEstimator.sample(l-Math.min(d,m),o.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),logger.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${g.toFixed(3)} s
      Estimated load time for current fragment: ${A.toFixed(3)} s
      Estimated load time for down switch fragment: ${C.toFixed(3)} s
      TTFB estimate: ${m}
      Current BW estimate: ${isFiniteNumber(y)?(y/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${w}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const a=r?r.duration:t.duration,i=this.hls.levels[t.level],o=(i.loaded?i.loaded.bytes:0)+s.loaded,u=(i.loaded?i.loaded.duration:0)+a;i.loaded={bytes:o,duration:u},i.realBitrate=Math.round(8*o/u)}if(t.bitrateTest){const a={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(Events.FRAG_BUFFERED,a),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:r,part:s}=t,a=s!=null&&s.stats.loaded?s.stats:r.stats;if(a.aborted||this.ignoreFragment(r))return;const i=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(i,a.loaded),a.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==PlaylistLevelType.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let r=this.getNextABRAutoLevel();if(e!==-1){const s=this.hls.levels;if(s.length>Math.max(e,r)&&s[e].loadError<=s[r].loadError)return e}return e!==-1&&(r=Math.min(e,r)),r}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{maxAutoLevel:s,config:a,minAutoLevel:i,media:o}=r,u=t?t.duration:e?e.duration:0,l=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,d=r.mainForwardBufferInfo,f=(d?d.len:0)/l;let g=this.findBestLevel(c,i,s,f,a.abrBandWidthFactor,a.abrBandWidthUpFactor);if(g>=0)return g;logger.trace(`[abr] ${f?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let m=u?Math.min(u,a.maxStarvationDelay):a.maxStarvationDelay,v=a.abrBandWidthFactor,y=a.abrBandWidthUpFactor;if(!f){const E=this.bitrateTestDelay;E&&(m=(u?Math.min(u,a.maxLoadingDelay):a.maxLoadingDelay)-E,logger.trace(`[abr] bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),v=y=1)}return g=this.findBestLevel(c,i,s,f+m,v,y),Math.max(g,0)}findBestLevel(e,t,r,s,a,i){var o;const{fragCurrent:u,partCurrent:l,lastLoadedFragLevel:c}=this,{levels:d}=this.hls,f=d[c],g=!!(f!=null&&(o=f.details)!=null&&o.live),m=f==null?void 0:f.codecSet,v=l?l.duration:u?u.duration:0,y=this.bwEstimator.getEstimateTTFB()/1e3;let E=t,_=-1;for(let T=r;T>=t;T--){const S=d[T];if(!S||m&&S.codecSet!==m){S&&(E=Math.min(T,E),_=Math.max(T,_));continue}_!==-1&&logger.trace(`[abr] Skipped level(s) ${E}-${_} with CODECS:"${d[_].attrs.CODECS}"; not compatible with "${f.attrs.CODECS}"`);const x=S.details,b=(l?x==null?void 0:x.partTarget:x==null?void 0:x.averagetargetduration)||v;let A;T<=c?A=a*e:A=i*e;const R=d[T].maxBitrate,C=this.getTimeToLoadFrag(y,A,R*b,x===void 0);if(logger.trace(`[abr] level:${T} adjustedbw-bitrate:${Math.round(A-R)} avgDuration:${b.toFixed(1)} maxFetchDuration:${s.toFixed(1)} fetchDuration:${C.toFixed(1)}`),A>R&&(C===0||!isFiniteNumber(C)||g&&!this.bitrateTestDelay||C<s))return T}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=concatUint8Arrays(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const a=n[s];t.set(a,r),r+=a.length}return t}const TICK_INTERVAL$1=100;class AudioStreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[audio-stream-controller]",PlaylistLevelType.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.ERROR,this.onError,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.ERROR,this.onError,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:a}){if(r==="main"){const i=t.cc;this.initPTS[t.cc]={baseTime:s,timescale:a},this.log(`InitPTS for cc: ${i} found from main: ${s}`),this.videoTrackCC=i,this.state===State.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=State.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$1),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=State.IDLE):(this.loadedmetadata=!1,this.state=State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{var e;const{levels:r,trackId:s}=this,a=r==null||(e=r[s])==null?void 0:e.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{var t;const r=performance.now(),s=this.retryDate;(!s||r>=s||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=State.IDLE);break}case State.WAITING_INIT_PTS:{const r=this.waitingData;if(r){const{frag:s,part:a,cache:i,complete:o}=r;if(this.initPTS[s.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=State.FRAG_LOADING;const u=i.flush(),l={frag:s,part:a,payload:u,networkDetails:null};this._handleFragmentLoadProgress(l),o&&super._handleFragmentLoadComplete(l)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${s.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const u=this.getLoadPosition(),l=BufferHelper.bufferInfo(this.mediaBuffer,u,this.config.maxBufferHole);fragmentWithinToleranceTest(l.end,this.config.maxFragLookUpTolerance,s)<0&&(this.log(`Waiting fragment cc (${s.cc}) @ ${s.start} cancelled because another fragment at ${l.end} is needed`),this.clearWaitingFragment())}}else this.state=State.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=State.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:r,trackId:s}=this,a=e.config;if(!(t!=null&&t[s])||!r&&(this.startFragRequested||!a.startFragPrefetch))return;const i=t[s],o=i.details;if(!o||o.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(o)){this.state=State.WAITING_TRACK;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const l=this.getFwdBufferInfo(u,PlaylistLevelType.AUDIO);if(l===null)return;const{bufferedTrack:c,switchingTrack:d}=this;if(!d&&this._streamEnded(l,o)){e.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,PlaylistLevelType.MAIN),g=l.len,m=this.getMaxBufferLength(f==null?void 0:f.len);if(g>=m&&!d)return;const y=o.fragments[0].start;let E=l.end;if(d&&r){const x=this.getLoadPosition();c&&d.attrs!==c.attrs&&(E=x),o.PTSKnown&&x<y&&(l.end>y||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=y+.05)}let _=this.getNextFragment(E,o),T=!1;if(_&&this.isLoopLoading(_,E)&&(T=!!_.gap,_=this.getNextFragmentLoopLoading(_,o,l,PlaylistLevelType.MAIN,m)),!_){this.bufferFlushed=!0;return}const S=f&&_.start>f.end+o.targetduration;if(S||!(f!=null&&f.len)&&l.len){const x=this.getAppendedFrag(_.start,PlaylistLevelType.MAIN);if(x===null||(T||(T=!!x.gap||!!S&&f.len===0),S&&!T||T&&l.nextStart&&l.nextStart<x.end))return}this.loadFragment(_,i,E)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Level(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?this.setInterval(TICK_INTERVAL$1):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=State.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=State.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var r;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:s}=this,{details:a,id:i}=t;if(!s){this.warn(`Audio tracks were reset while loading level ${i}`);return}this.log(`Track ${i} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const o=s[i];let u=0;if(a.live||(r=o.details)!=null&&r.live){const l=this.mainDetails;if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed||!l)return;!o.details&&a.hasProgramDateTime&&l.hasProgramDateTime?(alignMediaPlaylistByPDT(a,l),u=a.fragments[0].start):u=this.alignPlaylists(a,o.details)}o.details=a,this.levelLastLoaded=i,!this.startFragRequested&&(this.mainDetails||!a.live)&&this.setStartPosition(o.details,u),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:s,payload:a}=e,{config:i,trackId:o,levels:u}=this;if(!u){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const l=u[o];if(!l){this.warn("Audio track is undefined on fragment load progress");return}const c=l.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const d=i.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[r.cc],m=(t=r.initSegment)==null?void 0:t.data;if(g!==void 0){const y=s?s.index:-1,E=y!==-1,_=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount,a.byteLength,y,E);f.push(a,m,d,"",r,s,c.totalduration,!1,_,g)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);const{cache:v}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new ChunkCache,complete:!1};v.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=State.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&r.type===PlaylistLevelType.MAIN){var a;(a=this.videoBuffer||this.media)!=null&&a.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(r.sn!=="initSegment"){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},i)))}this.fragBufferedComplete(r,s)}onError(e,t){var r;if(t.fatal){this.state=State.ERROR;return}switch(t.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,t);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===State.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE))}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:a,chunkMeta:i}=e,o=this.getCurrentContext(i);if(!o){this.resetWhenMissingContext(i);return}const{frag:u,part:l,level:c}=o,{details:d}=c,{audio:f,text:g,id3:m,initSegment:v}=a;if(this.fragContextChanged(u)||!d){this.fragmentTracker.removeFragment(u);return}if(this.state=State.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),v!=null&&v.tracks){const y=u.initSegment||u;this._bufferInitSegment(v.tracks,y,i),s.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:r,tracks:v.tracks})}if(f){const{startPTS:y,endPTS:E,startDTS:_,endDTS:T}=f;l&&(l.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:y,endPTS:E,startDTS:_,endDTS:T}),u.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,y,E,_,T),this.bufferFragmentData(f,u,l,i)}if(m!=null&&(t=m.samples)!=null&&t.length){const y=_extends({id:r,frag:u,details:d},m);s.trigger(Events.FRAG_PARSING_METADATA,y)}if(g){const y=_extends({id:r,frag:u,details:d},g);s.trigger(Events.FRAG_PARSING_USERDATA,y)}}_bufferInitSegment(e,t,r){if(this.state!==State.PARSING)return;e.video&&delete e.video;const s=e.audio;if(!s)return;s.levelCodec=s.codec,s.id="audio",this.log(`Init audio buffer, container:${s.container}, codecs[parsed]=[${s.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,e);const a=s.initSegment;if(a!=null&&a.byteLength){const i={type:"audio",frag:t,part:null,chunkMeta:r,parent:t.type,data:a};this.hls.trigger(Events.BUFFER_APPENDING,i)}this.tick()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||s===FragmentState.NOT_LOADED||s===FragmentState.PARTIAL){var a;e.sn==="initSegment"?this._loadInitSegment(e,t):(a=t.details)!=null&&a.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,r))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:r,bufferedTrack:s}=this,a=s==null?void 0:s.attrs,i=e.attrs;r&&a&&(a.CHANNELS!==i.CHANNELS||a.NAME!==i.NAME||a.LANGUAGE!==i.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},e))}}class AudioTrackController extends BasePlaylistController{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:a}=t,i=this.tracksInGroup[r];if(!i||i.groupId!==s){this.warn(`Track with id:${r} and group:${s} not found in active group ${i.groupId}`);return}const o=i.details;i.details=t.details,this.log(`audio-track ${r} "${i.name}" lang:${i.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;const r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r||null;const s=this.tracks.filter(i=>!r||i.groupId===r);this.selectDefaultTrack&&!s.some(i=>i.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=s;const a={audioTracks:s};this.log(`Updating audio tracks, ${s.length} track(s) found in group:${r}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,a),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const r=this.currentTrack;t[this.trackId];const s=t[e],{groupId:a,name:i}=s;if(this.log(`Switching to audio-track ${e} "${i}" lang:${s.lang} group:${a}`),this.trackId=e,this.currentTrack=s,this.selectDefaultTrack=!1,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},s)),s.details&&!s.details.live)return;const o=this.switchParams(s.url,r==null?void 0:r.details);this.loadPlaylist(o)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{const r=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(r.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:r})}}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if((!this.selectDefaultTrack||s.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]!==void 0&&e.attrs["STABLE-RENDITION-ID"]===s.attrs["STABLE-RENDITION-ID"]||e.name===s.name&&e.lang===s.lang))return s.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,s=t.groupId;let a=t.url;if(e)try{a=e.addDirectives(a)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}this.log(`loading audio-track playlist ${r} "${t.name}" lang:${t.lang} group:${s}`),this.clearTimer(),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:a,id:r,groupId:s,deliveryDirectives:e||null})}}}function subtitleOptionsIdentical(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!subtitleAttributesIdentical(n[t].attrs,e[t].attrs))return!1;return!0}function subtitleAttributesIdentical(n,e){const t=n["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(r=>n[r]!==e[r])}const TICK_INTERVAL=500;class SubtitleStreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[subtitle-stream-controller]",PlaylistLevelType.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.ERROR,this.onError,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.ERROR,this.onError,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragPrevious=r,this.state=State.IDLE,!s)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let i;const o=r.start;for(let l=0;l<a.length;l++)if(o>=a[l].start&&o<=a[l].end){i=a[l];break}const u=r.start+r.duration;i?i.end=u:(i={start:o,end:u},a.push(i)),this.fragmentTracker.fragBuffered(r)}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const{currentTrackId:a,levels:i}=this;if(!i.length||!i[a]||!i[a].details)return;const u=i[a].details.targetduration,l=s-u;if(l<=0)return;t.endOffsetSubtitles=Math.max(0,l),this.tracksBuffered.forEach(c=>{for(let d=0;d<c.length;){if(c[d].end<=l){c.shift();continue}else if(c[d].start<l)c[d].start=l;else break;d++}}),this.fragmentTracker.removeFragmentsInRange(r,l,PlaylistLevelType.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===PlaylistLevelType.MAIN){var r;(r=this.media)!=null&&r.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(subtitleOptionsIdentical(this.levels,t)){this.levels=t.map(r=>new Level(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new Level(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(TICK_INTERVAL)}onSubtitleTrackLoaded(e,t){var r;const{details:s,id:a}=t,{currentTrackId:i,levels:o}=this;if(!o.length)return;const u=o[i];if(a>=o.length||a!==i||!u)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||(r=u.details)!=null&&r.live){const c=this.mainDetails;if(s.deltaUpdateFailed||!c)return;const d=c.fragments[0];u.details?(l=this.alignPlaylists(s,u.details),l===0&&d&&(l=d.start,addSliding(s,l))):s.hasProgramDateTime&&c.hasProgramDateTime?(alignMediaPlaylistByPDT(s,c),l=s.fragments[0].start):d&&(l=d.start,addSliding(s,l))}u.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(u.details,l),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),u.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s&&s.key&&s.iv&&s.method==="AES-128"){const i=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer).catch(o=>{throw a.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const u=performance.now();a.trigger(Events.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:i,tdecrypt:u}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:e,levels:t}=this,r=t[e];if(!t.length||!r||!r.details)return;const s=r.details,a=s.targetduration,{config:i}=this,o=this.getLoadPosition(),u=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o-a,i.maxBufferHole),{end:l,len:c}=u,d=this.getFwdBufferInfo(this.media,PlaylistLevelType.MAIN),f=this.getMaxBufferLength(d==null?void 0:d.len)+a;if(c>f)return;const g=s.fragments,m=g.length,v=s.edge;let y=null;const E=this.fragPrevious;if(l<v){const{maxFragLookUpTolerance:_}=i;y=findFragmentByPTS(E,g,Math.max(g[0].start,l),_),!y&&E&&E.start<g[0].start&&(y=g[0])}else y=g[m-1];if(!y)return;y=this.mapToInitFragWhenRequired(y),this.fragmentTracker.getState(y)===FragmentState.NOT_LOADED&&this.loadFragment(y,r,l)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,r){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,r))}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(e){this.buffered=void 0;const t=(r,s,a)=>{if(s=s>>>0,s>a-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${a})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}class SubtitleTrackController extends BasePlaylistController{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach(t=>{clearCurrentCues(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,details:s}=t,{trackId:a}=this,i=this.tracksInGroup[a];if(!i){this.warn(`Invalid subtitle track id ${r}`);return}const o=i.details;i.details=t.details,this.log(`subtitle track ${r} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;const r=t.textGroupIds[t.urlId],s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==r){const a=this.tracks.filter(u=>!r||u.groupId===r);this.tracksInGroup=a;const i=this.findTrackId(s==null?void 0:s.name)||this.findTrackId();this.groupId=r||null;const o={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,o),i!==-1&&this.setSubtitleTrack(i,s)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId,s)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if((!this.selectDefaultTrack||s.default)&&(!e||e===s.name))return s.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const r=t.id,s=t.groupId;let a=t.url;if(e)try{a=e.addDirectives(a)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}this.log(`Loading subtitle playlist for id ${r}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:a,id:r,groupId:s,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:r}=this;if(!t)return;const s=filterSubtitleTracks(t.textTracks),a=s.filter(o=>o.groupId===this.groupId);if(e===-1)[].slice.call(s).forEach(o=>{o.mode="disabled"});else{const o=a[r];o&&(o.mode="disabled")}const i=a[e];i&&(i.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var r;const s=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(r=s[e])!=null&&r.details)||e<-1||e>=s.length)return;this.clearTimer();const a=s[e];if(this.log(`Switching to subtitle-track ${e}`+(a?` "${a.name}" lang:${a.lang} group:${a.groupId}`:"")),this.trackId=e,a){const{id:i,groupId:o="",name:u,type:l,url:c}=a;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:i,groupId:o,name:u,type:l,url:c});const d=this.switchParams(a.url,t==null?void 0:t.details);this.loadPlaylist(d)}else this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=filterSubtitleTracks(this.media.textTracks);for(let r=0;r<t.length;r++)if(t[r].mode==="hidden")e=r;else if(t[r].mode==="showing"){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}function filterSubtitleTracks(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class BufferOperationQueue{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const r=this.queues[t];r.push(e),r.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const r=new Promise(a=>{t=a}),s={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(s,e),r}executeNext(e){const{buffers:t,queues:r}=this,s=t[e],a=r[e];if(a.length){const i=a[0];try{i.execute()}catch(o){logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),i.onError(o),s!=null&&s.updating||(a.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const MediaSource=getMediaSource(),VIDEO_CODEC_PROFILE_REPACE=/([ha]vc.)(?:\.[^.,]+)+/;class BufferController{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:r}=this;logger.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:t})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:r}=this;t&&t.src!==r&&logger.error(`Media element src was set while attaching MediaSource (${r} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.BUFFER_EOS,this.onBufferEos,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.FRAG_PARSED,this.onFragParsed,this),e.on(Events.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.BUFFER_EOS,this.onBufferEos,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.FRAG_PARSED,this.onFragParsed,this),e.off(Events.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new BufferOperationQueue(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,logger.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const r=this.media=t.media;if(r&&MediaSource){const s=this.mediaSource=new MediaSource;s.addEventListener("sourceopen",this._onMediaSourceOpen),s.addEventListener("sourceended",this._onMediaSourceEnded),s.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(s),this._objectUrl=r.src,r.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:r}=this;if(t){if(logger.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(s){logger.warn(`[buffer-controller]: onMediaDetaching: ${s.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),e.src===r?(e.removeAttribute("src"),e.load()):logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Events.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(r){logger.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,r)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const r=this.getSourceBufferTypes().length;Object.keys(t).forEach(s=>{if(r){const a=this.tracks[s];if(a&&typeof a.buffer.changeType=="function"){const{id:i,codec:o,levelCodec:u,container:l,metadata:c}=t[s],d=(a.levelCodec||a.codec).replace(VIDEO_CODEC_PROFILE_REPACE,"$1"),f=(u||o).replace(VIDEO_CODEC_PROFILE_REPACE,"$1");if(d!==f){const g=`${l};codecs=${u||o}`;this.appendChangeType(s,g),logger.log(`[buffer-controller]: switching codec ${d} to ${f}`),this.tracks[s]={buffer:a.buffer,codec:o,container:l,levelCodec:u,metadata:c,id:i}}}}else this.pendingTracks[s]=t[s]}),!r&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:r}=this,s={execute:()=>{const a=this.sourceBuffer[e];a&&(logger.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),a.changeType(t)),r.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{logger.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,a)}};r.append(s,e)}onBufferAppending(e,t){const{hls:r,operationQueue:s,tracks:a}=this,{data:i,type:o,frag:u,part:l,chunkMeta:c}=t,d=c.buffering[o],f=self.performance.now();d.start=f;const g=u.stats.buffering,m=l?l.stats.buffering:null;g.start===0&&(g.start=f),m&&m.start===0&&(m.start=f);const v=a.audio;let y=!1;o==="audio"&&(v==null?void 0:v.container)==="audio/mpeg"&&(y=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const E=u.start,_={execute:()=>{if(d.executeStart=self.performance.now(),y){const T=this.sourceBuffer[o];if(T){const S=E-T.timestampOffset;Math.abs(S)>=.1&&(logger.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${E} (delta: ${S}) sn: ${u.sn})`),T.timestampOffset=E)}}this.appendExecutor(i,o)},onStart:()=>{},onComplete:()=>{const T=self.performance.now();d.executeEnd=d.end=T,g.first===0&&(g.first=T),m&&m.first===0&&(m.first=T);const{sourceBuffer:S}=this,x={};for(const b in S)x[b]=BufferHelper.getBuffered(S[b]);this.appendError=0,this.hls.trigger(Events.BUFFER_APPENDED,{type:o,frag:u,part:l,chunkMeta:c,parent:u.type,timeRanges:x})},onError:T=>{logger.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,T);const S={type:ErrorTypes.MEDIA_ERROR,parent:u.type,details:ErrorDetails.BUFFER_APPEND_ERROR,frag:u,part:l,chunkMeta:c,error:T,err:T,fatal:!1};T.code===DOMException.QUOTA_EXCEEDED_ERR?S.details=ErrorDetails.BUFFER_FULL_ERROR:(this.appendError++,S.details=ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>r.config.appendErrorMaxRetry&&(logger.error(`[buffer-controller]: Failed ${r.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),S.fatal=!0)),r.trigger(Events.ERROR,S)}};s.append(_,o)}onBufferFlushing(e,t){const{operationQueue:r}=this,s=a=>({execute:this.removeExecutor.bind(this,a,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:a})},onError:i=>{logger.warn(`[buffer-controller]: Failed to remove from ${a} SourceBuffer`,i)}});t.type?r.append(s(t.type),t.type):this.getSourceBufferTypes().forEach(a=>{r.append(s(a),a)})}onFragParsed(e,t){const{frag:r,part:s}=t,a=[],i=s?s.elementaryStreams:r.elementaryStreams;i[ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(i[ElementaryStreamTypes.AUDIO]&&a.push("audio"),i[ElementaryStreamTypes.VIDEO]&&a.push("video"));const o=()=>{const u=self.performance.now();r.stats.buffering.end=u,s&&(s.stats.buffering.end=u);const l=s?s.stats:r.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:r,part:s,stats:l,id:r.type})};a.length===0&&logger.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(o,a)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((s,a)=>{const i=this.sourceBuffer[a];return i&&(!t.type||t.type===a)&&(i.ending=!0,i.ended||(i.ended=!0,logger.log(`[buffer-controller]: ${a} sourceBuffer now EOS`))),s&&!!(!i||i.ended)},!0)&&(logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(a=>{const i=this.sourceBuffer[a];i&&(i.ending=!1)});const{mediaSource:s}=this;if(!s||s.readyState!=="open"){s&&logger.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${s.readyState}`);return}logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),s.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:r,sourceBuffer:s}=this;if(!r||t===null)return;const a=this.getSourceBufferTypes();if(!a.length)return;const i=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!isFiniteNumber(i)||i<0)return;const o=r.currentTime,u=t.levelTargetDuration,l=Math.max(i,u),c=Math.floor(o/u)*u-l;a.forEach(d=>{const f=s[d];if(f){const g=BufferHelper.getBuffered(f);if(g.length>0&&c>g.start(0)){if(e.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:c}),t.live)e.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:c});else if(f.ended&&g.end(g.length-1)-o<u*2){logger.info(`[buffer-controller]: Cannot flush ${d} back buffer while SourceBuffer is in ended state`);return}e.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:c,type:d})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:r,mediaSource:s}=this,a=e.fragments[0].start+e.totalduration,i=r.duration,o=isFiniteNumber(s.duration)?s.duration:0;e.live&&t.config.liveDurationInfinity?(logger.log("[buffer-controller]: Media Source duration is set to Infinity"),s.duration=1/0,this.updateSeekableRange(e)):(a>o&&a>i||!isFiniteNumber(i))&&(logger.log(`[buffer-controller]: Updating Media Source duration to ${a.toFixed(3)}`),s.duration=a)}updateSeekableRange(e){const t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&t!=null&&t.setLiveSeekableRange){const a=Math.max(0,r[0].start),i=Math.max(a,a+e.totalduration);t.setLiveSeekableRange(a,i)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:r}=this,s=Object.keys(r).length;if(s&&!e||s===2){this.createSourceBuffers(r),this.pendingTracks={};const a=this.getSourceBufferTypes();if(a.length)this.hls.trigger(Events.BUFFER_CREATED,{tracks:this.tracks}),a.forEach(i=>{t.executeNext(i)});else{const i=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:i,reason:i.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){const a=e[s];if(!a)throw Error(`source buffer exists for track ${s}, however track does not`);const i=a.levelCodec||a.codec,o=`${a.container};codecs=${i}`;logger.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{const u=t[s]=r.addSourceBuffer(o),l=s;this.addBufferListener(l,"updatestart",this._onSBUpdateStart),this.addBufferListener(l,"updateend",this._onSBUpdateEnd),this.addBufferListener(l,"error",this._onSBUpdateError),this.tracks[s]={buffer:u,codec:i,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id}}catch(u){logger.error(`[buffer-controller]: error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,mimeType:o})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const r=new Error(`${e} SourceBuffer error`);logger.error(`[buffer-controller]: ${r}`,t),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,error:r,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(t)}removeExecutor(e,t,r){const{media:s,mediaSource:a,operationQueue:i,sourceBuffer:o}=this,u=o[e];if(!s||!a||!u){logger.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),i.shiftAndExecuteNext(e);return}const l=isFiniteNumber(s.duration)?s.duration:1/0,c=isFiniteNumber(a.duration)?a.duration:1/0,d=Math.max(0,t),f=Math.min(r,l,c);f>d&&!u.ending?(u.ended=!1,logger.log(`[buffer-controller]: Removing [${d},${f}] from the ${e} SourceBuffer`),u.remove(d,f)):i.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:r,sourceBuffer:s}=this,a=s[t];if(!a){logger.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),r.shiftAndExecuteNext(t);return}a.ended=!1,a.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:r}=this,s=t.map(a=>r.appendBlocker(a));Promise.all(s).then(()=>{e(),t.forEach(a=>{const i=this.sourceBuffer[a];i!=null&&i.updating||r.shiftAndExecuteNext(a)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,r){const s=this.sourceBuffer[e];if(!s)return;const a=r.bind(this,e);this.listeners[e].push({event:t,listener:a}),s.addEventListener(t,a)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(r=>{t.removeEventListener(r.event,r.listener)})}}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=function n(e){let t=e;return specialCea608CharsCodes.hasOwnProperty(e)&&(t=specialCea608CharsCodes[e]),String.fromCharCode(t)},NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;logger.log(`${this.time} [${e}] ${r}`)}}}const numArrayToHexArray=function n(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class PenState{constructor(e,t,r,s,a){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=s||"black",this.flash=a||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(e,t,r,s,a,i){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new PenState(t,r,s,a,i)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<NR_COLS;t++)this.chars.push(new StyledUnicodeChar);this.logger=e,this.pos=0,this.currPenState=new PenState}equals(e){let t=!0;for(let r=0;r<NR_COLS;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t}copy(e){for(let t=0;t<NR_COLS;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<NR_COLS;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=getCharForByte(e);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<NR_COLS;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<NR_COLS;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<NR_ROWS;t++)this.rows.push(new Row(e));this.logger=e,this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<NR_ROWS;e++)this.rows[e].clear();this.currRow=NR_ROWS-1}equals(e){let t=!0;for(let r=0;r<NR_ROWS;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<NR_ROWS;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<NR_ROWS;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<NR_ROWS;o++)this.rows[o].clear();const a=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){const o=i.rows[a].cueStartTime,u=this.logger.time;if(o&&u!==null&&o<u)for(let l=0;l<this.nrRollUpRows;l++)this.rows[t-this.nrRollUpRows+l+1].copy(i.rows[a+l])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,i=Math.max(a-1,0);r.setCursor(e.indent),e.color=r.chars[i].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let a=0;a<NR_ROWS;a++){const i=this.rows[a].getTextString();i&&(s=a+1,e?t.push("Row "+s+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(r),this.nonDisplayedMemory=new CaptionScreen(r),this.lastOutputScreen=new CaptionScreen(r),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Cea608Parser{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const s=new CaptionsLogger;this.channels=[null,new Cea608Channel(e,t,s),new Cea608Channel(e+1,r,s)],this.cmdHistory=createCmdHistory(),this.logger=s}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let r,s,a,i=!1;this.logger.time=e;for(let o=0;o<t.length;o+=2)if(s=t[o]&127,a=t[o+1]&127,!(s===0&&a===0)){if(this.logger.log(3,"["+numArrayToHexArray([t[o],t[o+1]])+"] -> ("+numArrayToHexArray([s,a])+")"),r=this.parseCmd(s,a),r||(r=this.parseMidrow(s,a)),r||(r=this.parsePAC(s,a)),r||(r=this.parseBackgroundAttributes(s,a)),!r&&(i=this.parseChars(s,a),i)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(i):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!r&&!i&&this.logger.log(2,"Couldn't parse cleaned data "+numArrayToHexArray([s,a])+" orig: "+numArrayToHexArray([t[o],t[o+1]]))}}parseCmd(e,t){const{cmdHistory:r}=this,s=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,a=(e===23||e===31)&&t>=33&&t<=35;if(!(s||a))return!1;if(hasCmdRepeated(e,t,r))return setLastCmd(null,null,r),this.logger.log(3,"Repeated command ("+numArrayToHexArray([e,t])+") is dropped"),!0;const i=e===20||e===21||e===23?1:2,o=this.channels[i];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),setLastCmd(e,t,r),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,"MIDROW ("+numArrayToHexArray([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=this.cmdHistory,a=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(a||i))return!1;if(hasCmdRepeated(e,t,s))return setLastCmd(null,null,s),!0;const o=e<=23?1:2;t>=64&&t<=95?r=o===1?rowsLowCh1[e]:rowsLowCh2[e]:r=o===1?rowsHighCh1[e]:rowsHighCh2[e];const u=this.channels[o];return u?(u.setPAC(this.interpretPAC(r,t)),setLastCmd(e,t,s),this.currentChannel=o,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19){let i;a===17?i=t+80:a===18?i=t+112:i=t+144,this.logger.log(2,"Special char '"+getCharForByte(i)+"' in channel "+r),s=[i]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);if(s){const i=numArrayToHexArray(s);this.logger.log(3,"Char codes =  "+i.join(",")),setLastCmd(e,t,this.cmdHistory)}return s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let a;const i={};e===16||e===24?(a=Math.floor((t-32)/2),i.background=backgroundColors[a],t%2===1&&(i.background=i.background+"_semi")):t===45?i.background="transparent":(i.foreground="black",t===47&&(i.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(i),setLastCmd(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=createCmdHistory()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function setLastCmd(n,e,t){t.a=n,t.b=e}function hasCmdRepeated(n,e,t){return t.a===n&&t.b===e}function createCmdHistory(){return{a:null,b:null}}class OutputFilter{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var VTTCue=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,u){if(typeof u!="string"||!Array.isArray(o))return!1;const l=u.toLowerCase();return~o.indexOf(l)?l:!1}function r(o){return t(n,o)}function s(o){return t(e,o)}function a(o,...u){let l=1;for(;l<arguments.length;l++){const c=arguments[l];for(const d in c)o[d]=c[d]}return o}function i(o,u,l){const c=this,d={enumerable:!0};c.hasBeenReset=!1;let f="",g=!1,m=o,v=u,y=l,E=null,_="",T=!0,S="auto",x="start",b=50,A="middle",R=50,C="middle";Object.defineProperty(c,"id",a({},d,{get:function(){return f},set:function(w){f=""+w}})),Object.defineProperty(c,"pauseOnExit",a({},d,{get:function(){return g},set:function(w){g=!!w}})),Object.defineProperty(c,"startTime",a({},d,{get:function(){return m},set:function(w){if(typeof w!="number")throw new TypeError("Start time must be set to a number.");m=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",a({},d,{get:function(){return v},set:function(w){if(typeof w!="number")throw new TypeError("End time must be set to a number.");v=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",a({},d,{get:function(){return y},set:function(w){y=""+w,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",a({},d,{get:function(){return E},set:function(w){E=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",a({},d,{get:function(){return _},set:function(w){const I=r(w);if(I===!1)throw new SyntaxError("An invalid or illegal string was specified.");_=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",a({},d,{get:function(){return T},set:function(w){T=!!w,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",a({},d,{get:function(){return S},set:function(w){if(typeof w!="number"&&w!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");S=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",a({},d,{get:function(){return x},set:function(w){const I=s(w);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");x=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",a({},d,{get:function(){return b},set:function(w){if(w<0||w>100)throw new Error("Position must be between 0 and 100.");b=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",a({},d,{get:function(){return A},set:function(w){const I=s(w);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");A=I,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",a({},d,{get:function(){return R},set:function(w){if(w<0||w>100)throw new Error("Size must be between 0 and 100.");R=w,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",a({},d,{get:function(){return C},set:function(w){const I=s(w);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");C=I,this.hasBeenReset=!0}})),c.displayState=void 0}return i.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},i}();class StringDecoder{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function parseTimeStamp(n){function e(r,s,a,i){return(r|0)*3600+(s|0)*60+(a|0)+parseFloat(i||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function parseOptions(n,e,t,r){const s=r?n.split(r):[n];for(const a in s){if(typeof s[a]!="string")continue;const i=s[a].split(t);if(i.length!==2)continue;const o=i[0],u=i[1];e(o,u)}}const defaults=new VTTCue(0,0,""),center=defaults.align==="middle"?"middle":"center";function parseCue(n,e,t){const r=n;function s(){const o=parseTimeStamp(n);if(o===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),o}function a(o,u){const l=new Settings;parseOptions(o,function(f,g){let m;switch(f){case"region":for(let v=t.length-1;v>=0;v--)if(t[v].id===g){l.set(f,t[v].region);break}break;case"vertical":l.alt(f,g,["rl","lr"]);break;case"line":m=g.split(","),l.integer(f,m[0]),l.percent(f,m[0])&&l.set("snapToLines",!1),l.alt(f,m[0],["auto"]),m.length===2&&l.alt("lineAlign",m[1],["start",center,"end"]);break;case"position":m=g.split(","),l.percent(f,m[0]),m.length===2&&l.alt("positionAlign",m[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":l.percent(f,g);break;case"align":l.alt(f,g,["start",center,"end","left","right"]);break}},/:/,/\s/),u.region=l.get("region",null),u.vertical=l.get("vertical","");let c=l.get("line","auto");c==="auto"&&defaults.line===-1&&(c=-1),u.line=c,u.lineAlign=l.get("lineAlign","start"),u.snapToLines=l.get("snapToLines",!0),u.size=l.get("size",100),u.align=l.get("align",center);let d=l.get("position","auto");d==="auto"&&defaults.position===50&&(d=u.align==="start"||u.align==="left"?0:u.align==="end"||u.align==="right"?100:50),u.position=d}function i(){n=n.replace(/^\s+/,"")}if(i(),e.startTime=s(),i(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),i(),e.endTime=s(),i(),a(n,e)}function fixLineBreaks(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let a=t.buffer,i=0;for(a=fixLineBreaks(a);i<a.length&&a[i]!=="\r"&&a[i]!==`
`;)++i;const o=a.slice(0,i);return a[i]==="\r"&&++i,a[i]===`
`&&++i,t.buffer=a.slice(i),o}function s(a){parseOptions(a,function(i,o){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=r();const o=a.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let i=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:a=r(),t.state){case"HEADER":/:/.test(a)?s(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{parseCue(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=a.indexOf("-->")!==-1;if(!a||o&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function n(e,t,r=0){return e.slice(r,r+t.length)===t},cueString2millis=function n(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!isFiniteNumber(t)||!isFiniteNumber(r)||!isFiniteNumber(s)||!isFiniteNumber(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=60*60*1e3*a,t},hash=function n(e){let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return(t>>>0).toString()};function generateCueId(n,e,t){return hash(n.toString())+hash(e.toString())+hash(t)}const calculateOffset=function n(e,t,r){let s=e[t],a=e[s.prevCC];if(!a||!a.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(i=a)!=null&&i.new;){var i;e.ccOffset+=s.start-a.start,s.new=!1,s=a,a=e[s.prevCC]}e.presentationOffset=r};function parseWebVTT(n,e,t,r,s,a,i){const o=new VTTParser,u=utf8ArrayToStr(new Uint8Array(n)).trim().replace(LINEBREAKS,`
`).split(`
`),l=[],c=toMpegTsClockFromTimescale(e.baseTime,e.timescale);let d="00:00.000",f=0,g=0,m,v=!0;o.oncue=function(y){const E=t[r];let _=t.ccOffset;const T=(f-c)/9e4;E!=null&&E.new&&(g!==void 0?_=t.ccOffset=E.start:calculateOffset(t,r,T)),T&&(_=T-t.presentationOffset);const S=y.endTime-y.startTime,x=normalizePts((y.startTime+_-g)*9e4,s*9e4)/9e4;y.startTime=Math.max(x,0),y.endTime=Math.max(x+S,0);const b=y.text.trim();y.text=decodeURIComponent(encodeURIComponent(b)),y.id||(y.id=generateCueId(y.startTime,y.endTime,b)),y.endTime>0&&l.push(y)},o.onparsingerror=function(y){m=y},o.onflush=function(){if(m){i(m);return}a(l)},u.forEach(y=>{if(v)if(startsWith(y,"X-TIMESTAMP-MAP=")){v=!1,y.slice(16).split(",").forEach(E=>{startsWith(E,"LOCAL:")?d=E.slice(6):startsWith(E,"MPEGTS:")&&(f=parseInt(E.slice(7)))});try{g=cueString2millis(d)/1e3}catch(E){m=E}return}else y===""&&(v=!1);o.parse(y+`
`)}),o.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(n,e,t,r){const s=findBox(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const a=s.map(o=>utf8ArrayToStr(o)),i=toTimescaleFromScale(e.baseTime,1,e.timescale);try{a.forEach(o=>t(parseTTML(o,i)))}catch(o){r(o)}}function parseTTML(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(a).reduce((d,f)=>(d[f]=s.getAttribute(`ttp:${f}`)||a[f],d),{}),o=s.getAttribute("xml:space")!=="preserve",u=collectionToDictionary(getElementCollection(s,"styling","style")),l=collectionToDictionary(getElementCollection(s,"layout","region")),c=getElementCollection(s,"body","[begin]");return[].map.call(c,d=>{const f=getTextContent(d,o);if(!f||!d.hasAttribute("begin"))return null;const g=parseTtmlTime(d.getAttribute("begin"),i),m=parseTtmlTime(d.getAttribute("dur"),i);let v=parseTtmlTime(d.getAttribute("end"),i);if(g===null)throw timestampParsingError(d);if(v===null){if(m===null)throw timestampParsingError(d);v=g+m}const y=new VTTCue(g-e,v-e,f);y.id=generateCueId(y.startTime,y.endTime,y.text);const E=l[d.getAttribute("region")],_=u[d.getAttribute("style")],T=getTtmlStyles(E,_,u),{textAlign:S}=T;if(S){const x=textAlignToLineAlign[S];x&&(y.lineAlign=x),y.align=S}return _extends(y,T),y}).filter(d=>d!==null)}function getElementCollection(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function collectionToDictionary(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function getTextContent(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var a;return r.nodeName==="br"&&s?t+`
`:(a=r.childNodes)!=null&&a.length?getTextContent(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function getTtmlStyles(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],i=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return i&&t.hasOwnProperty(i)&&(s=t[i]),a.reduce((o,u)=>{const l=getAttributeNS(e,r,u)||getAttributeNS(n,r,u)||getAttributeNS(s,r,u);return l&&(o[u]=l),o},{})}function getAttributeNS(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function timestampParsingError(n){return new Error(`Could not parse ttml timestamp ${n}`)}function parseTtmlTime(n,e){if(!n)return null;let t=parseTimeStamp(n);return t===null&&(HMSF_REGEX.test(n)?t=parseHoursMinutesSecondsFrames(n,e):TIME_UNIT_REGEX.test(n)&&(t=parseTimeUnits(n,e))),t}function parseHoursMinutesSecondsFrames(n,e){const t=HMSF_REGEX.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function parseTimeUnits(n,e){const t=TIME_UNIT_REGEX.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class TimelineController{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new OutputFilter(this,"textTrack1"),r=new OutputFilter(this,"textTrack2"),s=new OutputFilter(this,"textTrack3"),a=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,t,r),this.cea608Parser2=new Cea608Parser(3,s,a)}e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,r,s,a){let i=!1;for(let o=a.length;o--;){const u=a[o],l=intersection(u[0],u[1],t,r);if(l>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),i=!0,l/(r-t)>.5))return}if(i||a.push([t,r]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,r,s)}else{const o=this.Cues.newCue(null,t,r,s);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:a}){const{unparsedVttFrags:i}=this;r==="main"&&(this.initPTS[t.cc]={baseTime:s,timescale:a}),i.length&&(this.unparsedVttFrags=[],i.forEach(o=>{this.onFragLoaded(Events.FRAG_LOADED,o)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let r=0;r<t.textTracks.length;r++){const s=t.textTracks[r];if(s[e])return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:a,languageCode:i}=t[e],o=this.getExistingTrack(e);if(o)r[e]=o,clearCurrentCues(r[e]),sendAddTrackEvent(r[e],s);else{const u=this.createTextTrack("captions",a,i);u&&(u[e]=!0,r[e]=u)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{clearCurrentCues(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)clearCurrentCues(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(a=>a.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const i=this.media?this.media.textTracks:null;this.tracks.forEach((o,u)=>{let l;if(i&&u<i.length){let c=null;for(let d=0;d<i.length;d++)if(canReuseVttTextTrack(i[d],o)){c=i[d];break}c&&(l=c)}if(l)clearCurrentCues(l);else{const c=this._captionsOrSubtitlesFromCharacteristics(o);l=this.createTextTrack(c,o.name,o.lang),l&&(l.mode="disabled")}l&&(l.groupId=o.groupId,this.textTracks.push(l))})}else if(this.tracks.length){const i=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:i})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),r=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&r)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const a=`textTrack${s[1]}`,i=this.captionsProperties[a];i&&(i.label=r.name,r.lang&&(i.languageCode=r.lang),i.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:r,cea608Parser2:s,lastSn:a,lastPartIndex:i}=this;if(!(!this.enabled||!(r&&s))&&t.frag.type===PlaylistLevelType.MAIN){var o,u;const l=t.frag.sn,c=(o=t==null||(u=t.part)==null?void 0:u.index)!=null?o:-1;l===a+1||l===a&&c===i+1||(r.reset(),s.reset()),this.lastSn=l,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:r,payload:s}=t,{initPTS:a,unparsedVttFrags:i}=this;if(r.type===PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!a[r.cc]){i.push(t),a.length&&this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Missing initial subtitle PTS")});return}const o=r.decryptdata,u="stats"in t;if(o==null||!o.encrypted||u){const l=this.tracks[r.level],c=this.vttCCs;c[r.cc]||(c[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===IMSC1_CODEC?this._parseIMSC1(r,s):this._parseVTTs(r,s,c)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;parseIMSC1(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e,t,r){var s;const a=this.hls,i=(s=e.initSegment)!=null&&s.data?appendUint8Array(e.initSegment.data,new Uint8Array(t)):t;parseWebVTT(i,this.initPTS[e.cc],r,e.cc,e.start,o=>{this._appendCues(o,e.level),a.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{this._fallbackToIMSC1(e,t),logger.log(`Failed to parse VTT cue: ${o}`),a.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||parseIMSC1(t,this.initPTS[e.cc],()=>{r.textCodec=IMSC1_CODEC,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(a=>addCueToTrack(s,a))}else{const s=this.tracks[t];if(!s)return;const a=s.default?"default":"subtitles"+t;r.trigger(Events.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:r}=t;if(r.type===PlaylistLevelType.SUBTITLE){if(!this.initPTS[r.cc]){this.unparsedVttFrags.push(t);return}this.onFragLoaded(Events.FRAG_LOADED,t)}}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:r,cea608Parser2:s}=this;if(!this.enabled||!(r&&s))return;const{frag:a,samples:i}=t;if(!(a.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(a)==="NONE"))for(let o=0;o<i.length;o++){const u=i[o].bytes;if(u){const l=this.extractCea608Data(u);r.addData(i[o].pts,l[0]),s.addData(i[o].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:a}){const{media:i}=this;if(!(!i||i.currentTime<r)){if(!a||a==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(u=>removeCuesInRange(o[u],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(u=>removeCuesInRange(o[u],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let a=0;a<r;a++){const i=e[s++],o=127&e[s++],u=127&e[s++];if(o===0&&u===0)continue;if((4&i)!==0){const c=3&i;(c===0||c===1)&&(t[c].push(o),t[c].push(u))}}return t}}function canReuseVttTextTrack(n,e){return!!n&&n.label===e.name&&!(n.textTrack1||n.textTrack2)}function intersection(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class CapLevelController{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,a)=>this.isLevelAllowed(s)&&a<=e);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(i,o)=>o?i.width!==o.width||i.height!==o.height:!0;let a=e.length-1;for(let i=0;i<e.length;i+=1){const o=e[i];if((o.width>=t||o.height>=r)&&s(o,e[i+1])){a=i;break}}return a}}class FPSController{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const a=s-this.lastTime,i=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,u=1e3*i/a,l=this.hls;if(l.trigger(Events.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:r}),u>0&&i>l.config.fpsDroppedMonitoringThreshold*o){let c=l.currentLevel;logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=c)&&(c=c-1,l.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const LOGGER_PREFIX="[eme]";class EMEController{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=logger.debug.bind(logger,LOGGER_PREFIX),this.log=logger.log.bind(logger,LOGGER_PREFIX),this.warn=logger.warn.bind(logger,LOGGER_PREFIX),this.error=logger.error.bind(logger,LOGGER_PREFIX),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t[e];if(s)return s.licenseUrl;if(e===KeySystems.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(i,o,u)=>!!i&&u.indexOf(i)===o,s=t.map(i=>i.audioCodec).filter(r),a=t.map(i=>i.videoCodec).filter(r);return s.length+a.length===0&&a.push("avc1.42e01e"),new Promise((i,o)=>{const u=l=>{const c=l.shift();this.getMediaKeysPromise(c,s,a).then(d=>i({keySystem:c,mediaKeys:d})).catch(d=>{l.length?u(l):d instanceof EMEKeyError?o(d):o(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};u(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){const s=getSupportedMediaKeySystemConfigurations(e,t,r,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e];let i=a==null?void 0:a.keySystemAccess;if(!i){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(s)}`),i=this.requestMediaKeySystemAccess(e,s);const o=this.keySystemAccessPromises[e]={keySystemAccess:i};return i.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),i.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const l=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=u.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),l.then(d=>d?this.setMediaKeysServerCertificate(c,e,d):c))),o.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),o.mediaKeys})}return i.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Hex.hexDump(e.keyId||[])}`);const s=r.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),a="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,a,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Hex.hexDump(e.keyId)}updateKeySession(e,t){var r;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Hex.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),s.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,r)=>{const s=getKeySystemsForConfig(this.config),a=e.map(keySystemFormatToKeySystemDomain).filter(i=>!!i&&s.indexOf(i)!==-1);return this.getKeySystemSelectionPromise(a).then(({keySystem:i})=>{const o=keySystemDomainToKeySystemFormat(i);o?t(o):r(new Error(`Unable to find format for key-system "${i}"`))}).catch(r)})}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),s=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let a=this.keyIdToKeySessionPromise[r];return a||(a=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(t).then(({keySystem:i,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(i,o).then(()=>{this.throwIfDestroyed();const u=this.createMediaKeySessionContext({keySystem:i,mediaKeys:o,decryptdata:t}),l="cenc";return this.generateRequestWithPreferredKeySession(u,l,t.pssh,"playlist-key")}))),a.catch(i=>this.handleError(i))),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof EMEKeyError?this.hls.trigger(Events.ERROR,e.data):this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=keySystemFormatToKeySystemDomain(e.keyFormat),a=s?[s]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(a)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=getKeySystemsForConfig(this.config)),e.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:r}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),r===null)return;let s,a;if(t==="sinf"&&this.config.drmSystems[KeySystems.FAIRPLAY]){const c=bin2str(new Uint8Array(r));try{const d=base64Decode(JSON.parse(c).sinf),f=parseSinf(new Uint8Array(d));if(!f)return;s=f.subarray(8,24),a=KeySystems.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const c=parsePssh(r);if(c===null)return;c.version===0&&c.systemId===KeySystemIds.WIDEVINE&&c.data&&(s=c.data.subarray(8,24)),a=keySystemIdToKeySystemDomain(c.systemId)}if(!a||!s)return;const i=Hex.hexDump(s),{keyIdToKeySessionPromise:o,mediaKeySessions:u}=this;let l=o[i];for(let c=0;c<u.length;c++){const d=u[c],f=d.decryptdata;if(f.pssh||!f.keyId)continue;const g=Hex.hexDump(f.keyId);if(i===g||f.uri.replace(/-/g,"").indexOf(i)!==-1){l=o[g],delete o[g],f.pssh=new Uint8Array(r),f.keyId=s,l=o[i]=l.then(()=>this.generateRequestWithPreferredKeySession(d,t,r,"encrypted-event-key-match"));break}}l||(l=o[i]=this.getKeySystemSelectionPromise([a]).then(({keySystem:c,mediaKeys:d})=>{var f;this.throwIfDestroyed();const g=new LevelKey("ISO-23001-7",i,(f=keySystemDomainToKeySystemFormat(c))!=null?f:"");return g.pssh=new Uint8Array(r),g.keyId=s,this.attemptSetMediaKeys(c,d).then(()=>{this.throwIfDestroyed();const m=this.createMediaKeySessionContext({decryptdata:g,keySystem:c,mediaKeys:d});return this.generateRequestWithPreferredKeySession(m,t,r,"encrypted-event-no-match")})})),l.catch(c=>this.handleError(c))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>r.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var a,i;const o=(a=this.config.drmSystems)==null||(i=a[e.keySystem])==null?void 0:i.generateRequest;if(o)try{const f=o.call(this.hls,t,r,e);if(!f)throw new Error("Invalid response from configured generateRequest filter");t=f.initDataType,r=e.decryptdata.pssh=f.initData?new Uint8Array(f.initData):null}catch(f){var u;if(this.warn(f.message),(u=this.hls)!=null&&u.config.debug)throw f}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${l} (init data type: ${t} length: ${r?r.byteLength:null})`);const c=new EventEmitter;e.mediaKeysSession.onmessage=f=>{const g=e.mediaKeysSession;if(!g){c.emit("error",new Error("invalid state"));return}const{messageType:m,message:v}=f;this.log(`"${m}" message event for session "${g.sessionId}" message size: ${v.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,v).catch(y=>{this.handleError(y),c.emit("error",y)}):m==="license-release"?e.keySystem===KeySystems.FAIRPLAY&&(this.updateKeySession(e,strToUtf8array("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},e.mediaKeysSession.onkeystatuseschange=f=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const m=e.keyStatus;c.emit("keyStatus",m),m==="expired"&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};const d=new Promise((f,g)=>{c.on("error",g),c.on("keyStatus",m=>{m.startsWith("usable")?f():m==="output-restricted"?g(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?g(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?g(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var f;this.log(`Request generated for key-session "${(f=e.mediaKeysSession)==null?void 0:f.sessionId}" keyId: ${l}`)}).catch(f=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:f,fatal:!1},`Error generating key-session request: ${f}`)}).then(()=>d).catch(f=>{throw c.removeAllListeners(),this.removeSession(e),f}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Hex.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${Hex.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((i,o)=>{const u={responseType:"arraybuffer",url:a},l=t.certLoadPolicy.default,c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,g,m,v)=>{i(f.data)},onError:(f,g,m,v)=>{o(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:_objectSpread2({url:u.url,data:void 0},f)},`"${e}" certificate request failed (${a}). Status: ${f.code} (${f.text})`))},onTimeout:(f,g,m)=>{o(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(f,g,m)=>{o(new Error("aborted"))}};s.load(u,c,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,a)=>{e.setServerCertificate(r).then(i=>{this.log(`setServerCertificate ${i?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),s(e)}).catch(i=>{a(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:i,fatal:!0},i.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}setupLicenseXHR(e,t,r,s){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,r,s)}).catch(i=>{if(!r.decryptdata)throw i;return e.open("POST",t,!0),a.call(this.hls,e,t,r,s)}).then(i=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:i||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,a)=>{const i=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${i}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let u=o.response;this.log(`License received ${u instanceof ArrayBuffer?u.byteLength:u}`);const l=this.config.licenseResponseCallback;if(l)try{u=l.call(this.hls,o,i,e)}catch(c){this.error(c)}s(u)}else{const u=r.errorRetry,l=u?u.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||o.status>=400&&o.status<500)a(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:i,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${i}). Status: ${o.status} (${o.statusText})`));else{const c=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(s,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,i,e,t).then(({xhr:u,licenseChallenge:l})=>{u.send(l)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},LevelKey.clearKeyUriToKeyIdMap();const r=t.length;EMEController.CDMCleanupPromise=Promise.all(t.map(s=>this.removeSession(s)).concat(e==null?void 0:e.setMediaKeys(null).catch(s=>{this.log(`Could not clear media keys: ${s}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,a)=>(s.indexOf(a.keyFormat)===-1&&s.push(a.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);return s>-1&&this.mediaKeySessions.splice(s,1),t.remove().catch(a=>{this.log(`Could not remove session: ${a}`)}).then(()=>t.close()).catch(a=>{this.log(`Could not close session: ${a}`)})}}}EMEController.CDMCleanupPromise=void 0;class EMEKeyError extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}const CMCDVersion=1;var CMCDObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const CMCDStreamingFormatHLS="h";class CMCDController{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:CMCDObjectType.MANIFEST,su:!this.initialized})}catch(a){logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=s=>{try{const a=s.frag,i=this.hls.levels[a.level],o=this.getObjectType(a),u={d:a.duration*1e3,ot:o};(o===CMCDObjectType.VIDEO||o===CMCDObjectType.AUDIO||o==CMCDObjectType.MUXED)&&(u.br=i.bitrate/1e3,u.tb=this.getTopBandwidth(o)/1e3,u.bl=this.getBufferLength(o)),this.apply(s,u)}catch(a){logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||CMCDController.uuid(),this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.registerListeners())}registerListeners(){const e=this.hls;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:CMCDVersion,sf:CMCDStreamingFormatHLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){_extends(t,this.createData());const r=t.ot===CMCDObjectType.INIT||t.ot===CMCDObjectType.VIDEO||t.ot===CMCDObjectType.MUXED;if(this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){const s=CMCDController.toHeaders(t);if(!Object.keys(s).length)return;e.headers||(e.headers={}),_extends(e.headers,s)}else{const s=CMCDController.toQuery(t);if(!s)return;e.url=CMCDController.appendQueryToUri(e.url,s)}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return CMCDObjectType.TIMED_TEXT;if(e.sn==="initSegment")return CMCDObjectType.INIT;if(t==="audio")return CMCDObjectType.AUDIO;if(t==="main")return this.hls.audioTracks.length?CMCDObjectType.VIDEO:CMCDObjectType.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===CMCDObjectType.AUDIO)r=s.audioTracks;else{const a=s.maxAutoLevel,i=a>-1?a+1:s.levels.length;r=s.levels.slice(0,i)}for(const a of r)a.bitrate>t&&(t=a.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,r=e===CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:BufferHelper.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new r(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,i,o){t(a),this.loader.load(a,i,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new r(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,i,o){t(a),this.loader.load(a,i,o)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],r=l=>!Number.isNaN(l)&&l!=null&&l!==""&&l!==!1,s=l=>Math.round(l),a=l=>s(l/100)*100,o={br:s,d:s,bl:a,dl:a,mtp:a,nor:l=>encodeURIComponent(l),rtp:a,tb:s},u=Object.keys(e||{}).sort();for(const l of u){let c=e[l];if(!r(c)||l==="v"&&c===1||l=="pr"&&c===1)continue;const d=o[l];d&&(c=d(c));const f=typeof c;let g;l==="ot"||l==="sf"||l==="st"?g=`${l}=${c}`:f==="boolean"?g=l:f==="number"?g=`${l}=${c}`:g=`${l}=${JSON.stringify(c)}`,t.push(g)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),r={},s=["Object","Request","Session","Status"],a=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const o of t){const u=i[o]!=null?i[o]:1;a[u][o]=e[o]}for(let o=0;o<a.length;o++){const u=CMCDController.serialize(a[o]);u&&(r[`CMCD-${s[o]}`]=u)}return r}static toQuery(e){return`CMCD=${encodeURIComponent(CMCDController.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const r=e.includes("?")?"&":"?";return`${e}${r}${t}`}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=logger.log.bind(logger,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&r.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){let s=this.pathwayPriority;const a=this.pathwayId;this.penalizedPathways[a]||(this.penalizedPathways[a]=performance.now()),!s&&this.levels&&(s=this.levels.reduce((i,o)=>(i.indexOf(o.pathwayId)===-1&&i.push(o.pathwayId),i),[])),s&&s.length>1&&(this.updatePathwayPriority(s),r.resolved=this.pathwayId!==a)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(a=>{s-r[a]>PATHWAY_PENALTY_DURATION_MS&&delete r[a]});for(let a=0;a<e.length;a++){const i=e[a];if(r[i])continue;if(i===this.pathwayId)return;const o=this.hls.nextLoadLevel,u=this.hls.levels[o];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,this.hls.trigger(Events.LEVELS_UPDATED,{levels:t});const l=this.hls.levels[o];u&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==u.bitrate&&this.log(`Unstable Pathways change from bitrate ${u.bitrate} to ${l.bitrate}`),this.hls.nextLoadLevel=o);break}}}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(a=>{const{ID:i,"BASE-ID":o,"URI-REPLACEMENT":u}=a;if(t.some(c=>c.pathwayId===i))return;const l=this.getLevelsForPathway(o).map(c=>{const d=_extends({},c);d.details=void 0,d.url=performUriReplacement(c.uri,c.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",u);const f=new AttrList(c.attrs);f["PATHWAY-ID"]=i;const g=f.AUDIO&&`${f.AUDIO}_clone_${i}`,m=f.SUBTITLES&&`${f.SUBTITLES}_clone_${i}`;g&&(r[f.AUDIO]=g,f.AUDIO=g),m&&(s[f.SUBTITLES]=m,f.SUBTITLES=m),d.attrs=f;const v=new Level(d);return addGroupId(v,"audio",g),addGroupId(v,"text",m),v});t.push(...l),cloneRenditionGroups(this.audioTracks,r,u,i),cloneRenditionGroups(this.subtitleTracks,s,u,i)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+c)}const a={responseType:"json",url:s.href},i=t.steeringManifestLoadPolicy.default,o=i.errorRetry||i.timeoutRetry||{},u={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,d,f,g)=>{this.log(`Loaded steering manifest: "${s}"`);const m=c.data;if(m.VERSION!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":v,"PATHWAY-CLONES":y,"PATHWAY-PRIORITY":E}=m;if(v)try{this.uri=new self.URL(v,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${v}`);return}this.scheduleRefresh(this.uri||f.url),y&&this.clonePathways(y),E&&this.updatePathwayPriority(E)},onError:(c,d,f,g)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${d.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(c.code===429){const v=this.loader;if(typeof(v==null?void 0:v.getResponseHeader)=="function"){const y=v.getResponseHeader("Retry-After");y&&(m=parseFloat(y)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(c,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(a,u,l)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}function cloneRenditionGroups(n,e,t,r){n&&Object.keys(e).forEach(s=>{const a=n.filter(i=>i.groupId===s).map(i=>{const o=_extends({},i);return o.details=void 0,o.attrs=new AttrList(o.attrs),o.url=o.attrs.URI=performUriReplacement(i.url,i.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[s],o.attrs["PATHWAY-ID"]=r,o});n.push(...a)})}function performUriReplacement(n,e,t,r){const{HOST:s,PARAMS:a,[t]:i}=r;let o;e&&(o=i==null?void 0:i[e],o&&(n=o));const u=new self.URL(n);return s&&!o&&(u.host=s),a&&Object.keys(a).sort().forEach(l=>{l&&u.searchParams.set(l,a[l])}),u.href}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!this.stats.aborted)return a(r,t.url)}).catch(i=>(r.open("GET",t.url,!0),a(r,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(i=>{this.callbacks.onError({code:r.status,text:i.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=this.context.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:i}=r.loadPolicy;if(s)for(const o in s)e.setRequestHeader(o,s[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&isFiniteNumber(a)?a:i,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,a=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,o=t.responseType!=="text";if(i>=200&&i<300&&(o&&t.response||t.responseText!==null)){r.loading.end=Math.max(self.performance.now(),r.loading.first);const u=o?t.response:t.responseText,l=t.responseType==="arraybuffer"?u.byteLength:u.length;if(r.loaded=r.total=l,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first),!this.callbacks)return;const c=this.callbacks.onProgress;if(c&&c(r,e,u,t),!this.callbacks)return;const d={url:t.responseURL,data:u,code:i};this.callbacks.onSuccess(d,r,e,t)}else{const u=a.loadPolicy.errorRetry,l=r.retry;shouldRetry(u,l,!1,i)?this.retry(u):(logger.error(`${i} while loading ${e.url}`),this.callbacks.onError({code:i,text:t.statusText},e,t,r))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,r=this.stats.retry;if(shouldRetry(t,r,!0))this.retry(t);else{logger.warn(`timeout while loading ${this.context.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=getRetryDelay(e,r.retry),r.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const a=getRequestParameters(e,this.controller.signal),i=r.onProgress,o=e.responseType==="arraybuffer",u=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=l&&isFiniteNumber(l)?l:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(s,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;const f=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(s,e,this.response)},c-(f-s.loading.start)),!d.ok){const{status:g,statusText:m}=d;throw new FetchError(m||"fetch, bad network response",g,d)}return s.loading.first=f,s.total=getContentLength(d.headers)||s.total,i&&isFiniteNumber(t.highWaterMark)?this.loadProgressively(d,s,e,t.highWaterMark,i):o?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{const{response:f}=this;self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const g=d[u];g&&(s.loaded=s.total=g);const m={url:f.url,data:d,code:f.status};i&&!isFiniteNumber(t.highWaterMark)&&i(s,e,d,f),r.onSuccess(m,s,e,f)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),s.aborted)return;const f=d&&d.code||0,g=d?d.message:null;r.onError({code:f,text:g},e,d?d.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,a){const i=new ChunkCache,o=e.body.getReader(),u=()=>o.read().then(l=>{if(l.done)return i.dataLength&&a(t,r,i.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=l.value,d=c.length;return t.loaded+=d,d<s||i.dataLength?(i.push(c),i.dataLength>=s&&a(t,r,i.flush(),e)):a(t,r,c,e),u()}).catch(()=>Promise.reject());return u()}}function getRequestParameters(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(_extends({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function getByteRangeLength(n){const e=BYTERANGE.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function getContentLength(n){const e=n.get("Content-Range");if(e){const r=getByteRangeLength(e);if(isFiniteNumber(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function getRequest(n,e){return new self.Request(n.url,e)}class FetchError extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const WHITESPACE_CHAR=/\s/,Cues={newCue(n,e,t,r){const s=[];let a,i,o,u,l;const c=self.VTTCue||self.TextTrackCue;for(let f=0;f<r.rows.length;f++)if(a=r.rows[f],o=!0,u=0,l="",!a.isEmpty()){var d;for(let v=0;v<a.chars.length;v++)WHITESPACE_CHAR.test(a.chars[v].uchar)&&o?u++:(l+=a.chars[v].uchar,o=!1);a.cueStartTime=e,e===t&&(t+=1e-4),u>=16?u--:u++;const g=fixLineBreaks(l.trim()),m=generateCueId(e,t,g);n!=null&&(d=n.cues)!=null&&d.getCueById(m)||(i=new c(e,t,g),i.id=m,i.line=f+1,i.align="left",i.position=10+Math.min(80,Math.floor(u*8/32)*10),s.push(i))}return n&&s.length&&(s.sort((f,g)=>f.line==="auto"||g.line==="auto"?0:f.line>8&&g.line>8?g.line-f.line:f.line-g.line),s.forEach(f=>addCueToTrack(n,f))),s}},defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=deepCpy(n),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(a=>{const i=`${a==="level"?"playlist":a}LoadPolicy`,o=e[i]===void 0,u=[];s.forEach(l=>{const c=`${a}Loading${l}`,d=e[c];if(d!==void 0&&o){u.push(c);const f=t[i].default;switch(e[i]={default:f},l){case"TimeOut":f.maxLoadTimeMs=d,f.maxTimeToFirstByteMs=d;break;case"MaxRetry":f.errorRetry.maxNumRetry=d,f.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":f.errorRetry.retryDelayMs=d,f.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":f.errorRetry.maxRetryDelayMs=d,f.timeoutRetry.maxRetryDelayMs=d;break}}}),u.length&&logger.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${i}": ${JSON.stringify(e[i])}`)}),_objectSpread2(_objectSpread2({},t),e)}function deepCpy(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(deepCpy):Object.keys(n).reduce((e,t)=>(e[t]=deepCpy(n[t]),e),{}):n}function enableStreamingMode(n){const e=n.loader;e!==FetchLoader&&e!==XhrLoader?(logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):fetchSupported()&&(n.loader=FetchLoader,n.progressive=!0,n.enableSoftwareAES=!0,logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}class Hls{static get version(){return"1.4.3"}static isSupported(){return isSupported()}static get Events(){return Events}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(e){Hls.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,enableLogs(e.debug||!1,"Hls instance");const t=this.config=mergeConfig(Hls.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&enableStreamingMode(t);const{abrController:r,bufferController:s,capLevelController:a,errorController:i,fpsController:o}=t,u=new i(this),l=this.abrController=new r(this),c=this.bufferController=new s(this),d=this.capLevelController=new a(this),f=new o(this),g=new PlaylistLoader(this),m=new ID3TrackController(this),v=t.contentSteeringController,y=v?new v(this):null,E=this.levelController=new LevelController(this,y),_=new FragmentTracker(this),T=new KeyLoader(this.config),S=this.streamController=new StreamController(this,_,T);d.setStreamController(S),f.setStreamController(S);const x=[g,E,S];y&&x.splice(1,0,y),this.networkControllers=x;const b=[l,c,d,f,m,_];this.audioTrackController=this.createController(t.audioTrackController,x);const A=t.audioStreamController;A&&x.push(new A(this,_,T)),this.subtitleTrackController=this.createController(t.subtitleTrackController,x);const R=t.subtitleStreamController;R&&x.push(new R(this,_,T)),this.createController(t.timelineController,b),T.emeController=this.emeController=this.createController(t.emeController,b),this.cmcdController=this.createController(t.cmcdController,b),this.latencyController=this.createController(LatencyController,b),this.coreComponents=b,x.push(u);const C=u.onErrorOut;typeof C=="function"&&this.on(Events.ERROR,C,u)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,error:r})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){logger.log("attachMedia"),this._media=e,this.trigger(Events.MEDIA_ATTACHING,{media:e})}detachMedia(){logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,r=this.url,s=this.url=urlToolkitExports.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(Events.MANIFEST_LOADING,{url:e})}startLoad(e=-1){logger.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){logger.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){logger.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){logger.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){HdcpLevels.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e&&e.length?s=e.length-1:s=t,r)for(let a=s;a--;){const i=e[a].attrs["HDCP-LEVEL"];if(i&&i<=r)return a}return s}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Hls.defaultConfig=void 0;var flv={exports:{}};(function(n,e){(function(r,s){n.exports=s()})(self,function(){return function(){var t={"./node_modules/es6-promise/dist/es6-promise.js":function(i,o,u){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(l,c){i.exports=c()})(this,function(){function l(z){var te=typeof z;return z!==null&&(te==="object"||te==="function")}function c(z){return typeof z=="function"}var d=void 0;Array.isArray?d=Array.isArray:d=function(z){return Object.prototype.toString.call(z)==="[object Array]"};var f=d,g=0,m=void 0,v=void 0,y=function(te,ie){D[g]=te,D[g+1]=ie,g+=2,g===2&&(v?v(O):F())};function E(z){v=z}function _(z){y=z}var T=typeof window<"u"?window:void 0,S=T||{},x=S.MutationObserver||S.WebKitMutationObserver,b=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",A=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function R(){return function(){return process.nextTick(O)}}function C(){return typeof m<"u"?function(){m(O)}:L()}function w(){var z=0,te=new x(O),ie=document.createTextNode("");return te.observe(ie,{characterData:!0}),function(){ie.data=z=++z%2}}function I(){var z=new MessageChannel;return z.port1.onmessage=O,function(){return z.port2.postMessage(0)}}function L(){var z=setTimeout;return function(){return z(O,1)}}var D=new Array(1e3);function O(){for(var z=0;z<g;z+=2){var te=D[z],ie=D[z+1];te(ie),D[z]=void 0,D[z+1]=void 0}g=0}function N(){try{var z=Function("return this")().require("vertx");return m=z.runOnLoop||z.runOnContext,C()}catch{return L()}}var F=void 0;b?F=R():x?F=w():A?F=I():T===void 0?F=N():F=L();function H(z,te){var ie=this,he=new this.constructor(Q);he[q]===void 0&&se(he);var me=ie._state;if(me){var fe=arguments[me-1];y(function(){return Z(me,he,fe,ie._result)})}else M(ie,he,z,te);return he}function j(z){var te=this;if(z&&typeof z=="object"&&z.constructor===te)return z;var ie=new te(Q);return ne(ie,z),ie}var q=Math.random().toString(36).substring(2);function Q(){}var U=void 0,$=1,K=2;function G(){return new TypeError("You cannot resolve a promise with itself")}function ae(){return new TypeError("A promises callback cannot return that same promise.")}function W(z,te,ie,he){try{z.call(te,ie,he)}catch(me){return me}}function B(z,te,ie){y(function(he){var me=!1,fe=W(ie,te,function(_e){me||(me=!0,te!==_e?ne(he,_e):k(he,_e))},function(_e){me||(me=!0,P(he,_e))},"Settle: "+(he._label||" unknown promise"));!me&&fe&&(me=!0,P(he,fe))},z)}function V(z,te){te._state===$?k(z,te._result):te._state===K?P(z,te._result):M(te,void 0,function(ie){return ne(z,ie)},function(ie){return P(z,ie)})}function X(z,te,ie){te.constructor===z.constructor&&ie===H&&te.constructor.resolve===j?V(z,te):ie===void 0?k(z,te):c(ie)?B(z,te,ie):k(z,te)}function ne(z,te){if(z===te)P(z,G());else if(l(te)){var ie=void 0;try{ie=te.then}catch(he){P(z,he);return}X(z,te,ie)}else k(z,te)}function ce(z){z._onerror&&z._onerror(z._result),Y(z)}function k(z,te){z._state===U&&(z._result=te,z._state=$,z._subscribers.length!==0&&y(Y,z))}function P(z,te){z._state===U&&(z._state=K,z._result=te,y(ce,z))}function M(z,te,ie,he){var me=z._subscribers,fe=me.length;z._onerror=null,me[fe]=te,me[fe+$]=ie,me[fe+K]=he,fe===0&&z._state&&y(Y,z)}function Y(z){var te=z._subscribers,ie=z._state;if(te.length!==0){for(var he=void 0,me=void 0,fe=z._result,_e=0;_e<te.length;_e+=3)he=te[_e],me=te[_e+ie],he?Z(ie,he,me,fe):me(fe);z._subscribers.length=0}}function Z(z,te,ie,he){var me=c(ie),fe=void 0,_e=void 0,Te=!0;if(me){try{fe=ie(he)}catch(be){Te=!1,_e=be}if(te===fe){P(te,ae());return}}else fe=he;te._state!==U||(me&&Te?ne(te,fe):Te===!1?P(te,_e):z===$?k(te,fe):z===K&&P(te,fe))}function ee(z,te){try{te(function(he){ne(z,he)},function(he){P(z,he)})}catch(ie){P(z,ie)}}var oe=0;function re(){return oe++}function se(z){z[q]=oe++,z._state=void 0,z._result=void 0,z._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var le=function(){function z(te,ie){this._instanceConstructor=te,this.promise=new te(Q),this.promise[q]||se(this.promise),f(ie)?(this.length=ie.length,this._remaining=ie.length,this._result=new Array(this.length),this.length===0?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(ie),this._remaining===0&&k(this.promise,this._result))):P(this.promise,J())}return z.prototype._enumerate=function(ie){for(var he=0;this._state===U&&he<ie.length;he++)this._eachEntry(ie[he],he)},z.prototype._eachEntry=function(ie,he){var me=this._instanceConstructor,fe=me.resolve;if(fe===j){var _e=void 0,Te=void 0,be=!1;try{_e=ie.then}catch(Ae){be=!0,Te=Ae}if(_e===H&&ie._state!==U)this._settledAt(ie._state,he,ie._result);else if(typeof _e!="function")this._remaining--,this._result[he]=ie;else if(me===ve){var Re=new me(Q);be?P(Re,Te):X(Re,ie,_e),this._willSettleAt(Re,he)}else this._willSettleAt(new me(function(Ae){return Ae(ie)}),he)}else this._willSettleAt(fe(ie),he)},z.prototype._settledAt=function(ie,he,me){var fe=this.promise;fe._state===U&&(this._remaining--,ie===K?P(fe,me):this._result[he]=me),this._remaining===0&&k(fe,this._result)},z.prototype._willSettleAt=function(ie,he){var me=this;M(ie,void 0,function(fe){return me._settledAt($,he,fe)},function(fe){return me._settledAt(K,he,fe)})},z}();function ue(z){return new le(this,z).promise}function de(z){var te=this;return f(z)?new te(function(ie,he){for(var me=z.length,fe=0;fe<me;fe++)te.resolve(z[fe]).then(ie,he)}):new te(function(ie,he){return he(new TypeError("You must pass an array to race."))})}function pe(z){var te=this,ie=new te(Q);return P(ie,z),ie}function ge(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ye(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ve=function(){function z(te){this[q]=re(),this._result=this._state=void 0,this._subscribers=[],Q!==te&&(typeof te!="function"&&ge(),this instanceof z?ee(this,te):ye())}return z.prototype.catch=function(ie){return this.then(null,ie)},z.prototype.finally=function(ie){var he=this,me=he.constructor;return c(ie)?he.then(function(fe){return me.resolve(ie()).then(function(){return fe})},function(fe){return me.resolve(ie()).then(function(){throw fe})}):he.then(ie,ie)},z}();ve.prototype.then=H,ve.all=ue,ve.race=de,ve.resolve=j,ve.reject=pe,ve._setScheduler=E,ve._setAsap=_,ve._asap=y;function xe(){var z=void 0;if(typeof u.g<"u")z=u.g;else if(typeof self<"u")z=self;else try{z=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var te=z.Promise;if(te){var ie=null;try{ie=Object.prototype.toString.call(te.resolve())}catch{}if(ie==="[object Promise]"&&!te.cast)return}z.Promise=ve}return ve.polyfill=xe,ve.Promise=ve,ve})},"./node_modules/events/events.js":function(i){var o=typeof Reflect=="object"?Reflect:null,u=o&&typeof o.apply=="function"?o.apply:function(L,D,O){return Function.prototype.apply.call(L,D,O)},l;o&&typeof o.ownKeys=="function"?l=o.ownKeys:Object.getOwnPropertySymbols?l=function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:l=function(L){return Object.getOwnPropertyNames(L)};function c(I){console&&console.warn&&console.warn(I)}var d=Number.isNaN||function(L){return L!==L};function f(){f.init.call(this)}i.exports=f,i.exports.once=R,f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var g=10;function m(I){if(typeof I!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof I)}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(I){if(typeof I!="number"||I<0||d(I))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+I+".");g=I}}),f.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(L){if(typeof L!="number"||L<0||d(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this};function v(I){return I._maxListeners===void 0?f.defaultMaxListeners:I._maxListeners}f.prototype.getMaxListeners=function(){return v(this)},f.prototype.emit=function(L){for(var D=[],O=1;O<arguments.length;O++)D.push(arguments[O]);var N=L==="error",F=this._events;if(F!==void 0)N=N&&F.error===void 0;else if(!N)return!1;if(N){var H;if(D.length>0&&(H=D[0]),H instanceof Error)throw H;var j=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw j.context=H,j}var q=F[L];if(q===void 0)return!1;if(typeof q=="function")u(q,this,D);else for(var Q=q.length,U=x(q,Q),O=0;O<Q;++O)u(U[O],this,D);return!0};function y(I,L,D,O){var N,F,H;if(m(D),F=I._events,F===void 0?(F=I._events=Object.create(null),I._eventsCount=0):(F.newListener!==void 0&&(I.emit("newListener",L,D.listener?D.listener:D),F=I._events),H=F[L]),H===void 0)H=F[L]=D,++I._eventsCount;else if(typeof H=="function"?H=F[L]=O?[D,H]:[H,D]:O?H.unshift(D):H.push(D),N=v(I),N>0&&H.length>N&&!H.warned){H.warned=!0;var j=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=I,j.type=L,j.count=H.length,c(j)}return I}f.prototype.addListener=function(L,D){return y(this,L,D,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(L,D){return y(this,L,D,!0)};function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _(I,L,D){var O={fired:!1,wrapFn:void 0,target:I,type:L,listener:D},N=E.bind(O);return N.listener=D,O.wrapFn=N,N}f.prototype.once=function(L,D){return m(D),this.on(L,_(this,L,D)),this},f.prototype.prependOnceListener=function(L,D){return m(D),this.prependListener(L,_(this,L,D)),this},f.prototype.removeListener=function(L,D){var O,N,F,H,j;if(m(D),N=this._events,N===void 0)return this;if(O=N[L],O===void 0)return this;if(O===D||O.listener===D)--this._eventsCount===0?this._events=Object.create(null):(delete N[L],N.removeListener&&this.emit("removeListener",L,O.listener||D));else if(typeof O!="function"){for(F=-1,H=O.length-1;H>=0;H--)if(O[H]===D||O[H].listener===D){j=O[H].listener,F=H;break}if(F<0)return this;F===0?O.shift():b(O,F),O.length===1&&(N[L]=O[0]),N.removeListener!==void 0&&this.emit("removeListener",L,j||D)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(L){var D,O,N;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[L]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[L]),this;if(arguments.length===0){var F=Object.keys(O),H;for(N=0;N<F.length;++N)H=F[N],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(D=O[L],typeof D=="function")this.removeListener(L,D);else if(D!==void 0)for(N=D.length-1;N>=0;N--)this.removeListener(L,D[N]);return this};function T(I,L,D){var O=I._events;if(O===void 0)return[];var N=O[L];return N===void 0?[]:typeof N=="function"?D?[N.listener||N]:[N]:D?A(N):x(N,N.length)}f.prototype.listeners=function(L){return T(this,L,!0)},f.prototype.rawListeners=function(L){return T(this,L,!1)},f.listenerCount=function(I,L){return typeof I.listenerCount=="function"?I.listenerCount(L):S.call(I,L)},f.prototype.listenerCount=S;function S(I){var L=this._events;if(L!==void 0){var D=L[I];if(typeof D=="function")return 1;if(D!==void 0)return D.length}return 0}f.prototype.eventNames=function(){return this._eventsCount>0?l(this._events):[]};function x(I,L){for(var D=new Array(L),O=0;O<L;++O)D[O]=I[O];return D}function b(I,L){for(;L+1<I.length;L++)I[L]=I[L+1];I.pop()}function A(I){for(var L=new Array(I.length),D=0;D<L.length;++D)L[D]=I[D].listener||I[D];return L}function R(I,L){return new Promise(function(D,O){function N(H){I.removeListener(L,F),O(H)}function F(){typeof I.removeListener=="function"&&I.removeListener("error",N),D([].slice.call(arguments))}w(I,L,F,{once:!0}),L!=="error"&&C(I,N,{once:!0})})}function C(I,L,D){typeof I.on=="function"&&w(I,"error",L,D)}function w(I,L,D,O){if(typeof I.on=="function")O.once?I.once(L,D):I.on(L,D);else if(typeof I.addEventListener=="function")I.addEventListener(L,function N(F){O.once&&I.removeEventListener(L,N),D(F)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof I)}},"./node_modules/webworkify-webpack/index.js":function(i,o,u){function l(E){var _={};function T(x){if(_[x])return _[x].exports;var b=_[x]={i:x,l:!1,exports:{}};return E[x].call(b.exports,b,b.exports,T),b.l=!0,b.exports}T.m=E,T.c=_,T.i=function(x){return x},T.d=function(x,b,A){T.o(x,b)||Object.defineProperty(x,b,{configurable:!1,enumerable:!0,get:A})},T.r=function(x){Object.defineProperty(x,"__esModule",{value:!0})},T.n=function(x){var b=x&&x.__esModule?function(){return x.default}:function(){return x};return T.d(b,"a",b),b},T.o=function(x,b){return Object.prototype.hasOwnProperty.call(x,b)},T.p="/",T.oe=function(x){throw console.error(x),x};var S=T(T.s=ENTRY_MODULE);return S.default||S}var c="[\\.|\\-|\\+|\\w|/|@]+",d="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function f(E){return(E+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function g(E){return!isNaN(1*E)}function m(E,_,T){var S={};S[T]=[];var x=_.toString(),b=x.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!b)return S;for(var A=b[1],R=new RegExp("(\\\\n|\\W)"+f(A)+d,"g"),C;C=R.exec(x);)C[3]!=="dll-reference"&&S[T].push(C[3]);for(R=new RegExp("\\("+f(A)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+d,"g");C=R.exec(x);)E[C[2]]||(S[T].push(C[1]),E[C[2]]=u(C[1]).m),S[C[2]]=S[C[2]]||[],S[C[2]].push(C[4]);for(var w=Object.keys(S),I=0;I<w.length;I++)for(var L=0;L<S[w[I]].length;L++)g(S[w[I]][L])&&(S[w[I]][L]=1*S[w[I]][L]);return S}function v(E){var _=Object.keys(E);return _.reduce(function(T,S){return T||E[S].length>0},!1)}function y(E,_){for(var T={main:[_]},S={main:[]},x={main:{}};v(T);)for(var b=Object.keys(T),A=0;A<b.length;A++){var R=b[A],C=T[R],w=C.pop();if(x[R]=x[R]||{},!(x[R][w]||!E[R][w])){x[R][w]=!0,S[R]=S[R]||[],S[R].push(w);for(var I=m(E,E[R][w],R),L=Object.keys(I),D=0;D<L.length;D++)T[L[D]]=T[L[D]]||[],T[L[D]]=T[L[D]].concat(I[L[D]])}}return S}i.exports=function(E,_){_=_||{};var T={main:u.m},S=_.all?{main:Object.keys(T.main)}:y(T,E),x="";Object.keys(S).filter(function(w){return w!=="main"}).forEach(function(w){for(var I=0;S[w][I];)I++;S[w].push(I),T[w][I]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",x=x+"var "+w+" = ("+l.toString().replace("ENTRY_MODULE",JSON.stringify(I))+")({"+S[w].map(function(L){return""+JSON.stringify(L)+": "+T[w][L].toString()}).join(",")+`});
`}),x=x+"new (("+l.toString().replace("ENTRY_MODULE",JSON.stringify(E))+")({"+S.main.map(function(w){return""+JSON.stringify(w)+": "+T.main[w].toString()}).join(",")+"}))(self);";var b=new window.Blob([x],{type:"text/javascript"});if(_.bare)return b;var A=window.URL||window.webkitURL||window.mozURL||window.msURL,R=A.createObjectURL(b),C=new window.Worker(R);return C.objectURL=R,C}},"./src/config.js":function(i,o,u){u.r(o),u.d(o,{defaultConfig:function(){return l},createDefaultConfig:function(){return c}});var l={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function c(){return Object.assign({},l)}},"./src/core/features.js":function(i,o,u){u.r(o);var l=u("./src/io/io-controller.js"),c=u("./src/config.js"),d=function(){function f(){}return f.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},f.supportNetworkStreamIO=function(){var g=new l.default({},(0,c.createDefaultConfig)()),m=g.loaderType;return g.destroy(),m=="fetch-stream-loader"||m=="xhr-moz-chunked-loader"},f.getNetworkLoaderTypeName=function(){var g=new l.default({},(0,c.createDefaultConfig)()),m=g.loaderType;return g.destroy(),m},f.supportNativeMediaPlayback=function(g){f.videoElement==null&&(f.videoElement=window.document.createElement("video"));var m=f.videoElement.canPlayType(g);return m==="probably"||m=="maybe"},f.getFeatureList=function(){var g={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return g.mseFlvPlayback=f.supportMSEH264Playback(),g.networkStreamIO=f.supportNetworkStreamIO(),g.networkLoaderName=f.getNetworkLoaderTypeName(),g.mseLiveFlvPlayback=g.mseFlvPlayback&&g.networkStreamIO,g.nativeMP4H264Playback=f.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),g.nativeWebmVP8Playback=f.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),g.nativeWebmVP9Playback=f.supportNativeMediaPlayback('video/webm; codecs="vp9"'),g},f}();o.default=d},"./src/core/media-info.js":function(i,o,u){u.r(o);var l=function(){function c(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return c.prototype.isComplete=function(){var d=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,f=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&d&&f},c.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},c.prototype.getNearestKeyframe=function(d){if(this.keyframesIndex==null)return null;var f=this.keyframesIndex,g=this._search(f.times,d);return{index:g,milliseconds:f.times[g],fileposition:f.filepositions[g]}},c.prototype._search=function(d,f){var g=0,m=d.length-1,v=0,y=0,E=m;for(f<d[0]&&(g=0,y=E+1);y<=E;)if(v=y+Math.floor((E-y)/2),v===m||f>=d[v]&&f<d[v+1]){g=v;break}else d[v]<f?y=v+1:E=v-1;return g},c}();o.default=l},"./src/core/media-segment-info.js":function(i,o,u){u.r(o),u.d(o,{SampleInfo:function(){return l},MediaSegmentInfo:function(){return c},IDRSampleList:function(){return d},MediaSegmentInfoList:function(){return f}});var l=function(){function g(m,v,y,E,_){this.dts=m,this.pts=v,this.duration=y,this.originalDts=E,this.isSyncPoint=_,this.fileposition=null}return g}(),c=function(){function g(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return g.prototype.appendSyncPoint=function(m){m.isSyncPoint=!0,this.syncPoints.push(m)},g}(),d=function(){function g(){this._list=[]}return g.prototype.clear=function(){this._list=[]},g.prototype.appendArray=function(m){var v=this._list;m.length!==0&&(v.length>0&&m[0].originalDts<v[v.length-1].originalDts&&this.clear(),Array.prototype.push.apply(v,m))},g.prototype.getLastSyncPointBeforeDts=function(m){if(this._list.length==0)return null;var v=this._list,y=0,E=v.length-1,_=0,T=0,S=E;for(m<v[0].dts&&(y=0,T=S+1);T<=S;)if(_=T+Math.floor((S-T)/2),_===E||m>=v[_].dts&&m<v[_+1].dts){y=_;break}else v[_].dts<m?T=_+1:S=_-1;return this._list[y]},g}(),f=function(){function g(m){this._type=m,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),g.prototype.isEmpty=function(){return this._list.length===0},g.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},g.prototype._searchNearestSegmentBefore=function(m){var v=this._list;if(v.length===0)return-2;var y=v.length-1,E=0,_=0,T=y,S=0;if(m<v[0].originalBeginDts)return S=-1,S;for(;_<=T;)if(E=_+Math.floor((T-_)/2),E===y||m>v[E].lastSample.originalDts&&m<v[E+1].originalBeginDts){S=E;break}else v[E].originalBeginDts<m?_=E+1:T=E-1;return S},g.prototype._searchNearestSegmentAfter=function(m){return this._searchNearestSegmentBefore(m)+1},g.prototype.append=function(m){var v=this._list,y=m,E=this._lastAppendLocation,_=0;E!==-1&&E<v.length&&y.originalBeginDts>=v[E].lastSample.originalDts&&(E===v.length-1||E<v.length-1&&y.originalBeginDts<v[E+1].originalBeginDts)?_=E+1:v.length>0&&(_=this._searchNearestSegmentBefore(y.originalBeginDts)+1),this._lastAppendLocation=_,this._list.splice(_,0,y)},g.prototype.getLastSegmentBefore=function(m){var v=this._searchNearestSegmentBefore(m);return v>=0?this._list[v]:null},g.prototype.getLastSampleBefore=function(m){var v=this.getLastSegmentBefore(m);return v!=null?v.lastSample:null},g.prototype.getLastSyncPointBefore=function(m){for(var v=this._searchNearestSegmentBefore(m),y=this._list[v].syncPoints;y.length===0&&v>0;)v--,y=this._list[v].syncPoints;return y.length>0?y[y.length-1]:null},g}()},"./src/core/mse-controller.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./src/utils/logger.js"),f=u("./src/utils/browser.js"),g=u("./src/core/mse-events.js"),m=u("./src/core/media-segment-info.js"),v=u("./src/utils/exception.js"),y=function(){function E(_){this.TAG="MSEController",this._config=_,this._emitter=new(c()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new m.IDRSampleList}return E.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},E.prototype.on=function(_,T){this._emitter.addListener(_,T)},E.prototype.off=function(_,T){this._emitter.removeListener(_,T)},E.prototype.attachMediaElement=function(_){if(this._mediaSource)throw new v.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var T=this._mediaSource=new window.MediaSource;T.addEventListener("sourceopen",this.e.onSourceOpen),T.addEventListener("sourceended",this.e.onSourceEnded),T.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=_,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),_.src=this._mediaSourceObjectURL},E.prototype.detachMediaElement=function(){if(this._mediaSource){var _=this._mediaSource;for(var T in this._sourceBuffers){var S=this._pendingSegments[T];S.splice(0,S.length),this._pendingSegments[T]=null,this._pendingRemoveRanges[T]=null,this._lastInitSegments[T]=null;var x=this._sourceBuffers[T];if(x){if(_.readyState!=="closed"){try{_.removeSourceBuffer(x)}catch(b){d.default.e(this.TAG,b.message)}x.removeEventListener("error",this.e.onSourceBufferError),x.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[T]=null,this._sourceBuffers[T]=null}}if(_.readyState==="open")try{_.endOfStream()}catch(b){d.default.e(this.TAG,b.message)}_.removeEventListener("sourceopen",this.e.onSourceOpen),_.removeEventListener("sourceended",this.e.onSourceEnded),_.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},E.prototype.appendInitSegment=function(_,T){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(_),this._pendingSegments[_.type].push(_);return}var S=_,x=""+S.container;S.codec&&S.codec.length>0&&(x+=";codecs="+S.codec);var b=!1;if(d.default.v(this.TAG,"Received Initialization Segment, mimeType: "+x),this._lastInitSegments[S.type]=S,x!==this._mimeTypes[S.type]){if(this._mimeTypes[S.type])d.default.v(this.TAG,"Notice: "+S.type+" mimeType changed, origin: "+this._mimeTypes[S.type]+", target: "+x);else{b=!0;try{var A=this._sourceBuffers[S.type]=this._mediaSource.addSourceBuffer(x);A.addEventListener("error",this.e.onSourceBufferError),A.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(R){d.default.e(this.TAG,R.message),this._emitter.emit(g.default.ERROR,{code:R.code,msg:R.message});return}}this._mimeTypes[S.type]=x}T||this._pendingSegments[S.type].push(S),b||this._sourceBuffers[S.type]&&!this._sourceBuffers[S.type].updating&&this._doAppendSegments(),f.default.safari&&S.container==="audio/mpeg"&&S.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=S.mediaDuration/1e3,this._updateMediaSourceDuration())},E.prototype.appendMediaSegment=function(_){var T=_;this._pendingSegments[T.type].push(T),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var S=this._sourceBuffers[T.type];S&&!S.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},E.prototype.seek=function(_){for(var T in this._sourceBuffers)if(this._sourceBuffers[T]){var S=this._sourceBuffers[T];if(this._mediaSource.readyState==="open")try{S.abort()}catch(w){d.default.e(this.TAG,w.message)}this._idrList.clear();var x=this._pendingSegments[T];if(x.splice(0,x.length),this._mediaSource.readyState!=="closed"){for(var b=0;b<S.buffered.length;b++){var A=S.buffered.start(b),R=S.buffered.end(b);this._pendingRemoveRanges[T].push({start:A,end:R})}if(S.updating||this._doRemoveRanges(),f.default.safari){var C=this._lastInitSegments[T];C&&(this._pendingSegments[T].push(C),S.updating||this._doAppendSegments())}}}},E.prototype.endOfStream=function(){var _=this._mediaSource,T=this._sourceBuffers;if(!_||_.readyState!=="open"){_&&_.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}T.video&&T.video.updating||T.audio&&T.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,_.endOfStream())},E.prototype.getNearestKeyframe=function(_){return this._idrList.getLastSyncPointBeforeDts(_)},E.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var _=this._mediaElement.currentTime;for(var T in this._sourceBuffers){var S=this._sourceBuffers[T];if(S){var x=S.buffered;if(x.length>=1&&_-x.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},E.prototype._doCleanupSourceBuffer=function(){var _=this._mediaElement.currentTime;for(var T in this._sourceBuffers){var S=this._sourceBuffers[T];if(S){for(var x=S.buffered,b=!1,A=0;A<x.length;A++){var R=x.start(A),C=x.end(A);if(R<=_&&_<C+3){if(_-R>=this._config.autoCleanupMaxBackwardDuration){b=!0;var w=_-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[T].push({start:R,end:w})}}else C<_&&(b=!0,this._pendingRemoveRanges[T].push({start:R,end:C}))}b&&!S.updating&&this._doRemoveRanges()}}},E.prototype._updateMediaSourceDuration=function(){var _=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(_.video&&_.video.updating||_.audio&&_.audio.updating)){var T=this._mediaSource.duration,S=this._pendingMediaDuration;S>0&&(isNaN(T)||S>T)&&(d.default.v(this.TAG,"Update MediaSource duration from "+T+" to "+S),this._mediaSource.duration=S),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},E.prototype._doRemoveRanges=function(){for(var _ in this._pendingRemoveRanges)if(!(!this._sourceBuffers[_]||this._sourceBuffers[_].updating))for(var T=this._sourceBuffers[_],S=this._pendingRemoveRanges[_];S.length&&!T.updating;){var x=S.shift();T.remove(x.start,x.end)}},E.prototype._doAppendSegments=function(){var _=this._pendingSegments;for(var T in _)if(!(!this._sourceBuffers[T]||this._sourceBuffers[T].updating)&&_[T].length>0){var S=_[T].shift();if(S.timestampOffset){var x=this._sourceBuffers[T].timestampOffset,b=S.timestampOffset/1e3,A=Math.abs(x-b);A>.1&&(d.default.v(this.TAG,"Update MPEG audio timestampOffset from "+x+" to "+b),this._sourceBuffers[T].timestampOffset=b),delete S.timestampOffset}if(!S.data||S.data.byteLength===0)continue;try{this._sourceBuffers[T].appendBuffer(S.data),this._isBufferFull=!1,T==="video"&&S.hasOwnProperty("info")&&this._idrList.appendArray(S.info.syncPoints)}catch(R){this._pendingSegments[T].unshift(S),R.code===22?(this._isBufferFull||this._emitter.emit(g.default.BUFFER_FULL),this._isBufferFull=!0):(d.default.e(this.TAG,R.message),this._emitter.emit(g.default.ERROR,{code:R.code,msg:R.message}))}}},E.prototype._onSourceOpen=function(){if(d.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var _=this._pendingSourceBufferInit;_.length;){var T=_.shift();this.appendInitSegment(T,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(g.default.SOURCE_OPEN)},E.prototype._onSourceEnded=function(){d.default.v(this.TAG,"MediaSource onSourceEnded")},E.prototype._onSourceClose=function(){d.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},E.prototype._hasPendingSegments=function(){var _=this._pendingSegments;return _.video.length>0||_.audio.length>0},E.prototype._hasPendingRemoveRanges=function(){var _=this._pendingRemoveRanges;return _.video.length>0||_.audio.length>0},E.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(g.default.UPDATE_END)},E.prototype._onSourceBufferError=function(_){d.default.e(this.TAG,"SourceBuffer Error: "+_)},E}();o.default=y},"./src/core/mse-events.js":function(i,o,u){u.r(o);var l={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};o.default=l},"./src/core/transmuxer.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./node_modules/webworkify-webpack/index.js"),f=u.n(d),g=u("./src/utils/logger.js"),m=u("./src/utils/logging-control.js"),v=u("./src/core/transmuxing-controller.js"),y=u("./src/core/transmuxing-events.js"),E=u("./src/core/media-info.js"),_=function(){function T(S,x){if(this.TAG="Transmuxer",this._emitter=new(c()),x.enableWorker&&typeof Worker<"u")try{this._worker=f()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[S,x]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},m.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:m.default.getConfig()})}catch{g.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new v.default(S,x)}else this._controller=new v.default(S,x);if(this._controller){var b=this._controller;b.on(y.default.IO_ERROR,this._onIOError.bind(this)),b.on(y.default.DEMUX_ERROR,this._onDemuxError.bind(this)),b.on(y.default.INIT_SEGMENT,this._onInitSegment.bind(this)),b.on(y.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),b.on(y.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),b.on(y.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),b.on(y.default.MEDIA_INFO,this._onMediaInfo.bind(this)),b.on(y.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),b.on(y.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),b.on(y.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),b.on(y.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return T.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),m.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},T.prototype.on=function(S,x){this._emitter.addListener(S,x)},T.prototype.off=function(S,x){this._emitter.removeListener(S,x)},T.prototype.hasWorker=function(){return this._worker!=null},T.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},T.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},T.prototype.seek=function(S){this._worker?this._worker.postMessage({cmd:"seek",param:S}):this._controller.seek(S)},T.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},T.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},T.prototype._onInitSegment=function(S,x){var b=this;Promise.resolve().then(function(){b._emitter.emit(y.default.INIT_SEGMENT,S,x)})},T.prototype._onMediaSegment=function(S,x){var b=this;Promise.resolve().then(function(){b._emitter.emit(y.default.MEDIA_SEGMENT,S,x)})},T.prototype._onLoadingComplete=function(){var S=this;Promise.resolve().then(function(){S._emitter.emit(y.default.LOADING_COMPLETE)})},T.prototype._onRecoveredEarlyEof=function(){var S=this;Promise.resolve().then(function(){S._emitter.emit(y.default.RECOVERED_EARLY_EOF)})},T.prototype._onMediaInfo=function(S){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.MEDIA_INFO,S)})},T.prototype._onMetaDataArrived=function(S){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.METADATA_ARRIVED,S)})},T.prototype._onScriptDataArrived=function(S){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.SCRIPTDATA_ARRIVED,S)})},T.prototype._onStatisticsInfo=function(S){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.STATISTICS_INFO,S)})},T.prototype._onIOError=function(S,x){var b=this;Promise.resolve().then(function(){b._emitter.emit(y.default.IO_ERROR,S,x)})},T.prototype._onDemuxError=function(S,x){var b=this;Promise.resolve().then(function(){b._emitter.emit(y.default.DEMUX_ERROR,S,x)})},T.prototype._onRecommendSeekpoint=function(S){var x=this;Promise.resolve().then(function(){x._emitter.emit(y.default.RECOMMEND_SEEKPOINT,S)})},T.prototype._onLoggingConfigChanged=function(S){this._worker&&this._worker.postMessage({cmd:"logging_config",param:S})},T.prototype._onWorkerMessage=function(S){var x=S.data,b=x.data;if(x.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(x.msg){case y.default.INIT_SEGMENT:case y.default.MEDIA_SEGMENT:this._emitter.emit(x.msg,b.type,b.data);break;case y.default.LOADING_COMPLETE:case y.default.RECOVERED_EARLY_EOF:this._emitter.emit(x.msg);break;case y.default.MEDIA_INFO:Object.setPrototypeOf(b,E.default.prototype),this._emitter.emit(x.msg,b);break;case y.default.METADATA_ARRIVED:case y.default.SCRIPTDATA_ARRIVED:case y.default.STATISTICS_INFO:this._emitter.emit(x.msg,b);break;case y.default.IO_ERROR:case y.default.DEMUX_ERROR:this._emitter.emit(x.msg,b.type,b.info);break;case y.default.RECOMMEND_SEEKPOINT:this._emitter.emit(x.msg,b);break;case"logcat_callback":g.default.emitter.emit("log",b.type,b.logcat);break}},T}();o.default=_},"./src/core/transmuxing-controller.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./src/utils/logger.js"),f=u("./src/utils/browser.js"),g=u("./src/core/media-info.js"),m=u("./src/demux/flv-demuxer.js"),v=u("./src/remux/mp4-remuxer.js"),y=u("./src/demux/demux-errors.js"),E=u("./src/io/io-controller.js"),_=u("./src/core/transmuxing-events.js"),T=function(){function S(x,b){this.TAG="TransmuxingController",this._emitter=new(c()),this._config=b,x.segments||(x.segments=[{duration:x.duration,filesize:x.filesize,url:x.url}]),typeof x.cors!="boolean"&&(x.cors=!0),typeof x.withCredentials!="boolean"&&(x.withCredentials=!1),this._mediaDataSource=x,this._currentSegmentIndex=0;var A=0;this._mediaDataSource.segments.forEach(function(R){R.timestampBase=A,A+=R.duration,R.cors=x.cors,R.withCredentials=x.withCredentials,b.referrerPolicy&&(R.referrerPolicy=b.referrerPolicy)}),!isNaN(A)&&this._mediaDataSource.duration!==A&&(this._mediaDataSource.duration=A),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return S.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},S.prototype.on=function(x,b){this._emitter.addListener(x,b)},S.prototype.off=function(x,b){this._emitter.removeListener(x,b)},S.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},S.prototype._loadSegment=function(x,b){this._currentSegmentIndex=x;var A=this._mediaDataSource.segments[x],R=this._ioctl=new E.default(A,this._config,x);R.onError=this._onIOException.bind(this),R.onSeeked=this._onIOSeeked.bind(this),R.onComplete=this._onIOComplete.bind(this),R.onRedirect=this._onIORedirect.bind(this),R.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),b?this._demuxer.bindDataSource(this._ioctl):R.onDataArrival=this._onInitChunkArrival.bind(this),R.open(b)},S.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},S.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},S.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},S.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},S.prototype.seek=function(x){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var b=this._searchSegmentIndexContains(x);if(b===this._currentSegmentIndex){var A=this._mediaInfo.segments[b];if(A==null)this._pendingSeekTime=x;else{var R=A.getNearestKeyframe(x);this._remuxer.seek(R.milliseconds),this._ioctl.seek(R.fileposition),this._pendingResolveSeekPoint=R.milliseconds}}else{var C=this._mediaInfo.segments[b];if(C==null)this._pendingSeekTime=x,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(b);else{var R=C.getNearestKeyframe(x);this._internalAbort(),this._remuxer.seek(x),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[b].timestampBase,this._loadSegment(b,R.fileposition),this._pendingResolveSeekPoint=R.milliseconds,this._reportSegmentMediaInfo(b)}}this._enableStatisticsReporter()}},S.prototype._searchSegmentIndexContains=function(x){for(var b=this._mediaDataSource.segments,A=b.length-1,R=0;R<b.length;R++)if(x<b[R].timestampBase){A=R-1;break}return A},S.prototype._onInitChunkArrival=function(x,b){var A=this,R=null,C=0;if(b>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,C=this._demuxer.parseChunks(x,b);else if((R=m.default.probe(x)).match){this._demuxer=new m.default(R,this._config),this._remuxer||(this._remuxer=new v.default(this._config));var w=this._mediaDataSource;w.duration!=null&&!isNaN(w.duration)&&(this._demuxer.overridedDuration=w.duration),typeof w.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=w.hasAudio),typeof w.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=w.hasVideo),this._demuxer.timestampBase=w.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),C=this._demuxer.parseChunks(x,b)}else R=null,d.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){A._internalAbort()}),this._emitter.emit(_.default.DEMUX_ERROR,y.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),C=0;return C},S.prototype._onMediaInfo=function(x){var b=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},x),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,g.default.prototype));var A=Object.assign({},x);Object.setPrototypeOf(A,g.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=A,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var R=b._pendingSeekTime;b._pendingSeekTime=null,b.seek(R)})},S.prototype._onMetaDataArrived=function(x){this._emitter.emit(_.default.METADATA_ARRIVED,x)},S.prototype._onScriptDataArrived=function(x){this._emitter.emit(_.default.SCRIPTDATA_ARRIVED,x)},S.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},S.prototype._onIOComplete=function(x){var b=x,A=b+1;A<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(A)):(this._remuxer.flushStashedSamples(),this._emitter.emit(_.default.LOADING_COMPLETE),this._disableStatisticsReporter())},S.prototype._onIORedirect=function(x){var b=this._ioctl.extraData;this._mediaDataSource.segments[b].redirectedURL=x},S.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(_.default.RECOVERED_EARLY_EOF)},S.prototype._onIOException=function(x,b){d.default.e(this.TAG,"IOException: type = "+x+", code = "+b.code+", msg = "+b.msg),this._emitter.emit(_.default.IO_ERROR,x,b),this._disableStatisticsReporter()},S.prototype._onDemuxException=function(x,b){d.default.e(this.TAG,"DemuxException: type = "+x+", info = "+b),this._emitter.emit(_.default.DEMUX_ERROR,x,b)},S.prototype._onRemuxerInitSegmentArrival=function(x,b){this._emitter.emit(_.default.INIT_SEGMENT,x,b)},S.prototype._onRemuxerMediaSegmentArrival=function(x,b){if(this._pendingSeekTime==null&&(this._emitter.emit(_.default.MEDIA_SEGMENT,x,b),this._pendingResolveSeekPoint!=null&&x==="video")){var A=b.info.syncPoints,R=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,f.default.safari&&A.length>0&&A[0].originalDts===R&&(R=A[0].pts),this._emitter.emit(_.default.RECOMMEND_SEEKPOINT,R)}},S.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},S.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},S.prototype._reportSegmentMediaInfo=function(x){var b=this._mediaInfo.segments[x],A=Object.assign({},b);A.duration=this._mediaInfo.duration,A.segmentCount=this._mediaInfo.segmentCount,delete A.segments,delete A.keyframesIndex,this._emitter.emit(_.default.MEDIA_INFO,A)},S.prototype._reportStatisticsInfo=function(){var x={};x.url=this._ioctl.currentURL,x.hasRedirect=this._ioctl.hasRedirect,x.hasRedirect&&(x.redirectedURL=this._ioctl.currentRedirectedURL),x.speed=this._ioctl.currentSpeed,x.loaderType=this._ioctl.loaderType,x.currentSegmentIndex=this._currentSegmentIndex,x.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(_.default.STATISTICS_INFO,x)},S}();o.default=T},"./src/core/transmuxing-events.js":function(i,o,u){u.r(o);var l={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};o.default=l},"./src/core/transmuxing-worker.js":function(i,o,u){u.r(o);var l=u("./src/utils/logging-control.js"),c=u("./src/utils/polyfill.js"),d=u("./src/core/transmuxing-controller.js"),f=u("./src/core/transmuxing-events.js"),g=function(m){var v=null,y=L.bind(this);c.default.install(),m.addEventListener("message",function(D){switch(D.data.cmd){case"init":v=new d.default(D.data.param[0],D.data.param[1]),v.on(f.default.IO_ERROR,C.bind(this)),v.on(f.default.DEMUX_ERROR,w.bind(this)),v.on(f.default.INIT_SEGMENT,E.bind(this)),v.on(f.default.MEDIA_SEGMENT,_.bind(this)),v.on(f.default.LOADING_COMPLETE,T.bind(this)),v.on(f.default.RECOVERED_EARLY_EOF,S.bind(this)),v.on(f.default.MEDIA_INFO,x.bind(this)),v.on(f.default.METADATA_ARRIVED,b.bind(this)),v.on(f.default.SCRIPTDATA_ARRIVED,A.bind(this)),v.on(f.default.STATISTICS_INFO,R.bind(this)),v.on(f.default.RECOMMEND_SEEKPOINT,I.bind(this));break;case"destroy":v&&(v.destroy(),v=null),m.postMessage({msg:"destroyed"});break;case"start":v.start();break;case"stop":v.stop();break;case"seek":v.seek(D.data.param);break;case"pause":v.pause();break;case"resume":v.resume();break;case"logging_config":{var O=D.data.param;l.default.applyConfig(O),O.enableCallback===!0?l.default.addLogListener(y):l.default.removeLogListener(y);break}}});function E(D,O){var N={msg:f.default.INIT_SEGMENT,data:{type:D,data:O}};m.postMessage(N,[O.data])}function _(D,O){var N={msg:f.default.MEDIA_SEGMENT,data:{type:D,data:O}};m.postMessage(N,[O.data])}function T(){var D={msg:f.default.LOADING_COMPLETE};m.postMessage(D)}function S(){var D={msg:f.default.RECOVERED_EARLY_EOF};m.postMessage(D)}function x(D){var O={msg:f.default.MEDIA_INFO,data:D};m.postMessage(O)}function b(D){var O={msg:f.default.METADATA_ARRIVED,data:D};m.postMessage(O)}function A(D){var O={msg:f.default.SCRIPTDATA_ARRIVED,data:D};m.postMessage(O)}function R(D){var O={msg:f.default.STATISTICS_INFO,data:D};m.postMessage(O)}function C(D,O){m.postMessage({msg:f.default.IO_ERROR,data:{type:D,info:O}})}function w(D,O){m.postMessage({msg:f.default.DEMUX_ERROR,data:{type:D,info:O}})}function I(D){m.postMessage({msg:f.default.RECOMMEND_SEEKPOINT,data:D})}function L(D,O){m.postMessage({msg:"logcat_callback",data:{type:D,logcat:O}})}};o.default=g},"./src/demux/amf-parser.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/utils/utf8-conv.js"),d=u("./src/utils/exception.js"),f=function(){var m=new ArrayBuffer(2);return new DataView(m).setInt16(0,256,!0),new Int16Array(m)[0]===256}(),g=function(){function m(){}return m.parseScriptData=function(v,y,E){var _={};try{var T=m.parseValue(v,y,E),S=m.parseValue(v,y+T.size,E-T.size);_[T.data]=S.data}catch(x){l.default.e("AMF",x.toString())}return _},m.parseObject=function(v,y,E){if(E<3)throw new d.IllegalStateException("Data not enough when parse ScriptDataObject");var _=m.parseString(v,y,E),T=m.parseValue(v,y+_.size,E-_.size),S=T.objectEnd;return{data:{name:_.data,value:T.data},size:_.size+T.size,objectEnd:S}},m.parseVariable=function(v,y,E){return m.parseObject(v,y,E)},m.parseString=function(v,y,E){if(E<2)throw new d.IllegalStateException("Data not enough when parse String");var _=new DataView(v,y,E),T=_.getUint16(0,!f),S;return T>0?S=(0,c.default)(new Uint8Array(v,y+2,T)):S="",{data:S,size:2+T}},m.parseLongString=function(v,y,E){if(E<4)throw new d.IllegalStateException("Data not enough when parse LongString");var _=new DataView(v,y,E),T=_.getUint32(0,!f),S;return T>0?S=(0,c.default)(new Uint8Array(v,y+4,T)):S="",{data:S,size:4+T}},m.parseDate=function(v,y,E){if(E<10)throw new d.IllegalStateException("Data size invalid when parse Date");var _=new DataView(v,y,E),T=_.getFloat64(0,!f),S=_.getInt16(8,!f);return T+=S*60*1e3,{data:new Date(T),size:8+2}},m.parseValue=function(v,y,E){if(E<1)throw new d.IllegalStateException("Data not enough when parse Value");var _=new DataView(v,y,E),T=1,S=_.getUint8(0),x,b=!1;try{switch(S){case 0:x=_.getFloat64(1,!f),T+=8;break;case 1:{var A=_.getUint8(1);x=!!A,T+=1;break}case 2:{var R=m.parseString(v,y+1,E-1);x=R.data,T+=R.size;break}case 3:{x={};var C=0;for((_.getUint32(E-4,!f)&16777215)===9&&(C=3);T<E-4;){var w=m.parseObject(v,y+T,E-T-C);if(w.objectEnd)break;x[w.data.name]=w.data.value,T+=w.size}if(T<=E-3){var I=_.getUint32(T-1,!f)&16777215;I===9&&(T+=3)}break}case 8:{x={},T+=4;var C=0;for((_.getUint32(E-4,!f)&16777215)===9&&(C=3);T<E-8;){var L=m.parseVariable(v,y+T,E-T-C);if(L.objectEnd)break;x[L.data.name]=L.data.value,T+=L.size}if(T<=E-3){var I=_.getUint32(T-1,!f)&16777215;I===9&&(T+=3)}break}case 9:x=void 0,T=1,b=!0;break;case 10:{x=[];var D=_.getUint32(1,!f);T+=4;for(var O=0;O<D;O++){var N=m.parseValue(v,y+T,E-T);x.push(N.data),T+=N.size}break}case 11:{var F=m.parseDate(v,y+1,E-1);x=F.data,T+=F.size;break}case 12:{var H=m.parseString(v,y+1,E-1);x=H.data,T+=H.size;break}default:T=E,l.default.w("AMF","Unsupported AMF value type "+S)}}catch(j){l.default.e("AMF",j.toString())}return{data:x,size:T,objectEnd:b}},m}();o.default=g},"./src/demux/demux-errors.js":function(i,o,u){u.r(o);var l={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};o.default=l},"./src/demux/exp-golomb.js":function(i,o,u){u.r(o);var l=u("./src/utils/exception.js"),c=function(){function d(f){this.TAG="ExpGolomb",this._buffer=f,this._buffer_index=0,this._total_bytes=f.byteLength,this._total_bits=f.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return d.prototype.destroy=function(){this._buffer=null},d.prototype._fillCurrentWord=function(){var f=this._total_bytes-this._buffer_index;if(f<=0)throw new l.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var g=Math.min(4,f),m=new Uint8Array(4);m.set(this._buffer.subarray(this._buffer_index,this._buffer_index+g)),this._current_word=new DataView(m.buffer).getUint32(0,!1),this._buffer_index+=g,this._current_word_bits_left=g*8},d.prototype.readBits=function(f){if(f>32)throw new l.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(f<=this._current_word_bits_left){var g=this._current_word>>>32-f;return this._current_word<<=f,this._current_word_bits_left-=f,g}var m=this._current_word_bits_left?this._current_word:0;m=m>>>32-this._current_word_bits_left;var v=f-this._current_word_bits_left;this._fillCurrentWord();var y=Math.min(v,this._current_word_bits_left),E=this._current_word>>>32-y;return this._current_word<<=y,this._current_word_bits_left-=y,m=m<<y|E,m},d.prototype.readBool=function(){return this.readBits(1)===1},d.prototype.readByte=function(){return this.readBits(8)},d.prototype._skipLeadingZero=function(){var f;for(f=0;f<this._current_word_bits_left;f++)if(this._current_word&2147483648>>>f)return this._current_word<<=f,this._current_word_bits_left-=f,f;return this._fillCurrentWord(),f+this._skipLeadingZero()},d.prototype.readUEG=function(){var f=this._skipLeadingZero();return this.readBits(f+1)-1},d.prototype.readSEG=function(){var f=this.readUEG();return f&1?f+1>>>1:-1*(f>>>1)},d}();o.default=c},"./src/demux/flv-demuxer.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/demux/amf-parser.js"),d=u("./src/demux/sps-parser.js"),f=u("./src/demux/demux-errors.js"),g=u("./src/core/media-info.js"),m=u("./src/utils/exception.js");function v(E,_){return E[_]<<24|E[_+1]<<16|E[_+2]<<8|E[_+3]}var y=function(){function E(_,T){this.TAG="FLVDemuxer",this._config=T,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=_.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=_.hasAudioTrack,this._hasVideo=_.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new g.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var S=new ArrayBuffer(2);return new DataView(S).setInt16(0,256,!0),new Int16Array(S)[0]===256}()}return E.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},E.probe=function(_){var T=new Uint8Array(_),S={match:!1};if(T[0]!==70||T[1]!==76||T[2]!==86||T[3]!==1)return S;var x=(T[4]&4)>>>2!==0,b=(T[4]&1)!==0,A=v(T,5);return A<9?S:{match:!0,consumed:A,dataOffset:A,hasAudioTrack:x,hasVideoTrack:b}},E.prototype.bindDataSource=function(_){return _.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(E.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(_){this._onTrackMetadata=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(_){this._onMediaInfo=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(_){this._onMetaDataArrived=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(_){this._onScriptDataArrived=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onError",{get:function(){return this._onError},set:function(_){this._onError=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(_){this._onDataAvailable=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(_){this._timestampBase=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedDuration",{get:function(){return this._duration},set:function(_){this._durationOverrided=!0,this._duration=_,this._mediaInfo.duration=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedHasAudio",{set:function(_){this._hasAudioFlagOverrided=!0,this._hasAudio=_,this._mediaInfo.hasAudio=_},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"overridedHasVideo",{set:function(_){this._hasVideoFlagOverrided=!0,this._hasVideo=_,this._mediaInfo.hasVideo=_},enumerable:!1,configurable:!0}),E.prototype.resetMediaInfo=function(){this._mediaInfo=new g.default},E.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},E.prototype.parseChunks=function(_,T){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new m.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var S=0,x=this._littleEndian;if(T===0)if(_.byteLength>13){var b=E.probe(_);S=b.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,T+S!==this._dataOffset&&l.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var A=new DataView(_,S),R=A.getUint32(0,!x);R!==0&&l.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),S+=4}for(;S<_.byteLength;){this._dispatch=!0;var A=new DataView(_,S);if(S+11+4>_.byteLength)break;var C=A.getUint8(0),w=A.getUint32(0,!x)&16777215;if(S+11+w+4>_.byteLength)break;if(C!==8&&C!==9&&C!==18){l.default.w(this.TAG,"Unsupported tag type "+C+", skipped"),S+=11+w+4;continue}var I=A.getUint8(4),L=A.getUint8(5),D=A.getUint8(6),O=A.getUint8(7),N=D|L<<8|I<<16|O<<24,F=A.getUint32(7,!x)&16777215;F!==0&&l.default.w(this.TAG,"Meet tag which has StreamID != 0!");var H=S+11;switch(C){case 8:this._parseAudioData(_,H,w,N);break;case 9:this._parseVideoData(_,H,w,N,T+S);break;case 18:this._parseScriptData(_,H,w);break}var j=A.getUint32(11+w,!x);j!==11+w&&l.default.w(this.TAG,"Invalid PrevTagSize "+j),S+=11+w+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),S},E.prototype._parseScriptData=function(_,T,S){var x=c.default.parseScriptData(_,T,S);if(x.hasOwnProperty("onMetaData")){if(x.onMetaData==null||typeof x.onMetaData!="object"){l.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&l.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=x;var b=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},b)),typeof b.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=b.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof b.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=b.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof b.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=b.audiodatarate),typeof b.videodatarate=="number"&&(this._mediaInfo.videoDataRate=b.videodatarate),typeof b.width=="number"&&(this._mediaInfo.width=b.width),typeof b.height=="number"&&(this._mediaInfo.height=b.height),typeof b.duration=="number"){if(!this._durationOverrided){var A=Math.floor(b.duration*this._timescale);this._duration=A,this._mediaInfo.duration=A}}else this._mediaInfo.duration=0;if(typeof b.framerate=="number"){var R=Math.floor(b.framerate*1e3);if(R>0){var C=R/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=C,this._referenceFrameRate.fps_num=R,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=C}}if(typeof b.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var w=b.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(w),b.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=b,l.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(x).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},x))},E.prototype._parseKeyframesIndex=function(_){for(var T=[],S=[],x=1;x<_.times.length;x++){var b=this._timestampBase+Math.floor(_.times[x]*1e3);T.push(b),S.push(_.filepositions[x])}return{times:T,filepositions:S}},E.prototype._parseAudioData=function(_,T,S,x){if(S<=1){l.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var b=new DataView(_,T,S),A=b.getUint8(0),R=A>>>4;if(R!==2&&R!==10){this._onError(f.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+R);return}var C=0,w=(A&12)>>>2;if(w>=0&&w<=4)C=this._flvSoundRateTable[w];else{this._onError(f.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+w);return}var I=A&1,L=this._audioMetadata,D=this._audioTrack;if(L||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),L=this._audioMetadata={},L.type="audio",L.id=D.id,L.timescale=this._timescale,L.duration=this._duration,L.audioSampleRate=C,L.channelCount=I===0?1:2),R===10){var O=this._parseAACAudioData(_,T+1,S-1);if(O==null)return;if(O.packetType===0){L.config&&l.default.w(this.TAG,"Found another AudioSpecificConfig!");var N=O.data;L.audioSampleRate=N.samplingRate,L.channelCount=N.channelCount,L.codec=N.codec,L.originalCodec=N.originalCodec,L.config=N.config,L.refSampleDuration=1024/L.audioSampleRate*L.timescale,l.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",L);var F=this._mediaInfo;F.audioCodec=L.originalCodec,F.audioSampleRate=L.audioSampleRate,F.audioChannelCount=L.channelCount,F.hasVideo?F.videoCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.audioCodec+'"',F.isComplete()&&this._onMediaInfo(F)}else if(O.packetType===1){var H=this._timestampBase+x,j={unit:O.data,length:O.data.byteLength,dts:H,pts:H};D.samples.push(j),D.length+=O.data.length}else l.default.e(this.TAG,"Flv: Unsupported AAC data type "+O.packetType)}else if(R===2){if(!L.codec){var N=this._parseMP3AudioData(_,T+1,S-1,!0);if(N==null)return;L.audioSampleRate=N.samplingRate,L.channelCount=N.channelCount,L.codec=N.codec,L.originalCodec=N.originalCodec,L.refSampleDuration=1152/L.audioSampleRate*L.timescale,l.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",L);var F=this._mediaInfo;F.audioCodec=L.codec,F.audioSampleRate=L.audioSampleRate,F.audioChannelCount=L.channelCount,F.audioDataRate=N.bitRate,F.hasVideo?F.videoCodec!=null&&(F.mimeType='video/x-flv; codecs="'+F.videoCodec+","+F.audioCodec+'"'):F.mimeType='video/x-flv; codecs="'+F.audioCodec+'"',F.isComplete()&&this._onMediaInfo(F)}var q=this._parseMP3AudioData(_,T+1,S-1,!1);if(q==null)return;var H=this._timestampBase+x,Q={unit:q,length:q.byteLength,dts:H,pts:H};D.samples.push(Q),D.length+=q.length}}},E.prototype._parseAACAudioData=function(_,T,S){if(S<=1){l.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var x={},b=new Uint8Array(_,T,S);return x.packetType=b[0],b[0]===0?x.data=this._parseAACAudioSpecificConfig(_,T+1,S-1):x.data=b.subarray(1),x},E.prototype._parseAACAudioSpecificConfig=function(_,T,S){var x=new Uint8Array(_,T,S),b=null,A=0,R=0,C=0,w=null;if(A=R=x[0]>>>3,C=(x[0]&7)<<1|x[1]>>>7,C<0||C>=this._mpegSamplingRates.length){this._onError(f.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var I=this._mpegSamplingRates[C],L=(x[1]&120)>>>3;if(L<0||L>=8){this._onError(f.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}A===5&&(w=(x[1]&7)<<1|x[2]>>>7,(x[2]&124)>>>2);var D=self.navigator.userAgent.toLowerCase();return D.indexOf("firefox")!==-1?C>=6?(A=5,b=new Array(4),w=C-3):(A=2,b=new Array(2),w=C):D.indexOf("android")!==-1?(A=2,b=new Array(2),w=C):(A=5,w=C,b=new Array(4),C>=6?w=C-3:L===1&&(A=2,b=new Array(2),w=C)),b[0]=A<<3,b[0]|=(C&15)>>>1,b[1]=(C&15)<<7,b[1]|=(L&15)<<3,A===5&&(b[1]|=(w&15)>>>1,b[2]=(w&1)<<7,b[2]|=2<<2,b[3]=0),{config:b,samplingRate:I,channelCount:L,codec:"mp4a.40."+A,originalCodec:"mp4a.40."+R}},E.prototype._parseMP3AudioData=function(_,T,S,x){if(S<4){l.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var b=new Uint8Array(_,T,S),A=null;if(x){if(b[0]!==255)return;var R=b[1]>>>3&3,C=(b[1]&6)>>1,w=(b[2]&240)>>>4,I=(b[2]&12)>>>2,L=b[3]>>>6&3,D=L!==3?2:1,O=0,N=0,F="mp3";switch(R){case 0:O=this._mpegAudioV25SampleRateTable[I];break;case 2:O=this._mpegAudioV20SampleRateTable[I];break;case 3:O=this._mpegAudioV10SampleRateTable[I];break}switch(C){case 1:w<this._mpegAudioL3BitRateTable.length&&(N=this._mpegAudioL3BitRateTable[w]);break;case 2:w<this._mpegAudioL2BitRateTable.length&&(N=this._mpegAudioL2BitRateTable[w]);break;case 3:w<this._mpegAudioL1BitRateTable.length&&(N=this._mpegAudioL1BitRateTable[w]);break}A={bitRate:N,samplingRate:O,channelCount:D,codec:F,originalCodec:F}}else A=b;return A},E.prototype._parseVideoData=function(_,T,S,x,b){if(S<=1){l.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var A=new Uint8Array(_,T,S)[0],R=(A&240)>>>4,C=A&15;if(C!==7){this._onError(f.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+C);return}this._parseAVCVideoPacket(_,T+1,S-1,x,b,R)}},E.prototype._parseAVCVideoPacket=function(_,T,S,x,b,A){if(S<4){l.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var R=this._littleEndian,C=new DataView(_,T,S),w=C.getUint8(0),I=C.getUint32(0,!R)&16777215,L=I<<8>>8;if(w===0)this._parseAVCDecoderConfigurationRecord(_,T+4,S-4);else if(w===1)this._parseAVCVideoData(_,T+4,S-4,x,b,A,L);else if(w!==2){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid video packet type "+w);return}},E.prototype._parseAVCDecoderConfigurationRecord=function(_,T,S){if(S<7){l.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var x=this._videoMetadata,b=this._videoTrack,A=this._littleEndian,R=new DataView(_,T,S);x?typeof x.avcc<"u"&&l.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),x=this._videoMetadata={},x.type="video",x.id=b.id,x.timescale=this._timescale,x.duration=this._duration);var C=R.getUint8(0),w=R.getUint8(1);if(R.getUint8(2),R.getUint8(3),C!==1||w===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(R.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(f.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var I=R.getUint8(5)&31;if(I===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else I>1&&l.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+I);for(var L=6,D=0;D<I;D++){var O=R.getUint16(L,!A);if(L+=2,O!==0){var N=new Uint8Array(_,T+L,O);L+=O;var F=d.default.parseSPS(N);if(D===0){x.codecWidth=F.codec_size.width,x.codecHeight=F.codec_size.height,x.presentWidth=F.present_size.width,x.presentHeight=F.present_size.height,x.profile=F.profile_string,x.level=F.level_string,x.bitDepth=F.bit_depth,x.chromaFormat=F.chroma_format,x.sarRatio=F.sar_ratio,x.frameRate=F.frame_rate,(F.frame_rate.fixed===!1||F.frame_rate.fps_num===0||F.frame_rate.fps_den===0)&&(x.frameRate=this._referenceFrameRate);var H=x.frameRate.fps_den,j=x.frameRate.fps_num;x.refSampleDuration=x.timescale*(H/j);for(var q=N.subarray(1,4),Q="avc1.",U=0;U<3;U++){var $=q[U].toString(16);$.length<2&&($="0"+$),Q+=$}x.codec=Q;var K=this._mediaInfo;K.width=x.codecWidth,K.height=x.codecHeight,K.fps=x.frameRate.fps,K.profile=x.profile,K.level=x.level,K.refFrames=F.ref_frames,K.chromaFormat=F.chroma_format_string,K.sarNum=x.sarRatio.width,K.sarDen=x.sarRatio.height,K.videoCodec=Q,K.hasAudio?K.audioCodec!=null&&(K.mimeType='video/x-flv; codecs="'+K.videoCodec+","+K.audioCodec+'"'):K.mimeType='video/x-flv; codecs="'+K.videoCodec+'"',K.isComplete()&&this._onMediaInfo(K)}}}var G=R.getUint8(L);if(G===0){this._onError(f.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else G>1&&l.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+G);L++;for(var D=0;D<G;D++){var O=R.getUint16(L,!A);L+=2,O!==0&&(L+=O)}x.avcc=new Uint8Array(S),x.avcc.set(new Uint8Array(_,T,S),0),l.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",x)},E.prototype._parseAVCVideoData=function(_,T,S,x,b,A,R){for(var C=this._littleEndian,w=new DataView(_,T,S),I=[],L=0,D=0,O=this._naluLengthSize,N=this._timestampBase+x,F=A===1;D<S;){if(D+4>=S){l.default.w(this.TAG,"Malformed Nalu near timestamp "+N+", offset = "+D+", dataSize = "+S);break}var H=w.getUint32(D,!C);if(O===3&&(H>>>=8),H>S-O){l.default.w(this.TAG,"Malformed Nalus near timestamp "+N+", NaluSize > DataSize!");return}var j=w.getUint8(D+O)&31;j===5&&(F=!0);var q=new Uint8Array(_,T+D,O+H),Q={type:j,data:q};I.push(Q),L+=q.byteLength,D+=O+H}if(I.length){var U=this._videoTrack,$={units:I,length:L,isKeyframe:F,dts:N,cts:R,pts:N+R};F&&($.fileposition=b),U.samples.push($),U.length+=L}},E}();o.default=y},"./src/demux/sps-parser.js":function(i,o,u){u.r(o);var l=u("./src/demux/exp-golomb.js"),c=function(){function d(){}return d._ebsp2rbsp=function(f){for(var g=f,m=g.byteLength,v=new Uint8Array(m),y=0,E=0;E<m;E++)E>=2&&g[E]===3&&g[E-1]===0&&g[E-2]===0||(v[y]=g[E],y++);return new Uint8Array(v.buffer,0,y)},d.parseSPS=function(f){var g=d._ebsp2rbsp(f),m=new l.default(g);m.readByte();var v=m.readByte();m.readByte();var y=m.readByte();m.readUEG();var E=d.getProfileString(v),_=d.getLevelString(y),T=1,S=420,x=[0,420,422,444],b=8;if((v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128||v===138||v===144)&&(T=m.readUEG(),T===3&&m.readBits(1),T<=3&&(S=x[T]),b=m.readUEG()+8,m.readUEG(),m.readBits(1),m.readBool()))for(var A=T!==3?8:12,R=0;R<A;R++)m.readBool()&&(R<6?d._skipScalingList(m,16):d._skipScalingList(m,64));m.readUEG();var C=m.readUEG();if(C===0)m.readUEG();else if(C===1){m.readBits(1),m.readSEG(),m.readSEG();for(var w=m.readUEG(),R=0;R<w;R++)m.readSEG()}var I=m.readUEG();m.readBits(1);var L=m.readUEG(),D=m.readUEG(),O=m.readBits(1);O===0&&m.readBits(1),m.readBits(1);var N=0,F=0,H=0,j=0,q=m.readBool();q&&(N=m.readUEG(),F=m.readUEG(),H=m.readUEG(),j=m.readUEG());var Q=1,U=1,$=0,K=!0,G=0,ae=0,W=m.readBool();if(W){if(m.readBool()){var B=m.readByte(),V=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],X=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];B>0&&B<16?(Q=V[B-1],U=X[B-1]):B===255&&(Q=m.readByte()<<8|m.readByte(),U=m.readByte()<<8|m.readByte())}if(m.readBool()&&m.readBool(),m.readBool()&&(m.readBits(4),m.readBool()&&m.readBits(24)),m.readBool()&&(m.readUEG(),m.readUEG()),m.readBool()){var ne=m.readBits(32),ce=m.readBits(32);K=m.readBool(),G=ce,ae=ne*2,$=G/ae}}var k=1;(Q!==1||U!==1)&&(k=Q/U);var P=0,M=0;if(T===0)P=1,M=2-O;else{var Y=T===3?1:2,Z=T===1?2:1;P=Y,M=Z*(2-O)}var ee=(L+1)*16,oe=(2-O)*((D+1)*16);ee-=(N+F)*P,oe-=(H+j)*M;var re=Math.ceil(ee*k);return m.destroy(),m=null,{profile_string:E,level_string:_,bit_depth:b,ref_frames:I,chroma_format:S,chroma_format_string:d.getChromaFormatString(S),frame_rate:{fixed:K,fps:$,fps_den:ae,fps_num:G},sar_ratio:{width:Q,height:U},codec_size:{width:ee,height:oe},present_size:{width:re,height:oe}}},d._skipScalingList=function(f,g){for(var m=8,v=8,y=0,E=0;E<g;E++)v!==0&&(y=f.readSEG(),v=(m+y+256)%256),m=v===0?m:v},d.getProfileString=function(f){switch(f){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},d.getLevelString=function(f){return(f/10).toFixed(1)},d.getChromaFormatString=function(f){switch(f){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},d}();o.default=c},"./src/flv.js":function(i,o,u){u.r(o);var l=u("./src/utils/polyfill.js"),c=u("./src/core/features.js"),d=u("./src/io/loader.js"),f=u("./src/player/flv-player.js"),g=u("./src/player/native-player.js"),m=u("./src/player/player-events.js"),v=u("./src/player/player-errors.js"),y=u("./src/utils/logging-control.js"),E=u("./src/utils/exception.js");l.default.install();function _(b,A){var R=b;if(R==null||typeof R!="object")throw new E.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!R.hasOwnProperty("type"))throw new E.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(R.type){case"flv":return new f.default(R,A);default:return new g.default(R,A)}}function T(){return c.default.supportMSEH264Playback()}function S(){return c.default.getFeatureList()}var x={};x.createPlayer=_,x.isSupported=T,x.getFeatureList=S,x.BaseLoader=d.BaseLoader,x.LoaderStatus=d.LoaderStatus,x.LoaderErrors=d.LoaderErrors,x.Events=m.default,x.ErrorTypes=v.ErrorTypes,x.ErrorDetails=v.ErrorDetails,x.FlvPlayer=f.default,x.NativePlayer=g.default,x.LoggingControl=y.default,Object.defineProperty(x,"version",{enumerable:!0,get:function(){return"1.6.2"}}),o.default=x},"./src/index.js":function(i,o,u){i.exports=u("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(i,o,u){u.r(o);var l=u("./src/utils/browser.js"),c=u("./src/io/loader.js"),d=u("./src/utils/exception.js"),f=function(){var m=function(v,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,_){E.__proto__=_}||function(E,_){for(var T in _)Object.prototype.hasOwnProperty.call(_,T)&&(E[T]=_[T])},m(v,y)};return function(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");m(v,y);function E(){this.constructor=v}v.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),g=function(m){f(v,m);function v(y,E){var _=m.call(this,"fetch-stream-loader")||this;return _.TAG="FetchStreamLoader",_._seekHandler=y,_._config=E,_._needStash=!0,_._requestAbort=!1,_._contentLength=null,_._receivedLength=0,_}return v.isSupported=function(){try{var y=l.default.msedge&&l.default.version.minor>=15048,E=l.default.msedge?y:!0;return self.fetch&&self.ReadableStream&&E}catch{return!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),m.prototype.destroy.call(this)},v.prototype.open=function(y,E){var _=this;this._dataSource=y,this._range=E;var T=y.url;this._config.reuseRedirectedURL&&y.redirectedURL!=null&&(T=y.redirectedURL);var S=this._seekHandler.getConfig(T,E),x=new self.Headers;if(typeof S.headers=="object"){var b=S.headers;for(var A in b)b.hasOwnProperty(A)&&x.append(A,b[A])}var R={method:"GET",headers:x,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var A in this._config.headers)x.append(A,this._config.headers[A]);y.cors===!1&&(R.mode="same-origin"),y.withCredentials&&(R.credentials="include"),y.referrerPolicy&&(R.referrerPolicy=y.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,R.signal=this._abortController.signal),this._status=c.LoaderStatus.kConnecting,self.fetch(S.url,R).then(function(C){if(_._requestAbort){_._status=c.LoaderStatus.kIdle,C.body.cancel();return}if(C.ok&&C.status>=200&&C.status<=299){if(C.url!==S.url&&_._onURLRedirect){var w=_._seekHandler.removeURLParameters(C.url);_._onURLRedirect(w)}var I=C.headers.get("Content-Length");return I!=null&&(_._contentLength=parseInt(I),_._contentLength!==0&&_._onContentLengthKnown&&_._onContentLengthKnown(_._contentLength)),_._pump.call(_,C.body.getReader())}else if(_._status=c.LoaderStatus.kError,_._onError)_._onError(c.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:C.status,msg:C.statusText});else throw new d.RuntimeException("FetchStreamLoader: Http code invalid, "+C.status+" "+C.statusText)}).catch(function(C){if(!(_._abortController&&_._abortController.signal.aborted))if(_._status=c.LoaderStatus.kError,_._onError)_._onError(c.LoaderErrors.EXCEPTION,{code:-1,msg:C.message});else throw C})},v.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==c.LoaderStatus.kBuffering||!l.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},v.prototype._pump=function(y){var E=this;return y.read().then(function(_){if(_.done)if(E._contentLength!==null&&E._receivedLength<E._contentLength){E._status=c.LoaderStatus.kError;var T=c.LoaderErrors.EARLY_EOF,S={code:-1,msg:"Fetch stream meet Early-EOF"};if(E._onError)E._onError(T,S);else throw new d.RuntimeException(S.msg)}else E._status=c.LoaderStatus.kComplete,E._onComplete&&E._onComplete(E._range.from,E._range.from+E._receivedLength-1);else{if(E._abortController&&E._abortController.signal.aborted){E._status=c.LoaderStatus.kComplete;return}else if(E._requestAbort===!0)return E._status=c.LoaderStatus.kComplete,y.cancel();E._status=c.LoaderStatus.kBuffering;var x=_.value.buffer,b=E._range.from+E._receivedLength;E._receivedLength+=x.byteLength,E._onDataArrival&&E._onDataArrival(x,b,E._receivedLength),E._pump(y)}}).catch(function(_){if(E._abortController&&E._abortController.signal.aborted){E._status=c.LoaderStatus.kComplete;return}if(!(_.code===11&&l.default.msedge)){E._status=c.LoaderStatus.kError;var T=0,S=null;if((_.code===19||_.message==="network error")&&(E._contentLength===null||E._contentLength!==null&&E._receivedLength<E._contentLength)?(T=c.LoaderErrors.EARLY_EOF,S={code:_.code,msg:"Fetch stream meet Early-EOF"}):(T=c.LoaderErrors.EXCEPTION,S={code:_.code,msg:_.message}),E._onError)E._onError(T,S);else throw new d.RuntimeException(S.msg)}})},v}(c.BaseLoader);o.default=g},"./src/io/io-controller.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/io/speed-sampler.js"),d=u("./src/io/loader.js"),f=u("./src/io/fetch-stream-loader.js"),g=u("./src/io/xhr-moz-chunked-loader.js"),m=u("./src/io/xhr-range-loader.js"),v=u("./src/io/websocket-loader.js"),y=u("./src/io/range-seek-handler.js"),E=u("./src/io/param-seek-handler.js"),_=u("./src/utils/exception.js"),T=function(){function S(x,b,A){this.TAG="IOController",this._config=b,this._extraData=A,this._stashInitialSize=1024*384,b.stashInitialSize!=null&&b.stashInitialSize>0&&(this._stashInitialSize=b.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,b.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=x,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(x.url),this._refTotalLength=x.filesize?x.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new c.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return S.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},S.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},S.prototype.isPaused=function(){return this._paused},Object.defineProperty(S.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"extraData",{get:function(){return this._extraData},set:function(x){this._extraData=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(x){this._onDataArrival=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(x){this._onSeeked=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onError",{get:function(){return this._onError},set:function(x){this._onError=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onComplete",{get:function(){return this._onComplete},set:function(x){this._onComplete=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(x){this._onRedirect=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(x){this._onRecoveredEarlyEof=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentSpeed",{get:function(){return this._loaderClass===m.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),S.prototype._selectSeekHandler=function(){var x=this._config;if(x.seekType==="range")this._seekHandler=new y.default(this._config.rangeLoadZeroStart);else if(x.seekType==="param"){var b=x.seekParamStart||"bstart",A=x.seekParamEnd||"bend";this._seekHandler=new E.default(b,A)}else if(x.seekType==="custom"){if(typeof x.customSeekHandler!="function")throw new _.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new x.customSeekHandler}else throw new _.InvalidArgumentException("Invalid seekType in config: "+x.seekType)},S.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=v.default;else if(f.default.isSupported())this._loaderClass=f.default;else if(g.default.isSupported())this._loaderClass=g.default;else if(m.default.isSupported())this._loaderClass=m.default;else throw new _.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},S.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},S.prototype.open=function(x){this._currentRange={from:0,to:-1},x&&(this._currentRange.from=x),this._speedSampler.reset(),x||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},S.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},S.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},S.prototype.resume=function(){if(this._paused){this._paused=!1;var x=this._resumeFrom;this._resumeFrom=0,this._internalSeek(x,!0)}},S.prototype.seek=function(x){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(x,!0)},S.prototype._internalSeek=function(x,b){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(b),this._loader.destroy(),this._loader=null;var A={from:x,to:-1};this._currentRange={from:A.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,A),this._onSeeked&&this._onSeeked()},S.prototype.updateUrl=function(x){if(!x||typeof x!="string"||x.length===0)throw new _.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=x},S.prototype._expandBuffer=function(x){for(var b=this._stashSize;b+1024*1024*1<x;)b*=2;if(b+=1024*1024*1,b!==this._bufferSize){var A=new ArrayBuffer(b);if(this._stashUsed>0){var R=new Uint8Array(this._stashBuffer,0,this._stashUsed),C=new Uint8Array(A,0,b);C.set(R,0)}this._stashBuffer=A,this._bufferSize=b}},S.prototype._normalizeSpeed=function(x){var b=this._speedNormalizeList,A=b.length-1,R=0,C=0,w=A;if(x<b[0])return b[0];for(;C<=w;){if(R=C+Math.floor((w-C)/2),R===A||x>=b[R]&&x<b[R+1])return b[R];b[R]<x?C=R+1:w=R-1}},S.prototype._adjustStashSize=function(x){var b=0;this._config.isLive||x<512?b=x:x>=512&&x<=1024?b=Math.floor(x*1.5):b=x*2,b>8192&&(b=8192);var A=b*1024+1024*1024*1;this._bufferSize<A&&this._expandBuffer(A),this._stashSize=b*1024},S.prototype._dispatchChunks=function(x,b){return this._currentRange.to=b+x.byteLength-1,this._onDataArrival(x,b)},S.prototype._onURLRedirect=function(x){this._redirectedURL=x,this._onRedirect&&this._onRedirect(x)},S.prototype._onContentLengthKnown=function(x){x&&this._fullRequestFlag&&(this._totalLength=x,this._fullRequestFlag=!1)},S.prototype._onLoaderChunkArrival=function(x,b,A){if(!this._onDataArrival)throw new _.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(x.byteLength);var R=this._speedSampler.lastSecondKBps;if(R!==0){var C=this._normalizeSpeed(R);this._speedNormalized!==C&&(this._speedNormalized=C,this._adjustStashSize(C))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=b),this._stashUsed+x.byteLength<=this._stashSize){var L=new Uint8Array(this._stashBuffer,0,this._stashSize);L.set(new Uint8Array(x),this._stashUsed),this._stashUsed+=x.byteLength}else{var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var O=this._stashBuffer.slice(0,this._stashUsed),w=this._dispatchChunks(O,this._stashByteStart);if(w<O.byteLength){if(w>0){var D=new Uint8Array(O,w);L.set(D,0),this._stashUsed=D.byteLength,this._stashByteStart+=w}}else this._stashUsed=0,this._stashByteStart+=w;this._stashUsed+x.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+x.byteLength),L=new Uint8Array(this._stashBuffer,0,this._bufferSize)),L.set(new Uint8Array(x),this._stashUsed),this._stashUsed+=x.byteLength}else{var w=this._dispatchChunks(x,b);if(w<x.byteLength){var I=x.byteLength-w;I>this._bufferSize&&(this._expandBuffer(I),L=new Uint8Array(this._stashBuffer,0,this._bufferSize)),L.set(new Uint8Array(x,w),0),this._stashUsed+=I,this._stashByteStart=b+w}}}else if(this._stashUsed===0){var w=this._dispatchChunks(x,b);if(w<x.byteLength){var I=x.byteLength-w;I>this._bufferSize&&this._expandBuffer(I);var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);L.set(new Uint8Array(x,w),0),this._stashUsed+=I,this._stashByteStart=b+w}}else{this._stashUsed+x.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+x.byteLength);var L=new Uint8Array(this._stashBuffer,0,this._bufferSize);L.set(new Uint8Array(x),this._stashUsed),this._stashUsed+=x.byteLength;var w=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(w<this._stashUsed&&w>0){var D=new Uint8Array(this._stashBuffer,w);L.set(D,0)}this._stashUsed-=w,this._stashByteStart+=w}}},S.prototype._flushStashBuffer=function(x){if(this._stashUsed>0){var b=this._stashBuffer.slice(0,this._stashUsed),A=this._dispatchChunks(b,this._stashByteStart),R=b.byteLength-A;if(A<b.byteLength)if(x)l.default.w(this.TAG,R+" bytes unconsumed data remain when flush buffer, dropped");else{if(A>0){var C=new Uint8Array(this._stashBuffer,0,this._bufferSize),w=new Uint8Array(b,A);C.set(w,0),this._stashUsed=w.byteLength,this._stashByteStart+=A}return 0}return this._stashUsed=0,this._stashByteStart=0,R}return 0},S.prototype._onLoaderComplete=function(x,b){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},S.prototype._onLoaderError=function(x,b){switch(l.default.e(this.TAG,"Loader error, code = "+b.code+", msg = "+b.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,x=d.LoaderErrors.UNRECOVERABLE_EARLY_EOF),x){case d.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var A=this._currentRange.to+1;A<this._totalLength&&(l.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(A,!1));return}x=d.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case d.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case d.LoaderErrors.CONNECTING_TIMEOUT:case d.LoaderErrors.HTTP_STATUS_CODE_INVALID:case d.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(x,b);else throw new _.RuntimeException("IOException: "+b.msg)},S}();o.default=T},"./src/io/loader.js":function(i,o,u){u.r(o),u.d(o,{LoaderStatus:function(){return c},LoaderErrors:function(){return d},BaseLoader:function(){return f}});var l=u("./src/utils/exception.js"),c={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},d={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},f=function(){function g(m){this._type=m||"undefined",this._status=c.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return g.prototype.destroy=function(){this._status=c.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},g.prototype.isWorking=function(){return this._status===c.kConnecting||this._status===c.kBuffering},Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(m){this._onContentLengthKnown=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(m){this._onURLRedirect=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(m){this._onDataArrival=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(m){this._onError=m},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onComplete",{get:function(){return this._onComplete},set:function(m){this._onComplete=m},enumerable:!1,configurable:!0}),g.prototype.open=function(m,v){throw new l.NotImplementedException("Unimplemented abstract function!")},g.prototype.abort=function(){throw new l.NotImplementedException("Unimplemented abstract function!")},g}()},"./src/io/param-seek-handler.js":function(i,o,u){u.r(o);var l=function(){function c(d,f){this._startName=d,this._endName=f}return c.prototype.getConfig=function(d,f){var g=d;if(f.from!==0||f.to!==-1){var m=!0;g.indexOf("?")===-1&&(g+="?",m=!1),m&&(g+="&"),g+=this._startName+"="+f.from.toString(),f.to!==-1&&(g+="&"+this._endName+"="+f.to.toString())}return{url:g,headers:{}}},c.prototype.removeURLParameters=function(d){var f=d.split("?")[0],g=void 0,m=d.indexOf("?");m!==-1&&(g=d.substring(m+1));var v="";if(g!=null&&g.length>0)for(var y=g.split("&"),E=0;E<y.length;E++){var _=y[E].split("="),T=E>0;_[0]!==this._startName&&_[0]!==this._endName&&(T&&(v+="&"),v+=y[E])}return v.length===0?f:f+"?"+v},c}();o.default=l},"./src/io/range-seek-handler.js":function(i,o,u){u.r(o);var l=function(){function c(d){this._zeroStart=d||!1}return c.prototype.getConfig=function(d,f){var g={};if(f.from!==0||f.to!==-1){var m=void 0;f.to!==-1?m="bytes="+f.from.toString()+"-"+f.to.toString():m="bytes="+f.from.toString()+"-",g.Range=m}else this._zeroStart&&(g.Range="bytes=0-");return{url:d,headers:g}},c.prototype.removeURLParameters=function(d){return d},c}();o.default=l},"./src/io/speed-sampler.js":function(i,o,u){u.r(o);var l=function(){function c(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return c.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},c.prototype.addBytes=function(d){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=d,this._totalBytes+=d):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=d,this._totalBytes+=d):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=d,this._totalBytes+=d,this._lastCheckpoint=this._now())},Object.defineProperty(c.prototype,"currentKBps",{get:function(){this.addBytes(0);var d=(this._now()-this._lastCheckpoint)/1e3;return d==0&&(d=1),this._intervalBytes/d/1024},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"averageKBps",{get:function(){var d=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/d/1024},enumerable:!1,configurable:!0}),c}();o.default=l},"./src/io/websocket-loader.js":function(i,o,u){u.r(o);var l=u("./src/io/loader.js"),c=u("./src/utils/exception.js"),d=function(){var g=function(m,v){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,E){y.__proto__=E}||function(y,E){for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&(y[_]=E[_])},g(m,v)};return function(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");g(m,v);function y(){this.constructor=m}m.prototype=v===null?Object.create(v):(y.prototype=v.prototype,new y)}}(),f=function(g){d(m,g);function m(){var v=g.call(this,"websocket-loader")||this;return v.TAG="WebSocketLoader",v._needStash=!0,v._ws=null,v._requestAbort=!1,v._receivedLength=0,v}return m.isSupported=function(){try{return typeof self.WebSocket<"u"}catch{return!1}},m.prototype.destroy=function(){this._ws&&this.abort(),g.prototype.destroy.call(this)},m.prototype.open=function(v){try{var y=this._ws=new self.WebSocket(v.url);y.binaryType="arraybuffer",y.onopen=this._onWebSocketOpen.bind(this),y.onclose=this._onWebSocketClose.bind(this),y.onmessage=this._onWebSocketMessage.bind(this),y.onerror=this._onWebSocketError.bind(this),this._status=l.LoaderStatus.kConnecting}catch(_){this._status=l.LoaderStatus.kError;var E={code:_.code,msg:_.message};if(this._onError)this._onError(l.LoaderErrors.EXCEPTION,E);else throw new c.RuntimeException(E.msg)}},m.prototype.abort=function(){var v=this._ws;v&&(v.readyState===0||v.readyState===1)&&(this._requestAbort=!0,v.close()),this._ws=null,this._status=l.LoaderStatus.kComplete},m.prototype._onWebSocketOpen=function(v){this._status=l.LoaderStatus.kBuffering},m.prototype._onWebSocketClose=function(v){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},m.prototype._onWebSocketMessage=function(v){var y=this;if(v.data instanceof ArrayBuffer)this._dispatchArrayBuffer(v.data);else if(v.data instanceof Blob){var E=new FileReader;E.onload=function(){y._dispatchArrayBuffer(E.result)},E.readAsArrayBuffer(v.data)}else{this._status=l.LoaderStatus.kError;var _={code:-1,msg:"Unsupported WebSocket message type: "+v.data.constructor.name};if(this._onError)this._onError(l.LoaderErrors.EXCEPTION,_);else throw new c.RuntimeException(_.msg)}},m.prototype._dispatchArrayBuffer=function(v){var y=v,E=this._receivedLength;this._receivedLength+=y.byteLength,this._onDataArrival&&this._onDataArrival(y,E,this._receivedLength)},m.prototype._onWebSocketError=function(v){this._status=l.LoaderStatus.kError;var y={code:v.code,msg:v.message};if(this._onError)this._onError(l.LoaderErrors.EXCEPTION,y);else throw new c.RuntimeException(y.msg)},m}(l.BaseLoader);o.default=f},"./src/io/xhr-moz-chunked-loader.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/io/loader.js"),d=u("./src/utils/exception.js"),f=function(){var m=function(v,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,_){E.__proto__=_}||function(E,_){for(var T in _)Object.prototype.hasOwnProperty.call(_,T)&&(E[T]=_[T])},m(v,y)};return function(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");m(v,y);function E(){this.constructor=v}v.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),g=function(m){f(v,m);function v(y,E){var _=m.call(this,"xhr-moz-chunked-loader")||this;return _.TAG="MozChunkedLoader",_._seekHandler=y,_._config=E,_._needStash=!0,_._xhr=null,_._requestAbort=!1,_._contentLength=null,_._receivedLength=0,_}return v.isSupported=function(){try{var y=new XMLHttpRequest;return y.open("GET","https://example.com",!0),y.responseType="moz-chunked-arraybuffer",y.responseType==="moz-chunked-arraybuffer"}catch(E){return l.default.w("MozChunkedLoader",E.message),!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),m.prototype.destroy.call(this)},v.prototype.open=function(y,E){this._dataSource=y,this._range=E;var _=y.url;this._config.reuseRedirectedURL&&y.redirectedURL!=null&&(_=y.redirectedURL);var T=this._seekHandler.getConfig(_,E);this._requestURL=T.url;var S=this._xhr=new XMLHttpRequest;if(S.open("GET",T.url,!0),S.responseType="moz-chunked-arraybuffer",S.onreadystatechange=this._onReadyStateChange.bind(this),S.onprogress=this._onProgress.bind(this),S.onloadend=this._onLoadEnd.bind(this),S.onerror=this._onXhrError.bind(this),y.withCredentials&&(S.withCredentials=!0),typeof T.headers=="object"){var x=T.headers;for(var b in x)x.hasOwnProperty(b)&&S.setRequestHeader(b,x[b])}if(typeof this._config.headers=="object"){var x=this._config.headers;for(var b in x)x.hasOwnProperty(b)&&S.setRequestHeader(b,x[b])}this._status=c.LoaderStatus.kConnecting,S.send()},v.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=c.LoaderStatus.kComplete},v.prototype._onReadyStateChange=function(y){var E=y.target;if(E.readyState===2){if(E.responseURL!=null&&E.responseURL!==this._requestURL&&this._onURLRedirect){var _=this._seekHandler.removeURLParameters(E.responseURL);this._onURLRedirect(_)}if(E.status!==0&&(E.status<200||E.status>299))if(this._status=c.LoaderStatus.kError,this._onError)this._onError(c.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:E.status,msg:E.statusText});else throw new d.RuntimeException("MozChunkedLoader: Http code invalid, "+E.status+" "+E.statusText);else this._status=c.LoaderStatus.kBuffering}},v.prototype._onProgress=function(y){if(this._status!==c.LoaderStatus.kError){this._contentLength===null&&y.total!==null&&y.total!==0&&(this._contentLength=y.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var E=y.target.response,_=this._range.from+this._receivedLength;this._receivedLength+=E.byteLength,this._onDataArrival&&this._onDataArrival(E,_,this._receivedLength)}},v.prototype._onLoadEnd=function(y){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===c.LoaderStatus.kError)return;this._status=c.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},v.prototype._onXhrError=function(y){this._status=c.LoaderStatus.kError;var E=0,_=null;if(this._contentLength&&y.loaded<this._contentLength?(E=c.LoaderErrors.EARLY_EOF,_={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(E=c.LoaderErrors.EXCEPTION,_={code:-1,msg:y.constructor.name+" "+y.type}),this._onError)this._onError(E,_);else throw new d.RuntimeException(_.msg)},v}(c.BaseLoader);o.default=g},"./src/io/xhr-range-loader.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/io/speed-sampler.js"),d=u("./src/io/loader.js"),f=u("./src/utils/exception.js"),g=function(){var v=function(y,E){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,T){_.__proto__=T}||function(_,T){for(var S in T)Object.prototype.hasOwnProperty.call(T,S)&&(_[S]=T[S])},v(y,E)};return function(y,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");v(y,E);function _(){this.constructor=y}y.prototype=E===null?Object.create(E):(_.prototype=E.prototype,new _)}}(),m=function(v){g(y,v);function y(E,_){var T=v.call(this,"xhr-range-loader")||this;return T.TAG="RangeLoader",T._seekHandler=E,T._config=_,T._needStash=!1,T._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],T._currentChunkSizeKB=384,T._currentSpeedNormalized=0,T._zeroSpeedChunkCount=0,T._xhr=null,T._speedSampler=new c.default,T._requestAbort=!1,T._waitForTotalLength=!1,T._totalLengthReceived=!1,T._currentRequestURL=null,T._currentRedirectedURL=null,T._currentRequestRange=null,T._totalLength=null,T._contentLength=null,T._receivedLength=0,T._lastTimeLoaded=0,T}return y.isSupported=function(){try{var E=new XMLHttpRequest;return E.open("GET","https://example.com",!0),E.responseType="arraybuffer",E.responseType==="arraybuffer"}catch(_){return l.default.w("RangeLoader",_.message),!1}},y.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),v.prototype.destroy.call(this)},Object.defineProperty(y.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),y.prototype.open=function(E,_){this._dataSource=E,this._range=_,this._status=d.LoaderStatus.kConnecting;var T=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(T=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!T?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},y.prototype._openSubRange=function(){var E=this._currentChunkSizeKB*1024,_=this._range.from+this._receivedLength,T=_+E;this._contentLength!=null&&T-this._range.from>=this._contentLength&&(T=this._range.from+this._contentLength-1),this._currentRequestRange={from:_,to:T},this._internalOpen(this._dataSource,this._currentRequestRange)},y.prototype._internalOpen=function(E,_){this._lastTimeLoaded=0;var T=E.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?T=this._currentRedirectedURL:E.redirectedURL!=null&&(T=E.redirectedURL));var S=this._seekHandler.getConfig(T,_);this._currentRequestURL=S.url;var x=this._xhr=new XMLHttpRequest;if(x.open("GET",S.url,!0),x.responseType="arraybuffer",x.onreadystatechange=this._onReadyStateChange.bind(this),x.onprogress=this._onProgress.bind(this),x.onload=this._onLoad.bind(this),x.onerror=this._onXhrError.bind(this),E.withCredentials&&(x.withCredentials=!0),typeof S.headers=="object"){var b=S.headers;for(var A in b)b.hasOwnProperty(A)&&x.setRequestHeader(A,b[A])}if(typeof this._config.headers=="object"){var b=this._config.headers;for(var A in b)b.hasOwnProperty(A)&&x.setRequestHeader(A,b[A])}x.send()},y.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=d.LoaderStatus.kComplete},y.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},y.prototype._onReadyStateChange=function(E){var _=E.target;if(_.readyState===2){if(_.responseURL!=null){var T=this._seekHandler.removeURLParameters(_.responseURL);_.responseURL!==this._currentRequestURL&&T!==this._currentRedirectedURL&&(this._currentRedirectedURL=T,this._onURLRedirect&&this._onURLRedirect(T))}if(_.status>=200&&_.status<=299){if(this._waitForTotalLength)return;this._status=d.LoaderStatus.kBuffering}else if(this._status=d.LoaderStatus.kError,this._onError)this._onError(d.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:_.status,msg:_.statusText});else throw new f.RuntimeException("RangeLoader: Http code invalid, "+_.status+" "+_.statusText)}},y.prototype._onProgress=function(E){if(this._status!==d.LoaderStatus.kError){if(this._contentLength===null){var _=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,_=!0;var T=E.total;this._internalAbort(),T!=null&T!==0&&(this._totalLength=T)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,_){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var S=E.loaded-this._lastTimeLoaded;this._lastTimeLoaded=E.loaded,this._speedSampler.addBytes(S)}},y.prototype._normalizeSpeed=function(E){var _=this._chunkSizeKBList,T=_.length-1,S=0,x=0,b=T;if(E<_[0])return _[0];for(;x<=b;){if(S=x+Math.floor((b-x)/2),S===T||E>=_[S]&&E<_[S+1])return _[S];_[S]<E?x=S+1:b=S-1}},y.prototype._onLoad=function(E){if(this._status!==d.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var _=this._speedSampler.lastSecondKBps;if(_===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(_=this._speedSampler.currentKBps)),_!==0){var T=this._normalizeSpeed(_);this._currentSpeedNormalized!==T&&(this._currentSpeedNormalized=T,this._currentChunkSizeKB=T)}var S=E.target.response,x=this._range.from+this._receivedLength;this._receivedLength+=S.byteLength;var b=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():b=!0,this._onDataArrival&&this._onDataArrival(S,x,this._receivedLength),b&&(this._status=d.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},y.prototype._onXhrError=function(E){this._status=d.LoaderStatus.kError;var _=0,T=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(_=d.LoaderErrors.EARLY_EOF,T={code:-1,msg:"RangeLoader meet Early-Eof"}):(_=d.LoaderErrors.EXCEPTION,T={code:-1,msg:E.constructor.name+" "+E.type}),this._onError)this._onError(_,T);else throw new f.RuntimeException(T.msg)},y}(d.BaseLoader);o.default=m},"./src/player/flv-player.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./src/utils/logger.js"),f=u("./src/utils/browser.js"),g=u("./src/player/player-events.js"),m=u("./src/core/transmuxer.js"),v=u("./src/core/transmuxing-events.js"),y=u("./src/core/mse-controller.js"),E=u("./src/core/mse-events.js"),_=u("./src/player/player-errors.js"),T=u("./src/config.js"),S=u("./src/utils/exception.js"),x=function(){function b(A,R){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(c()),this._config=(0,T.createDefaultConfig)(),typeof R=="object"&&Object.assign(this._config,R),A.type.toLowerCase()!=="flv")throw new S.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");A.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=A,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var C=f.default.chrome&&(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661);this._alwaysSeekKeyframe=!!(C||f.default.msedge||f.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return b.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},b.prototype.on=function(A,R){var C=this;A===g.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){C._emitter.emit(g.default.MEDIA_INFO,C.mediaInfo)}):A===g.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){C._emitter.emit(g.default.STATISTICS_INFO,C.statisticsInfo)}),this._emitter.addListener(A,R)},b.prototype.off=function(A,R){this._emitter.removeListener(A,R)},b.prototype.attachMediaElement=function(A){var R=this;if(this._mediaElement=A,A.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),A.addEventListener("seeking",this.e.onvSeeking),A.addEventListener("canplay",this.e.onvCanPlay),A.addEventListener("stalled",this.e.onvStalled),A.addEventListener("progress",this.e.onvProgress),this._msectl=new y.default(this._config),this._msectl.on(E.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(E.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(E.default.SOURCE_OPEN,function(){R._mseSourceOpened=!0,R._hasPendingLoad&&(R._hasPendingLoad=!1,R.load())}),this._msectl.on(E.default.ERROR,function(C){R._emitter.emit(g.default.ERROR,_.ErrorTypes.MEDIA_ERROR,_.ErrorDetails.MEDIA_MSE_ERROR,C)}),this._msectl.attachMediaElement(A),this._pendingSeekTime!=null)try{A.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},b.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},b.prototype.load=function(){var A=this;if(!this._mediaElement)throw new S.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new S.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new m.default(this._mediaDataSource,this._config),this._transmuxer.on(v.default.INIT_SEGMENT,function(R,C){A._msectl.appendInitSegment(C)}),this._transmuxer.on(v.default.MEDIA_SEGMENT,function(R,C){if(A._msectl.appendMediaSegment(C),A._config.lazyLoad&&!A._config.isLive){var w=A._mediaElement.currentTime;C.info.endDts>=(w+A._config.lazyLoadMaxDuration)*1e3&&A._progressChecker==null&&(d.default.v(A.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),A._suspendTransmuxer())}}),this._transmuxer.on(v.default.LOADING_COMPLETE,function(){A._msectl.endOfStream(),A._emitter.emit(g.default.LOADING_COMPLETE)}),this._transmuxer.on(v.default.RECOVERED_EARLY_EOF,function(){A._emitter.emit(g.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(v.default.IO_ERROR,function(R,C){A._emitter.emit(g.default.ERROR,_.ErrorTypes.NETWORK_ERROR,R,C)}),this._transmuxer.on(v.default.DEMUX_ERROR,function(R,C){A._emitter.emit(g.default.ERROR,_.ErrorTypes.MEDIA_ERROR,R,{code:-1,msg:C})}),this._transmuxer.on(v.default.MEDIA_INFO,function(R){A._mediaInfo=R,A._emitter.emit(g.default.MEDIA_INFO,Object.assign({},R))}),this._transmuxer.on(v.default.METADATA_ARRIVED,function(R){A._emitter.emit(g.default.METADATA_ARRIVED,R)}),this._transmuxer.on(v.default.SCRIPTDATA_ARRIVED,function(R){A._emitter.emit(g.default.SCRIPTDATA_ARRIVED,R)}),this._transmuxer.on(v.default.STATISTICS_INFO,function(R){A._statisticsInfo=A._fillStatisticsInfo(R),A._emitter.emit(g.default.STATISTICS_INFO,Object.assign({},A._statisticsInfo))}),this._transmuxer.on(v.default.RECOMMEND_SEEKPOINT,function(R){A._mediaElement&&!A._config.accurateSeek&&(A._requestSetTime=!0,A._mediaElement.currentTime=R/1e3)}),this._transmuxer.open()}},b.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},b.prototype.play=function(){return this._mediaElement.play()},b.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(b.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(A){this._mediaElement.volume=A},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(A){this._mediaElement.muted=A},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(A){this._mediaElement?this._internalSeek(A):this._pendingSeekTime=A},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),b.prototype._fillStatisticsInfo=function(A){if(A.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return A;var R=!0,C=0,w=0;if(this._mediaElement.getVideoPlaybackQuality){var I=this._mediaElement.getVideoPlaybackQuality();C=I.totalVideoFrames,w=I.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(C=this._mediaElement.webkitDecodedFrameCount,w=this._mediaElement.webkitDroppedFrameCount):R=!1;return R&&(A.decodedFrames=C,A.droppedFrames=w),A},b.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var A=this._mediaElement.buffered,R=this._mediaElement.currentTime,C=0,w=0;w<A.length;w++){var I=A.start(w),L=A.end(w);if(I<=R&&R<L){C=L;break}}C>=R+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(d.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},b.prototype._onmseBufferFull=function(){d.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},b.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},b.prototype._checkProgressAndResume=function(){for(var A=this._mediaElement.currentTime,R=this._mediaElement.buffered,C=!1,w=0;w<R.length;w++){var I=R.start(w),L=R.end(w);if(A>=I&&A<L){A>=L-this._config.lazyLoadRecoverDuration&&(C=!0);break}}C&&(window.clearInterval(this._progressChecker),this._progressChecker=null,C&&(d.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},b.prototype._isTimepointBuffered=function(A){for(var R=this._mediaElement.buffered,C=0;C<R.length;C++){var w=R.start(C),I=R.end(C);if(A>=w&&A<I)return!0}return!1},b.prototype._internalSeek=function(A){var R=this._isTimepointBuffered(A),C=!1,w=0;if(A<1&&this._mediaElement.buffered.length>0){var I=this._mediaElement.buffered.start(0);(I<1&&A<I||f.default.safari)&&(C=!0,w=f.default.safari?.1:I)}if(C)this._requestSetTime=!0,this._mediaElement.currentTime=w;else if(R){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=A;else{var L=this._msectl.getNearestKeyframe(Math.floor(A*1e3));this._requestSetTime=!0,L!=null?this._mediaElement.currentTime=L.dts/1e3:this._mediaElement.currentTime=A}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(A),this._transmuxer.seek(Math.floor(A*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=A)},b.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var A=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(A)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(A),this._transmuxer.seek(Math.floor(A*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=A))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},b.prototype._checkAndResumeStuckPlayback=function(A){var R=this._mediaElement;if(A||!this._receivedCanPlay||R.readyState<2){var C=R.buffered;C.length>0&&R.currentTime<C.start(0)&&(d.default.w(this.TAG,"Playback seems stuck at "+R.currentTime+", seek to "+C.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=C.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},b.prototype._onvLoadedMetadata=function(A){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},b.prototype._onvSeeking=function(A){var R=this._mediaElement.currentTime,C=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(R<1&&C.length>0){var w=C.start(0);if(w<1&&R<w||f.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=f.default.safari?.1:w;return}}if(this._isTimepointBuffered(R)){if(this._alwaysSeekKeyframe){var I=this._msectl.getNearestKeyframe(Math.floor(R*1e3));I!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=I.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:R,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},b.prototype._onvCanPlay=function(A){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},b.prototype._onvStalled=function(A){this._checkAndResumeStuckPlayback(!0)},b.prototype._onvProgress=function(A){this._checkAndResumeStuckPlayback()},b}();o.default=x},"./src/player/native-player.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./src/player/player-events.js"),f=u("./src/config.js"),g=u("./src/utils/exception.js"),m=function(){function v(y,E){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(c()),this._config=(0,f.createDefaultConfig)(),typeof E=="object"&&Object.assign(this._config,E),y.type.toLowerCase()==="flv")throw new g.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(y.hasOwnProperty("segments"))throw new g.InvalidArgumentException("NativePlayer("+y.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=y,this._mediaElement=null}return v.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(y,E){var _=this;y===d.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){_._emitter.emit(d.default.MEDIA_INFO,_.mediaInfo)}):y===d.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){_._emitter.emit(d.default.STATISTICS_INFO,_.statisticsInfo)}),this._emitter.addListener(y,E)},v.prototype.off=function(y,E){this._emitter.removeListener(y,E)},v.prototype.attachMediaElement=function(y){if(this._mediaElement=y,y.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{y.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},v.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.load=function(){if(!this._mediaElement)throw new g.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},v.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype.play=function(){return this._mediaElement.play()},v.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(v.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(y){this._mediaElement.volume=y},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(y){this._mediaElement.muted=y},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(y){this._mediaElement?this._mediaElement.currentTime=y:this._pendingSeekTime=y},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"mediaInfo",{get:function(){var y=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",E={mimeType:y+this._mediaDataSource.type};return this._mediaElement&&(E.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(E.width=this._mediaElement.videoWidth,E.height=this._mediaElement.videoHeight)),E},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statisticsInfo",{get:function(){var y={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return y;var E=!0,_=0,T=0;if(this._mediaElement.getVideoPlaybackQuality){var S=this._mediaElement.getVideoPlaybackQuality();_=S.totalVideoFrames,T=S.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(_=this._mediaElement.webkitDecodedFrameCount,T=this._mediaElement.webkitDroppedFrameCount):E=!1;return E&&(y.decodedFrames=_,y.droppedFrames=T),y},enumerable:!1,configurable:!0}),v.prototype._onvLoadedMetadata=function(y){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(d.default.MEDIA_INFO,this.mediaInfo)},v.prototype._reportStatisticsInfo=function(){this._emitter.emit(d.default.STATISTICS_INFO,this.statisticsInfo)},v}();o.default=m},"./src/player/player-errors.js":function(i,o,u){u.r(o),u.d(o,{ErrorTypes:function(){return d},ErrorDetails:function(){return f}});var l=u("./src/io/loader.js"),c=u("./src/demux/demux-errors.js"),d={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},f={NETWORK_EXCEPTION:l.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:l.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:l.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:l.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:c.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:c.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:c.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(i,o,u){u.r(o);var l={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};o.default=l},"./src/remux/aac-silent.js":function(i,o,u){u.r(o);var l=function(){function c(){}return c.getSilentFrame=function(d,f){if(d==="mp4a.40.2"){if(f===1)return new Uint8Array([0,200,0,128,35,128]);if(f===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(f===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(f===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(f===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(f===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(f===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},c}();o.default=l},"./src/remux/mp4-generator.js":function(i,o,u){u.r(o);var l=function(){function c(){}return c.init=function(){c.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var d in c.types)c.types.hasOwnProperty(d)&&(c.types[d]=[d.charCodeAt(0),d.charCodeAt(1),d.charCodeAt(2),d.charCodeAt(3)]);var f=c.constants={};f.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),f.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),f.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),f.STSC=f.STCO=f.STTS,f.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),f.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),f.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),f.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),f.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},c.box=function(d){for(var f=8,g=null,m=Array.prototype.slice.call(arguments,1),v=m.length,y=0;y<v;y++)f+=m[y].byteLength;g=new Uint8Array(f),g[0]=f>>>24&255,g[1]=f>>>16&255,g[2]=f>>>8&255,g[3]=f&255,g.set(d,4);for(var E=8,y=0;y<v;y++)g.set(m[y],E),E+=m[y].byteLength;return g},c.generateInitSegment=function(d){var f=c.box(c.types.ftyp,c.constants.FTYP),g=c.moov(d),m=new Uint8Array(f.byteLength+g.byteLength);return m.set(f,0),m.set(g,f.byteLength),m},c.moov=function(d){var f=c.mvhd(d.timescale,d.duration),g=c.trak(d),m=c.mvex(d);return c.box(c.types.moov,f,g,m)},c.mvhd=function(d,f){return c.box(c.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},c.trak=function(d){return c.box(c.types.trak,c.tkhd(d),c.mdia(d))},c.tkhd=function(d){var f=d.id,g=d.duration,m=d.presentWidth,v=d.presentHeight;return c.box(c.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,m>>>8&255,m&255,0,0,v>>>8&255,v&255,0,0]))},c.mdia=function(d){return c.box(c.types.mdia,c.mdhd(d),c.hdlr(d),c.minf(d))},c.mdhd=function(d){var f=d.timescale,g=d.duration;return c.box(c.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,85,196,0,0]))},c.hdlr=function(d){var f=null;return d.type==="audio"?f=c.constants.HDLR_AUDIO:f=c.constants.HDLR_VIDEO,c.box(c.types.hdlr,f)},c.minf=function(d){var f=null;return d.type==="audio"?f=c.box(c.types.smhd,c.constants.SMHD):f=c.box(c.types.vmhd,c.constants.VMHD),c.box(c.types.minf,f,c.dinf(),c.stbl(d))},c.dinf=function(){var d=c.box(c.types.dinf,c.box(c.types.dref,c.constants.DREF));return d},c.stbl=function(d){var f=c.box(c.types.stbl,c.stsd(d),c.box(c.types.stts,c.constants.STTS),c.box(c.types.stsc,c.constants.STSC),c.box(c.types.stsz,c.constants.STSZ),c.box(c.types.stco,c.constants.STCO));return f},c.stsd=function(d){return d.type==="audio"?d.codec==="mp3"?c.box(c.types.stsd,c.constants.STSD_PREFIX,c.mp3(d)):c.box(c.types.stsd,c.constants.STSD_PREFIX,c.mp4a(d)):c.box(c.types.stsd,c.constants.STSD_PREFIX,c.avc1(d))},c.mp3=function(d){var f=d.channelCount,g=d.audioSampleRate,m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return c.box(c.types[".mp3"],m)},c.mp4a=function(d){var f=d.channelCount,g=d.audioSampleRate,m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return c.box(c.types.mp4a,m,c.esds(d))},c.esds=function(d){var f=d.config||[],g=f.length,m=new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(f).concat([6,1,2]));return c.box(c.types.esds,m)},c.avc1=function(d){var f=d.avcc,g=d.codecWidth,m=d.codecHeight,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>>8&255,g&255,m>>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return c.box(c.types.avc1,v,c.box(c.types.avcC,f))},c.mvex=function(d){return c.box(c.types.mvex,c.trex(d))},c.trex=function(d){var f=d.id,g=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return c.box(c.types.trex,g)},c.moof=function(d,f){return c.box(c.types.moof,c.mfhd(d.sequenceNumber),c.traf(d,f))},c.mfhd=function(d){var f=new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255]);return c.box(c.types.mfhd,f)},c.traf=function(d,f){var g=d.id,m=c.box(c.types.tfhd,new Uint8Array([0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255])),v=c.box(c.types.tfdt,new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255])),y=c.sdtp(d),E=c.trun(d,y.byteLength+16+16+8+16+8+8);return c.box(c.types.traf,m,v,E,y)},c.sdtp=function(d){for(var f=d.samples||[],g=f.length,m=new Uint8Array(4+g),v=0;v<g;v++){var y=f[v].flags;m[v+4]=y.isLeading<<6|y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy}return c.box(c.types.sdtp,m)},c.trun=function(d,f){var g=d.samples||[],m=g.length,v=12+16*m,y=new Uint8Array(v);f+=8+v,y.set([0,0,15,1,m>>>24&255,m>>>16&255,m>>>8&255,m&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255],0);for(var E=0;E<m;E++){var _=g[E].duration,T=g[E].size,S=g[E].flags,x=g[E].cts;y.set([_>>>24&255,_>>>16&255,_>>>8&255,_&255,T>>>24&255,T>>>16&255,T>>>8&255,T&255,S.isLeading<<2|S.dependsOn,S.isDependedOn<<6|S.hasRedundancy<<4|S.isNonSync,0,0,x>>>24&255,x>>>16&255,x>>>8&255,x&255],12+16*E)}return c.box(c.types.trun,y)},c.mdat=function(d){return c.box(c.types.mdat,d)},c}();l.init(),o.default=l},"./src/remux/mp4-remuxer.js":function(i,o,u){u.r(o);var l=u("./src/utils/logger.js"),c=u("./src/remux/mp4-generator.js"),d=u("./src/remux/aac-silent.js"),f=u("./src/utils/browser.js"),g=u("./src/core/media-segment-info.js"),m=u("./src/utils/exception.js"),v=function(){function y(E){this.TAG="MP4Remuxer",this._config=E,this._isLive=E.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new g.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new g.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(f.default.chrome&&(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661)),this._fillSilentAfterSeek=f.default.msedge||f.default.msie,this._mp3UseMpegAudio=!f.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return y.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},y.prototype.bindDataSource=function(E){return E.onDataAvailable=this.remux.bind(this),E.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(y.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(E){this._onInitSegment=E},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(E){this._onMediaSegment=E},enumerable:!1,configurable:!0}),y.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},y.prototype.seek=function(E){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},y.prototype.remux=function(E,_){if(!this._onMediaSegment)throw new m.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(E,_),this._remuxVideo(_),this._remuxAudio(E)},y.prototype._onTrackMetadataReceived=function(E,_){var T=null,S="mp4",x=_.codec;if(E==="audio")this._audioMeta=_,_.codec==="mp3"&&this._mp3UseMpegAudio?(S="mpeg",x="",T=new Uint8Array):T=c.default.generateInitSegment(_);else if(E==="video")this._videoMeta=_,T=c.default.generateInitSegment(_);else return;if(!this._onInitSegment)throw new m.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(E,{type:E,data:T.buffer,codec:x,container:E+"/"+S,mediaDuration:_.duration})},y.prototype._calculateDtsBase=function(E,_){this._dtsBaseInited||(E.samples&&E.samples.length&&(this._audioDtsBase=E.samples[0].dts),_.samples&&_.samples.length&&(this._videoDtsBase=_.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},y.prototype.flushStashedSamples=function(){var E=this._videoStashedLastSample,_=this._audioStashedLastSample,T={type:"video",id:1,sequenceNumber:0,samples:[],length:0};E!=null&&(T.samples.push(E),T.length=E.length);var S={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};_!=null&&(S.samples.push(_),S.length=_.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(T,!0),this._remuxAudio(S,!0)},y.prototype._remuxAudio=function(E,_){if(this._audioMeta!=null){var T=E,S=T.samples,x=void 0,b=-1,A=-1,R=this._audioMeta.refSampleDuration,C=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,w=this._dtsBaseInited&&this._audioNextDts===void 0,I=!1;if(!(!S||S.length===0)&&!(S.length===1&&!_)){var L=0,D=null,O=0;C?(L=0,O=T.length):(L=8,O=8+T.length);var N=null;if(S.length>1&&(N=S.pop(),O-=N.length),this._audioStashedLastSample!=null){var F=this._audioStashedLastSample;this._audioStashedLastSample=null,S.unshift(F),O+=F.length}N!=null&&(this._audioStashedLastSample=N);var H=S[0].dts-this._dtsBase;if(this._audioNextDts)x=H-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())x=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(I=!0);else{var j=this._audioSegmentInfoList.getLastSampleBefore(H);if(j!=null){var q=H-(j.originalDts+j.duration);q<=3&&(q=0);var Q=j.dts+j.duration+q;x=H-Q}else x=0}if(I){var U=H-x,$=this._videoSegmentInfoList.getLastSegmentBefore(H);if($!=null&&$.beginDts<U){var K=d.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(K){var G=$.beginDts,ae=U-$.beginDts;l.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+G+", duration: "+ae),S.unshift({unit:K,dts:G,pts:G}),O+=K.byteLength}}else I=!1}for(var W=[],B=0;B<S.length;B++){var F=S[B],V=F.unit,X=F.dts-this._dtsBase,G=X,ne=!1,ce=null,k=0;if(!(X<-.001)){if(this._audioMeta.codec!=="mp3"){var P=X,M=3;if(this._audioNextDts&&(P=this._audioNextDts),x=X-P,x<=-M*R){l.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+X+" ms ,curRefDts: "+P+" ms)  due to dtsCorrection: "+x+" ms overlap.");continue}else if(x>=M*R&&this._fillAudioTimestampGap&&!f.default.safari){ne=!0;var Y=Math.floor(x/R);l.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+X+" ms, curRefDts: "+P+" ms, ")+("dtsCorrection: "+Math.round(x)+" ms, generate: "+Y+" frames")),G=Math.floor(P),k=Math.floor(P+R)-G;var K=d.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);K==null&&(l.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),K=V),ce=[];for(var Z=0;Z<Y;Z++){P=P+R;var ee=Math.floor(P),oe=Math.floor(P+R)-ee,re={dts:ee,pts:ee,cts:0,unit:K,size:K.byteLength,duration:oe,originalDts:X,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ce.push(re),O+=re.size}this._audioNextDts=P+R}else G=Math.floor(P),k=Math.floor(P+R)-G,this._audioNextDts=P+R}else{if(G=X-x,B!==S.length-1){var se=S[B+1].dts-this._dtsBase-x;k=se-G}else if(N!=null){var se=N.dts-this._dtsBase-x;k=se-G}else W.length>=1?k=W[W.length-1].duration:k=Math.floor(R);this._audioNextDts=G+k}b===-1&&(b=G),W.push({dts:G,pts:G,cts:0,unit:F.unit,size:F.unit.byteLength,duration:k,originalDts:X,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),ne&&W.push.apply(W,ce)}}if(W.length===0){T.samples=[],T.length=0;return}C?D=new Uint8Array(O):(D=new Uint8Array(O),D[0]=O>>>24&255,D[1]=O>>>16&255,D[2]=O>>>8&255,D[3]=O&255,D.set(c.default.types.mdat,4));for(var B=0;B<W.length;B++){var V=W[B].unit;D.set(V,L),L+=V.byteLength}var J=W[W.length-1];A=J.dts+J.duration;var le=new g.MediaSegmentInfo;le.beginDts=b,le.endDts=A,le.beginPts=b,le.endPts=A,le.originalBeginDts=W[0].originalDts,le.originalEndDts=J.originalDts+J.duration,le.firstSample=new g.SampleInfo(W[0].dts,W[0].pts,W[0].duration,W[0].originalDts,!1),le.lastSample=new g.SampleInfo(J.dts,J.pts,J.duration,J.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(le),T.samples=W,T.sequenceNumber++;var ue=null;C?ue=new Uint8Array:ue=c.default.moof(T,b),T.samples=[],T.length=0;var de={type:"audio",data:this._mergeBoxes(ue,D).buffer,sampleCount:W.length,info:le};C&&w&&(de.timestampOffset=b),this._onMediaSegment("audio",de)}}},y.prototype._remuxVideo=function(E,_){if(this._videoMeta!=null){var T=E,S=T.samples,x=void 0,b=-1,A=-1,R=-1,C=-1;if(!(!S||S.length===0)&&!(S.length===1&&!_)){var w=8,I=null,L=8+E.length,D=null;if(S.length>1&&(D=S.pop(),L-=D.length),this._videoStashedLastSample!=null){var O=this._videoStashedLastSample;this._videoStashedLastSample=null,S.unshift(O),L+=O.length}D!=null&&(this._videoStashedLastSample=D);var N=S[0].dts-this._dtsBase;if(this._videoNextDts)x=N-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())x=0;else{var F=this._videoSegmentInfoList.getLastSampleBefore(N);if(F!=null){var H=N-(F.originalDts+F.duration);H<=3&&(H=0);var j=F.dts+F.duration+H;x=N-j}else x=0}for(var q=new g.MediaSegmentInfo,Q=[],U=0;U<S.length;U++){var O=S[U],$=O.dts-this._dtsBase,K=O.isKeyframe,G=$-x,ae=O.cts,W=G+ae;b===-1&&(b=G,R=W);var B=0;if(U!==S.length-1){var V=S[U+1].dts-this._dtsBase-x;B=V-G}else if(D!=null){var V=D.dts-this._dtsBase-x;B=V-G}else Q.length>=1?B=Q[Q.length-1].duration:B=Math.floor(this._videoMeta.refSampleDuration);if(K){var X=new g.SampleInfo(G,W,B,O.dts,!0);X.fileposition=O.fileposition,q.appendSyncPoint(X)}Q.push({dts:G,pts:W,cts:ae,units:O.units,size:O.length,isKeyframe:K,duration:B,originalDts:$,flags:{isLeading:0,dependsOn:K?2:1,isDependedOn:K?1:0,hasRedundancy:0,isNonSync:K?0:1}})}I=new Uint8Array(L),I[0]=L>>>24&255,I[1]=L>>>16&255,I[2]=L>>>8&255,I[3]=L&255,I.set(c.default.types.mdat,4);for(var U=0;U<Q.length;U++)for(var ne=Q[U].units;ne.length;){var ce=ne.shift(),k=ce.data;I.set(k,w),w+=k.byteLength}var P=Q[Q.length-1];if(A=P.dts+P.duration,C=P.pts+P.duration,this._videoNextDts=A,q.beginDts=b,q.endDts=A,q.beginPts=R,q.endPts=C,q.originalBeginDts=Q[0].originalDts,q.originalEndDts=P.originalDts+P.duration,q.firstSample=new g.SampleInfo(Q[0].dts,Q[0].pts,Q[0].duration,Q[0].originalDts,Q[0].isKeyframe),q.lastSample=new g.SampleInfo(P.dts,P.pts,P.duration,P.originalDts,P.isKeyframe),this._isLive||this._videoSegmentInfoList.append(q),T.samples=Q,T.sequenceNumber++,this._forceFirstIDR){var M=Q[0].flags;M.dependsOn=2,M.isNonSync=0}var Y=c.default.moof(T,b);T.samples=[],T.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Y,I).buffer,sampleCount:Q.length,info:q})}}},y.prototype._mergeBoxes=function(E,_){var T=new Uint8Array(E.byteLength+_.byteLength);return T.set(E,0),T.set(_,E.byteLength),T},y}();o.default=v},"./src/utils/browser.js":function(i,o,u){u.r(o);var l={};function c(){var d=self.navigator.userAgent.toLowerCase(),f=/(edge)\/([\w.]+)/.exec(d)||/(opr)[\/]([\w.]+)/.exec(d)||/(chrome)[ \/]([\w.]+)/.exec(d)||/(iemobile)[\/]([\w.]+)/.exec(d)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||d.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(d)||d.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(d)||[],g=/(ipad)/.exec(d)||/(ipod)/.exec(d)||/(windows phone)/.exec(d)||/(iphone)/.exec(d)||/(kindle)/.exec(d)||/(android)/.exec(d)||/(windows)/.exec(d)||/(mac)/.exec(d)||/(linux)/.exec(d)||/(cros)/.exec(d)||[],m={browser:f[5]||f[3]||f[1]||"",version:f[2]||f[4]||"0",majorVersion:f[4]||f[2]||"0",platform:g[0]||""},v={};if(m.browser){v[m.browser]=!0;var y=m.majorVersion.split(".");v.version={major:parseInt(m.majorVersion,10),string:m.version},y.length>1&&(v.version.minor=parseInt(y[1],10)),y.length>2&&(v.version.build=parseInt(y[2],10))}if(m.platform&&(v[m.platform]=!0),(v.chrome||v.opr||v.safari)&&(v.webkit=!0),v.rv||v.iemobile){v.rv&&delete v.rv;var E="msie";m.browser=E,v[E]=!0}if(v.edge){delete v.edge;var _="msedge";m.browser=_,v[_]=!0}if(v.opr){var T="opera";m.browser=T,v[T]=!0}if(v.safari&&v.android){var S="android";m.browser=S,v[S]=!0}v.name=m.browser,v.platform=m.platform;for(var x in l)l.hasOwnProperty(x)&&delete l[x];Object.assign(l,v)}c(),o.default=l},"./src/utils/exception.js":function(i,o,u){u.r(o),u.d(o,{RuntimeException:function(){return c},IllegalStateException:function(){return d},InvalidArgumentException:function(){return f},NotImplementedException:function(){return g}});var l=function(){var m=function(v,y){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,_){E.__proto__=_}||function(E,_){for(var T in _)Object.prototype.hasOwnProperty.call(_,T)&&(E[T]=_[T])},m(v,y)};return function(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");m(v,y);function E(){this.constructor=v}v.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),c=function(){function m(v){this._message=v}return Object.defineProperty(m.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),m.prototype.toString=function(){return this.name+": "+this.message},m}(),d=function(m){l(v,m);function v(y){return m.call(this,y)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),v}(c),f=function(m){l(v,m);function v(y){return m.call(this,y)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),v}(c),g=function(m){l(v,m);function v(y){return m.call(this,y)||this}return Object.defineProperty(v.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),v}(c)},"./src/utils/logger.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=function(){function f(){}return f.e=function(g,m){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var v="["+g+"] > "+m;f.ENABLE_CALLBACK&&f.emitter.emit("log","error",v),f.ENABLE_ERROR&&(console.error?console.error(v):console.warn?console.warn(v):console.log(v))},f.i=function(g,m){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var v="["+g+"] > "+m;f.ENABLE_CALLBACK&&f.emitter.emit("log","info",v),f.ENABLE_INFO&&(console.info?console.info(v):console.log(v))},f.w=function(g,m){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var v="["+g+"] > "+m;f.ENABLE_CALLBACK&&f.emitter.emit("log","warn",v),f.ENABLE_WARN&&(console.warn?console.warn(v):console.log(v))},f.d=function(g,m){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var v="["+g+"] > "+m;f.ENABLE_CALLBACK&&f.emitter.emit("log","debug",v),f.ENABLE_DEBUG&&(console.debug?console.debug(v):console.log(v))},f.v=function(g,m){(!g||f.FORCE_GLOBAL_TAG)&&(g=f.GLOBAL_TAG);var v="["+g+"] > "+m;f.ENABLE_CALLBACK&&f.emitter.emit("log","verbose",v),f.ENABLE_VERBOSE&&console.log(v)},f}();d.GLOBAL_TAG="flv.js",d.FORCE_GLOBAL_TAG=!1,d.ENABLE_ERROR=!0,d.ENABLE_INFO=!0,d.ENABLE_WARN=!0,d.ENABLE_DEBUG=!0,d.ENABLE_VERBOSE=!0,d.ENABLE_CALLBACK=!1,d.emitter=new(c()),o.default=d},"./src/utils/logging-control.js":function(i,o,u){u.r(o);var l=u("./node_modules/events/events.js"),c=u.n(l),d=u("./src/utils/logger.js"),f=function(){function g(){}return Object.defineProperty(g,"forceGlobalTag",{get:function(){return d.default.FORCE_GLOBAL_TAG},set:function(m){d.default.FORCE_GLOBAL_TAG=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"globalTag",{get:function(){return d.default.GLOBAL_TAG},set:function(m){d.default.GLOBAL_TAG=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableAll",{get:function(){return d.default.ENABLE_VERBOSE&&d.default.ENABLE_DEBUG&&d.default.ENABLE_INFO&&d.default.ENABLE_WARN&&d.default.ENABLE_ERROR},set:function(m){d.default.ENABLE_VERBOSE=m,d.default.ENABLE_DEBUG=m,d.default.ENABLE_INFO=m,d.default.ENABLE_WARN=m,d.default.ENABLE_ERROR=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableDebug",{get:function(){return d.default.ENABLE_DEBUG},set:function(m){d.default.ENABLE_DEBUG=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableVerbose",{get:function(){return d.default.ENABLE_VERBOSE},set:function(m){d.default.ENABLE_VERBOSE=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableInfo",{get:function(){return d.default.ENABLE_INFO},set:function(m){d.default.ENABLE_INFO=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableWarn",{get:function(){return d.default.ENABLE_WARN},set:function(m){d.default.ENABLE_WARN=m,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableError",{get:function(){return d.default.ENABLE_ERROR},set:function(m){d.default.ENABLE_ERROR=m,g._notifyChange()},enumerable:!1,configurable:!0}),g.getConfig=function(){return{globalTag:d.default.GLOBAL_TAG,forceGlobalTag:d.default.FORCE_GLOBAL_TAG,enableVerbose:d.default.ENABLE_VERBOSE,enableDebug:d.default.ENABLE_DEBUG,enableInfo:d.default.ENABLE_INFO,enableWarn:d.default.ENABLE_WARN,enableError:d.default.ENABLE_ERROR,enableCallback:d.default.ENABLE_CALLBACK}},g.applyConfig=function(m){d.default.GLOBAL_TAG=m.globalTag,d.default.FORCE_GLOBAL_TAG=m.forceGlobalTag,d.default.ENABLE_VERBOSE=m.enableVerbose,d.default.ENABLE_DEBUG=m.enableDebug,d.default.ENABLE_INFO=m.enableInfo,d.default.ENABLE_WARN=m.enableWarn,d.default.ENABLE_ERROR=m.enableError,d.default.ENABLE_CALLBACK=m.enableCallback},g._notifyChange=function(){var m=g.emitter;if(m.listenerCount("change")>0){var v=g.getConfig();m.emit("change",v)}},g.registerListener=function(m){g.emitter.addListener("change",m)},g.removeListener=function(m){g.emitter.removeListener("change",m)},g.addLogListener=function(m){d.default.emitter.addListener("log",m),d.default.emitter.listenerCount("log")>0&&(d.default.ENABLE_CALLBACK=!0,g._notifyChange())},g.removeLogListener=function(m){d.default.emitter.removeListener("log",m),d.default.emitter.listenerCount("log")===0&&(d.default.ENABLE_CALLBACK=!1,g._notifyChange())},g}();f.emitter=new(c()),o.default=f},"./src/utils/polyfill.js":function(i,o,u){u.r(o);var l=function(){function c(){}return c.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(d,f){return d.__proto__=f,d},Object.assign=Object.assign||function(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var f=Object(d),g=1;g<arguments.length;g++){var m=arguments[g];if(m!=null)for(var v in m)m.hasOwnProperty(v)&&(f[v]=m[v])}return f},typeof self.Promise!="function"&&u("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},c}();l.install(),o.default=l},"./src/utils/utf8-conv.js":function(i,o,u){u.r(o);function l(d,f,g){var m=d;if(f+g<m.length){for(;g--;)if((m[++f]&192)!==128)return!1;return!0}else return!1}function c(d){for(var f=[],g=d,m=0,v=d.length;m<v;){if(g[m]<128){f.push(String.fromCharCode(g[m])),++m;continue}else if(!(g[m]<192)){if(g[m]<224){if(l(g,m,1)){var y=(g[m]&31)<<6|g[m+1]&63;if(y>=128){f.push(String.fromCharCode(y&65535)),m+=2;continue}}}else if(g[m]<240){if(l(g,m,2)){var y=(g[m]&15)<<12|(g[m+1]&63)<<6|g[m+2]&63;if(y>=2048&&(y&63488)!==55296){f.push(String.fromCharCode(y&65535)),m+=3;continue}}}else if(g[m]<248&&l(g,m,3)){var y=(g[m]&7)<<18|(g[m+1]&63)<<12|(g[m+2]&63)<<6|g[m+3]&63;if(y>65536&&y<1114112){y-=65536,f.push(String.fromCharCode(y>>>10|55296)),f.push(String.fromCharCode(y&1023|56320)),m+=4;continue}}}f.push(String.fromCharCode(65533)),++m}return f.join("")}o.default=c}},r={};function s(i){var o=r[i];if(o!==void 0)return o.exports;var u=r[i]={exports:{}};return t[i].call(u.exports,u,u.exports,s),u.exports}s.m=t,function(){s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,{a:o}),o}}(),function(){s.d=function(i,o){for(var u in o)s.o(o,u)&&!s.o(i,u)&&Object.defineProperty(i,u,{enumerable:!0,get:o[u]})}}(),function(){s.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)}}(),function(){s.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})}}();var a=s("./src/index.js");return a}()})})(flv);var flvExports=flv.exports;const Flv=getDefaultExportFromCjs$1(flvExports);ref(0);const activeGroup=ref(0),activeChannel=ref(-1),activeLine=ref(-1),menuName=ref(""),groupName=ref(""),channelName=ref(""),lineName=ref(""),currentGroupDataset=ref(),hlsInstance=ref(),flvInstance=ref(),videoRef=ref(),currentPlayInfo=reactive({indexs:[],names:[],line:{},menu:"",setMenu(n){this.menu=n},setLine(n){this.line=n},setNames(n="",e="",t=""){this.names=[n,e,t]},setIndexs(n=-1,e=-1,t=-1){this.indexs=[n,e,t]},title(){return this.names.slice(1,3).join("-")},info(){return this.names.join("-")},infoIndex(){return this.indexs.join("-")},navIndex(){[activeGroup.value,activeChannel.value,activeLine.value]=this.indexs},navNames(){[groupName.value,channelName.value,lineName.value]=this.names},checkGroup(){let[n,e,t]=this.indexs;activeGroup.value==n&&(activeChannel.value=e)&&(activeLine.value=t)},checkGroupAndChannel(){let[n,e,t]=this.indexs;activeGroup.value==n&&activeChannel.value==e&&(activeLine.value=t)}}),pause=()=>{var n,e;hlsInstance.value&&videoRef.value&&((n=videoRef.value)==null||n.pause()),flvInstance.value&&videoRef.value&&((e=videoRef.value)==null||e.pause(),flvInstance.value.pause())},setMuted=(n=!0)=>{videoRef.value&&(videoRef.value.muted=n)},resumePlay=()=>{var n,e;hlsInstance.value&&videoRef.value&&videoRef.value.paused&&((n=videoRef.value)==null||n.play()),flvInstance.value&&videoRef.value&&(videoRef.value.paused&&((e=videoRef.value)==null||e.play()),flvInstance.value.paused&&flvInstance.value.play()),setMuted(!1)},destroty=()=>{var n,e;hlsInstance.value&&videoRef.value&&((n=videoRef.value)==null||n.pause(),hlsInstance.value.destroy(),hlsInstance.value=null),flvInstance.value&&videoRef.value&&((e=videoRef.value)==null||e.pause(),flvInstance.value.pause(),flvInstance.value.unload(),flvInstance.value.detachMediaElement(),flvInstance.value.destroy(),flvInstance.value=null)},setAppTitle=(n="MPBugTV")=>{document.title=n},play=(n=null)=>{if(destroty(),!n)return;let e=n.value;e&&nextTick(()=>{setAppTitle(currentPlayInfo.title());const t=new RegExp(/\.mp3/gi),r=new RegExp(/\.flv/gi);console.log("play:src",e,{mp3:t.test(e),flv:r.test(e)}),t.test(e)&&playMP3(e),r.test(e)&&playFLV(e),!r.test(e)&&!t.test(e)&&playHLS(e),videoRef.value.poster=n.poster?n.poster:""})},playMP3=n=>{videoRef.value&&n&&(videoRef.value.src=n,videoRef.value.play())},playHLS=n=>{if(Hls.isSupported()&&n)try{hlsInstance.value=new Hls,hlsInstance.value.loadSource(n),hlsInstance.value.attachMedia(videoRef.value),hlsInstance.value.on(Hls.Events.MANIFEST_PARSED,function(){videoRef.value.play()}),hlsInstance.value.on(Hls.Events.ERROR,(e,t)=>{console.log("加载失败",{event:e,data:t})})}catch{}},playFLV=n=>{if(Flv.isSupported()&&n)try{flvInstance.value=Flv.createPlayer({type:"flv",url:n}),flvInstance.value.attachMediaElement(videoRef.value),flvInstance.value.load(),flvInstance.value.play()}catch{}},searchConfig=reactive({filterENABLE:!0,proxyENABLE:!0,proxyName:"wp2",proxyURL:"wp",platformCode:"ZYK1080SON",platformLabel:"优质资源库"}),handler={plugins:async n=>{var t;let e=(t=n.plugins)==null?void 0:t.update;if(e&&(e!=null&&e.name))try{let{name:r,from:s}=e,a={name:s,filterENABLE:searchConfig.filterENABLE,proxyENABLE:searchConfig.proxyENABLE,proxyName:searchConfig.proxyName},i=await searchEngine(a)[r]();return i&&(i.group=n.group),console.log("newGroup:",{newGroup:i}),i}catch(r){console.error("categoryClicked:error:",{error:r},r)}return null},loading:async n=>{let{name:e,search:t}=n,{id:r,tid:s,from:a}=t,i={filterENABLE:searchConfig.filterENABLE,proxyENABLE:searchConfig.proxyENABLE,proxyName:searchConfig.proxyName};i.name=a;let{newGroup:o}=await searchEngine(i)[t.name]({tid:s,channelName:channelName.value});return o&&(o.group=groupName.value),console.log("loading:newGroup:",{newGroup:o}),o},"id_&_from":async n=>{let{name:e,search:t}=n,{id:r,tid:s,from:a}=t,i={filterENABLE:searchConfig.filterENABLE,proxyENABLE:searchConfig.proxyENABLE,proxyName:searchConfig.proxyName};i.name=a;let o=3,u={_activePLTab:1,_groupName:groupName.value,_channelName:channelName.value,_channel:n},{newGroup:l}=await searchEngine(i).searchByVideoID({id:r,retryNum:o,callback:null,currentChannel:u});return l&&(l.group=groupName.value,l.channel&&l.channel[channelName.value].length>0&&(n=l.channel[channelName.value][0])),console.log("id_&_from:newGroup:",{newGroup:l,item:n}),{newGroup:l,newLine:n}}},loadGroupSearchContent=async n=>{try{if(n.plugins)return await handler.plugins(n)}catch{}},loadChannelSearchContent=async n=>{try{let e=n[0],{name:t,search:r}=e,{id:s,tid:a,from:i}=r;if(e.name&&e.name=="loading")return await handler.loading(e)}catch(e){console.error(e)}},loadLineSearchContent=async n=>{try{let{name:e,value:t,search:r}=n,{id:s,tid:a,from:i}=r;if(s&&i&&t=="update")return await handler["id_&_from"](n)}catch(e){console.error(e)}},updateFromNewGroup=(n,e)=>{let t=!0;for(const r of n)if(r.group==e.group){t=!1;for(const[s,a]of Object.entries(e.channel))r.channel[s]=a}t&&n.push(e)},updateLineFromNewGroup=(n,e)=>{let t=!0;for(const r of n)if(r.group==e.group){t=!1;for(const[s,a]of Object.entries(e.channel)){const i=a;for(const o of i){let u=r.channel[s].findIndex(l=>l.name==o.name);r.channel[s][u]=o}}}t&&n.push(e)},_hoisted_1$c=["src"],_sfc_main$l=defineComponent({__name:"Iframe",props:{src:null},setup(n){const e=n;return(t,r)=>(openBlock(),createElementBlock("iframe",{src:e.src,frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"true",allowfullscreen:"allowfullscreen",mozallowfullscreen:"mozallowfullscreen",msallowfullscreen:"msallowfullscreen",oallowfullscreen:"oallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",sandbox:"allow-top-navigation allow-same-origin allow-scripts"},null,8,_hoisted_1$c))}}),Iframe_vue_vue_type_style_index_0_scoped_9e58da80_lang="",Iframe$1=_export_sfc(_sfc_main$l,[["__scopeId","data-v-9e58da80"]]),requestFullscreen=(n=document.body)=>{const e=["requestFullscreen","mozRequestFullScreen","msRequestFullscreen","webkitRequestFullScreen"];for(const t of e)try{n[t]();return}catch{}return null},exitFullscreen=()=>{const n=["exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen"];for(const e of n)try{document[e]();break}catch{}},toggleFullScreen=(n=document.body)=>{document.fullscreenElement?exitFullscreen():requestFullscreen(n)},_hoisted_1$b=["src"],_sfc_main$k=defineComponent({__name:"Video",props:{src:null},setup(n){const e=n,t=()=>{},r=()=>{},s=ref(),a=computed(()=>e.src),i=()=>{requestFullscreen(videoRef.value)};return watch(a,(o,u)=>{o&&play()}),onMounted(()=>{videoRef.value=s.value,nextTick(()=>{e.src&&play(e.src)})}),onUnmounted(()=>{destroty()}),(o,u)=>(openBlock(),createElementBlock("video",{autoplay:"",muted:"",controls:"",ref_key:"videoDom",ref:s,onDblclick:i,onMouseover:t,onMouseleave:r,src:e.src},null,40,_hoisted_1$b))}}),Video_vue_vue_type_style_index_0_scoped_fe690c98_lang="",Video=_export_sfc(_sfc_main$k,[["__scopeId","data-v-fe690c98"]]),_withScopeId$3=n=>(pushScopeId("data-v-b5005ea3"),n=n(),popScopeId(),n),_hoisted_1$a=["title"],_hoisted_2$6={class:"play-top-right-bar"},_hoisted_3$5=_withScopeId$3(()=>createBaseVNode("i",{class:"fa fa-arrows-alt"},null,-1)),_hoisted_4$4=[_hoisted_3$5],_hoisted_5$3={class:"play-list"},_hoisted_6$1={class:"play-controller"},_hoisted_7$1={class:"play-title"},_hoisted_8$1={class:"title"},_hoisted_9$1=["onClick","title"],_sfc_main$j=defineComponent({__name:"Player",props:{channelName:null,lines:null},setup(n,{expose:e}){const t=ref(),r=ref(),s=ref(),a=ref(!1),i=computed(()=>a.value?Iframe$1:Video),o=async v=>{try{let{newGroup:y,newLine:E}=await loadLineSearchContent(v);console.log("!!!onClickLine",{newGroup:y,currentGroupDataset:currentGroupDataset.value}),E&&(v=E,updateLineFromNewGroup(currentGroupDataset.value,y))}catch{}return v},u=async(v,y)=>{v&&(console.log("onClickLine",{item:v,index:y}),v=await o(v),lineName.value=v.name,activeLine.value=y,s.value=v.value,a.value=v==null?void 0:v.iframe,!a.value&&play(v),currentPlayInfo.setLine(v),currentPlayInfo.setNames(groupName.value,channelName.value,lineName.value),currentPlayInfo.setIndexs(activeGroup.value,activeChannel.value,activeLine.value),addPathSearch("active",currentPlayInfo.infoIndex()))},l=()=>{currentPlayInfo.navIndex(),currentPlayInfo.navNames()},c=()=>{r.value&&(setTransition(r.value,"transform 0.5s, opacity 0.5s"),setOpacity(r.value,0),setTransform(r.value,"translateY(-40px"))},d=()=>{r.value&&(setTransition(r.value,"transform 0.5s, opacity 0.5s"),setOpacity(r.value,1),setTransform(r.value,"translateY(0px"))},f=ref(!1),g=ref();return watch(f,(v,y)=>{v&&d(),!v&&c()}),onUnmounted(()=>{t.value&&(t.value.onmousemove=null)}),onMounted(()=>{nextTick(()=>{f.value=!1,g.value=null,t.value.onmousemove=function(){f.value=!0,clearTimeout(g.value),currentPlayInfo.info()&&(g.value=setTimeout(function(){f.value=!1},2e3))}})}),e({onClickLine:u,onClickPlaybox:()=>{t.value.click()}}),(v,y)=>{const E=resolveComponent("lu");return openBlock(),createElementBlock(Fragment$1,null,[createBaseVNode("div",{class:"play-box",ref_key:"playbox",ref:t,onTouchstart:d,onMouseleave:c,onMouseenter:d},[unref(currentPlayInfo).info()?(openBlock(),createElementBlock("div",{key:0,class:"play-top-bar",ref_key:"playTopBar",ref:r},[createBaseVNode("span",{class:"text-elipsis",onClick:y[0]||(y[0]=_=>l()),title:unref(currentPlayInfo).info()},toDisplayString(unref(currentPlayInfo).info()),9,_hoisted_1$a),createBaseVNode("span",_hoisted_2$6,[createBaseVNode("span",{onClick:y[1]||(y[1]=_=>unref(toggleFullScreen)(t.value)),title:"全屏"},_hoisted_4$4)])],512)):createCommentVNode("",!0),(openBlock(),createBlock(resolveDynamicComponent(unref(i)),{src:s.value},null,8,["src"]))],544),createBaseVNode("div",_hoisted_5$3,[createBaseVNode("div",_hoisted_6$1,[createBaseVNode("div",_hoisted_7$1,[createBaseVNode("span",_hoisted_8$1,toDisplayString(unref(channelName)),1)])]),createVNode(E,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(n.lines,(_,T)=>(openBlock(),createElementBlock("li",{class:normalizeClass(["text-elipsis",{active:unref(activeLine)==T}]),onClick:S=>u(_,T),key:T,title:_.name},toDisplayString(_.name),11,_hoisted_9$1))),128))]),_:1})])],64)}}}),Player_vue_vue_type_style_index_0_scoped_b5005ea3_lang="",Player=_export_sfc(_sfc_main$j,[["__scopeId","data-v-b5005ea3"]]),_hoisted_1$9=["src"],_sfc_main$i=defineComponent({__name:"Iframe",props:{src:null},setup(n){const e=n;return(t,r)=>(openBlock(),createElementBlock("iframe",{src:e.src,frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"true",allowfullscreen:"allowfullscreen",mozallowfullscreen:"mozallowfullscreen",msallowfullscreen:"msallowfullscreen",oallowfullscreen:"oallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",sandbox:"allow-top-navigation allow-same-origin allow-scripts"},null,8,_hoisted_1$9))}}),Iframe_vue_vue_type_style_index_0_scoped_16e391db_lang="",Iframe=_export_sfc(_sfc_main$i,[["__scopeId","data-v-16e391db"]]),getCover=n=>{try{if(n.constructor.name=="Array"&&n.length>0&&(n=n[0]),n.poster)return n.poster;if(n.cover)return n.cover;if(n.url||n.value)return`https://api.iowen.cn/favicon/${new URL(n.url||n.value).hostname}.png`}catch{}return"/assets/logo.svg"},_withScopeId$2=n=>(pushScopeId("data-v-d0f35a23"),n=n(),popScopeId(),n),_hoisted_1$8=["title"],_hoisted_2$5={class:"play-top-right-bar"},_hoisted_3$4=_withScopeId$2(()=>createBaseVNode("i",{class:"fa fa-arrows-alt"},null,-1)),_hoisted_4$3=[_hoisted_3$4],_hoisted_5$2={class:"play-list"},_hoisted_6={class:"play-controller"},_hoisted_7={class:"play-title"},_hoisted_8={class:"title"},_hoisted_9=["onClick","title"],_hoisted_10=["title"],_hoisted_11={key:0},_hoisted_12=["href","title"],_hoisted_13=_withScopeId$2(()=>createBaseVNode("i",{class:"fa fa-sign-out icon","aria-hidden":"true"},null,-1)),_hoisted_14=[_hoisted_13],_sfc_main$h=defineComponent({__name:"Player",props:{channelName:null,lines:null},setup(n,{expose:e}){const t=ref(),r=ref(),s=ref(),a=ref(!1),i=computed(()=>(a.value,Iframe)),o=(m,v)=>{m&&(console.log("onClickLine",{item:m,index:v}),lineName.value=m.name,activeLine.value=v,s.value=m.value||m.url,a.value=m==null?void 0:m.iframe,!a.value&&play(m.value||m.url),currentPlayInfo.setLine(m),currentPlayInfo.setNames(groupName.value,channelName.value,lineName.value),currentPlayInfo.setIndexs(activeGroup.value,activeChannel.value,activeLine.value),addPathSearch("active",currentPlayInfo.infoIndex()))},u=()=>{currentPlayInfo.navIndex(),currentPlayInfo.navNames()},l=()=>{r.value&&(setTransition(r.value,"transform 0.5s, opacity 0.5s"),setOpacity(r.value,0),setTransform(r.value,"translateY(-40px"))},c=()=>{r.value&&(setTransition(r.value,"transform 0.5s, opacity 0.5s"),setOpacity(r.value,1),setTransform(r.value,"translateY(0px"))},d=ref(!1),f=ref();return watch(d,(m,v)=>{m&&c(),!m&&l()}),onUnmounted(()=>{t.value&&(t.value.onmousemove=null)}),onBeforeMount(()=>{window.addEventListener("error",m=>{console.log("window:error",{event:m}),console.error(m)})}),onMounted(()=>{nextTick(()=>{d.value=!1,f.value=null})}),e({onClickLine:o,onClickPlaybox:()=>{t.value.click()}}),(m,v)=>{const y=resolveComponent("lu");return openBlock(),createElementBlock(Fragment$1,null,[createBaseVNode("div",{class:"play-box",ref_key:"playbox",ref:t},[unref(currentPlayInfo).info()?(openBlock(),createElementBlock("div",{key:0,class:"play-top-bar",ref_key:"playTopBar",ref:r},[createBaseVNode("span",{class:"text-elipsis",onClick:v[0]||(v[0]=E=>u()),title:unref(currentPlayInfo).info()},"Preview："+toDisplayString(unref(currentPlayInfo).info()),9,_hoisted_1$8),createBaseVNode("span",_hoisted_2$5,[createBaseVNode("span",{onClick:v[1]||(v[1]=E=>unref(toggleFullScreen)(t.value)),title:"全屏"},_hoisted_4$3)])],512)):createCommentVNode("",!0),(openBlock(),createBlock(resolveDynamicComponent(unref(i)),{src:s.value},null,8,["src"]))],512),createBaseVNode("div",_hoisted_5$2,[createBaseVNode("div",_hoisted_6,[createBaseVNode("div",_hoisted_7,[createBaseVNode("span",_hoisted_8,toDisplayString(unref(channelName)),1)])]),createVNode(y,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(n.lines,(E,_)=>(openBlock(),createElementBlock("li",{class:normalizeClass(["text-elipsis",{active:unref(activeLine)==_}]),onClick:T=>o(E,_),key:_,title:E.name},[createBaseVNode("div",{class:"icon",style:normalizeStyle({background:`url(${unref(getCover)(E)}) center center / contain no-repeat`})},null,4),createBaseVNode("span",{class:"text-elipsis",title:"快速预览："+E.name},toDisplayString(E.name),9,_hoisted_10),E.value||E.url?(openBlock(),createElementBlock("span",_hoisted_11,[createBaseVNode("a",{href:E.value||E.url,target:"_blank",title:"新页直连："+(E.value||E.url)},_hoisted_14,8,_hoisted_12)])):createCommentVNode("",!0)],10,_hoisted_9))),128))]),_:1})])],64)}}}),Player_vue_vue_type_style_index_0_scoped_d0f35a23_lang="",Software=_export_sfc(_sfc_main$h,[["__scopeId","data-v-d0f35a23"]]),_hoisted_1$7={class:"group-area"},_hoisted_2$4=["onClick"],_hoisted_3$3={class:"channels"},_hoisted_4$2=["onKeydown","onClick","tabindex"],_hoisted_5$1={class:"bg-word"},_sfc_main$g=defineComponent({__name:"GridBox",props:{dataset:null,page:{default:"player"}},setup(n,{expose:e}){const t=n,r={player:Player,software:Software},s=computed(()=>r[t.page]||Player),a=ref([]),i=T=>{a.value.push(T)},o=ref(),u=ref(),l=ref(),c=ref();watch(()=>t.dataset,(T,S)=>{console.log("watch:dataset",{cur:T,pre:S}),currentGroupDataset.value=[...T]});const d=computed(()=>{var T,S;return currentGroupDataset.value?(groupName.value=((T=currentGroupDataset.value[activeGroup.value])==null?void 0:T.group)||"",((S=currentGroupDataset.value[activeGroup.value])==null?void 0:S.channel)||{}):{}}),f=computed(()=>d.value[channelName.value]||[]),g=T=>{try{if(T.constructor.name=="Array"&&T.length>0&&(T=T[0]),T.poster)return T.poster;if(T.cover)return T.cover;if(T.url||T.value)return`https://api.iowen.cn/favicon/${new URL(T.url||T.value).hostname}.png`}catch{}return""},m=()=>{setOpacity(o.value,1);let S=o.value.clientHeight/2*16/9;u.value.style.gridTemplateColumns=`150px auto ${S}px`,resumePlay()},v=()=>{setOpacity(o.value,0),u.value.style.gridTemplateColumns="150px auto 0px",activeChannel.value=-1,pause()},y=async(T,S)=>{groupName.value=T.group,activeGroup.value=S,activeChannel.value=-1,setScrollTop(l.value,0),currentPlayInfo.setMenu(menuName.value),currentPlayInfo.checkGroup();let x=await loadGroupSearchContent(T);x&&(console.log("!!!onClickGroup",{newGroup:x,currentGroupDataset:currentGroupDataset.value}),updateFromNewGroup(currentGroupDataset.value,x))},E=async(T,S)=>{if(!T)return;if(channelName.value=T,activeLine.value=-1,activeChannel.value==S){v();return}activeChannel.value=S;let x=d.value[T];console.log("onClickCard",{item:T,channel:x,pa:o.value}),m(),currentPlayInfo.checkGroupAndChannel(),_(),currentPlayInfo.setIndexs(activeGroup.value,activeChannel.value,0),addPathSearch("active",currentPlayInfo.infoIndex());let b=await loadChannelSearchContent(x);console.log("!!!onClickCard",{newGroup:b,currentGroupDataset:currentGroupDataset.value}),b&&updateFromNewGroup(currentGroupDataset.value,b)},_=()=>{const T=u.value;console.log("~~gotoBottom",{el:T}),T&&T.scrollTo({top:T.offsetHeight,behavior:"smooth"})};return onMounted(()=>{currentGroupDataset.value=t.dataset,nextTick(()=>{let{active:T}=currentPathSearch.obj;if(T){let[S,x,b]=T.split("-");currentPlayInfo.setIndexs(S,x,b),currentPlayInfo.navIndex(),channelName.value=Object.keys(d.value)[x],m(),console.log("~~~~player.value.playbox",c.value),c.value.onClickLine(f.value[b],b),c.value.onClickPlaybox(),setTimeout(()=>{resumePlay(),_()},3e3)}console.log("!!!active",T,Object.keys(d.value),currentPlayInfo)})}),e({gridBoxRef:u}),(T,S)=>(openBlock(),createElementBlock("div",{class:"grid-box",ref_key:"gridBoxRef",ref:u},[createBaseVNode("div",_hoisted_1$7,[renderSlot(T.$slots,"group",{},void 0,!0),createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(n.dataset,(x,b)=>(openBlock(),createElementBlock("li",{onClick:A=>y(x,b),class:normalizeClass([{active:b==unref(activeGroup)}]),key:b},[createBaseVNode("span",null,[createBaseVNode("i",{class:normalizeClass(x.icon||"fa fa-desktop")},null,2)]),createBaseVNode("span",null,toDisplayString(x.group),1)],10,_hoisted_2$4))),128))])]),createBaseVNode("div",{class:"content-area",ref_key:"contentAreaRef",ref:l},[renderSlot(T.$slots,"content",{},void 0,!0),createBaseVNode("div",_hoisted_3$3,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(Object.keys(unref(d)),(x,b)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["card-box",[{"card-active":b==unref(activeChannel)}]]),onKeydown:withKeys(A=>E(x,b),["enter"]),onClick:withModifiers(A=>E(x,b),["stop"]),key:b,tabindex:b,ref_for:!0,ref:i},[createBaseVNode("span",{class:normalizeClass(["card",{bg:g(unref(d)[x])}]),style:normalizeStyle({background:`url(${g(unref(d)[x])}) center center / contain no-repeat`,"background-size":"32px","background-position":"bottom right"})},null,6),createBaseVNode("span",_hoisted_5$1,toDisplayString(x[0]||""),1),createBaseVNode("span",null,toDisplayString(x),1)],42,_hoisted_4$2))),128))])],512),createBaseVNode("div",{class:"player-area",ref_key:"playerAreaRef",ref:o},[(openBlock(),createBlock(resolveDynamicComponent(unref(s)),{ref_key:"player",ref:c,channelName:unref(channelName),lines:unref(f)},null,8,["channelName","lines"]))],512)],512))}}),GridBox_vue_vue_type_style_index_0_scoped_17f19203_lang="",GridBox=_export_sfc(_sfc_main$g,[["__scopeId","data-v-17f19203"]]),cnrRadio=[{group:"央广电台",icon:"fa fa-podcast",channel:{中国之声:[{name:"高音质",value:"update",search:{id:"639",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"639",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],经济之声:[{name:"高音质",value:"update",search:{id:"640",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"640",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],环球资讯广播:[{name:"高音质",value:"update",search:{id:"692",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"692",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],音乐之声:[{name:"高音质",value:"update",search:{id:"641",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"641",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],中国交通广播:[{name:"高音质",value:"update",search:{id:"653",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"653",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],文艺之声:[{name:"高音质",value:"update",search:{id:"648",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"648",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],大湾区之声:[{name:"高音质",value:"update",search:{id:"645",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"645",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],经典音乐广播:[{name:"高音质",value:"update",search:{id:"642",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"642",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],台海之声:[{name:"高音质",value:"update",search:{id:"643",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"643",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],神州之声:[{name:"高音质",value:"update",search:{id:"644",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"644",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],香港之声:[{name:"高音质",value:"update",search:{id:"646",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"646",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],民族之声:[{name:"高音质",value:"update",search:{id:"647",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"647",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],老年之声:[{name:"高音质",value:"update",search:{id:"649",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"649",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],藏语广播:[{name:"高音质",value:"update",search:{id:"650",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"650",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],维吾尔语广播:[{name:"高音质",value:"update",search:{id:"651",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"651",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],阅读之声:[{name:"高音质",value:"update",search:{id:"652",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"652",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],中国乡村之声:[{name:"高音质",value:"update",search:{id:"654",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"654",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],哈萨克语广播:[{name:"高音质",value:"update",search:{id:"655",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"655",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],HITFM劲曲调频:[{name:"高音质",value:"update",search:{id:"662",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"662",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],轻松调频:[{name:"高音质",value:"update",search:{id:"689",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"689",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],南海之声:[{name:"高音质",value:"update",search:{id:"664",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"664",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"线路(跨域限制)",value:"update"}],"英语资讯广播 CGTN Radio":[{name:"高音质",value:"update",search:{id:"734",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}},{name:"低音质",value:"update",search:{id:"734",tid:0,type:"中央人民广播电台",line:"",from:"ZYYT",playfrom:""}}]}}],cctv=[{group:"央视频道",icon:"fa fa-play-circle",channel:{CCTV13新闻:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"https://live-play.cctvnews.cctv.com/cctv/merge_cctv13_mud.m3u8"},{name:"线路HD",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240502_1/playlist.m3u8?CONTENTID=00000110240502_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"线路2.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225638/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv13_2.m3u8"}],CCTV1综合:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"https://cctvwbndks.v.kcdnvip.com/cctvwbnd/cctv1_2/index.m3u8"},{name:"线路HD",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240127_1/encoder/0/playlist.m3u8?CONTENTID=00000110240127_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-1/live.m3u8"},{name:"线路2.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225642/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv1_2.m3u8"}],CCTV2财经:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"https://cctvwbndks.v.kcdnvip.com/cctvwbnd/cctv2_2/index.m3u8"},{name:"线路HD",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240244_1/playlist.m3u8?CONTENTID=00000110240244_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"线路2.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225643/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv2_2.m3u8"}],CCTV3综艺:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240245_1/encoder/1/playlist.m3u8?CONTENTID=00000110240245_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-3/live.m3u8"},{name:"线路2.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225647/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225634/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv3_2.m3u8"}],CCTV4国际:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"https://www.kankanzhibo.com/player/index?id=1302",iframe:!0,parserURL:""},{name:"线路HD",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240316_1/playlist.m3u8?CONTENTID=00000110240316_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"线路2.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225621/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225621/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv4_2.m3u8"}],CCTV5体育:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"https://node1.olelive.com:6443/live/CCTV5HD/hls.m3u8"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-5/live.m3u8"},{name:"线路HD(跨域限制)",value:"http://39.135.138.59:18890/PLTV/88888910/224/3221225633/index.m3u8"},{name:"线路.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225633/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv5_2.m3u8"}],"CCTV5+HD体育":[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/cctv5phd/4000000/mnf.m3u8"},{name:"线路.HD(跨域限制)",value:"http://39.135.138.60:18890/PLTV/88888910/224/3221225649/index.m3u8"},{name:"线路2.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225706/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv5plus_2.m3u8"}],CCTV6电影:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240247_1/encoder/1/playlist.m3u8?CONTENTID=00000110240247_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"线路2",value:"http://113.62.253.22/live.aishang.ctlcdn.com/00000110240247_1/playlist.m3u8?CONTENTID=00000110240247_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-6/live.m3u8"},{name:"线路.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225650/index.m3u8"},{name:"线路.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225632/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv6_2.m3u8"}],CCTV7国防军事:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/cctv7/1300000/mnf.m3u8"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-7/live.m3u8"},{name:"线路.HD(跨域限制)",value:"http://39.135.138.60:18890/PLTV/88888910/224/3221225624/index.m3u8"},{name:"线路.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225624/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv7_2.m3u8"}],CCTV8电视剧:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240249_1/encoder/1/playlist.m3u8?CONTENTID=00000110240249_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"线路2.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225635/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225631/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv8_2.m3u8"}],CCTV9纪录:[{name:"线路1.HD",url:"https://tv.cctv.com/live/",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240250_1/encoder/1/playlist.m3u8?CONTENTID=00000110240250_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-9/live.m3u8"},{name:"线路2.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225646/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225646/index.m3u8"},{name:"audio",value:"https://piccpndali.v.myalicdn.com/audio/cctv9_2.m3u8"}],CCTV10科教:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240251_1/encoder/1/playlist.m3u8?CONTENTID=00000110240251_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-10/live.m3u8"},{name:"线路2",value:"http://39.134.66.66/PLTV/88888888/224/3221225677/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225636/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv10_2.m3u8"}],CCTV11戏曲:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240328_1/encoder/0/playlist.m3u8?CONTENTID=00000110240328_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-11/live.m3u8"},{name:"线路2.HD(跨域限制)",value:"http://39.135.138.59:18890/PLTV/88888910/224/3221225628/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225628/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv11_2.m3u8"}],CCTV12社会法制:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240252_1/encoder/1/playlist.m3u8?CONTENTID=00000110240252_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-12/live.m3u8"},{name:"线路2.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225637/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv12_2.m3u8"}],CCTV14少儿:[{name:"线路1",url:"https://tv.cctv.com/live/",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/cctvsehd/4000000/mnf.m3u8"},{name:"河南党教(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-cctv-14/live.m3u8"},{name:"线路2.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225639/index.m3u8"},{name:"线路3.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225640/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv14_2.m3u8"}],CCTV15音乐:[{name:"线路2.IP6(跨域限制)",url:"https://tv.cctv.com/live/",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225641/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv15_2.m3u8"}],CCTV16奥林匹克:[{name:"线路2.IP6(跨域限制)",url:"https://tv.cctv.com/live/",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221226230/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv16_2.m3u8"}],CCTV17农业:[{name:"线路.HD(跨域限制)",url:"https://tv.cctv.com/live/",value:"http://39.135.138.58:18890/PLTV/88888910/224/3221225908/index.m3u8"},{name:"线路.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221225909/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv17_2.m3u8"}],CCTV纯4K:[{name:"线路.4K(跨域限制)",url:"https://tv.cctv.com/live/",value:"http://39.135.138.60:18890/PLTV/88888910/224/3221225786/index.m3u8"},{name:"audio",value:"https://piccpndks.v.kcdnvip.com/audio/cctv16_2.m3u8"}]}},{group:"CGTN",channel:{"CGTN.NEWS":[{name:"线路1",url:"https://news.cgtn.com",value:"https://news.cgtn.com/resource/live/english/cgtn-news.m3u8"}],"CGTN.DOC":[{name:"线路1",url:"https://news.cgtn.com",value:"https://livedoc.cgtn.com/1000d/prog_index.m3u8"}],CGTN俄语:[{name:"线路1",url:"https://news.cgtn.com",value:"http://news.cgtn.com/resource/live/russian/cgtn-r.m3u8"}],CGTN法语:[{name:"线路1",url:"https://news.cgtn.com",value:"https://livefr.cgtn.com/1000f/prog_index.m3u8"}],CGTN阿语:[{name:"线路1",url:"https://news.cgtn.com",value:"https://livear.cgtn.com/1000a/prog_index.m3u8"}],CGTN西班牙:[{name:"线路1",url:"https://news.cgtn.com",value:"https://livees.cgtn.com/1000e/prog_index.m3u8"}],CETV1综合:[{name:"线路(跨域限制)",url:"https://news.cgtn.com",value:"http://txycsbl.centv.cn/zb/0628cetv1.m3u8"}],CETV2继续教育:[{name:"线路(跨域限制)",url:"https://news.cgtn.com",value:"http://txycsbl.centv.cn/zb/0822cetv2.m3u8"}],CETV3人文纪录:[{name:"线路(跨域限制)",url:"https://news.cgtn.com",value:"http://txycsbl.centv.cn/zb/0822cetv3.m3u8"}],CETV4空中课堂:[{name:"线路(跨域限制)",url:"https://news.cgtn.com",value:"http://txycsbl.centv.cn/zb/0822cetv4.m3u8"}],中国新华新闻电视网:[{name:"线路(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225694/index.m3u8"}]}}],radio=[{group:"地方广播",icon:"fa fa-podcast",plugins:{update:{name:"getRadioProvinceList",from:"ZYYT"}},channel:{音乐电台:[{name:"經典FM",value:"https://play-radio-stream3.hndt.com/now/C5NvUpwy/playlist.m3u8"},{name:"警廣之聲",value:"https://play-radio-stream3.hndt.com/now/prIgXGFo/playlist.m3u8"},{name:"舞迷心竅",value:"https://play-radio-stream3.hndt.com/now/WBhgSD3A/playlist.m3u8"},{name:"天籟古典",value:"https://play-radio-stream3.hndt.com/now/MdOpB4zP/playlist.m3u8"},{name:"民謠藍調",value:"https://play-radio-stream3.hndt.com/now/XWfN89gh/playlist.m3u8"},{name:"80後音樂台",value:"https://play-radio-stream3.hndt.com/now/SFZeH2cb/playlist.m3u8"},{name:"潮流音樂台",value:"https://play-radio-stream3.hndt.com/now/Or5au0KN/playlist.m3u8"},{name:"搖滾天空台",value:"https://play-radio-stream3.hndt.com/now/SXJtR4M4/playlist.m3u8"},{name:"動感音樂台",value:"https://play-radio-stream3.hndt.com/now/ufjjbZxV/playlist.m3u8"},{name:"民謠音樂台",value:"https://play-radio-stream3.hndt.com/now/DTK5qc83/playlist.m3u8"},{name:"心靈音樂館",value:"https://play-radio-stream3.hndt.com/now/AFqvb0VX/playlist.m3u8"},{name:"格萊美音樂台",value:"https://play-radio-stream3.hndt.com/now/yorSd1X2/playlist.m3u8"},{name:"天籟之音.國風",value:"https://play-radio-stream3.hndt.com/now/UzPxbRaT/playlist.m3u8"},{name:"天籟之音.Hi-Fi.Radio",value:"https://play-radio-stream3.hndt.com/now/JxkyN5mR/playlist.m3u8"},{name:"天籁之音.经典正流行",value:"https://play-radio-stream3.hndt.com/now/WUBA5hW2/playlist.m3u"}],香港:[{name:"普通話台",value:"https://rthkaudio6-lh.akamaihd.net/i/radiopth_1@355869/master.m3u8?audio"},{name:"第一台",value:"https://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8"},{name:"第二台",value:"https://rthkaudio2-lh.akamaihd.net/i/radio2_1@355865/master.m3u8"},{name:"第三台",value:"https://rthkaudio3-lh.akamaihd.net/i/radio3_1@355866/master.m3u8"},{name:"第四台",value:"https://rthkaudio4-lh.akamaihd.net/i/radio4_1@355867/master.m3u8"},{name:"第五台",value:"https://rthkaudio5-lh.akamaihd.net/i/radio5_1@355868/master.m3u8"}],台湾:[{name:"国立教育.高雄",url:"https://www.kh.edu.tw",value:"https://cast.ner.gov.tw/5"},{name:"国立教育.台东",value:"https://cast.ner.gov.tw/6"},{name:"国立教育.台东2",value:"https://cast.ner.gov.tw/7"},{name:"台北百家知识",value:"http://livestream.1766.today:1768/live1.mp3"},{name:"中广新闻网",value:"http://n05a-eu.rcs.revma.com/78fm9wyy2tzuv?rj-ttl=5&rj-tok=AAABgNbkEy8ABT_5ZlPby5oz3g"},{name:"时刻新闻",value:"http://n29a-eu.rcs.revma.com/55tyxsy4qtzuv.m4a?rj-ttl=5&rj-tok=AAABgNbkd3IA1UYuWKM3EfouAA"},{name:"竹科广播",value:"https://n08a-eu.rcs.revma.com/7mnq8rt7k5zuv?rj-ttl=5&rj-tok=AAABgo42HEIA4mKJbXtsAAi0GA"},{name:"台视",value:"http://61.219.170.95:18543/.m3u8"},{name:"年代",value:"http://61.219.170.95:18558/.m3u8"},{name:"八大1台",value:"http://61.219.170.95:18539/.m3u8"},{name:"卫视中文",value:"http://61.219.170.95:18522/.m3u8"}],河南广播:[{name:"新闻广播",url:"https://www.hntv.tv",value:"https://stream.hndt.com/live/xinwen/playlist.m3u8?audio"},{name:"交通广播",value:"https://stream.hndt.com/live/jiaotong/playlist.m3u8?audio"},{name:"戏曲广播",value:"https://stream.hndt.com/live/yule/playlist.m3u8?audio"},{name:"音乐广播",value:"https://stream.hndt.com/live/yinyue/playlist.m3u8?audio"},{name:"经济广播",value:"https://stream.hndt.com/live/jingji/playlist.m3u8?audio"},{name:"教育广播",value:"https://stream.hndt.com/live/jiaoyu/playlist.m3u8?audio"}],南宁:[{name:"南宁1074交通台",value:"https://hls.nntv.cn/nnradio/FM1074.m3u8"},{name:"南宁1049经典",value:"https://hls.nntv.cn/nnradio/FM1049.m3u8"},{name:"南宁990新闻台",value:"https://hls.nntv.cn/nnradio/FM1014.m3u8"},{name:"南宁895快乐",value:"https://hls.nntv.cn/nnradio/FM895.m3u8"}]}}],liveCap=[{group:"直播中国",icon:"fa fa-video-camera",channel:{中央电视塔中塔西:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/ztx_1/index.m3u8"}],九华山:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/jhs05_1_md.m3u8"}],九寨沟:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/wygjt1_1/index.m3u8?contentid=2820180516001"}],"云台山-小寨沟":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/ytsxzg_1_md.m3u8"}],云龙山观景台南:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/ylh03_1_md.m3u8"}],六盘山红军长征景区:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/lpsgmjng01_1_md.m3u8"}],"北京.密云.古北水镇":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/dlst03_1/index.m3u8"}],十八洞村:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/sbd01_1/index.m3u8"}],南天一柱:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/tyhjntyz_1/index.m3u8?contentid=2820180516001"}],双乳峰:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xysrf_1_md.m3u8",lyric:""}],"吉林.松花江.市区段":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/zh03_1_md.m3u8"}],"四川.乐山睡佛":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hkhs01_1_md.m3u8"}],"四川.凉山.彝族自治州.西昌市.邛海景区":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/xcqh01_1/index.m3u8"}],"四川.凉山.邛海景区":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xcqh01_1_md.m3u8"}],"四川.阿坝州.九曲黄河第一湾":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/tyhjtynl_1/index.m3u8?contentid=2820180516001"}],大容山莲花山顶:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/drs01_1_md.m3u8"}],"浙江.杭州.西湖断桥":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xjtcmys_1_md.m3u8"}],宁夏黄河大峡谷:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hhdxg01_1/index.m3u8"}],宁夏黄河漂流:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nxspthhpl_1_md.m3u8"}],"山东.日照.东港区灯塔广场":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/gly01_1_md.m3u8"}],"山东.泰山.大观峰":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/taishan03_1/index.m3u8?contentid=2820180516001"}],"山东.泰山天街":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hsxksqj_1/index.m3u8"}],"山东.潍坊.安丘市青云山民俗游乐园":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hssxf_1/index.m3u8?contentid=2820180516001"}],峨眉云海日出:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/emsarm_1/index.m3u8?contentid=2820180516001"}],峨眉山远眺贡嘎雪山:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/emsyh_1/index.m3u8"}],"广东.广州塔.海心桥":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/ztb_1_md.m3u8"}],"广东.珠海.港珠澳大桥风帆塔":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/qdls04_1_md.m3u8"}],"广东.珠海.珠海大剧院":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/dxsdtts_1/index.m3u8"}],"广东.韶关.新丰马头镇":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/ljgcdyhxgjt_1/index.m3u8"}],"广西.柳州.河东市民广场":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/lsdfgfl_1_md.m3u8"}],"张家界-阿凡达悬浮山":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/zjjafdxfs_1_md.m3u8"}],张家界将军列队:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/zjjjjdl_1/index.m3u8?contentid=2820180516001"}],张家界武陵源景区宝峰湖:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/zjjbfh_1/index.m3u8"}],张家界武陵源景区迷魂台:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/zjjmht_1/index.m3u8"}],成都大熊猫繁育研究基地:[{name:"基地1",value:"https://gcwbcdtxy.liveplay.myqcloud.com/gcwbcd/cdrmipanda_1/index.m3u8"}],"新疆.伊犁.巩留县蝶湖公园":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hgsylztpb_1/index.m3u8"}],"新疆.阜康.天山天池":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xjtcdhsz_1_md.m3u8"}],无锡惠山二茅峰望锡城:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/wysdhpcy_1/index.m3u8?contentid=2820180516001"}],日月石:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/tyhjrys_1_md.m3u8"}],朱鹮04:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/zh04_1_md.m3u8"}],桂林漓江景区:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/gllj01_1_md.m3u8"}],"江苏.句容.天王樱花园晚樱大道":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nywbwg01_1_md.m3u8"}],"江苏.无锡.惠山二茅峰望锡城":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/wysdhpcy_1/index.m3u8?contentid=2820180516001"}],江苏徐州云龙湖风景区云龙山观景台南:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/ylh03_1/index.m3u8"}],江苏聚龙湖:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nxsptdmgy_1_md.m3u8"}],江西武功山云顶:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/jyg04_1/index.m3u8?contentid=2820180516001"}],"河南.南阳.淅川县丹江口水库":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/hsxkscj_1_md.m3u8"}],"河南.洛阳.中国国花园新七福神":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/tjhh02_1_md.m3u8"}],"河南.洛阳.瀍壑朱樱":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/sgns02_1_md.m3u8"}],泰山主峰:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/taishan01_1/index.m3u8?contentid=2820180516001"}],"浙江.乌镇.蓝印花布":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/zjwzlyhb_1/index.m3u8"}],"浙江.杭州.云栖小镇":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/hnttpgsz_1_md.m3u8"}],"浙江.杭州.千岛湖":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/caqdh_1_md.m3u8"}],"浙江.杭州.西湖全景":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xjtcdgs_1_md.m3u8"}],"浙江.杭州.西湖区龙坞茶镇":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/wysyxdhp_1/index.m3u8?contentid=2820180516001"}],"浙江.温州.泰顺县廊桥文化园":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nss01_1_md.m3u8"}],浙江舟山东极岛:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/djd01_1_md.m3u8"}],"湖南.张家界.天门山天空步道":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/djyewm_1_md.m3u8"}],"湖南.张家界.武陵源黄石寨":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/szgk01_1/index.m3u8"}],"湖南.湘西州.凤凰古城":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/fhgcdnhs_1_md.m3u8"}],"湖南.湘西州.泸溪县潭溪镇大陂流村":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/zyqcdx01_1_md.m3u8"}],"湖南.衡阳.衡阳县华山村":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hkts11_1/index.m3u8"}],"湖南.邵阳.茛山将军石":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/xjtchxpt_1_md.m3u8"}],"湖南.邵阳.茛山骆驼峰":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/jhs05_1/index.m3u8"}],湘西凤凰古城南华山:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/fhgcdnhs_1/index.m3u8"}],牡丹江雪乡梦幻家园:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/mdjxxmhjyxj_1/index.m3u8"}],"甘肃.嘉峪关.关城景区":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/dxssyt_1_md.m3u8"}],直播中国精编直播:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/wgw05_1_md.m3u8"}],"福建.漳州.官畲景区":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/tms04_1/index.m3u8"}],舟山东极岛:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/djd01_1_md.m3u8"}],"西藏.墨脱.海市蜃楼观景台":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nxsptdmgy_1_md.m3u8"}],"辽宁.沈阳.浑河桥":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/ljgcdsc_1/index.m3u8"}],"都江堰.鱼嘴":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/djyqyl1_1/index.m3u8"}],重庆洪崖洞:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/tyhjtys_1/index.m3u8?contentid=2820180516001"}],长津湖:[{name:"线路1",value:"https://cdn.oss-cn-hangzhou-shanghai.myqcloud.com.zhegeyuming.top/video/1647245120032.m3u",lyric:"",error:!0}],"陕西.安康.凤堰古梯田":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/emsyh_1/index.m3u8?contentid=2820180516001"}],"陕西.汉中.南郑区陈村水库":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/zsslstpt_1/index.m3u8"}],"陕西.汉中.朱鹨自然保护区":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/ytshsx_1/index.m3u8"}],"陕西.汉中.洋县朱鹨梨园":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/zdxq01_1_md.m3u8"}],雪乡梦幻家园:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/mdjxxmhjyxj_1/index.m3u8?contentid=2820180516001"}],"黄山-梦笔生花":[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/hsmbsh_1_md.m3u8"}],黄河漂流:[{name:"线路1",value:"http://gctxyc.liveplay.myqcloud.com/gc/nxspthhpl_1_md.m3u8"}],"黑龙江.哈尔滨.霁虹桥":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/hkts09_1/index.m3u8"}],"黑龙江.牡丹江.镜泊湖":[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/jyg04_1/index.m3u8?contentid=2820180516001"}],黟县宏村月沼:[{name:"线路1",value:"https://gctxyc.liveplay.myqcloud.com/gc/yxhcyz_1/index.m3u8?contentid=2820180516001"}]}},{group:"直播景观",icon:"fa fa-video-camera",channel:{"Nature.Live.Aurora":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c953819932c837b49397345/playlist.m3u8"}],"Nature.Live.Forest":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c953836932c837b49397355/playlist.m3u8"}],"Nature.Live.Lake":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c95385c932c837b49397356/playlist.m3u8"}],"Nature.Live.Mountain":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c95387b932c837b49397357/playlist.m3u8"}],"Nature.Live.Rivers":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c95388f932c837b4939735a/playlist.m3u8"}],"Nature.Live.Sunset":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c9538a5932c837b4939735b/playlist.m3u8"}],"Nature.Live.Beaches":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c95396f932c837b49397360/playlist.m3u8"}],"Nature.Live.Tropics":[{name:"路线1",value:"https://stitcheraws.unreel.me/wse-node02.powr.com/live/5c9538b9932c837b4939735c/playlist.m3u8"}],"Nature.Live.Waterfalls":[{name:"路线1",value:"https://95771f8415a84e31bd152fe9c6c9905c.mediatailor.us-east-1.amazonaws.com/v1/master/82ded7a88773aef3d6dd1fedce15ba2d57eb6bca/wse_powr_com_5c953910932c837b4939735d/playlist.m3u8"}]}},{group:"短视频平台",icon:"fa fa-mixcloud",channel:{抖音:[{name:"路线1",value:"https://www.douyin.com/video/7022831631677263140?modeFrom=",iframe:!0,parserURL:""}],快手:[{name:"路线1",value:"https://www.kuaishou.com/new-reco",iframe:!0,parserURL:""},{name:"直播",value:"https://live.kuaishou.com/",iframe:!0,parserURL:""}]}}],english=[{group:"外语频道.国家",icon:"fa fa-youtube-play",channel:{俄罗斯:[{name:"RT.Doc",url:"https://www.rt.com/",value:"https://rt-rtd.rttv.com/live/rtdoc/playlist.m3u8"}],新加坡:[{name:"新加坡CNA",url:"https://www.channelnewsasia.com/singapore",value:"http://d2e1asnsl7br7b.cloudfront.net/7782e205e72f43aeb4a48ec97f66ebbe/index_4.m3u8"},{name:"新加坡TLC",value:"https://s6.hopslan.com/tlc/index.m3u8"}],越南:[{name:"Lao.SV.TV",value:"https://livefta.malimarcdn.com/ftaedge00/laosvtv.stream/playlist.m3u8"},{name:"Lao.Thai.US.TV",value:"https://livefta.malimarcdn.com/ftaedge00/laothaius.sdp/playlist.m3u8"},{name:"Lao.Thoong.TV",value:"https://livefta.malimarcdn.com/ftaedge00/lookthoongtv.sdp/playlist.m3u8"},{name:"HBTV(跨域限制)",value:"https://dacastmmd.mmdlive.lldns.net/dacastmmd/896cad7d35a847f585551378cd7ba4d2/manifest.m3u8?p=79&s=1676317945&e=1676318065&h=9c6c01b3df48d5461ad885e9b3468b28"}],日本:[{name:"NHKworld",url:"https://www3.nhk.or.jp/nhkworld",value:"https://cdn.nhkworld.jp/www11/nhkworld-tv/bmcc-live/zh/playlist.m3u8"},{name:"日本新闻",value:"https://n24-cdn-live.ntv.co.jp/ch01/index.m3u8"},{name:"NHK华语",value:"https://nhkw-zh-hlscomp.akamaized.net/ixxemlzk1vqvy44o/playlist.m3u8"},{name:"NHKworld2(跨域限制)",value:"https://livecdn.fptplay.net/hda2/nhkworld_vhls.smil/chunklist_b5000000.m3u8"}],韩国:[{name:"Arirang.EN",url:"https://www.arirang.com",value:"http://amdlive.ctnd.com.edgesuite.net/arirang_1ch/smil:arirang_1ch.smil/playlist.m3u8"},{name:"KBS-World(跨域限制)",value:"https://livecdn.fptplay.net/sdb/kbs_hls.smil/playlist.m3u8"}],非洲:[{name:"佛得角TCSM",value:"https://stream.internet.one/RadioCaboVerde/video.m3u8"}],阿拉伯:[{name:"黎巴嫩LBC",url:"https://www.lbcgroup.tv",value:"https://rotanastudios-lbc-1-eu.xiaomi.wurl.tv/playlist.m3u8"},{"半岛新闻 (1080p)":[{name:"路线1",value:"https://live-hls-web-aje.getaj.net/AJE/01.m3u8"}]}],爱尔兰:[{name:"CorkCommunity",value:"https://s6.hopslan.com/tlc/index.m3u8"}],新西兰:[{name:"Euronews.nz",value:"https://euronews-euronews-world-1-nz.samsung.wurl.tv/playlist.m3u8"},{name:"Firstlight",value:"https://uni01rtmp.tulix.tv/firstlight/firstlight.smil/playlist.m3u8"},{name:"Juice",value:"https://juicex.nz/hls/mystream.m3u8"},{name:"Parliament",value:"https://ptvlive.kordia.net.nz/out/v1/daf20b9a9ec5449dadd734e50ce52b74/index.m3u8"},{name:"Love.Nature.4K",value:"https://lovestoriestv-lovestoriestv-1-nz.samsung.wurl.tv/playlist.m3u8"}],澳洲:[{name:"ABC-News",url:"https://www.abc.net.au/news",value:"https://abc-iview-mediapackagestreams-2.akamaized.net/out/v1/6e1cc6d25ec0480ea099a5399d73bc4b/index.m3u8"},{name:"channel-news",value:"https://austchannel-live.akamaized.net/hls/live/2002729/austchannel-news/master.m3u8"},{name:"wonder",value:"https://lds-wonder-samsungau.amagi.tv/playlist.m3u8"},{name:"zoomoo",value:"https://zoomoo-samsungau.amagi.tv/playlist.m3u8"}],英国:[{name:"Reuters.Now",url:"https://www.reuters.com/news/live",value:"https://reuters-reutersnow-1-nl.samsung.wurl.tv/playlist.m3u8"},{name:"GB.News",value:"https://cdn-apse1-prod.tsv2.amagi.tv/linear/amg01076-lightningintern-gbnewsnz-samsungnz/playlist.m3u8"},{name:"Guardian",value:"https://rakuten-guardian-1-ie.samsung.wurl.tv/playlist.m3u8"},{name:"Euronews",value:"https://rakuten-euronews-1-nl.samsung.wurl.tv/playlist.m3u8"},{name:"IQRAA",value:"https://bloomberg-quicktake-1-be.samsung.wurl.tv/playlist.m3u8"},{name:"BBC.new(跨域限制)",value:"https://livecdn.fptplay.net/sdb/bbcnew_2000.stream/chunklist_b2500000.m3u8"},{name:"BBC.Earth.HD",value:"https://bcovlive-a.akamaihd.net/c9bf201b06694453bb29282f97191f58/us-east-1/6240731308001/playlist.m3u8"},{name:"BBC.World.new",value:"http://103.199.161.254/Content/bbcworld/Live/Channel(BBCworld)/index.m3u8"},{name:"BBC.Drama",value:"https://bbceu-bbcdrama-2-it.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Comedy",value:"https://rakuten-comedymovies-1-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Rakuten.Family",value:"https://rakuten-family-1-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Comedy(samsung)",value:"https://uksono1-samsunguk.amagi.tv/playlist.m3u8"},{name:"Edge.Sport",value:"https://edgesport-samsunguk.amagi.tv/playlist.m3u8"},{name:"Sky.Movies.Comedy",value:"http://dminnvll.cdn.mangomolo.com/dubaione/smil:dubaione.stream.smil/chunklist_b380000.m3u8"},{name:"Sofy.TV",value:"https://sofytv-samsunguk.amagi.tv/playlist.m3u8"},{name:"Afrobeats",value:"https://stream.ecable.tv/afrobeats/tracks-v1a1/index.m3u8"}],德国:[{name:"Euronews.Deutsch",url:"https://de.euronews.com",value:"https://rakuten-euronews-5-de.samsung.wurl.com/manifest/playlist.m3u8"},{name:"Chemnitz.Fernsehen",value:"https://chemnitz.iptv-playoutcenter.de/chemnitz/chemnitzfernsehen.stream_1/playlist.m3u8"},{name:"Das.Erste",value:"https://derste247livede.akamaized.net/hls/live/658317/daserste_de/master.m3u8"},{name:"Das.Erste.720p",value:"https://mcdn.daserste.de/daserste/de/master.m3u8"},{name:"ems.TV.Lingen",value:"https://5889e7d0d6e28.streamlock.net/ev1tv-live/_definst_/mp4:livestream/playlist.m3u8"},{name:"Erz-TV.Stollberg",value:"https://5acade5fc0c29.streamlock.net/kabeljournal/live2020.stream/playlist.m3u8"},{name:"Health.TV",value:"http://62.67.13.53:1935/HealthTV/ghtv_live_master.stream/playlist.m3u8"},{name:"Noa.4.Hamburg",value:"https://hls1.wtnet.de/noa4hh/apple/wifi6500.m3u8"},{name:"Noa.4.Norderstedt",value:"https://hls1.wtnet.de/noa4/apple/wifi6500.m3u8"}],法国:[{name:"Supertoons",value:"https://kedoo-supertoonstv-3-fr.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Family.Français",value:"https://rakuten-family-7-fr.samsung.wurl.tv/playlist.m3u8"},{name:"Euronews.Français",value:"https://alchimie-euronews-1-fr.samsung.wurl.com/manifest/playlist.m3u8"},{name:"Euronews.EN",value:"https://euronews-euronews-world-1-au.samsung.wurl.com/manifest/playlist.m3u8"},{name:"TV78",value:"https://streamtv.cdn.dvmr.fr/TV78/ngrp:tv78.stream_all/master.m3u8"},{name:"TVR(Bretagne)",value:"https://streamtv.cdn.dvmr.fr/TVR/ngrp:tvr.stream_all/master.m3u8"},{name:"Fashion.TV.de",value:"https://fashiontv-fashiontv-4-de.samsung.wurl.com/manifest/playlist.m3u8"},{name:"Fashion.TV.se",value:"https://fashiontv-fashiontv-5-se.samsung.wurl.tv/playlist.m3u8"},{name:"Czech&Slovak",value:"http://lb.streaming.sk/fashiontv/stream/playlist.m3u8"},{name:"Midnite.Secrets&Slovak",value:"https://fash1043.cloudycdn.services/slive/_definst_/ftv_midnite_secrets_adaptive.smil/playlist.m3u8"},{name:"BBC.Doctor.Who.fr",value:"https://bbceu-bbcdrama-1-fr.samsung.wurl.tv/playlist.m3u8"}],意大利:[{name:"Euronews.Italiano",value:"https://rakuten-euronews-3-it.samsung.wurl.com/manifest/playlist.m3u8"},{name:"Rakuten.Family.it",value:"https://rakuten-family-6-it.samsung.wurl.tv/playlist.m3u8"},{name:"Animation.it",value:"https://yamatovideo-yamatoanimation-1-it.samsung.wurl.tv/playlist.m3u8"},{name:"Persiana.Junior.it",value:"https://deaplaneta-planetakidz-2-it.samsung.wurl.tv/playlist.m3u8"}],西班牙:[{name:"Euronews.Español",value:"https://rakuten-euronews-4-es.samsung.wurl.com/manifest/playlist.m3u8"},{name:"Rakuten.Family.es",value:"https://rakuten-family-2-es.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Drama.es",value:"https://rakuten-tvshows-2-es.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Comedy.es",value:"https://rakuten-comedy-9-se.samsung.wurl.tv/playlist.m3u8"},{name:"Mytime.Spain",value:"https://rakuten-actionmovies-2-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Planeta.Junior.es",value:"https://deaplaneta-planetakidz-1-es.samsung.wurl.tv/playlist.m3u8"}],葡萄牙:[{name:"Rakuten.Family.Portugal",value:"https://rakuten-family-14-pt.samsung.wurl.tv/playlist.m3u8"}],比利时:[{name:"Rakuten.Euronews.Belgium",value:"https://rakuten-euronews-10-be.samsung.wurl.tv/playlist.m3u8"},{name:"AFV.FAMILY",value:"https://futuretoday-afv-family-2-be.samsung.wurl.tv/playlist.m3u8"}],荷兰:[{name:"Rakuten.Drama.Netherlands",value:"https://rakuten-drama-8-nl.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Action.Netherlands",value:"https://rakuten-action-8-nl.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Comedy.Netherlands",value:"https://rakuten-comedy-8-nl.samsung.wurl.tv/playlist.m3u8"},{name:"Pet.Club.TV.Netherlands",value:"https://rakuten-drama-8-nl.samsung.wurl.tv/playlist.m3u8"},{name:"Strongman.Champions.League",value:"https://rightsboosterltd-scl-1-nl.samsung.wurl.tv/playlist.m3u8"}],丹麦:[{name:"Rakuten.Action.Denmark",value:"https://rakuten-action-10-dk.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Drama.Denmark",value:"https://rakuten-drama-10-dk.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Family.Denmark",value:"https://rakuten-family-10-dk.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Comedy.Denmark",value:"https://rakuten-comedy-10-dk.samsung.wurl.tv/playlist.m3u8"}],加拿大:[{name:"Gusto.TV",value:"https://gustotv-gustotv-2-se.samsung.wurl.tv/playlist.m3u8"},{name:"Positiv",value:"https://rtmtv-samsung-ca.samsung.wurl.tv/playlist.m3u8"},{name:"Kidoodle",value:"https://kidoodletv-kdtv-1-ca.samsung.wurl.tv/playlist.m3u8"}],美国:[{name:"ABC.News",url:"https://abcnews.go.com/",value:"http://cms-wowza.lunabyte.io/wbrz-live-1/_definst_/smil:wbrz-live.smil/chunklist_b1300000.m3u8"},{name:"ABC.News.USA",value:"https://d202koqm588atp.cloudfront.net/v1/master/3fec3e5cac39a52b2132f9c66c83dae043dc17d4/prod-samsungtvplus-stitched-publica/samsungtvplus_us_abcnewslive_001.m3u8?ads.caid=ABCNewsLive&ads.csid=samsungtvplus_us_abcnewslive_ssai&ads.xumo_platform=samsung&ads._fw_is_lat=%7BTARGETOPT%7D&ads._fw_us_privacy=1YNY&ads._fw_coppa=0&ads._fw_did=%7BPSID%7D&ads._fw_content_category=IAB12&ads._fw_content_genre=news&ads._fw_content_language=en&ads._fw_content_rating=tv-g&ads._fw_deviceMake=samsung&ads._fw_gdpr=0&ads.appName=%7BAPP_NAME%7D&ads.xumo_contentId=58&ads.xumo_contentName=ABCNewsLive&ads.xumo_providerId=58&ads.xumo_providerName=ABCNewsLive&ads.xumo_channelId=9999533&ads.xumo_channelName=ABCNewsLive&ads.xumo_adsystem=mediatailor&ads.tpcl=MIDROLL&ads._fw_app_store_url=%7BAPP_DOMAIN%7D"},{name:"Bloomberg",value:"https://bloomberg-bloomberg-1-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Bloomberg.India",value:"https://bloomberg-quicktake-1-se.samsung.wurl.tv/playlist.m3u8"},{name:"CNN",value:"https://225f14f181b14665bde8b60479eed3d2.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Samsung-at_CNN/playlist.m3u8?ads.wurl_channel=662&ads.wurl_name=CNN&ads.coppa=0&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.consent=%7BTC_STRING%7D"},{name:"CNN.NEWS.HD",value:"https://cnn-cnninternational-1-eu.rakuten.wurl.tv/playlist.m3u8"},{name:"Cheddar.News",value:"https://bcf66772c67a40ec839611926b59b041.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_Cheddar/playlist.m3u8?ads.wurl_channel=575&ads.wurl_name=Cheddar&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Fox.News",value:"http://fox-foxnewsnow-samsungus.amagi.tv/playlist.m3u8"},{name:"Fox.Sport",value:"https://austchannel-live.akamaized.net/hls/live/2002736/austchannel-sport/master1280x720_v3.m3u8"},{name:"Fox.LiveNOW",value:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/samsungus-fox-newsnow-samsung/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"NBC.News",value:"https://nbcnews2.akamaized.net/hls/live/723426/NBCNewsPlaymaker24x7Linear99a3a827-ua/master.m3u8"},{name:"Newsmax",value:"https://newsmax-vizio.amagi.tv/playlist.m3u8"},{name:"NBC.News.NOW",value:"https://d2gjhy8g9ziabr.cloudfront.net/v1/master/3fec3e5cac39a52b2132f9c66c83dae043dc17d4/prod-samsungtvplus-stitched/samsungtvplus_us_nbcnewsnow_001.m3u8?ads.caid=NBCNewsNOW&ads.csid=samsungtvplus_us_nbcnewsnow_ssai&ads.xumo_platform=samsung&ads._fw_is_lat=%7BTARGETOPT%7D&ads._fw_us_privacy=1YNY&ads._fw_coppa=0&ads._fw_did=%7BPSID%7D&ads._fw_content_category=IAB12&ads._fw_content_genre=News&ads._fw_content_language=en&ads._fw_content_rating=tv-g&ads._fw_deviceMake=samsung&ads._fw_gdpr=0&ads.appName=%7BAPP_NAME%7D&ads.xumo_contentId=1828&ads.xumo_contentName=NBCNewsNOW&ads.xumo_providerId=1828&ads.xumo_providerName=NBCNewsNOW&ads.xumo_channelId=9999542&ads.xumo_adsystem=mediatailor&ads.tpcl=MIDROLL&ads._fw_app_store_url=%7BAPP_DOMAIN%7D"},{name:"Yahoo.Finance",value:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/yahoofina-samsungyahoofinance/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Yahoo.Finance2",value:"https://yahoofinance-localnow.amagi.tv/playlist.m3u8"},{name:"TODAY.All.Day",value:"https://d2gjhy8g9ziabr.cloudfront.net/v1/master/3fec3e5cac39a52b2132f9c66c83dae043dc17d4/prod-samsungtvplus-stitched/samsungtvplus_us_todayallday_001.m3u8?ads.caid=TodayAllDay&ads.csid=samsungtvplus_us_todayallday_ssai&ads.xumo_platform=samsung&ads._fw_is_lat=%7BTARGETOPT%7D&ads._fw_us_privacy=1YNY&ads._fw_coppa=0&ads._fw_did=%7BPSID%7D&ads._fw_content_category=IAB1-7&ads._fw_content_genre=lifestyle&ads._fw_content_language=en&ads._fw_content_rating=tv-g&ads._fw_deviceMake=samsung&ads._fw_gdpr=0&ads.appName=%7BAPP_NAME%7D&ads.xumo_contentId=179&ads.xumo_contentName=NBCToday&ads.xumo_providerId=179&ads.xumo_providerName=NBCToday&ads.xumo_channelId=9999545&ads.xumo_adsystem=mediatailor&ads.tpcl=MIDROLL&ads._fw_app_store_url=%7BAPP_DOMAIN%7D"},{name:"Go.USA",value:"https://brandusa-gousa-1-nl.samsung.wurl.tv/playlist.m3u8"},{name:"Go.USA.TV",value:"https://brandusa-gousa-1-se.samsung.wurl.tv/playlist.m3u8"}]}}],englishGroup=[{group:"外语频道.分类",icon:"fa fa-youtube-play",channel:{TalkShow:[{name:"TED",url:"https://www.ted.com",value:"https://d36n7d67yr3rea.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-tg68yl0b8e9qy-ssai-prd/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"TalkTV",value:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg00738-newsuk-talkradiotv-ono/playlist.m3u8"},{name:"JohnnyCarson",value:"https://johnnycarson-vizio.amagi.tv/playlist.m3u8"},{name:"Comedy.Dynamics",value:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/cinedigm-samsung-comedy-dynamics-clean/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Comedy.DryBar",value:"https://ed26e7d0159f4266a552c44f68472edc.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_DryBarComedy/playlist.m3u8?ads.us_privacy=1YNY&ads.wurl_channel=370&ads.wurl_name=DryBarComedy&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Comedy.DryBar(samsung)",value:"https://drybar-drybarcomedy-1-ca.samsung.wurl.tv/playlist.m3u8"}],Movie:[{name:"MovieSphere",url:"https://tv24.co.uk/",value:"https://moviesphere-samsung-samsungus.amagi.tv/playlist.m3u8"},{name:"MovieSphere2",value:"https://moviesphereuk-samsunguk.amagi.tv/playlist.m3u8"},{name:"Xplore1",value:"http://xlpore-samsungus.amagi.tv/playlist.m3u8"},{name:"Xplore2",value:"https://cdn-ue1-prod.tsv2.amagi.tv/linear/samsungus-xplore-samsungus/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Xplore3",value:"https://cdn-uw2-prod.tsv2.amagi.tv/linear/amg00111-hearstmediaprod-xploreintlnl-samsungnl/playlist.m3u8"},{name:"Rakuten.Action.se",value:"https://rakuten-action-9-se.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.Drama.se",value:"https://rakuten-drama-9-se.samsung.wurl.tv/playlist.m3u8"},{name:"Rakuten.tvshows.it",value:"https://rakuten-tvshows-6-it.samsung.wurl.tv/playlist.m3u8"},{name:"Asian.Crush",value:"https://479cc5aa923d4f399f440d76bc53da92.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_AsianCrush/playlist.m3u8?ads.wurl_channel=269&ads.wurl_name=AsianCrush&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Movie.Hub",value:"https://dje6yassknq8t.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/MovieHub2-prod/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"NEW.KMOVIES",value:"https://bd281c27a16f4a7fb4a88260378e8082.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_NewMovies/playlist.m3u8?ads.wurl_channel=618&ads.wurl_name=NewMovies&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"The.Walking.Dead.Universe",value:"https://645c5b3f342a4329a847a557fbe77b05.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_TWDUniverseTV14/playlist.m3u8?ads.wurl_channel=844&ads.wurl_name=TWDUniverseTV14&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"MyTime.Movie",value:"https://mytime-tcl.amagi.tv/playlist1080-p.m3u8"},{name:"MyTime.Movie.Network",value:"https://amg00500-studiocitypictu-mytimegerman-samsungat-166eh.amagi.tv/playlist/amg00500-studiocitypictu-mytimegerman-samsungat/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.tc_string=%7BTC_STRING%7D&ads.coppa=0"},{name:"T2",value:"https://d3qg0hadt0dkov.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-3sfgyrfz9zduo-prod/amgtennisus/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Baywatch",value:"https://d3vdwtqqboxhm9.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/BayWatch2-prod/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Stories.by.AMC",value:"https://fe0423aba9c44b9e92576576e4d3189a.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_AMCPresentsClean/playlist.m3u8?ads.wurl_channel=663&ads.wurl_name=AMCPresentsClean&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Midnight.Pulp",value:"https://9c59d528776940fc9817c9571867375a.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_MidnightPulp-1/playlist.m3u8?ads.wurl_channel=678&ads.wurl_name=MidnightPulp&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Maverick.Black.Cinema",value:"https://995059ba59a44c949b7b00ce255a4861.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_MaverickBlackCinema/playlist.m3u8?ads.wurl_channel=451&ads.wurl_name=MaverickBlackCinema&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Gravitas.Movies",value:"https://651944d3f0d240738e7d5fa272ac4e24.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_GravitasMovies/playlist.m3u8?ads.wurl_channel=248&ads.wurl_name=GravitasMovies&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"CINEVAULT:Classics",value:"https://40f8d33f8895435f9e63aa829c93bba0.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Samsung_CinevaultClassics/playlist.m3u8?ads.wurl_channel=1043&ads.wurl_name=CinevaultClassics&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"CINEVAULT:80s",value:"https://fb9770c9cf584d64b3c5e3a26637d5ec.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_Cinevault80s/playlist.m3u8?ads.wurl_channel=691&ads.wurl_name=Cinevault80s&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"CINEVAULT:Westerns",value:"https://e7300fca01d348dea7b8f35f2721cc48.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_CinevaultWesterns/playlist.m3u8?ads.wurl_channel=690&ads.wurl_name=CinevaultWesterns&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"The.Preview.Channel",value:"https://cca0faa1668740379640339007b036ec.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_ThePreviewChannel/playlist.m3u8?ads.wurl_channel=501&ads.wurl_name=ThePreviewChannel&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"武当集合EN",value:"https://stream-us-east-1.getpublica.com/playlist.m3u8?network_id=73&live=1&avod=1&app_bundle=com.plexapp.android&did=62274240-07e7-5d94-8dc8-ef68cf19e175&app_domain=app.plex.tv&app_name=plex&h=&w=&content_title=ARzd_FTe3Z1WCpT3U8Ae&content_series=5eea605474085f0040ddc770&custom4=plex&gdpr=0&device_make=&device_model=&coppa=0&us_privacy=1---&custom_6=ARzd_FTe3Z1WCpT3U8Ae&custom_7=5eea605474085f0040ddc770&is_lat=0"},{name:"宠物集合EN",value:"https://01cd1772259d4e6f8a67e261e321be29.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_ThePetCollective/playlist.m3u8?ads.wurl_channel=136&ads.wurl_name=ThePetCollective&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=6ZxzzfM9tChjwn6RaNiQ&ads.plex_id=5eea605574085f0040ddc78e&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Made.In.Hollywood",value:"https://stream.ads.ottera.tv/playlist.m3u8?network_id=759&livestream=1&live=1&app_bundle=com.plexapp.android&did=62274240-07e7-5d94-8dc8-ef68cf19e175&app_domain=app.plex.tv&app_name=plex&h=&w=&custom4=plex&gdpr=0&device_make=&device_model=&coppa=1&us_privacy=1---&custom_6=6ZxzzfM9tChjwn6RaNiQ&custom_7=60db63d29ec966002c9ea6f0&is_lat=0"},{name:"24.Hour.Free.Movies",value:"https://d15690s323oesy.cloudfront.net/v1/master/9d062541f2ff39b5c0f48b743c6411d25f62fc25/UDU-Plex2/145.m3u8?ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.channel_Id=5fd115bab7ef8d002dcf181d&ads.did=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.partnerChannel=muxip.24hourmovies&ads.dnt=0&ads.app_bundle=com.plexapp.android&ads.app_name=plex&ads.app_domain=app.plex.tv&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.channel_name=24hourmovies&ads.us_privacy=1---&ads.gdpr=0&ads.consent=0"},{name:"Law&Crime",value:"https://0e6490ecfe9b4c7696b00aa6767caa75.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_LawAndCrime/playlist.m3u8?ads.wurl_channel=226&ads.wurl_name=LawAndCrime&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=6ZxzzfM9tChjwn6RaNiQ&ads.plex_id=5eea605674085f0040ddc79d&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Crime.360",value:"https://3440fd560ae042b3827ece4da26dec30.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_Crime360/playlist.m3u8?ads.wurl_channel=393&ads.wurl_name=Crime360&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.plex_id=5f74cf7effbe690040689f41&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Discover.Film",value:"https://2953c6ed7ab54067823fe467ad9ed80f.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Plex_DiscoverFilm/playlist.m3u8?ads.wurl_channel=1009&ads.wurl_name=DiscoverFilm&ads.coppa=0&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.plex_id=618198fe4e1b6764011b046a&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Stories.by.AMC",value:"https://5def33c73f084e11a19ca77697d6b413.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_AMCPresents/playlist.m3u8?ads.wurl_channel=474&ads.wurl_name=AMCPresents&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.plex_id=5fc705e2a2236e002d69f3ba&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"The.Archive",value:"https://stream-us-east-1.getpublica.com/playlist.m3u8?network_id=74&live=1&app_bundle=com.plexapp.android&did=62274240-07e7-5d94-8dc8-ef68cf19e175&app_domain=app.plex.tv&app_name=plex&h=&w=&content_title=ARzd_FTe3Z1WCpT3U8Ae&content_series=5eea605674085f0040ddc7a0&custom4=plex&gdpr=0&device_make=&device_model=&coppa=0&us_privacy=1---&custom_6=ARzd_FTe3Z1WCpT3U8Ae&custom_7=5eea605674085f0040ddc7a0&is_lat=0"},{name:"The.Boat.Show",value:"https://e99f8e610cd24f40a2c5f054d33aad3a.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_TheBoatShow/playlist.m3u8?ads.wurl_channel=529&ads.wurl_name=TheBoatShow&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.plex_id=5efe1de6e0b3f5003f5d9f82&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"The.Design.Network",value:"https://9215cc5c363c4ed297905b3ca9195080.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Plex_TheDesignNetwork-2/playlist.m3u8?ads.wurl_channel=553&ads.wurl_name=TheDesignNetwork&ads.coppa=0&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=6ZxzzfM9tChjwn6RaNiQ&ads.plex_id=5f0641d3e8ffda004033b16e&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Cinevault.80s",value:"https://gsn-cinevault-80s-1-us.vizio.wurl.tv/playlist.m3u8"},{name:"Cinevault.westerns",value:"https://gsn-cinevault-westerns-1-us.vizio.wurl.tv/playlist.m3u8"},{name:"EXTRA.TV",value:"https://scripps-gritxtra-1-us.vizio.wurl.tv/playlist.m3u8"}],FamilyTV:[{name:"HappyKids",url:"https://happykids.tv",value:"https://happykids-vizio.amagi.tv/playlist.m3u8"},{name:"Zoomoo",value:"https://zoomoo-samsungau.amagi.tv/playlist.m3u8"},{name:"PBS.Kids.1080p",value:"https://livestream.pbskids.org/out/v1/1e3d77b418ad4a819b3f4c80ac0373b5/est.m3u8"},{name:"TG.Junior",value:"https://stream-us-east-1.getpublica.com/playlist.m3u8?network_id=61&live=1&app_bundle=com.plexapp.android&did=62274240-07e7-5d94-8dc8-ef68cf19e175&app_domain=app.plex.tv&app_name=plex&h=&w=&content_title=6ZxzzfM9tChjwn6RaNiQ&content_series=5f170d64b898490041b4938f&custom4=plex&gdpr=0&device_make=&device_model=&coppa=1&us_privacy=1---&custom_6=6ZxzzfM9tChjwn6RaNiQ&custom_7=5f170d64b898490041b4938f&is_lat=0"},{name:"FamilyRakutenTV",value:"https://ad66907c364a4e7eb47c7f61e1d50ee3.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung-at_RakutenFamily/playlist.m3u8?ads.wurl_channel=725&ads.wurl_name=RakutenFamily&ads.coppa=1&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.consent=%7BTC_STRING%7D"},{name:"RakutenTV",value:"https://696c8ef0d3824ac28f38d6277481fbe5.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung-at_RakutenActionMovies/playlist.m3u8?ads.wurl_channel=439&ads.wurl_name=RakutenActionMovies&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0&ads.consent=%7BTC_STRING%7D"},{name:"BounceXL",value:"https://c217322ca48e4d1e98ab33fe41a5ed01.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Samsung_BounceXL/playlist.m3u8?ads.wurl_channel=938&ads.wurl_name=BounceXL&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Always.Funny.Videos",value:"https://d2hnz12weo628w.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/AFV2-prod/samsung.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"AVF.Family",value:"https://rakuten-family-16-be.samsung.wurl.tv/playlist.m3u8"},{name:"Kids.Flix",value:"https://mondotv-mondotvkids-1-it.samsung.wurl.tv/playlist.m3u8"},{name:"SAFA.TV",value:"https://futuretoday-afv-family-2-be.samsung.wurl.tv/playlist.m3u8"}],Music:[{name:"Vevo.Latino",url:"https://pluto.tv/en/live-tv/vevo-latino",value:"https://na.linear.zype.com/634387d4-169a-45db-a7e3-10e4e02fbd67/2e2e55d0495040c4868bcdc9ddf16471-samsung/live.m3u8?sitesection_id=vevo_linear%3A_samsungtvplus&sitesection_network_id=516283&sitesection_fallback_id=15346233&device_id=%7BPSID%7D&target_option=%7BTARGETOPT%7D&us_privacy=1YNY&app_name=%7BAPP_NAME%7D&app_domain=%7BAPP_DOMAIN%7D"},{name:"Vevo.R&B",value:"https://na.linear.zype.com/6faae100-3b35-4797-bb10-7f804b932d16/992f9669ef444754919c6bac2c8d11b3-samsung/live.m3u8?sitesection_id=vevo_linear%3A_samsungtvplus&sitesection_network_id=516283&sitesection_fallback_id=15346233&device_id=%7BPSID%7D&target_option=%7BTARGETOPT%7D&us_privacy=1YNY&app_name=%7BAPP_NAME%7D&app_domain=%7BAPP_DOMAIN%7D"},{name:"Vevo.Hip-Hop",value:"https://na.linear.zype.com/52d35886-a8d0-4e05-93ca-3a7d7ef9e086/a5d8206e5d124ad6a6a4306444efbc3c-samsung/live.m3u8?sitesection_id=vevo_linear%3A_samsungtvplus&sitesection_network_id=516283&sitesection_fallback_id=15346233&device_id=%7BPSID%7D&target_option=%7BTARGETOPT%7D&us_privacy=1YNY&app_name=%7BAPP_NAME%7D&app_domain=%7BAPP_DOMAIN%7D"},{name:"Vevo.2K",value:"https://d2lzzmzt70lih2.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-cci0vkzzomoo0-prod/26c1e462-824a-4fc9-8a80-764352bf45d4/ee3fcf1d-1183-42c6-97f7-e6e1e3ab856f-samsung-tv/live.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Vevo.Country",value:"https://na.linear.zype.com/e92b7406-d2bb-4c1f-aa46-d5575010d9f0/feeb7c9bb5f8446cb46e2cc6697270cb-samsung/live.m3u8?sitesection_id=vevo_linear%3A_samsungtvplus&sitesection_network_id=516283&sitesection_fallback_id=15346233&device_id=%7BPSID%7D&target_option=%7BTARGETOPT%7D&us_privacy=1YNY&app_name=%7BAPP_NAME%7D&app_domain=%7BAPP_DOMAIN%7D"},{name:"Vevo.Pop",value:"https://na.linear.zype.com/b99e99b3-4fad-ceab-7f71-27f319b5416b/c5e1968c592947d79609414b21abf9ff-samsung/live.m3u8?sitesection_id=vevo_linear%3A_samsungtvplus&sitesection_network_id=516283&sitesection_fallback_id=15346233&device_id=%7BPSID%7D&target_option=%7BTARGETOPT%7D&us_privacy=1YNY&app_name=%7BAPP_NAME%7D&app_domain=%7BAPP_DOMAIN%7D"},{name:"XITE.80s.Flashback",url:"https://xite.com/",value:"https://dw0oa71jud5ry.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/usbb320000647-prod/amg80rewind/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"XITE.90s.Throwback",value:"https://d3fr64zqebnqn3.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/usbb3200007ak-prod/amg90rock/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"XITE.Rock.On",value:"https://dri82941jql2y.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/RockMetal-prod/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"XITE.Just.Chill",value:"https://d3ai750ol9my06.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/JustChill-prod/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Clubbing.TV",value:"https://clubbingtv-rakuten.amagi.tv/playlist.m3u8"},{name:"CG.Entertainment",value:"https://cgentertainment-cgtv-1-it.samsung.wurl.tv/playlist.m3u8"}],Discovery:[{name:"PBS.America",url:"https://www.pbs.org/",value:"https://pbs-samsunguk.amagi.tv/playlist.m3u8"},{name:"PBS.KIDS",value:"https://d3afonbm0qxmbc.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-elbbbj7vf6xsf-prod/est.m3u8"},{name:"DUST.sci-fi",value:"https://dmnrfk13mvw0g.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-fn3k0b4vpit0u-prod/amgdust/playlist.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"True.Crime.Now",value:"https://alliantcontent-truecrimenow-3-nz.samsung.wurl.tv/playlist.m3u8"},{name:"Discovery.Film",value:"https://tfd-distro.amagi.tv/index.m3u8"},{name:"Discovery.Science(跨域限制)",value:"https://cdn-apse1-prod.tsv2.amagi.tv/linear/amg01448-samsungin-discoverysciin-samsungin/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Discovery.Kids(跨域限制)",value:"https://cdn-apse1-prod.tsv2.amagi.tv/linear/amg01448-samsungin-discoverykids-samsungin/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=1"},{name:"Discovery.HD(跨域限制)",value:"https://cdn-apse1-prod.tsv2.amagi.tv/linear/amg01448-samsungin-discoveryhdin-samsungin/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Discovery(跨域限制)",value:"https://livecdn.fptplay.net/hda2/discovery_vhls.smil/chunklist_b5000000.m3u8"},{name:"NatGeoHD(跨域限制)",value:"http://vips-livecdn.fptplay.net/hda2/natgeohd_vhls.smil/playlist.m3u8"},{name:"NatGeDWild(跨域限制)",value:"https://livecdn.fptplay.net/hda3/natgeowild_vhls.smil/chunklist_b5000000.m3u8"},{name:"Smithsonian.Channel.Asia",value:"https://smithsonianaus-samsungau.amagi.tv/playlist.m3u8"},{name:"History.Hit",value:"https://ldsaaaaaa-timeline-samsung-uk-azlgu.amagi.tv/playlist/ldsAAAAAA-timeline-samsung-uk/playlist.m3u8?ads.did=%7BPSID%7D&ads.dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.tc_string=%7BTC_STRING%7D&ads.coppa=0"},{name:"BBC.History",value:"https://7a0978fa08424aa3b473d22dc144bd01.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Samsung-de_BBCHistory/playlist.m3u8?ads.wurl_channel=947&ads.wurl_name=BBCHistory&ads.coppa=0&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.consent=%7BTC_STRING%7D"},{name:"MagellanTV.NOW",value:"https://96f6ab4a7f3c434699b8502a36d670fc.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_MagellanTV/playlist.m3u8?ads.wurl_channel=304&ads.wurl_name=MagellanTV&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=6ZxzzfM9tChjwn6RaNiQ&ads.plex_id=5f5132e262fe160040f26bf2&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Documentary+",value:"https://d81f847ce52b4de18d41134229faa86e.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Samsung_DocumentaryPlus/playlist.m3u8?ads.wurl_channel=894&ads.wurl_name=DocumentaryPlus&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"Real.Life",value:"https://lds-realfamilies-plex.amagi.tv/amRdirect/us_privacy=1---&did=62274240-07e7-5d94-8dc8-ef68cf19e175&dnt=0&X-Plex-Token=6ZxzzfM9tChjwn6RaNiQ&channelId=5fd9089d102006002d33c0fc&uid=1gasjrdnh-pe2s-f08-19v8-wpu2rlz1x3s/hls/amagi_hls_data_ldsAAAAAA-realfamiliesplex/CDN/playlist.m3u8"},{name:"Real.Nosey",value:"https://1022d09cb9f743d0b7bd7fc0fd7eab26.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Plex_RealNosey/playlist.m3u8?ads.wurl_channel=349&ads.wurl_name=RealNosey&ads.us_privacy=1---&ads.psid=62274240-07e7-5d94-8dc8-ef68cf19e175&ads.targetopt=0&ads.plex_token=ARzd_FTe3Z1WCpT3U8Ae&ads.plex_id=5f0ff262d71dcb00449ec018&ads.ua=okhttp%2F4.9.0&ads.app_bundle=com.plexapp.android&ads.app_store_url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.plexapp.android&ads.gdpr=0&ads.consent=0&ads.device_type=handset&ads.device_id_type="},{name:"Real.Stories",value:"https://lds-realstories-plex.amagi.tv/amRdirect/us_privacy=1---&did=62274240-07e7-5d94-8dc8-ef68cf19e175&dnt=0&X-Plex-Token=6ZxzzfM9tChjwn6RaNiQ&channelId=5f74cf83ffbe690040689f4a&uid=1gasjrddr-3ruv-gl-wrtt-abu8yij3qq/hls/amagi_hls_data_ldsAAAAAA-realstories-plex/CDN/playlist.m3u8"},{name:"Real.Vision",value:"https://cdn-apse1-prod.tsv2.amagi.tv/linear/amg00426-littledotstudio-realwildnz-samsungnz/playlist.m3u8"},{name:"WeatherNation",value:"https://d2ferbiwcx1539.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-8zd06wicndthf-ssai-prd/WNNationalSamsung/WNNationalSamsung.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.us_privacy=1YNY&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"WeatherSpy",value:"https://7eeb372ee2224dbf9138691d0f5d218b.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_WeatherSpy/playlist.m3u8?ads.wurl_channel=387&ads.wurl_name=WeatherSpy&ads.coppa=0&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D"},{name:"WeatherSpy(samsung)",value:"https://jukin-weatherspy-1-us.samsung.wurl.tv/playlist.m3u8"},{name:"Crime360",value:"https://dab88d35ef5b44ec99be60adef855bf2.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_Crime360/playlist.m3u8?ads.wurl_channel=393&ads.wurl_name=Crime360&ads.psid=%7BPSID%7D&ads.us_privacy=1YNY&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"Travel.XP",value:"https://travelxp-travelxp-1-eu.rakuten.wurl.tv/playlist.m3u8"}],Sports:[{name:"Edgesports",url:"https://www.nbcsportsedge.com/",value:"https://edgesport-samsungus.amagi.tv/playlist.m3u8"},{name:"FreeSports",value:"https://d3cq7cdp2cfi92.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-2ff27mp9b8422-prod/hls-harvester2-1293-prod/us-east-1/cc-2ff27mp9b8422/master.m3u8?ads.device_did=%7BPSID%7D&ads.device_dnt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.consent=%7BTC_STRING%7D"},{name:"ACC-DigitalNetwork",value:"https://1a8f69077b904368aedb538ed5045ac1.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_ACCDigitalNetwork/playlist.m3u8?ads.wurl_channel=599&ads.wurl_name=ACCDigitalNetwork&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"MAVTVSelect",value:"https://5e40ddae915641febc61168f0f1d612a.mediatailor.us-east-1.amazonaws.com/v1/master/44f73ba4d03e9607dcd9bebdcb8494d86964f1d8/Samsung_MavTV/playlist.m3u8?ads.wurl_channel=303&ads.wurl_name=MavTV&ads.us_privacy=1YNY&ads.psid=%7BPSID%7D&ads.targetopt=%7BTARGETOPT%7D&ads.app_domain=%7BAPP_DOMAIN%7D&ads.app_name=%7BAPP_NAME%7D&ads.coppa=0"},{name:"TENNIS",value:"https://tennischannel-intl-samsung-uk.amagi.tv/playlist540_p.m3u8"},{name:"AVF.Family",value:"https://mavtv-mavtvglobal-1-be.samsung.wurl.tv/playlist.m3u8"},{name:"RedBull-TV",value:"https://rbmn-live.akamaized.net/hls/live/590964/BoRB-AT/master.m3u8"},{name:"Outside",value:"https://outsidetv-outside-localnow.amagi.tv/playlistR1080p.m3u8"},{name:"Insight",value:"https://insighttv-samsung-canada.amagi.tv/playlist.m3u8"},{name:"Inwild",value:"https://inwild-samsung-uk.amagi.tv/playlist.m3u8"}],"NASA-Television":[{name:"Media",url:"https://www.nasa.gov/",value:"https://ntv2.akamaized.net/hls/live/2013923/NASA-NTV2-HLS/master.m3u8"},{name:"Public",value:"https://ntv1.akamaized.net/hls/live/2014075/NASA-NTV1-HLS/master.m3u8"},{name:"SpaceX",value:"https://c1--cn-gotcha208.bilivideo.com/live-bvc/837435/live_13945088_2879895_1500/index.m3u8?expires=1660423245&len=0&oi=3738723966&pt=web&qn=0&trid=1007211554f5809e4dedbdebedeb05843ad4&sigparams=cdn,expires,len,oi,pt,qn,trid&cdn=cn-gotcha208&sign=c96c05db4735909b53e7794cf9353129&sk=c9c6154426932efa80d25af02e87a3bd&p2p_type=1&src=57345&sl=1&free_type=0&pp=rtmp&machinezone=jd&source=onetier&site=72eea5b1ba20fb9ba0c62ae1c4c92ed1&order=1"}],UniTV:[{name:"UCTV.University.of.California",url:"https://www.uctv.tv/",value:"https://59e8e1c60a2b2.streamlock.net/509/509.stream/playlist.m3u8"},{name:"线路1",value:"https://vblive-c.viebit.com/65ea794b-dd82-41ce-8e98-a9177289a063/playlist.m3u8"},{name:"线路2",value:"https://vblive-c.viebit.com/65ea794b-dd82-41ce-8e98-a9177289a063/chunklist.m3u8"},{name:"Cloudflare.TV",value:"https://cloudflare.tv/hls/live.m3u8"},{name:"The.360.Channel",value:"https://www.filmon.com/vr-streams/4136.high/playlist.m3u8"}]}}],englishRadio=[{group:"外语广播",icon:"fa fa-podcast",channel:{美国广播电台:[{name:"National.Public.Radio",value:"https://npr-ice.streamguys1.com/live.mp3"},{name:"Bloomberg",value:"https://bloomberg-bloombergtv-3-nl.samsung.wurl.tv/playlist.m3u8"},{name:"FOX.News.Radio",value:"https://live.wostreaming.net/direct/foxnewsradio-foxnewsradioaac-imc?source=fnr.web"},{name:"MSNBC.News.Radio",value:"https://tunein.ord.streamguys1.com/msnbc-free"},{name:"美国之声VOA",value:"https://voa-ingest.akamaized.net/hls/live/2035200/161_352R/playlist.m3u8?audio"}],澳大利亚广播电台:[{name:"ABC-News",value:"https://mediaserviceslive.akamaized.net/hls/live/2038311/newsradio/master.m3u8?audio"},{name:"ABC-Melbourne",value:"https://mediaserviceslive.akamaized.net/hls/live/2038300/localmelbourne/master.m3u8?audio"},{name:"ABC-Brisbane",value:"https://mediaserviceslive.akamaized.net/hls/live/2038304/localbrisbane/master.m3u8?audio"},{name:"ABC-Canberra",value:"https://mediaserviceslive.akamaized.net/hls/live/2038303/localcanberra/master.m3u8?audio"},{name:"ABC-Sydney",value:"https://mediaserviceslive.akamaized.net/hls/live/2038302/localsydney/master.m3u8?audio"},{name:"ABC-Adelaide",value:"https://mediaserviceslive.akamaized.net/hls/live/2038311/newsradio/masterhq.m3u8?audio"},{name:"ABC-Perth",value:"https://mediaserviceslive.akamaized.net/hls/live/2038301/localperth/master.m3u8?audio"},{name:"ABC-Australia",value:"https://mediaserviceslive.akamaized.net/hls/live/2038311/newsradio/masterhq.m3u8?audio"},{name:"ABC-National-2RN",value:"https://mediaserviceslive.akamaized.net/hls/live/2038318/rnnsw/master.m3u8?audio"},{name:"NewsRadio",value:"https://mediaserviceslive.akamaized.net/hls/live/2038311/newsradio/master.m3u8?audio"},{name:"Kids-listen",value:"https://mediaserviceslive.akamaized.net/hls/live/2038321/abcextra/index.m3u8?audio"},{name:"Country",value:"https://mediaserviceslive.akamaized.net/hls/live/2038322/abccountry/masterhq.m3u8?audio"},{name:"Jazz",value:"https://mediaserviceslive.akamaized.net/hls/live/2038319/abcjazz/masterhq.m3u8?audio"},{name:"Classic",value:"https://mediaserviceslive.akamaized.net/hls/live/2038316/classicfmnsw/master.m3u8?audio"},{name:"Classic-2",value:"https://mediaserviceslive.akamaized.net/hls/live/2038317/classic2/masterhq.m3u8"},{name:"triple-j-Unearthed",value:"https://mediaserviceslive.akamaized.net/hls/live/2038305/triplejunearthed/masterhq.m3u8?audio"},{name:"triple-j",value:"https://mediaserviceslive.akamaized.net/hls/live/2038308/triplejnsw/masterhq.m3u8?audio"},{name:"Double-J",value:"https://mediaserviceslive.akamaized.net/hls/live/2038315/doublejnsw/masterhq.m3u8?audio"}],"ABC-Radio":[{name:"ABC-News-Radio",value:"http://live-radio01.mediahubaustralia.com/PBW/aac/"},{name:"ABC-National-Radio",value:"http://live-radio01.mediahubaustralia.com/2RNW/aac/"},{name:"ABC-Sydney-Radio",value:"http://live-radio01.mediahubaustralia.com/2LRW/aac/"},{name:"ABC-Classic-Radio",value:"http://live-radio01.mediahubaustralia.com/2FMW/aac/"},{name:"ABC-Brisbane-Radio",value:"http://live-radio01.mediahubaustralia.com/4LRW/aac/"},{name:"BBC-World-Radio",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_world_service"},{name:"VOA-EN-Radio",value:"http://n04.radiojar.com/t2n88q0st5quv?rj-tok=AAABgo4NE1QArW6dTYSHdicQzQ&rj-ttl=5"}],BBC:[{name:"World Service",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_world_service"},{name:"Music",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_6music"},{name:"London 94.9",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_london"},{name:"Radio 1",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_radio_one"},{name:"Radio 2",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_radio_two"},{name:"Radio 3",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_radio_three"},{name:"Radio 4 FM",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_radio_fourfm"},{name:"Radio 5 live",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_radio_five_live_online_nonuk"},{name:"Asian Network",value:"https://stream.live.vc.bbcmedia.co.uk/bbc_asian_network"}],"113FM Radio":[{name:"Bang Bang!",value:"https://113fm-atunwadigital.streamguys1.com/1006?audio"},{name:"Pop’d",value:"https://113fm-atunwadigital.streamguys1.com/1052?audio"},{name:"Big Kickin’ Country",value:"https://113fm-atunwadigital.streamguys1.com/1004?audio"},{name:"Power!",value:"https://113fm-atunwadigital.streamguys1.com/1053?audio"},{name:"Blues Town",value:"https://113fm-atunwadigital.streamguys1.com/1005?audio"},{name:"Salsa!",value:"https://113fm-atunwadigital.streamguys1.com/1059?audio"},{name:"Chill Zone",value:"https://113fm-atunwadigital.streamguys1.com/1007?audio"},{name:"Synthetic!",value:"https://113fm-atunwadigital.streamguys1.com/1061?audio"},{name:"Classic One",value:"https://113fm-atunwadigital.streamguys1.com/1008?audio"},{name:"Zen",value:"https://113fm-atunwadigital.streamguys1.com/1068?audio"},{name:"Elevator!",value:"https://113fm-atunwadigital.streamguys1.com/1010?audio"},{name:"The Lounge",value:"https://113fm-atunwadigital.streamguys1.com/1064?audio"},{name:"Energy!",value:"https://113fm-atunwadigital.streamguys1.com/1011?audio"},{name:"Flashback!",value:"https://113fm-atunwadigital.streamguys1.com/1012?audio"},{name:"Free Bird",value:"https://113fm-atunwadigital.streamguys1.com/1013?audio"},{name:"113.FM Hits!",value:"https://113fm-atunwadigital.streamguys1.com/1046?audio"},{name:"Indie Nation",value:"https://113fm-atunwadigital.streamguys1.com/1047?audio"},{name:"Jazzy!",value:"https://113fm-atunwadigital.streamguys1.com/1067?audio"},{name:"Jitterbug",value:"https://113fm-atunwadigital.streamguys1.com/1048?audio"},{name:"Alt-X",value:"https://113fm-atunwadigital.streamguys1.com/1001?audio"},{name:"113.FM BPM RADIO",value:"https://113fm.cdnstream1.com/1736_128?cb=139271.mp3"}],AsiaFM:[{name:"HD音乐台",value:"https://lhttp.qingting.fm/live/5022405/64k.mp3"},{name:"亚洲天空台",value:"https://lhttp.qingting.fm/live/20071/64k.mp3"},{name:"亚洲经典台",value:"https://lhttp.qingting.fm/live/5021912/64k.mp3"},{name:"亚洲音乐台",value:"https://lhttp.qtfm.cn/live/4581/64k.mp3"}],"Asia DREAM Radio":[{name:"亚洲梦想电台",value:"https://igor.torontocast.com:1025/;?shoutcast"},{name:"Jazz Sakura",value:"https://kathy.torontocast.com:3330/;?shoutcast"},{name:"Jazz Club Bandstand",value:"https://daniel.torontocast.com:2630/;?shoutcast"},{name:"J-Pop Christmas Radio",value:"https://ruby.torontocast.com:1120/;?shoutcast"},{name:"J-Pop Powerplay",value:"https://kathy.torontocast.com:3560/;?shoutcast"},{name:"Japan Hits",value:"https://igor.torontocast.com:1025/;?shoutcast"},{name:"J-Pop Powerplay Kawaii",value:"https://kathy.torontocast.com:3060/;?shoutcast"},{name:"J-Pop Sakura 懐かしい",value:"https://igor.torontocast.com:1710/;?shoutcast"},{name:"J-Rock Powerplay",value:"https://kathy.torontocast.com:3340/;?shoutcast"},{name:"J-Club Powerplay HipHop",value:"https://kathy.torontocast.com:3350/;?shoutcast"}]}}],localTV=[{group:"地方频道",icon:"fa fa-tv",channel:{清华大学电视台:[{name:"线路1",url:"https://www.tsinghua.edu.cn/",value:"https://live.cic.tsinghua.edu.cn/hls/tsinghuatv.m3u8"}],北京大学电视台:[{name:"线路1(跨域限制)",url:"https://pku.edu.cn",value:"https://stream.tv.pku.edu.cn/tv/sd/live.m3u8"}],北京:[{name:"北京卫视(有延迟)",url:"https://www.brtn.cn/",value:"https://media.hndyjyfw.gov.cn/live/jz-beijingweishi/live.m3u8"},{name:"北京卫视",value:"http://1.204.169.243/live.aishang.ctlcdn.com/00000110240129_1/encoder/1/playlist.m3u8?CONTENTID=00000110240129_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR"},{name:"北京卫视.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888888/224/3221225600/2/index.m3u8"},{name:"北京卫视.HD(跨域限制)",value:"http://39.135.138.60:18890/PLTV/88888910/224/3221225673/index.m3u8"},{name:"中国交通北京频道",value:"https://tv.lanjingfm.com/cctbn/heibei.m3u8"},{name:"卡酷少儿",value:"https://hsplay-360.v.btime.com/live_btime/btv_sn_20170706_s10/index.m3u8?time=1679206612&sign=e269c7739b1b02b32d35826bff755f3b"},{name:"卡酷少儿.IP6(跨域限制)",value:"http://[2409:8087:5011:1020::2b]/180000001002/00000001000000000090000000215608/main.m3u8?IASHttpSessionId=OTT"},{name:"北京纪实科教频道(跨域限制)",value:"http://39.135.138.59:18890/PLTV/88888910/224/3221225627/index.m3u8"},{name:"北京新闻频道",value:"https://live.funhillrm.com/5/sd/live.m3u8"},{name:"北京财经频道",value:"http://111.31.106.45/downlive.brtvcloud.com/brtv8kapptv/brtv8kappcaijing.m3u8"},{name:"北京文艺频道",value:"http://111.31.106.45/downlive.brtvcloud.com/brtv8kapptv/brtv8kappwenyi.m3u8"},{name:"北京影视频道",value:"http://111.31.106.45/downlive.brtvcloud.com/brtv8kapptv/brtv8kappyingshi.m3u8"},{name:"北京生活频道",value:"http://111.31.106.45/downlive.brtvcloud.com/brtv8kapptv/brtv8kappshenghuo.m3u8"}],香港:[{name:"TVB翡翠台.iframe",url:"https://www.tvb.com/",value:"https://www.kankanzhibo.com/player/index?id=1334206",iframe:!0,parserURL:""},{name:"TVB明珠台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334207",iframe:!0,parserURL:""},{name:"TVB.J2.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334209",iframe:!0,parserURL:""},{name:"TVBS亞洲台_34",value:"http://pull-l3-cny.douyincdn.com/third/stream-9f6ea8b662a55d5fa562ebaeb2880bfc.m3u8"},{name:"凤凰卫视",value:"https://playtv-live.ifeng.com/live/06OLEGEGM4G.m3u8"},{name:"凤凰卫视(跨域限制)",value:"http://hwrr.jx.chinamobile.com:8080/PLTV/88888888/224/3221226248/index.m3u8"},{name:"凤凰卫视.audio",value:"https://playtv-live.ifeng.com/live/06OLEGEGM4G_audio.m3u8"},{name:"凤凰资讯",value:"https://playtv-live.ifeng.com/live/06OLEEWQKN4.m3u8"},{name:"凤凰资讯(跨域限制)",value:"http://hwrr.jx.chinamobile.com:8080/PLTV/88888888/224/3221226274/index.m3u8"},{name:"凤凰资讯.audio",value:"https://playtv-live.ifeng.com/live/06OLEEWQKN4_audio.m3u8"},{name:"凤凰香港.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888910/224/3221226251/index.m3u8"},{name:"香港卫视.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334199",iframe:!0,parserURL:""},{name:"香港有线新闻台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334212",iframe:!0,parserURL:""},{name:"香港有线财经资讯台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334215",iframe:!0,parserURL:""},{name:"香港有线体育.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334723",iframe:!0,parserURL:""},{name:"香港有线18台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334214",iframe:!0,parserURL:""},{name:"香港无线新闻台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334210",iframe:!0,parserURL:""},{name:"耀才财经(跨域限制)",value:"http://202.69.67.66:443/webcast/bshdlive-pc/playlist.m3u8?wowzasessionid=64000?zgangd"},{name:"香港有线603台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334200",iframe:!0,parserURL:""},{name:"港台电视31.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334196",iframe:!0,parserURL:""},{name:"港台电视32.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334195",iframe:!0,parserURL:""},{name:"港台电视32",value:"https://rthktv32-live.akamaized.net/hls/live/2036819/RTHKTV32/stream5/streamPlaylist.m3u8"},{name:"Now新闻.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334221",iframe:!0,parserURL:""},{name:"ViuTv.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334198",iframe:!0,parserURL:""}],澳门:[{name:"澳亚衛視",url:"https://m.mastvnet.com/",value:"https://live.mastvnet.com/lsdream/lY44pmm/2000/live.m3u8"},{name:"澳视卫星",value:"http://61.244.22.5/ch3/_definst_/ch3.live/playlist.m3u8"},{name:"澳视资讯",value:"http://103.233.191.134:1935/ch5/info_ch5.live/playlist.m3u8"},{name:"蓮花衛視",value:"https://2754871298.cloudvdn.com/a.m3u8?domain=live-hls.macaulotustv.com&player=OcwAAMJRMYgyOJsW&secondToken=secondToken%3A-FfW5vp8w7LfoQufgUk_2Ata6CY&streamid=lotustv%3Alotustv%2Fmacaulotustv&v3=1"}],台湾:[{name:"TVBS.iframe",url:"https://www.tvbs.com.tw/",value:"https://www.kankanzhibo.com/player/index?id=1334180",iframe:!0,parserURL:""},{name:"TVBS新闻",value:"http://pull-l3-cny.douyincdn.com/third/stream-e6b6ef594c30eb3f3de0fa4ba0ce86e6.m3u8"},{name:"TVBS亚洲台",value:"http://pull-l3-cny.douyincdn.com/third/stream-9f6ea8b662a55d5fa562ebaeb2880bfc.m3u8"},{name:"TVBS欢乐台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334179",iframe:!0,parserURL:""},{name:"东森新闻.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334237",iframe:!0,parserURL:""},{name:"台视.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334173",iframe:!0,parserURL:""},{name:"台视新闻.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334172",iframe:!0,parserURL:""},{name:"三立新闻台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334244",iframe:!0,parserURL:""},{name:"华视CTS.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334165",iframe:!0,parserURL:""},{name:"中视.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334170",iframe:!0,parserURL:""},{name:"中视新闻.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334169",iframe:!0,parserURL:""},{name:"中天新闻.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334177",iframe:!0,parserURL:""},{name:"中天综合",value:"http://pull-l3-cny.douyincdn.com/third/stream-5f26752efeee9e0c53cf6b530640ce60.m3u8",iframe:!1,lyric:"",error:!1},{name:"民视新闻台.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334167",iframe:!0,parserURL:""},{name:"民视.iframe",value:"https://www.kankanzhibo.com/player/index?id=1334168",iframe:!0,parserURL:""},{name:"台湾大愛1",value:"https://pulltv1.wanfudaluye.com/live/tv1.m3u8"},{name:"台湾大愛2",value:"https://pulltv2.wanfudaluye.com/live/tv2.m3u8"},{name:"淨宗學院網絡電臺",value:"https://live.ciguang.tv/live/hdtv.m3u8?auth_key=5216465889-0-0-701a98b03302233fc07fa2ee9e85d39b"},{name:"華藏衛視",value:"http://118.163.88.61:1935/hwazanlivetv/live.stream/playlist.m3u8"},{name:"原住民電視",value:"http://streamipcf.akamaized.net/live/_definst_/live_720/key_b1500.m3u8"},{name:"唯心電視",value:"http://mobile.ccdntech.com/transcoder/_definst_/vod164_Live/live/chunklist_w1177047531.m3u8"}],浙江:[{name:"浙江卫视",url:"http://www.zjstv.com/",value:"http://hw-vl.cztv.com/channels/lantian/channel01/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=6df39222f74eb12d899322a51e25f672&t=1670254786"},{name:"钱江都市",value:"http://hw-vl.cztv.com/channels/lantian/channel02/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=0616e508d41d39782aa42641910f716e&t=1670254876"},{name:"浙江经济生活",value:"http://hw-vl.cztv.com/channels/lantian/channel03/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=b1776013e8cb06dd962cb2d7c7076eee&t=1670254989"},{name:"浙江教科影视",value:"http://ali-vl.cztv.com/channels/lantian/channel04/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=1047928b74abc3f8ea503afaf9b27870&t=1670255051"},{name:"浙江民生休闲",value:"http://hw-vl.cztv.com/channels/lantian/channel06/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=5da5883eac7e1c203b764975705411f1&t=1670255113"},{name:"浙江新闻",value:"http://hw-vl.cztv.com/channels/lantian/channel07/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=70cb4362715f246668bc30b5280c4f37&t=1670255170"},{name:"浙江少儿频道",value:"http://hw-vl.cztv.com/channels/lantian/channel08/360p.m3u8?a=1000&d=1f87b5d61e6b800b6ce9ea091b9bcdb7&k=0d04eeba5ac82e2dfb77eaa21adfe635&t=1670255206"}],湖南:[{name:"湖南卫视(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-hunanweishi-gq/live.m3u8"},{name:"湖南卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240130_1/playlist.m3u8?CONTENTID=00000110240130_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"金鹰卡通",value:"https://padtx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPTUyNjc4NTI1ZDVkYjBhYzBjNjhhMjgzNTNmOWRlZmQ2JmVzPTE2NzkyNjM0NTYmdXVpZD02ZDA3ZjFjZWRlNjJjNGQzYWZhYTI4Yjg0NGExMzljMy1kZTU0MTg2ZCZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/JYKTMPP360.m3u8"},{name:"金鹰卡通.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225721/index.m3u8"},{name:"金鹰纪实",value:"https://padtx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPWM2ZmNhMWMxODIxYTc4ZjY3MTkxZDI0NDNlNDdkMmM3JmVzPTE2NzkyNjI4OTAmdXVpZD0wMzkxOTUyNWQ2MDNmNTE3Zjc1Y2Q5YjYwNDUzYzVhYS1kZTU0MTg2ZCZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/JYJSMPP360.m3u8"},{name:"湖南经视",value:"https://phonetx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPTg4MzRjYTI1ODQ4YzY0NGQ0ZTA4ZjExZGNkNzdjMjc3JmVzPTE2NzAyODI1OTEmdXVpZD1iNjY3ZDRiNmFhMzE3ZTIzMDk0NDg1NzIwZjlmYWE5Yy03MTEwYTI2YyZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/HNJSMPP360.m3u8?_t=1670253791265&_t=1670253806391"},{name:"湖南娱乐",value:"https://phoneqq.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPWFkMmJmOTBhMWJhZjEzZmUxYjZkYzY3YTcxN2NiZjU5JmVzPTE2NzAyODI3MTcmdXVpZD0zM2YyNzgyYTBmZmYxYzc0Mjg2YWY1YjdiOWFlYjM4ZC03MTEwYTI2YyZ2PTImYXM9MCZjZG5leF9pZD1xcV9waG9uZV9saXZl/HNYLMPP360.m3u8?_t=1670253917844&_t=1670253922933"},{name:"湖南电影",value:"https://phoneal.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPTk1OTMyNTIxZWU0YTVlOTJmZWVlNDQ2OTdlYTVkYzMzJmVzPTE2NzAyODI3NDYmdXVpZD04ZDcwYzY0ZGYzY2ZlNzYxMjgxMGQzMmI5ZjQwMmE3Ni03MTEwYTI2YyZ2PTImYXM9MCZjZG5leF9pZD1hbF9waG9uZTM,/HNDYMPP360.m3u8?_t=1670253946262&_t=1670253996485"},{name:"湖南都市",value:"https://phonetx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPTBhZGJkZDczMjk3NzVjZWEzYzNlMjc1OTQxYzAyNTUzJmVzPTE2NzAyODI4MjAmdXVpZD05Mzk0OWIwZjg5NTJlMGE1MDI5MTJkMGQyODMzOTllYi03MTEwYTI2YyZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/JYKTMPP360.m3u8?_t=1670254021040&_t=1670254033789"},{name:"湖南电视剧",value:"https://padal.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPWI4ODY4YmYzODhmZjYyMTk5MjFlZmU2MzEyYWFmYzE2JmVzPTE2NzkyNjI4OTYmdXVpZD0zMjhlMzEwMjJkYmUzNDQxMzhiNDNiMWNmNGE1ZTEzMC1kZTU0MTg2ZCZ2PTImYXM9MCZjZG5leF9pZD1hbF9waG9uZTM,/HNDSJMPP360.m3u8"},{name:"国际频道",value:"https://phonetx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPWFmMTJlYmNmYjIzM2M4ODQ0MDk5YTRkM2YzNjAwNWNmJmVzPTE2NzAyODI5MzMmdXVpZD01YWFjZGViODA3NzAxNWYzZDQ4NmVjMGU5ZmUwNjc5MS03MTEwYTI2YyZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/HNGJMPP360.m3u8?_t=1670254133093"},{name:"四海钓鱼",value:"https://phonetx.qing.mgtv.com/nn_live/nn_x64/cWlkPSZzPTg1NzVhODcxNDI4ODc1MTBjYWRkMjc3YzJjM2Q0NmY2JmVzPTE2NzkyMTg3NjgmdXVpZD02N2NlZGYyODU3MjBkZDkyZTBhNDBkMGQxMTI1MWQ5NS02NzQ3NDY2NyZ2PTImYXM9MCZjZG5leF9pZD10eF9waG9uZV9saXZl/KLCDMPP360.m3u8"}],广东:[{name:"广东卫视",value:"https://tcdn.itouchtv.cn/live/gdws.m3u8?t_token=611d129ddf1f44131fda2c9f6c7a63ed-GRuRTc82RcuzStwocHbWE5XCn1z5XiPOjjCyJKQKvEJogUFdHRJGrc8V5BXJ0Ylpgzzbe+JzmId2b7DrorSg6Bw/WEH6gAtdn9hlrrmcixWBnjcTm12Q9uWymq7ajhg05CoMyzyMdPZYxSuwFK62bzkPujkxJfuJbbZqjtu2Eg/qRtr319oiFxegKRHQVY8var2Av4xo/SRquO6KsJDnQHEktVXBUa2TsApNtJ+f5RJpg8gEKaNsO5YdzfPZ2uOW4SLZcD62dLRAo8I2j8a4k2RkaY8ZQLCYz+C/Ythw1q6uYIpsoODRk0sa5jrk+UghGY4mD1mu2yi0BdSuLfkLIsHPyRX23rA+tJJYLoFco69ROFZV/rL5v7uU7m0PCeXKDY5Wy3sjMRpH4EZ50dPV7JVslk4kp3Gtu8lpok6VQMVRuFS+Cf5hp7WKijwbS+R56UTNdFb8VX0D6LE0qvmuIQ=="},{name:"广东卫视.HD(跨域限制)",value:"http://39.135.138.58:18890/PLTV/88888910/224/3221225742/index.m3u8"},{name:"广东体育",value:"https://p.ggiptv.com/play.php?token=OmzxVeHPZB%2BGakfzg6B6utJl&tid=itv&id=4#.m3u8"},{name:"广东移动",value:"https://sztctv.gdtv.cn/live/ydpd.m3u8?auth_key=1670263420-0-0-3560b05d1941acfd603ea2283756069b"},{name:"广东珠江",value:"https://tcdn.itouchtv.cn/live/gdzj.m3u8?t_token=f16eb636a9ab072bf326e4e90caa7648-JFGOXcmqIdE4uDCFCJ32zja6wCVUhWydceaj5T1fUVguzK%2Fh5hiJVQWYjq5KBG1gWGM184UTh9LC8azzM%2FzMbSRPlB2QZMGwIDfu7Ee%2FX2eBYN7oVGT%2BClDkLoeUMQ0cbO%2BZGRkQ2kV83nLUb9WD0B1KuURJyUFVECdC9e1OgS3YVIsx7k7NtjFME5DvkkOMQLmJ3MP9XQNIL%2Bh8cjyagRYp8%2F6Hq0qgB8J0trr37TuGwwRMe%2Ff37dgUa15Pv18unXDMaqPFrYHPoweR%2BkbuOZh2K2tw4ELNU8toR6GCcxRL0rWTeLCMPkr0zrylHQkAQShaXrze3E9WTNXyteZGaffFbLKkN3dt1ob2xQ8M2CclaDXgh2XvfzdRvD3S5OkkRZWMLCK6HeGmPzbiZRk%2Bi7%2FVhKPyUUe9f4mttFQfrkZQBpcTa4ZE%2FTrrA6WDo9ksx%2Fu8Qh4Vx4reuzHsuFjo5Q%3D%3D"},{name:"广州综合",value:"https://aplays.gztv.com/sec/zhonghes.m3u8?auth_key=1676320438-0-0-b98b7bc2fcd9f2494c7da8c599355531"},{name:"广州新闻",value:"https://aplays.gztv.com/sec/xinwen.m3u8?auth_key=1679215151-0-0-acc86110aceb3c4c11a9b7304c00f8f6"},{name:"南国都市(4K)",value:"https://aplays.gztv.com/sec/shenghuos.m3u8?auth_key=1676320533-0-0-226eeae1e50951abc94ff68ff4f35c5b"},{name:"深圳卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240132_1/playlist.m3u8?CONTENTID=00000110240132_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"深圳公共",value:"https://sztv-live.cutv.com/2q76Sw2/500/o5k2g70.m3u8?sign=cd87999d1886b6435f12460c62f59cc9&t=cf3944b3"},{name:"深圳娱乐",value:"https://sztv-live.cutv.com/1q4iPng/500/q4i1g40.m3u8?sign=7a2f81b24a9c84fabc52303fb251b81a&t=cf39215c"},{name:"深圳卫视.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225741/index.m3u8"}],广西:[{name:"广西卫视",cover:"https://www.gxtv.cn/static/web/images/home/gxrtv_logo_new.png",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240037_1/encoder/0/playlist.m3u8?CONTENTID=00000110240037_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"广西卫视.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225731/index.m3u8"},{name:"广西卫视.IP6(跨域限制)",value:"http://[2409:8087:3869:8021:1001::e5]:6610/PLTV/88888888/224/3221225731/2/index.m3u8"},{name:"广西综艺旅游(跨域限制)",value:"http://111.59.189.40:8445/tsfile/live/1023_1.m3u8"},{name:"广西影视(跨域限制)",value:"http://111.59.189.40:8445/tsfile/live/1024_1.m3u8"},{name:"广西新闻(跨域限制)",value:"http://111.59.189.40:8445/tsfile/live/1025_1.m3u8"},{name:"广西都市(跨域限制)",value:"http://111.59.189.40:8445/tsfile/live/1027_1.m3u8"}],南宁:[{name:"南宁新闻综合",value:"https://hls.nntv.cn/nnlive/NNTV_NEWS_A.m3u8"},{name:"南宁都市生活",value:"https://hls.nntv.cn/nnlive/NNTV_METRO_A.m3u8"},{name:"南宁影视娱乐",value:"https://hls.nntv.cn/nnlive/NNTV_VOD_A.m3u8"},{name:"南宁公共",value:"https://hls.nntv.cn/nnlive/NNTV_PUB_A.m3u8"},{name:"南宁马山",value:"https://hls.nntv.cn/nnlive/MSTV_A.m3u8"},{name:"南宁上林",value:"https://hls.nntv.cn/nnlive/SLTV_A.m3u8"},{name:"南宁老友直播",value:"http://hls.nntv.cn/nnlive/NNTV_LYOU.m3u8"}],江苏:[{name:"江苏卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240133_1/playlist.m3u8?CONTENTID=00000110240133_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"江苏教育",value:"http://183.207.248.11/PLTV/4/224/3221225923/index.m3u8"},{name:"江苏影视",value:"https://live-hls.jstv.com/livezhuzhan/jsys.m3u8?upt=174db1d91670257893"}],重庆:[{name:"重庆卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240012_1/playlist.m3u8?CONTENTID=00000110240012_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"重庆卫视.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225692/index.m3u8"}],上海:[{name:"上海卫视(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-shanghaiweishi-gq/live.m3u8"},{name:"东方卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240242_1/playlist.m3u8?CONTENTID=00000110240242_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"第一财经",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/dycjhd/4000000/mnf.m3u8"},{name:"东方财经",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/dfcj/1300000/mnf.m3u8"},{name:"东方影视",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/dsjpdhd/4000000/mnf.m3u8"},{name:"新闻综合",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/xwzhhd/2300000/mnf.m3u8"},{name:"紀實人文",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/jspdhd/4000000/mnf.m3u8"},{name:"哈哈炫動",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/hhxdhd/4000000/mnf.m3u8"},{name:"欢笑剧场",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/hxjchd/4000000/mnf.m3u8"},{name:"动漫秀场",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/dmxchd/4000000/mnf.m3u8"}],福建:[{name:"东南卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240588_1/playlist.m3u8?CONTENTID=00000110240588_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],湖北:[{name:"湖北卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240135_1/playlist.m3u8?CONTENTID=00000110240135_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],四川卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240071_1/playlist.m3u8?CONTENTID=00000110240071_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],海南旅游卫视:[{name:"线路1",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/lyws/1300000/mnf.m3u8"}],厦门卫视:[{name:"线路1",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/xmws/1300000/mnf.m3u8"}],天津卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240136_1/playlist.m3u8?CONTENTID=00000110240136_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],安徽卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240256_1/playlist.m3u8?CONTENTID=00000110240256_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],江西卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240049_1/playlist.m3u8?CONTENTID=00000110240049_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],内蒙古卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240060_1/playlist.m3u8?CONTENTID=00000110240060_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],宁夏卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://stream.nxtv.com.cn/wspd/sd/live.m3u8?_upt=d2bcae691679351589",iframe:!0,parserURL:""}],云南卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240082_1/playlist.m3u8?CONTENTID=00000110240082_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],青海卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240059_1/playlist.m3u8?CONTENTID=00000110240059_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],贵州卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240318_1/playlist.m3u8?CONTENTID=00000110240318_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],陕西卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240066_1/playlist.m3u8?CONTENTID=00000110240066_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],河南卫视:[{name:"河南卫视",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240041_1/playlist.m3u8?CONTENTID=00000110240041_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"河南都市(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-henandushi/live.m3u8"},{name:"河南民生(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-henanminsheng/live.m3u8"},{name:"河南梨园(有延迟)",value:"https://media.hndyjyfw.gov.cn/live/jz-henanliyuan/live.m3u8"}],河北卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240317_1/playlist.m3u8?CONTENTID=00000110240317_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],山东卫视:[{name:"线路",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240254_1/playlist.m3u8?CONTENTID=00000110240254_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"线路.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225738/index.m3u8"}],山西卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240065_1/playlist.m3u8?CONTENTID=00000110240065_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],兵团卫视:[{name:"线路1",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/btws/1300000/mnf.m3u8"}],延边卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://live.ybtvyun.com/video/s10006-90fe76c52091/index.m3u8",iframe:!0,parserURL:""}],甘肃卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240034_1/playlist.m3u8?CONTENTID=00000110240034_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],西藏卫视:[{name:"线路1",value:"https://tv.vtibet.cn/live/EfgSmE4jCTBtvchannel3.m3u8"}],新疆卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://livehyw5.chinamcache.com/hyw/zb01.m3u8?txSecret=ac4608d03b3fec4557d137827a3f4bb6&txTime=95A66655",iframe:!0,parserURL:""}],吉林卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240046_1/playlist.m3u8?CONTENTID=00000110240046_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],辽宁卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240255_1/playlist.m3u8?CONTENTID=00000110240255_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""}],黑龙江卫视:[{name:"线路1",value:"http://player.ggapk.net/tv_player/tc_player.php?url=http://1.204.169.243/live.aishang.ctlcdn.com/00000110240131_1/playlist.m3u8?CONTENTID=00000110240131_1&AUTHINFO=FABqh274XDn8fkurD5614t%2B1RvYajgx%2Ba3PxUJe1SMO4OjrtFitM6ZQbSJEFffaD35hOAhZdTXOrK0W8QvBRom%2BXaXZYzB%2FQfYjeYzGgKhP%2Fdo%2BXpr4quVxlkA%2BubKvbU1XwJFRgrbX%2BnTs60JauQUrav8kLj%2FPH8LxkDFpzvkq75UfeY%2FVNDZygRZLw4j%2BXtwhj%2FIuXf1hJAU0X%2BheT7g%3D%3D&USERTOKEN=eHKuwve%2F35NVIR5qsO5XsuB0O2BhR0KR",iframe:!0,parserURL:""},{name:"线路.HD(跨域限制)",value:"http://39.134.115.163:8080/PLTV/88888910/224/3221225690/index.m3u8"}]}}],music_playlist=[{group:"酷我.精选歌单",icon:"fa fa-music",plugins:{update:{name:"getHotListHTML",from:"ZYMUSIC"}},channel:{}}],dataSource$3={live:[...cctv,...localTV,...english,...englishGroup,...liveCap],radio:[...cnrRadio,...radio,...englishRadio,...music_playlist],movie:[...englishGroup]},_sfc_main$f=defineComponent({__name:"Live",setup(n){const e=ref(dataSource$3.live),t=(s=currentPathSearch.obj.go)=>{e.value=dataSource$3[s]||[],console.log("!!!currentPathSearch",currentPathSearch),activeGroup.value=0,menuName.value=s};watch(()=>currentPathSearch.obj.go,(s,a)=>{console.log("watch:pathSearch",{cur:s,pre:a}),t(s)});const r=()=>{const s=menu$2.getActive();console.log("!!!checkSearchPath",{m:s,currentPathSearch}),!currentPathSearch.obj.go&&s.sublink&&(currentPathSearch.obj.go=s.sublink,t(),updatePathSearch())};return onMounted(()=>{nextTick(()=>{r()})}),(s,a)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createVNode(GridBox,{dataset:e.value},null,8,["dataset"])]),_:1}))}}),_sfc_main$e=defineComponent({__name:"TV",setup(n){logoItem.setTitle("MPBugTV"),logoItem.setSubTitle("时空葫芦.TV");let e="/application/tv";return menuList[e]=[{name:"<",link:"application",status:""},{name:"直播",sublink:"live",status:"active"},{name:"电台",sublink:"radio",status:""},{name:"电影",sublink:"movie",status:""},{name:"电视剧",sublink:"teleplay",status:""},{name:"动漫",sublink:"animation",status:""},{name:"综艺",sublink:"tvshow",status:""}],(t,r)=>(openBlock(),createBlock(_sfc_main$f))}}),_sfc_main$d=defineComponent({__name:"KTV",setup(n){let e="/application/ktv";return menuList[e]=[{name:"<",link:"application",status:""},{name:"热门",sublink:"hot",status:""},{name:"华语",sublink:"mandarin",status:"active"},{name:"粤语",sublink:"cantonese",status:""},{name:"外语",sublink:"foreign",status:""},{name:"男歌手",sublink:"man",status:""},{name:"女歌手",sublink:"women",status:""}],(t,r)=>(openBlock(),createElementBlock("div",null,"KTV..."))}}),doc=[{group:"格式化文档",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"文本对比",channel:{JSON:[]}},{group:"文本统计",channel:{JSON:[]}},{group:"正则表达式",channel:{JSON:[]}},{group:"Cron校验工具",channel:{JSON:[]}},{group:"Markdown工具",channel:{表格转换:[],预览:[]}}],image=[{group:"图片压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"图片滤镜",channel:{JSON:[]}},{group:"图片抠图",channel:{JSON:[]}},{group:"图片宽高",channel:{JSON:[]}},{group:"图片识别",channel:{JSON:[]}},{group:"颜色工具",channel:{表格转换:[],预览:[]}},{group:"证件照",channel:{换底色:[],裁剪:[],排版:[]}},{group:"格式转换",channel:{表格转换:[],预览:[]}}],audio=[{group:"音频裁剪",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"人声伴奏分离",channel:{JSON:[]}},{group:"文本统计",channel:{JSON:[]}},{group:"正则表达式",channel:{JSON:[]}},{group:"Cron校验工具",channel:{JSON:[]}},{group:"Markdown工具",channel:{表格转换:[],预览:[]}}],video=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],dataSource$2={doc:[...doc],image:[...image],audio:[...audio],video:[...video]};let path$2="/application/tools";menuList[path$2]=[{name:"<",link:"application",status:""},{name:"文档",sublink:"doc",status:"active"},{name:"图片",sublink:"image",status:""},{name:"音频",sublink:"audio",status:""},{name:"视频",sublink:"video",status:""},{name:"文件",sublink:"file",status:""},{name:"生成器",sublink:"generator",status:""},{name:"AI",sublink:"AI",status:""},{name:"网络",sublink:"network",status:""},{name:"计算",sublink:"counter",status:""},{name:"字词句典",sublink:"dict",status:""},{name:"儿童",sublink:"kid",status:""},{name:"学生",sublink:"student",status:""},{name:"老师",sublink:"teacher",status:""},{name:"打工人",sublink:"worker",status:""},{name:"老板",sublink:"boss",status:""}];const defaultMenuName$2="doc",datasource$2=ref(dataSource$2),dataset$2=ref(dataSource$2[defaultMenuName$2]),_sfc_main$c=defineComponent({__name:"index",setup(n){logoItem.setTitle("MPBugT"),logoItem.setSubTitle("时空葫芦.Tools");const e=(r=currentPathSearch.obj.go)=>{r&&(dataset$2.value=datasource$2.value[r]||[],console.log("!!!currentPathSearch",{name:r,currentPathSearch,datasource:datasource$2.value,dataset:dataset$2.value}),activeGroup.value=0,menuName.value=r)};watch(()=>currentPathSearch.obj.go,(r,s)=>{console.log("watch:pathSearch",{cur:r,pre:s}),e(r)});const t=()=>{const r=menu$2.getActive();console.log("!!!checkSearchPath",{m:r,currentPathSearch}),!currentPathSearch.obj.go&&r.sublink&&(currentPathSearch.obj.go=r.sublink,e(),updatePathSearch())};return onMounted(()=>{nextTick(()=>{t()})}),(r,s)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createVNode(GridBox,{dataset:unref(dataset$2),page:"software"},null,8,["dataset"])]),_:1}))}}),_sfc_main$b=defineComponent({__name:"Tools",setup(n){return(e,t)=>(openBlock(),createBlock(_sfc_main$c))}}),win=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[{name:"中文 WPS",value:"https://platform.wps.cn/"},{name:"国际 WPS",value:"https://www.wps.com/office/"},{name:"企业 WPS",value:"https://ep.wps.cn/"},{name:"金山文档",value:"https://www.kdocs.cn/"},{name:"金山协作",value:"https://xz.wps.cn/"},{name:"金山办公",value:"https://account.wps.cn/login"},{name:"金山会议",value:"https://meeting.kdocs.cn/"},{name:"WPS 365",value:"https://365.wps.cn/home"},{name:"WPS开放平台",value:"https://open.wps.cn/"},{name:"金山PDF",value:"https://www.wpspdf.cn/"},{name:"金山词霸",value:"https://www.iciba.com/"},{name:"金山打字通",value:"https://www.51dzt.com/"},{name:"稻壳儿",value:"https://www.docer.com/"},{name:"WPS考试宝典",value:"https://kos.wps.cn/download?frpo=wps_officialweb_card"}],Office:[{name:"正版Office下载",value:"https://www.microsoft.com/zh-cn/microsoft-365/products-apps-services"},{name:"Microsoft 365 中文",value:"https://www.office.com/?omkt=zh-CN"},{name:"Microsoft 365 教育",value:"https://www.microsoft.com/zh-cn/education/products/microsoft-365"},{name:"Microsoft 365 外文",value:"https://www.office.com/"},{name:"Microsoft Teams 教育",value:"https://www.microsoft.com/zh-cn/education/products/teams"},{name:"登录 Microsoft",value:"https://login.microsoftonline.com/"},{name:"Microsoft cloud",value:"https://www.microsoft.com/zh-cn/microsoft-cloud"},{name:"itellyou",value:"https://msdn.itellyou.cn/"},{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1Op94Ymr1jEQf4rJMLjvPPA"}],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-windows",channel:{ISO:[{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows XP":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1I4sjJfEFVVy-2Ncv3dQuYg"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 7":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1TpQgzY01rU7lC_NzHtA0fw"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 8":[{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 10":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1qv2eb6q-ZSMx2Xe5NNAcQA"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 11":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/12TeHnV6gFH_IojZwhGkRSg"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"Microsoft Defender",value:"https://www.microsoft.com/zh-cn/microsoft-365/microsoft-defender-for-individuals"},{name:"微软电脑管家",value:"https://pcmanager.microsoft.com/cn"},{name:"火绒",value:"https://www.huorong.cn/"},{name:"360卫士",value:"https://weishi.360.cn/"},{name:"金山毒霸",value:"https://www.duba.net/"},{name:"卡巴斯基",value:"https://www.kaspersky.com.cn/downloads"},{name:"Norton™ 360",value:"https://cn.norton.com/"},{name:"Avast Free Antivirus",value:"https://www.avast.com/zh-cn/free-antivirus-download#pc"},{name:"McAfee",value:"https://www.mcafee.com/"},{name:"Bitdefender",value:"https://www.bitdefender.com/"},{name:"Webroot",value:"https://www.webroot.com/"},{name:"AVG",value:"https://www.avg.com/en-us/free-antivirus-download"},{name:"Malwarebytes",value:"https://www.malwarebytes.com/"},{name:"腾讯电脑管家",value:"https://guanjia.qq.com/"}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{外国产:[{name:"Firefox",value:"https://www.firefox.com.cn/"},{name:"Chrome",value:"https://www.google.cn/intl/zh-CN/chrome/"},{name:"Edge",value:"https://www.microsoft.com/zh-cn/edge/download"},{name:"Safari",value:"https://support.apple.com/zh_CN/downloads/safari"},{name:"Opera",value:"https://www.opera.com/zh-cn"},{name:"Brave",value:"https://brave.com"}],国产:[{name:"QQ浏览器",value:"https://browser.qq.com/"},{name:"UC",value:"https://www.uc.cn/"},{name:"搜狗高速浏览器",value:"https://ie.sogou.com/"},{name:"傲游浏览器",value:"https://www.maxthon.cn/"},{name:"猎豹浏览器",value:"https://www.liebao.cn/"},{name:"360极速浏览器",value:"https://browser.360.cn/eex/"}],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[{name:"PotPlayer",value:"http://www.potplayercn.com/"},{name:"VLC",value:"https://www.videolan.org/vlc/index.zh_CN.html"},{name:"mpv",value:"https://mpv.io/"},{name:"KMPlayer",value:"https://www.kmplayer.com/"},{name:"StellarPlayer",value:"https://www.stellarplayer.com/"},{name:"爱奇艺万能联播",value:"http://static-s.iqiyi.com/wnbf/get.html"},{name:"QQ影音",value:"https://player.qq.com/"},{name:"暴风影音",value:"http://www.baofeng.com/"},{name:"迅雷影音",value:"https://video.xunlei.com/pc.html"}],格式转换:[{name:"迅捷视频转换器",value:"https://www.xunjieshipin.com/video-converter?zhhxx11"},{name:"在线视频转换器",value:"https://convertio.co/zh/video-converter/"},{name:"Aconvert",value:"https://www.aconvert.com/cn/video/"},{name:"格式工厂",value:"http://formatfactory.org/CN/download.html"}],下载:[{name:"Youtube影片下載",value:"https://zh.savefrom.net/226/"},{name:"哔哩哔哩视频解析下载",value:"https://bilibili.iiilab.com/"}],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[{name:"酷我",value:"http://www.kuwo.cn/"},{name:"酷狗",value:"https://www.kugou.com/"},{name:"网易云",value:"https://music.163.com/"},{name:"QQ音乐",value:"https://y.qq.com/"},{name:"魔音MORIN",value:"http://morin.feiyu.vin/"},{name:"Listen1",value:"https://listen1.github.io/listen1/"},{name:"Spotify",value:"https://www.spotify.com/"},{name:"RarmaRadio",value:"https://raimersoft.com/rarmaradio.html"},{name:"MusicPlayer2",value:"https://gitee.com/zhongyang219/MusicPlayer2"}],格式转换:[{name:"音乐解锁",value:"https://tool.sacdr.net/"}],下载:[{name:"下歌吧",value:"https://music.y444.cn/"}],AI:[{name:"音乐人声分离",value:"https://vocalremover.org/zh/"}]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}},{group:"资源发现",icon:"fa fa-sitemap",channel:{软件库站:[{name:"小众软件",value:"https://www.appinn.com/"},{name:"分享迷",value:"https://www.fenxm.com/"},{name:"FileHorse",value:"https://www.filehorse.com/"},{name:"Filehippo",value:"https://filehippo.com/"},{name:"Sourceforge",value:"https://sourceforge.net/"},{name:"Fileplanet",value:"https://www.fileplanet.com/"},{name:"腾讯应用宝",value:"https://sj.qq.com/"}]}}],linux=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[],Office:[],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-linux",channel:{鸿蒙:[{name:"HarmonyOS",value:"https://www.harmonyos.com/"},{name:"HarmonyOS Gitee",value:"https://gitee.com/openharmony"},{name:"HarmonyOS Github",value:"https://github.com/Awesome-HarmonyOS/HarmonyOS"},{name:"HarmonyOS Develop",value:"https://www.harmonyos.com/cn/develop"},{name:"华为云.开源镜像",value:"https://mirrors.huaweicloud.com/"}],Arch:[{name:"Arch",value:"https://archlinux.org/"}],Ubuntu:[],gentoo:[],debian:[],fedora:[],freeBSD:[],openSUSE:[],CentOS:[],麒麟:[],深度:[],中标:[],开源镜像:[{name:"阿里云",value:"https://developer.aliyun.com/mirror/"},{name:"华为云.开源镜像",value:"https://mirrors.huaweicloud.com/"},{name:"清华大学开源软件镜像站",value:"https://mirrors.tuna.tsinghua.edu.cn/"},{name:"腾讯软件源",value:"https://mirrors.cloud.tencent.com/"},{name:"网易开源镜像站",value:"http://mirrors.163.com/"},{name:"中国科学技术大学",value:"http://mirrors.ustc.edu.cn/"},{name:"浙江大学开源软件镜像站",value:"http://mirrors.zju.edu.cn/"},{name:"兰州大学开源社区镜像站",value:"http://mirror.lzu.edu.cn/"},{name:"哈尔滨工业大学开源镜像站",value:"http://mirrors.hit.edu.cn/#/home"},{name:"思谋学术",value:"https://ac.scmor.com/"},{name:"金山",value:""},{name:"金山",value:""}]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"金山",value:""}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{chrome:[],edge:[],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[],格式转换:[],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[],格式转换:[],AI:[]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}}],mac=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[],Office:[],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-laptop",channel:{ISO:[],"Mac OS X 10.0 (Cheetah)":[],"Mac OS X 10.1 (Puma)":[],"Mac OS X 10.2 (Jaguar)":[],"Mac OS X 10.3 (Panther)":[],"Mac OS X 10.4 (Tiger)":[],"Mac OS X 10.5 (Leopard)":[],"Mac OS X 10.6 (Snow Leopard)":[],"OS X 10.7 (Lion)":[],"OS X 10.8 (Mountain Lion)":[],"OS X 10.9 (Mavericks)":[],"OS X 10.10 (Yosemite)":[],"OS X 10.11 (El Capitan)":[],"macOS 10.12 (Sierra)":[],"macOS 10.13 (High Sierra)":[],"macOS 10.14 (Mojave)":[],"macOS 10.15 (Catalina)":[],"macOS 11 (Big Sur)":[],"macOS 12 (Monterey)":[],"macOS 13 (Ventura)":[]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"360",value:""},{name:"火绒",value:""},{name:"金山",value:""}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{chrome:[],edge:[],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[],格式转换:[],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[],格式转换:[],AI:[]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}}],game=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],android=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],mp=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],mpp=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],repo=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],menu$1=[{name:"<",link:"application",status:""},{name:"Win",sublink:"win",status:"active"},{name:"Mac",sublink:"mac",status:""},{name:"Linux",sublink:"linux",status:""},{name:"Game",sublink:"game",status:""},{name:"Android",sublink:"android",status:""},{name:"小程序",sublink:"mp",status:""},{name:"公众号",sublink:"mpp",status:""},{name:"仓库",sublink:"repo",status:""}],dataSource$1={win,linux,mac,game,android,mp,mpp,repo};let path$1="/application/software";menuList[path$1]=menu$1;const defaultMenuName$1=menu$1[1].sublink,datasource$1=ref(dataSource$1),dataset$1=ref(dataSource$1[defaultMenuName$1]),_sfc_main$a=defineComponent({__name:"index",setup(n){logoItem.setTitle("MPBugS"),logoItem.setSubTitle("时空葫芦.软件库");const e=(r=currentPathSearch.obj.go)=>{r&&(dataset$1.value=datasource$1.value[r]||[],console.log("!!!currentPathSearch",{name:r,currentPathSearch,datasource:datasource$1.value,dataset:dataset$1.value}),activeGroup.value=0,menuName.value=r)};watch(()=>currentPathSearch.obj.go,(r,s)=>{console.log("watch:pathSearch",{cur:r,pre:s}),e(r)});const t=()=>{const r=menu$2.getActive();console.log("!!!checkSearchPath",{m:r,currentPathSearch}),!currentPathSearch.obj.go&&r.sublink&&(currentPathSearch.obj.go=r.sublink,e(),updatePathSearch())};return onMounted(()=>{nextTick(()=>{t()})}),(r,s)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createVNode(GridBox,{dataset:unref(dataset$1),page:"software"},null,8,["dataset"])]),_:1}))}}),oa=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[{name:"中文 WPS",value:"https://platform.wps.cn/"},{name:"国际 WPS",value:"https://www.wps.com/office/"},{name:"企业 WPS",value:"https://ep.wps.cn/"},{name:"金山文档",value:"https://www.kdocs.cn/"},{name:"金山协作",value:"https://xz.wps.cn/"},{name:"金山办公",value:"https://account.wps.cn/login"},{name:"金山会议",value:"https://meeting.kdocs.cn/"},{name:"WPS 365",value:"https://365.wps.cn/home"},{name:"WPS开放平台",value:"https://open.wps.cn/"},{name:"金山PDF",value:"https://www.wpspdf.cn/"},{name:"金山词霸",value:"https://www.iciba.com/"},{name:"金山打字通",value:"https://www.51dzt.com/"},{name:"稻壳儿",value:"https://www.docer.com/"},{name:"WPS考试宝典",value:"https://kos.wps.cn/download?frpo=wps_officialweb_card"}],Office:[{name:"正版Office下载",value:"https://www.microsoft.com/zh-cn/microsoft-365/products-apps-services"},{name:"Microsoft 365 中文",value:"https://www.office.com/?omkt=zh-CN"},{name:"Microsoft 365 教育",value:"https://www.microsoft.com/zh-cn/education/products/microsoft-365"},{name:"Microsoft 365 外文",value:"https://www.office.com/"},{name:"Microsoft Teams 教育",value:"https://www.microsoft.com/zh-cn/education/products/teams"},{name:"登录 Microsoft",value:"https://login.microsoftonline.com/"},{name:"Microsoft cloud",value:"https://www.microsoft.com/zh-cn/microsoft-cloud"},{name:"itellyou",value:"https://msdn.itellyou.cn/"},{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1Op94Ymr1jEQf4rJMLjvPPA"}],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-windows",channel:{ISO:[{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows XP":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1I4sjJfEFVVy-2Ncv3dQuYg"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 7":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1TpQgzY01rU7lC_NzHtA0fw"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 8":[{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 10":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/1qv2eb6q-ZSMx2Xe5NNAcQA"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}],"Windows 11":[{name:"百度网盘(pwd:9999)",value:"https://pan.baidu.com/s/12TeHnV6gFH_IojZwhGkRSg"},{name:"itellyou",value:"https://msdn.itellyou.cn/"}]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"360",value:""},{name:"火绒",value:""},{name:"金山",value:""}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{chrome:[],edge:[],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[{name:"PotPlayer",value:"http://www.potplayercn.com/"},{name:"VLC",value:"https://www.videolan.org/vlc/index.zh_CN.html"},{name:"mpv",value:"https://mpv.io/"},{name:"KMPlayer",value:"https://www.kmplayer.com/"},{name:"StellarPlayer",value:"https://www.stellarplayer.com/"},{name:"爱奇艺万能联播",value:"http://static-s.iqiyi.com/wnbf/get.html"},{name:"QQ影音",value:"https://player.qq.com/"},{name:"暴风影音",value:"http://www.baofeng.com/"},{name:"迅雷影音",value:"https://video.xunlei.com/pc.html"}],格式转换:[{name:"迅捷视频转换器",value:"https://www.xunjieshipin.com/video-converter?zhhxx11"},{name:"在线视频转换器",value:"https://convertio.co/zh/video-converter/"},{name:"Aconvert",value:"https://www.aconvert.com/cn/video/"},{name:"格式工厂",value:"http://formatfactory.org/CN/download.html"}],下载:[{name:"Youtube影片下載",value:"https://zh.savefrom.net/226/"},{name:"哔哩哔哩视频解析下载",value:"https://bilibili.iiilab.com/"}],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[{name:"酷我",value:"http://www.kuwo.cn/"},{name:"酷狗",value:"https://www.kugou.com/"},{name:"网易云",value:"https://music.163.com/"},{name:"QQ音乐",value:"https://y.qq.com/"},{name:"魔音MORIN",value:"http://morin.feiyu.vin/"},{name:"Listen1",value:"https://listen1.github.io/listen1/"},{name:"Spotify",value:"https://www.spotify.com/"},{name:"RarmaRadio",value:"https://raimersoft.com/rarmaradio.html"},{name:"MusicPlayer2",value:"https://gitee.com/zhongyang219/MusicPlayer2"}],格式转换:[{name:"音乐解锁",value:"https://tool.sacdr.net/"}],下载:[{name:"下歌吧",value:"https://music.y444.cn/"}],AI:[{name:"音乐人声分离",value:"https://vocalremover.org/zh/"}]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}},{group:"资源发现",icon:"fa fa-sitemap",channel:{软件库站:[{name:"小众软件",value:"https://www.appinn.com/"},{name:"分享迷",value:"https://www.fenxm.com/"}]}}],photographer=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[],Office:[],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-linux",channel:{ISO:[],Arch:[],Ubuntu:[],gentoo:[],debian:[],fedora:[],freeBSD:[],openSUSE:[],CentOS:[],麒麟:[],深度:[],中标:[]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"360",value:""},{name:"火绒",value:""},{name:"金山",value:""}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{chrome:[],edge:[],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[],格式转换:[],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[],格式转换:[],AI:[]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}}],engineer=[{group:"办公",icon:"fa fa-envira",channel:{WPS:[],Office:[],插件:[],PDF:[]}},{group:"系统安装",icon:"fa fa-laptop",channel:{ISO:[],"Mac OS X 10.0 (Cheetah)":[],"Mac OS X 10.1 (Puma)":[],"Mac OS X 10.2 (Jaguar)":[],"Mac OS X 10.3 (Panther)":[],"Mac OS X 10.4 (Tiger)":[],"Mac OS X 10.5 (Leopard)":[],"Mac OS X 10.6 (Snow Leopard)":[],"OS X 10.7 (Lion)":[],"OS X 10.8 (Mountain Lion)":[],"OS X 10.9 (Mavericks)":[],"OS X 10.10 (Yosemite)":[],"OS X 10.11 (El Capitan)":[],"macOS 10.12 (Sierra)":[],"macOS 10.13 (High Sierra)":[],"macOS 10.14 (Mojave)":[],"macOS 10.15 (Catalina)":[],"macOS 11 (Big Sur)":[],"macOS 12 (Monterey)":[],"macOS 13 (Ventura)":[]}},{group:"安全",icon:"fa fa-expeditedssl",channel:{杀毒软件:[{name:"360",value:""},{name:"火绒",value:""},{name:"金山",value:""}],监控软件:[],垃圾清理:[],备份恢复:[{name:"美化",value:""}]}},{group:"浏览器",icon:"fa fa-edge",channel:{chrome:[],edge:[],插件:[]}},{group:"视频",icon:"fa fa-youtube-play",channel:{播放器:[],格式转换:[],AI:[]}},{group:"音频",icon:"fa fa-microphone",channel:{播放器:[],格式转换:[],AI:[]}},{group:"图片",icon:"fa fa-magic",channel:{播放器:[],格式转换:[],AI:[]}},{group:"聊天",icon:"fa fa-comments",channel:{QQ:[],Wechat:[],Ding:[]}},{group:"硬件",icon:"fa fa-tachometer",channel:{驱动:[],光盘:[],硬盘:[],USB:[],嵌入式:[]}},{group:"网络",icon:"fa fa-sitemap",channel:{下载器:[],服务端:[],文件传输:[],检测:[],防火墙:[],wifi:[]}}],media=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],designer=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],developer=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],lawyer=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],devOps=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],academic=[{group:"视频压缩",channel:{JSON:[{name:"美化",value:""},{name:"混淆",value:""},{name:"加密",value:""}],"XML/HTML":[{name:"美化",value:""}],SQL:[{name:"美化",value:""}],DateTime:[{name:"美化",value:""}]}},{group:"音频分离",channel:{JSON:[]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],entertainment=[{group:"电影电视剧",icon:"fa fa-youtube-play",channel:{大平台:[{name:"优酷",cover:"",url:"https://www.youku.com"},{name:"爱奇艺",cover:"",url:"https://www.iqiyi.com"},{name:"腾讯视频",cover:"",url:"https://v.qq.com"},{name:"芒果TV",cover:"",url:"https://www.mgtv.com"},{name:"B站",cover:"",url:"https://www.bilibili.com"},{name:"Acfun",cover:"https://ali-imgs.acfun.cn/kos/nlav10360/static/common/widget/header/img/acfunlogo.11a9841251f31e1a3316.svg",url:"http://www.acfun.cn/"},{name:"西瓜视频",cover:"",url:"http://www.ixigua.com/"},{name:"好看视频",cover:"",url:"http://haokan.baidu.com/"},{name:"梨视频",cover:"",url:"http://www.pearvideo.com/"},{name:"1905视频",cover:"",url:"http://www.1905.com/"},{name:"CCTV",cover:"",url:"http://tv.cctv.com/live"}],直播:[{name:"虎牙直播",cover:"",url:"http://www.huya.com/"},{name:"斗鱼直播",cover:"",url:"http://www.douyu.com/"},{name:"淘宝直播",cover:"",url:"http://taolive.taobao.com/explore/index.html"},{name:"小红书",cover:"",url:"http://www.xiaohongshu.com/"},{name:"风直播",cover:"",url:"http://flive.ifeng.com/"},{name:"搜狐视频",cover:"",url:"http://tv.sohu.com/"},{name:"网易视频",cover:"",url:"http://v.163.com/"}],短视频:[{name:"抖音",cover:"",url:"https://live.douyin.com/"},{name:"快手",cover:"",url:"http://www.kuaishou.com/new-reco"}],小站:[{name:"Freeok",cover:"",url:"https://www.freeok.vip/"},{name:"MX动漫",cover:"",url:"http://www.mxdm8.com/"}],外网:[{name:"YouTube",cover:"",url:"http://www.YouTube.com/"},{name:"Instagram",cover:"",url:"http://www.Instagram.com/"},{name:"Vimeo",cover:"",url:"http://www.Vimeo.com/"},{name:"Dailymotion",cover:"",url:"http://www.Dailymotion.com/"}]}},{group:"音乐",icon:"fa fa-microphone",channel:{大平台:[{name:"QQ音乐",cover:"",url:"http://y.qq.com/"},{name:"酷狗",cover:"",url:"http://www.kugou.com/"},{name:"酷我",cover:"",url:"http://www.kuwo.cn/"},{name:"喜马拉雅",cover:"",url:"http://www.ximalaya.com/"},{name:"网易云",cover:"",url:"http://music.163.com/"}]}},{group:"VIP地址解析",channel:{JSON:[]}},{group:"帧截图",channel:{JSON:[]}},{group:"格式转换",channel:{JSON:[]}}],menu=[{name:"<",link:"application",status:""},{name:"办公",sublink:"oa",status:"active"},{name:"娱乐",sublink:"entertainment",status:""},{name:"开发者",sublink:"developer",status:""},{name:"设计师",sublink:"designer",status:""},{name:"学术科研",sublink:"academic",status:""},{name:"律师",sublink:"lawyer",status:""},{name:"工程师",sublink:"engineer",status:""},{name:"摄影师",sublink:"photographer",status:""},{name:"新媒体",sublink:"media",status:""},{name:"运维",sublink:"devOps",status:""}],dataSource={oa,photographer,engineer,media,developer,lawyer,devOps,entertainment,designer,academic};for(const n of menu)!dataSource[n.sublink]&&(dataSource[n.sublink]=[]);let path="/application/nav";menuList[path]=menu;const defaultMenuName=menu[1].name,datasource=ref(dataSource),dataset=ref(dataSource[defaultMenuName]),_sfc_main$9=defineComponent({__name:"index",setup(n){logoItem.setTitle("MPBugN"),logoItem.setSubTitle("时空葫芦.导航");const e=(r=currentPathSearch.obj.go)=>{r&&(dataset.value=datasource.value[r]||[],console.log("!!!currentPathSearch",{name:r,currentPathSearch,datasource:datasource.value,dataset:dataset.value}),activeGroup.value=0,menuName.value=r)};watch(()=>currentPathSearch.obj.go,(r,s)=>{console.log("watch:pathSearch",{cur:r,pre:s}),e(r)});const t=()=>{const r=menu$2.getActive();console.log("!!!checkSearchPath",{m:r,currentPathSearch}),!currentPathSearch.obj.go&&r.sublink&&(currentPathSearch.obj.go=r.sublink,e(),updatePathSearch())};return onMounted(()=>{nextTick(()=>{t()})}),(r,s)=>(openBlock(),createBlock(Wrapper,null,{container:withCtx(()=>[createVNode(GridBox,{dataset:unref(dataset),page:"software"},null,8,["dataset"])]),_:1}))}}),routes$1={"/":Application,"/favour":_sfc_main$m,"/signal":Signal,"/network":_sfc_main$p,"/setting":_sfc_main$o,"/application":Application,"/application/tv":_sfc_main$e,"/application/ktv":_sfc_main$d,"/application/tools":_sfc_main$b,"/application/software":_sfc_main$a,"/application/nav":_sfc_main$9},currentPath=ref(window.location.hash),currentPathSearch=reactive({path:"",search:"",array:[],obj:{}});window.addEventListener("hashchange",()=>{updateContent()});const updateContent=()=>{currentPath.value=window.location.hash;let n=parsePath(currentPath==null?void 0:currentPath.value),e=parsePathSearch(currentPath==null?void 0:currentPath.value);nextTick(()=>{let t=menuList[n]||menuList["/"];e&&t.map(r=>r.status=r.name!="<"&&(n.includes(r.link)||e.includes(r.sublink))?"active":""),menu$2.setLink(n),menu$2.update(),menu$2.setMenu(t),console.log("hashchange",currentPath.value,{path:n,pathSearch:e,currentView,newMenu:t,menuList})})},parsePathSearch=(n="")=>{let e="";try{e=n.match(/\?([\s\S]*)/i)[1]}catch{}try{currentPathSearch.path=window.location.hash.match(/([\s\S]*)\?/i)[1]+"?"}catch{}currentPathSearch.search=e;let t=e.split("&");return currentPathSearch.array=t,currentPathSearch.obj=t.reduce((r,s)=>{let[a,...i]=s.split("=");return a&&(r[a]=i.join()),r},{}),console.log("currentPathSearch",{currentPathSearch}),e},addPathSearch=(n="",e="")=>{n&&(currentPathSearch.obj={...currentPathSearch.obj,[n]:e}),updatePathSearch()},updatePathSearch=()=>{let n=window.location.hash.match(/([\s\S]*)\?/i),e=n?n[1]:window.location.hash;e=e+"?",currentPathSearch.path=e;let t=[];for(const[r,s]of Object.entries(currentPathSearch.obj))console.log(`${r}: ${s}`),t.push(`${r}=${s}`);e+=t.join("&"),window.location.hash=e},parsePath=(n="")=>{let e="";try{e=n.match(/#([\s\S]*?)$/i)[1]}catch{}try{e=n.match(/#([\s\S]*?)(\?)/i)[1]}catch{}return console.log("parsePath",{path:n,result:e}),e||"/"},currentView=computed(()=>routes$1[parsePath(currentPath==null?void 0:currentPath.value)]||Application),_hoisted_1$6=["onClick","tabindex"],_sfc_main$8=defineComponent({__name:"Menu",setup(n){const e=ref(null),t=ref(null),r=()=>{let l=t.value,c=Math.floor(Math.random()*10+5)*.1;setTransition(l,`transform ${c}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${c}s`),setPosition(l,{x:0,y:0},"perspective(400px) rotatex(0deg) scaleX(1)"),setOpacity(l,1)},s=()=>{let l=t.value,c=Math.floor(Math.random()*20+10)*.1;setTransition(l,`transform ${c}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${c/2}s`);let d=l.offsetWidth;return setPosition(l,{x:-d,y:0}),setOpacity(l,0),c},a=(l=null)=>{if(menu$2.link==parsePath(window.location.hash)&&(l==null||l.name!="<"))return 0;let c=s();return setTimeout(()=>{r()},c*1e3),c},i=l=>{let c=a(l);setTimeout(()=>{menu$2.list.map(d=>{d.status=d.name==l.name?"active":""}),l.sublink&&window.open("#"+menu$2.link+"?go="+l.sublink,"_self"),l.link&&menu$2.setLink(l.link),l.link&&window.open("#/"+l.link,"_self")},c*1e3)},o=()=>{var c;const l=(c=t.value)==null?void 0:c.querySelector("li.active");l!=null&&l.focus&&(l==null||l.focus())},u=()=>{var f;const l=(f=t.value)==null?void 0:f.querySelector("li.active");if(!l)return;const{left:c}=l.getBoundingClientRect(),{width:d}=e.value.getBoundingClientRect();e.value.scrollTo({left:c-d,behavior:"smooth"}),setTimeout(()=>{o()},1e3)};return onMounted(()=>{menu$2.open=r,menu$2.close=s,menu$2.update=a,updateContent(),nextTick(()=>{setTimeout(()=>{u()},1e3)})}),(l,c)=>(openBlock(),createElementBlock("div",{class:"menu",ref_key:"menuRef",ref:e},[createBaseVNode("ul",{ref_key:"menuRef_ul",ref:t},[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(unref(menu$2).list,(d,f)=>(openBlock(),createElementBlock("li",{onClick:g=>i(d),key:d.name,tabindex:f+1,class:normalizeClass({active:d.status})},toDisplayString(d.name),11,_hoisted_1$6))),128))],512)],512))}}),Menu_vue_vue_type_style_index_0_scoped_2c1dcbb9_lang="",Menu=_export_sfc(_sfc_main$8,[["__scopeId","data-v-2c1dcbb9"]]),ToolsItem_vue_vue_type_style_index_0_scoped_7a96c7e9_lang="",_sfc_main$7={},_hoisted_1$5={class:"item"};function _sfc_render(n,e){return openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("i",null,[renderSlot(n.$slots,"icon",{},void 0,!0)])])}const ToolsItem=_export_sfc(_sfc_main$7,[["render",_sfc_render],["__scopeId","data-v-7a96c7e9"]]),_withScopeId$1=n=>(pushScopeId("data-v-93c0e9ef"),n=n(),popScopeId(),n),_hoisted_1$4={class:"tools"},_hoisted_2$3=_withScopeId$1(()=>createBaseVNode("i",{class:"fa fa-search fa-3","aria-hidden":"true"},null,-1)),_hoisted_3$2=_withScopeId$1(()=>createBaseVNode("i",{class:"fa fa-cog fa-3","aria-hidden":"true"},null,-1)),_hoisted_4$1=_withScopeId$1(()=>createBaseVNode("i",{class:"fa fa-wifi fa-3","aria-hidden":"true"},null,-1)),_sfc_main$6=defineComponent({__name:"Tools",setup(n){const e=()=>{$dialog.showDialog(),$dialog.setCloseSec(10)},t=()=>{$dialog.showDialog()},r=()=>{$dialog.hideDialog()};return(s,a)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createVNode(ToolsItem,{onClick:t},{icon:withCtx(()=>[_hoisted_2$3]),_:1}),createVNode(ToolsItem,{onClick:r},{icon:withCtx(()=>[_hoisted_3$2]),_:1}),createVNode(ToolsItem,{onClick:e},{icon:withCtx(()=>[_hoisted_4$1]),_:1})]))}}),Tools_vue_vue_type_style_index_0_scoped_93c0e9ef_lang="",Tools=_export_sfc(_sfc_main$6,[["__scopeId","data-v-93c0e9ef"]]),_hoisted_1$3={class:"timedate"},_sfc_main$5=defineComponent({__name:"DateTime",setup(n){const e=ref(new Date().toLocaleDateString()),t=ref(new Date().toLocaleTimeString()),r=setInterval(()=>{e.value=new Date().toLocaleDateString(),t.value=new Date().toLocaleTimeString()},1e3);return onMounted(()=>{}),onUnmounted(()=>{clearInterval(r)}),(s,a)=>(openBlock(),createElementBlock("div",_hoisted_1$3,toDisplayString(t.value),1))}}),DateTime_vue_vue_type_style_index_0_scoped_a78c60c4_lang="",DateTime=_export_sfc(_sfc_main$5,[["__scopeId","data-v-a78c60c4"]]),_hoisted_1$2={class:"wrapper"},_hoisted_2$2={class:"left-container"},_hoisted_3$1={class:"right-container"},_sfc_main$4=defineComponent({__name:"index",setup(n){return(e,t)=>(openBlock(),createElementBlock("header",null,[createBaseVNode("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createVNode(Logo,{title:unref(logoItem).title,subtitle:unref(logoItem).subtitle},null,8,["title","subtitle"]),createVNode(Menu,{class:"header-menu"})]),createBaseVNode("div",_hoisted_3$1,[createVNode(Tools,{class:"tools"}),createVNode(DateTime,{class:"datetime"})])])]))}}),index_vue_vue_type_style_index_0_scoped_6764c10d_lang="",Header=_export_sfc(_sfc_main$4,[["__scopeId","data-v-6764c10d"]]),_sfc_main$3=defineComponent({__name:"index",setup(n){return(e,t)=>(openBlock(),createBlock(resolveDynamicComponent(unref(currentView))))}}),_hoisted_1$1={class:"dialog-header"},_hoisted_2$1={class:"dialog-title"},_hoisted_3={class:"dialog-tools"},_hoisted_4={class:"dialog-body"},_hoisted_5={key:0,tabindex:"-1",class:"dialog-footer"},_sfc_main$2=defineComponent({__name:"index",props:{title:null},setup(n){const e=ref(null),t=()=>{let u=e.value;setDomOnCenter(u);let l=Math.floor(Math.random()*20+10)*.1;setTransition(u,`transform ${l}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${l}s`),setPosition(u,{x:0,y:0},"perspective(400px) rotatex(0deg) scaleX(1)"),setOpacity(u,1)},r=()=>{let u=e.value;if(!$dialog.show){let c=Math.floor(Math.random()*20+10)*.1;setTransition(u,`transform ${c}s cubic-bezier(.64,-0.74,.2,1.55), opacity ${c}s`)}let l=window.screen.availHeight;setPosition(u,{x:0,y:-l},"perspective(400px) rotatex(90deg) scaleX(0)"),setOpacity(u,0)},s=()=>{setTransition(e.value,""),r()},a=()=>{s(),setTimeout(()=>{t()},1e3)},i=computed(()=>$dialog.show);watch(i,async(u,l)=>{!$dialog.show&&r(),$dialog.show&&t()});const o=()=>{window.addEventListener("resize",()=>{$dialog.show&&setDomOnCenter(e.value)})};return onMounted(()=>{nextTick(()=>{s(),o(),$dialog.show&&a()})}),(u,l)=>(openBlock(),createElementBlock("div",{ref_key:"dialog",ref:e,class:"dialog"},[createBaseVNode("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("i",null,[renderSlot(u.$slots,"icon",{},void 0,!0)]),createBaseVNode("span",null,toDisplayString(n.title),1)]),createBaseVNode("div",_hoisted_3,[renderSlot(u.$slots,"tools",{},void 0,!0)])]),createBaseVNode("div",_hoisted_4,[renderSlot(u.$slots,"body",{},void 0,!0)]),unref($dialog).showFooter?(openBlock(),createElementBlock("div",_hoisted_5,[renderSlot(u.$slots,"footer",{},void 0,!0)])):createCommentVNode("",!0)],512))}}),index_vue_vue_type_style_index_0_scoped_c78b8255_lang="",Dialog=_export_sfc(_sfc_main$2,[["__scopeId","data-v-c78b8255"]]),_withScopeId=n=>(pushScopeId("data-v-da08b300"),n=n(),popScopeId(),n),_hoisted_1=_withScopeId(()=>createBaseVNode("i",{class:"fa fa-info-circle fa-2x","aria-hidden":"true"},null,-1)),_hoisted_2={key:0,style:{margin:"0 10px",color:"var(--color-text-green)"}},_sfc_main$1=defineComponent({__name:"info",setup(n){ref(null);const e=ref(null);$dialog.hideDialog(),$dialog.title="欢迎",$dialog.body="亲，很高兴你能来这溜个湾，体验一下时空魔法葫芦电视。这里有好看的电影电视节目。我们可以用遥控器上下左右键切换选项，按回车选中。";const t=()=>{var s;e.value&&((s=e.value)==null||s.focus())},r=computed(()=>$dialog.autoCloseSec);return watch(r,async(s,a)=>{!s&&$dialog.show&&($dialog.show=!1,e.value.focus())}),onMounted(()=>{nextTick(()=>{setTimeout(()=>{$dialog.showDialog(),$dialog.show&&t(),$dialog.show&&$dialog.setCloseSec(1)},1e3)})}),(s,a)=>(openBlock(),createBlock(Dialog,{show:unref($dialog).show,title:unref($dialog).title,onMouseenter:t},{icon:withCtx(()=>[_hoisted_1]),tools:withCtx(()=>[createBaseVNode("span",{class:"button no-border",onClick:a[0]||(a[0]=i=>unref($dialog).show=!1),tabindex:"-1"},"X")]),body:withCtx(()=>[createTextVNode(toDisplayString(unref($dialog).body)+" ",1),unref(r)>0?(openBlock(),createElementBlock("span",_hoisted_2,"（ "+toDisplayString(unref(r))+"秒后关闭 ）",1)):createCommentVNode("",!0)]),footer:withCtx(()=>[createBaseVNode("button",{ref_key:"okBtn",ref:e,class:"button",onClick:a[1]||(a[1]=i=>unref($dialog).show=!1),tabindex:"-1"},"OK",512)]),_:1},8,["show","title"]))}}),info_vue_vue_type_style_index_0_scoped_da08b300_lang="",DialogInfo=_export_sfc(_sfc_main$1,[["__scopeId","data-v-da08b300"]]),_sfc_main=defineComponent({__name:"App",setup(n){return(e,t)=>(openBlock(),createElementBlock(Fragment$1,null,[createVNode(DialogInfo),createVNode(Header),createVNode(_sfc_main$3)],64))}});/*!
  * vue-router v4.2.0
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof window<"u";function isESModule(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const assign=Object.assign;function applyToParams(n,e){const t={};for(const r in e){const s=e[r];t[r]=isArray(s)?s.map(n):n(s)}return t}const noop=()=>{},isArray=Array.isArray,TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=n=>n.replace(TRAILING_SLASH_RE,"");function parseURL(n,e,t="/"){let r,s={},a="",i="";const o=e.indexOf("#");let u=e.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(r=e.slice(0,u),a=e.slice(u+1,o>-1?o:e.length),s=n(a)),o>-1&&(r=r||e.slice(0,o),i=e.slice(o,e.length)),r=resolveRelativePath(r??e,t),{fullPath:r+(a&&"?")+a+i,path:r,query:s,hash:i}}function stringifyURL(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function stripBase(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function isSameRouteLocation(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&isSameRouteRecord(e.matched[r],t.matched[s])&&isSameRouteLocationParams(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function isSameRouteRecord(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function isSameRouteLocationParams(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!isSameRouteLocationParamsValue(n[t],e[t]))return!1;return!0}function isSameRouteLocationParamsValue(n,e){return isArray(n)?isEquivalentArray(n,e):isArray(e)?isEquivalentArray(e,n):n===e}function isEquivalentArray(n,e){return isArray(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function resolveRelativePath(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let a=t.length-1,i,o;for(i=0;i<r.length;i++)if(o=r[i],o!==".")if(o==="..")a>1&&a--;else break;return t.slice(0,a).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}var NavigationType;(function(n){n.pop="pop",n.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(n){n.back="back",n.forward="forward",n.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(n){if(!n)if(isBrowser){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),removeTrailingSlash(n)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(n,e){return n.replace(BEFORE_HASH_RE,"#")+e}function getElementPosition(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const computeScrollPosition=()=>({left:window.pageXOffset,top:window.pageYOffset});function scrollToPosition(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=getElementPosition(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function getScrollKey(n,e){return(history.state?history.state.position-e:-1)+n}const scrollPositions=new Map;function saveScrollPosition(n,e){scrollPositions.set(n,e)}function getSavedScrollPosition(n){const e=scrollPositions.get(n);return scrollPositions.delete(n),e}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(n,e){const{pathname:t,search:r,hash:s}=e,a=n.indexOf("#");if(a>-1){let o=s.includes(n.slice(a))?n.slice(a).length:1,u=s.slice(o);return u[0]!=="/"&&(u="/"+u),stripBase(u,"")}return stripBase(t,n)+r+s}function useHistoryListeners(n,e,t,r){let s=[],a=[],i=null;const o=({state:f})=>{const g=createCurrentLocation(n,location),m=t.value,v=e.value;let y=0;if(f){if(t.value=g,e.value=f,i&&i===m){i=null;return}y=v?f.position-v.position:0}else r(g);s.forEach(E=>{E(t.value,m,{delta:y,type:NavigationType.pop,direction:y?y>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function u(){i=t.value}function l(f){s.push(f);const g=()=>{const m=s.indexOf(f);m>-1&&s.splice(m,1)};return a.push(g),g}function c(){const{history:f}=window;f.state&&f.replaceState(assign({},f.state,{scroll:computeScrollPosition()}),"")}function d(){for(const f of a)f();a=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:u,listen:l,destroy:d}}function buildState(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?computeScrollPosition():null}}function useHistoryStateNavigation(n){const{history:e,location:t}=window,r={value:createCurrentLocation(n,t)},s={value:e.state};s.value||a(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function a(u,l,c){const d=n.indexOf("#"),f=d>-1?(t.host&&document.querySelector("base")?n:n.slice(d))+u:createBaseLocation()+n+u;try{e[c?"replaceState":"pushState"](l,"",f),s.value=l}catch(g){console.error(g),t[c?"replace":"assign"](f)}}function i(u,l){const c=assign({},e.state,buildState(s.value.back,u,s.value.forward,!0),l,{position:s.value.position});a(u,c,!0),r.value=u}function o(u,l){const c=assign({},s.value,e.state,{forward:u,scroll:computeScrollPosition()});a(c.current,c,!0);const d=assign({},buildState(r.value,u,null),{position:c.position+1},l);a(u,d,!1),r.value=u}return{location:r,state:s,push:o,replace:i}}function createWebHistory(n){n=normalizeBase(n);const e=useHistoryStateNavigation(n),t=useHistoryListeners(n,e.state,e.location,e.replace);function r(a,i=!0){i||t.pauseListeners(),history.go(a)}const s=assign({location:"",base:n,go:r,createHref:createHref.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function createWebHashHistory(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),createWebHistory(n)}function isRouteLocation(n){return typeof n=="string"||n&&typeof n=="object"}function isRouteName(n){return typeof n=="string"||typeof n=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(n,e){return assign(new Error,{type:n,[NavigationFailureSymbol]:!0},e)}function isNavigationFailure(n,e){return n instanceof Error&&NavigationFailureSymbol in n&&(e==null||!!(n.type&e))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(n,e){const t=assign({},BASE_PATH_PARSER_OPTIONS,e),r=[];let s=t.start?"^":"";const a=[];for(const l of n){const c=l.length?[]:[90];t.strict&&!l.length&&(s+="/");for(let d=0;d<l.length;d++){const f=l[d];let g=40+(t.sensitive?.25:0);if(f.type===0)d||(s+="/"),s+=f.value.replace(REGEX_CHARS_RE,"\\$&"),g+=40;else if(f.type===1){const{value:m,repeatable:v,optional:y,regexp:E}=f;a.push({name:m,repeatable:v,optional:y});const _=E||BASE_PARAM_PATTERN;if(_!==BASE_PARAM_PATTERN){g+=10;try{new RegExp(`(${_})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${m}" (${_}): `+S.message)}}let T=v?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;d||(T=y&&l.length<2?`(?:/${T})`:"/"+T),y&&(T+="?"),s+=T,g+=20,y&&(g+=-8),v&&(g+=-20),_===".*"&&(g+=-50)}c.push(g)}r.push(c)}if(t.strict&&t.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&(s+="(?:/|$)");const i=new RegExp(s,t.sensitive?"":"i");function o(l){const c=l.match(i),d={};if(!c)return null;for(let f=1;f<c.length;f++){const g=c[f]||"",m=a[f-1];d[m.name]=g&&m.repeatable?g.split("/"):g}return d}function u(l){let c="",d=!1;for(const f of n){(!d||!c.endsWith("/"))&&(c+="/"),d=!1;for(const g of f)if(g.type===0)c+=g.value;else if(g.type===1){const{value:m,repeatable:v,optional:y}=g,E=m in l?l[m]:"";if(isArray(E)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const _=isArray(E)?E.join("/"):E;if(!_)if(y)f.length<2&&(c.endsWith("/")?c=c.slice(0,-1):d=!0);else throw new Error(`Missing required param "${m}"`);c+=_}}return c||"/"}return{re:i,score:r,keys:a,parse:o,stringify:u}}function compareScoreArray(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function comparePathParserScore(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const a=compareScoreArray(r[t],s[t]);if(a)return a;t++}if(Math.abs(s.length-r.length)===1){if(isLastScoreNegative(r))return 1;if(isLastScoreNegative(s))return-1}return s.length-r.length}function isLastScoreNegative(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(n){if(!n)return[[]];if(n==="/")return[[ROOT_TOKEN]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(g){throw new Error(`ERR (${t})/"${l}": ${g}`)}let t=0,r=t;const s=[];let a;function i(){a&&s.push(a),a=[]}let o=0,u,l="",c="";function d(){l&&(t===0?a.push({type:0,value:l}):t===1||t===2||t===3?(a.length>1&&(u==="*"||u==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):e("Invalid state to consume buffer"),l="")}function f(){l+=u}for(;o<n.length;){if(u=n[o++],u==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:u==="/"?(l&&d(),i()):u===":"?(d(),t=1):f();break;case 4:f(),t=r;break;case 1:u==="("?t=2:VALID_PARAM_RE.test(u)?f():(d(),t=0,u!=="*"&&u!=="?"&&u!=="+"&&o--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:t=3:c+=u;break;case 3:d(),t=0,u!=="*"&&u!=="?"&&u!=="+"&&o--,c="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${l}"`),d(),i(),s}function createRouteRecordMatcher(n,e,t){const r=tokensToParser(tokenizePath(n.path),t),s=assign(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function createRouterMatcher(n,e){const t=[],r=new Map;e=mergeOptions({strict:!1,end:!0,sensitive:!1},e);function s(c){return r.get(c)}function a(c,d,f){const g=!f,m=normalizeRouteRecord(c);m.aliasOf=f&&f.record;const v=mergeOptions(e,c),y=[m];if("alias"in c){const T=typeof c.alias=="string"?[c.alias]:c.alias;for(const S of T)y.push(assign({},m,{components:f?f.record.components:m.components,path:S,aliasOf:f?f.record:m}))}let E,_;for(const T of y){const{path:S}=T;if(d&&S[0]!=="/"){const x=d.record.path,b=x[x.length-1]==="/"?"":"/";T.path=d.record.path+(S&&b+S)}if(E=createRouteRecordMatcher(T,d,v),f?f.alias.push(E):(_=_||E,_!==E&&_.alias.push(E),g&&c.name&&!isAliasRecord(E)&&i(c.name)),m.children){const x=m.children;for(let b=0;b<x.length;b++)a(x[b],E,f&&f.children[b])}f=f||E,(E.record.components&&Object.keys(E.record.components).length||E.record.name||E.record.redirect)&&u(E)}return _?()=>{i(_)}:noop}function i(c){if(isRouteName(c)){const d=r.get(c);d&&(r.delete(c),t.splice(t.indexOf(d),1),d.children.forEach(i),d.alias.forEach(i))}else{const d=t.indexOf(c);d>-1&&(t.splice(d,1),c.record.name&&r.delete(c.record.name),c.children.forEach(i),c.alias.forEach(i))}}function o(){return t}function u(c){let d=0;for(;d<t.length&&comparePathParserScore(c,t[d])>=0&&(c.record.path!==t[d].record.path||!isRecordChildOf(c,t[d]));)d++;t.splice(d,0,c),c.record.name&&!isAliasRecord(c)&&r.set(c.record.name,c)}function l(c,d){let f,g={},m,v;if("name"in c&&c.name){if(f=r.get(c.name),!f)throw createRouterError(1,{location:c});v=f.record.name,g=assign(paramsFromLocation(d.params,f.keys.filter(_=>!_.optional).map(_=>_.name)),c.params&&paramsFromLocation(c.params,f.keys.map(_=>_.name))),m=f.stringify(g)}else if("path"in c)m=c.path,f=t.find(_=>_.re.test(m)),f&&(g=f.parse(m),v=f.record.name);else{if(f=d.name?r.get(d.name):t.find(_=>_.re.test(d.path)),!f)throw createRouterError(1,{location:c,currentLocation:d});v=f.record.name,g=assign({},d.params,c.params),m=f.stringify(g)}const y=[];let E=f;for(;E;)y.unshift(E.record),E=E.parent;return{name:v,path:m,params:g,matched:y,meta:mergeMetaFields(y)}}return n.forEach(c=>a(c)),{addRoute:a,resolve:l,removeRoute:i,getRoutes:o,getRecordMatcher:s}}function paramsFromLocation(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function normalizeRouteRecord(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:normalizeRecordProps(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function normalizeRecordProps(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="boolean"?t:t[r];return e}function isAliasRecord(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function mergeMetaFields(n){return n.reduce((e,t)=>assign(e,t.meta),{})}function mergeOptions(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function isRecordChildOf(n,e){return e.children.some(t=>t===n||isRecordChildOf(n,t))}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(n){return encodeURI(""+n).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(n){return commonEncode(n).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(n){return commonEncode(n).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(n){return encodeQueryValue(n).replace(EQUAL_RE,"%3D")}function encodePath(n){return commonEncode(n).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(n){return n==null?"":encodePath(n).replace(SLASH_RE,"%2F")}function decode(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function parseQuery(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const a=r[s].replace(PLUS_RE," "),i=a.indexOf("="),o=decode(i<0?a:a.slice(0,i)),u=i<0?null:decode(a.slice(i+1));if(o in e){let l=e[o];isArray(l)||(l=e[o]=[l]),l.push(u)}else e[o]=u}return e}function stringifyQuery(n){let e="";for(let t in n){const r=n[t];if(t=encodeQueryKey(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(isArray(r)?r.map(a=>a&&encodeQueryValue(a)):[r&&encodeQueryValue(r)]).forEach(a=>{a!==void 0&&(e+=(e.length?"&":"")+t,a!=null&&(e+="="+a))})}return e}function normalizeQuery(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=isArray(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n,reset:t}}function guardToPromiseFn(n,e,t,r,s){const a=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((i,o)=>{const u=d=>{d===!1?o(createRouterError(4,{from:t,to:e})):d instanceof Error?o(d):isRouteLocation(d)?o(createRouterError(2,{from:e,to:d})):(a&&r.enterCallbacks[s]===a&&typeof d=="function"&&a.push(d),i())},l=n.call(r&&r.instances[s],e,t,u);let c=Promise.resolve(l);n.length<3&&(c=c.then(u)),c.catch(d=>o(d))})}function extractComponentsGuards(n,e,t,r){const s=[];for(const a of n)for(const i in a.components){let o=a.components[i];if(!(e!=="beforeRouteEnter"&&!a.instances[i]))if(isRouteComponent(o)){const l=(o.__vccOpts||o)[e];l&&s.push(guardToPromiseFn(l,t,r,a,i))}else{let u=o();s.push(()=>u.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${i}" at "${a.path}"`));const c=isESModule(l)?l.default:l;a.components[i]=c;const f=(c.__vccOpts||c)[e];return f&&guardToPromiseFn(f,t,r,a,i)()}))}}return s}function isRouteComponent(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function useLink(n){const e=inject(routerKey),t=inject(routeLocationKey),r=computed(()=>e.resolve(unref(n.to))),s=computed(()=>{const{matched:u}=r.value,{length:l}=u,c=u[l-1],d=t.matched;if(!c||!d.length)return-1;const f=d.findIndex(isSameRouteRecord.bind(null,c));if(f>-1)return f;const g=getOriginalPath(u[l-2]);return l>1&&getOriginalPath(c)===g&&d[d.length-1].path!==g?d.findIndex(isSameRouteRecord.bind(null,u[l-2])):f}),a=computed(()=>s.value>-1&&includesParams(t.params,r.value.params)),i=computed(()=>s.value>-1&&s.value===t.matched.length-1&&isSameRouteLocationParams(t.params,r.value.params));function o(u={}){return guardEvent(u)?e[unref(n.replace)?"replace":"push"](unref(n.to)).catch(noop):Promise.resolve()}return{route:r,href:computed(()=>r.value.href),isActive:a,isExactActive:i,navigate:o}}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(n,{slots:e}){const t=reactive(useLink(n)),{options:r}=inject(routerKey),s=computed(()=>({[getLinkClass(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[getLinkClass(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const a=e.default&&e.default(t);return n.custom?a:h("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},a)}}}),RouterLink=RouterLinkImpl;function guardEvent(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function includesParams(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!isArray(s)||s.length!==r.length||r.some((a,i)=>a!==s[i]))return!1}return!0}function getOriginalPath(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const getLinkClass=(n,e,t)=>n??e??t,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=inject(routerViewLocationKey),s=computed(()=>n.route||r.value),a=inject(viewDepthKey,0),i=computed(()=>{let l=unref(a);const{matched:c}=s.value;let d;for(;(d=c[l])&&!d.components;)l++;return l}),o=computed(()=>s.value.matched[i.value]);provide(viewDepthKey,computed(()=>i.value+1)),provide(matchedRouteKey,o),provide(routerViewLocationKey,s);const u=ref();return watch(()=>[u.value,o.value,n.name],([l,c,d],[f,g,m])=>{c&&(c.instances[d]=l,g&&g!==c&&l&&l===f&&(c.leaveGuards.size||(c.leaveGuards=g.leaveGuards),c.updateGuards.size||(c.updateGuards=g.updateGuards))),l&&c&&(!g||!isSameRouteRecord(c,g)||!f)&&(c.enterCallbacks[d]||[]).forEach(v=>v(l))},{flush:"post"}),()=>{const l=s.value,c=n.name,d=o.value,f=d&&d.components[c];if(!f)return normalizeSlot(t.default,{Component:f,route:l});const g=d.props[c],m=g?g===!0?l.params:typeof g=="function"?g(l):g:null,y=h(f,assign({},m,e,{onVnodeUnmounted:E=>{E.component.isUnmounted&&(d.instances[c]=null)},ref:u}));return normalizeSlot(t.default,{Component:y,route:l})||y}}});function normalizeSlot(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const RouterView=RouterViewImpl;function createRouter(n){const e=createRouterMatcher(n.routes,n),t=n.parseQuery||parseQuery,r=n.stringifyQuery||stringifyQuery,s=n.history,a=useCallbacks(),i=useCallbacks(),o=useCallbacks(),u=shallowRef(START_LOCATION_NORMALIZED);let l=START_LOCATION_NORMALIZED;isBrowser&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=applyToParams.bind(null,B=>""+B),d=applyToParams.bind(null,encodeParam),f=applyToParams.bind(null,decode);function g(B,V){let X,ne;return isRouteName(B)?(X=e.getRecordMatcher(B),ne=V):ne=B,e.addRoute(ne,X)}function m(B){const V=e.getRecordMatcher(B);V&&e.removeRoute(V)}function v(){return e.getRoutes().map(B=>B.record)}function y(B){return!!e.getRecordMatcher(B)}function E(B,V){if(V=assign({},V||u.value),typeof B=="string"){const M=parseURL(t,B,V.path),Y=e.resolve({path:M.path},V),Z=s.createHref(M.fullPath);return assign(M,Y,{params:f(Y.params),hash:decode(M.hash),redirectedFrom:void 0,href:Z})}let X;if("path"in B)X=assign({},B,{path:parseURL(t,B.path,V.path).path});else{const M=assign({},B.params);for(const Y in M)M[Y]==null&&delete M[Y];X=assign({},B,{params:d(M)}),V.params=d(V.params)}const ne=e.resolve(X,V),ce=B.hash||"";ne.params=c(f(ne.params));const k=stringifyURL(r,assign({},B,{hash:encodeHash(ce),path:ne.path})),P=s.createHref(k);return assign({fullPath:k,hash:ce,query:r===stringifyQuery?normalizeQuery(B.query):B.query||{}},ne,{redirectedFrom:void 0,href:P})}function _(B){return typeof B=="string"?parseURL(t,B,u.value.path):assign({},B)}function T(B,V){if(l!==B)return createRouterError(8,{from:V,to:B})}function S(B){return A(B)}function x(B){return S(assign(_(B),{replace:!0}))}function b(B){const V=B.matched[B.matched.length-1];if(V&&V.redirect){const{redirect:X}=V;let ne=typeof X=="function"?X(B):X;return typeof ne=="string"&&(ne=ne.includes("?")||ne.includes("#")?ne=_(ne):{path:ne},ne.params={}),assign({query:B.query,hash:B.hash,params:"path"in ne?{}:B.params},ne)}}function A(B,V){const X=l=E(B),ne=u.value,ce=B.state,k=B.force,P=B.replace===!0,M=b(X);if(M)return A(assign(_(M),{state:typeof M=="object"?assign({},ce,M.state):ce,force:k,replace:P}),V||X);const Y=X;Y.redirectedFrom=V;let Z;return!k&&isSameRouteLocation(r,ne,X)&&(Z=createRouterError(16,{to:Y,from:ne}),U(ne,ne,!0,!1)),(Z?Promise.resolve(Z):w(Y,ne)).catch(ee=>isNavigationFailure(ee)?isNavigationFailure(ee,2)?ee:Q(ee):j(ee,Y,ne)).then(ee=>{if(ee){if(isNavigationFailure(ee,2))return A(assign({replace:P},_(ee.to),{state:typeof ee.to=="object"?assign({},ce,ee.to.state):ce,force:k}),V||Y)}else ee=L(Y,ne,!0,P,ce);return I(Y,ne,ee),ee})}function R(B,V){const X=T(B,V);return X?Promise.reject(X):Promise.resolve()}function C(B){const V=G.values().next().value;return V&&typeof V.runWithContext=="function"?V.runWithContext(B):B()}function w(B,V){let X;const[ne,ce,k]=extractChangingRecords(B,V);X=extractComponentsGuards(ne.reverse(),"beforeRouteLeave",B,V);for(const M of ne)M.leaveGuards.forEach(Y=>{X.push(guardToPromiseFn(Y,B,V))});const P=R.bind(null,B,V);return X.push(P),W(X).then(()=>{X=[];for(const M of a.list())X.push(guardToPromiseFn(M,B,V));return X.push(P),W(X)}).then(()=>{X=extractComponentsGuards(ce,"beforeRouteUpdate",B,V);for(const M of ce)M.updateGuards.forEach(Y=>{X.push(guardToPromiseFn(Y,B,V))});return X.push(P),W(X)}).then(()=>{X=[];for(const M of B.matched)if(M.beforeEnter&&!V.matched.includes(M))if(isArray(M.beforeEnter))for(const Y of M.beforeEnter)X.push(guardToPromiseFn(Y,B,V));else X.push(guardToPromiseFn(M.beforeEnter,B,V));return X.push(P),W(X)}).then(()=>(B.matched.forEach(M=>M.enterCallbacks={}),X=extractComponentsGuards(k,"beforeRouteEnter",B,V),X.push(P),W(X))).then(()=>{X=[];for(const M of i.list())X.push(guardToPromiseFn(M,B,V));return X.push(P),W(X)}).catch(M=>isNavigationFailure(M,8)?M:Promise.reject(M))}function I(B,V,X){for(const ne of o.list())C(()=>ne(B,V,X))}function L(B,V,X,ne,ce){const k=T(B,V);if(k)return k;const P=V===START_LOCATION_NORMALIZED,M=isBrowser?history.state:{};X&&(ne||P?s.replace(B.fullPath,assign({scroll:P&&M&&M.scroll},ce)):s.push(B.fullPath,ce)),u.value=B,U(B,V,X,P),Q()}let D;function O(){D||(D=s.listen((B,V,X)=>{if(!ae.listening)return;const ne=E(B),ce=b(ne);if(ce){A(assign(ce,{replace:!0}),ne).catch(noop);return}l=ne;const k=u.value;isBrowser&&saveScrollPosition(getScrollKey(k.fullPath,X.delta),computeScrollPosition()),w(ne,k).catch(P=>isNavigationFailure(P,12)?P:isNavigationFailure(P,2)?(A(P.to,ne).then(M=>{isNavigationFailure(M,20)&&!X.delta&&X.type===NavigationType.pop&&s.go(-1,!1)}).catch(noop),Promise.reject()):(X.delta&&s.go(-X.delta,!1),j(P,ne,k))).then(P=>{P=P||L(ne,k,!1),P&&(X.delta&&!isNavigationFailure(P,8)?s.go(-X.delta,!1):X.type===NavigationType.pop&&isNavigationFailure(P,20)&&s.go(-1,!1)),I(ne,k,P)}).catch(noop)}))}let N=useCallbacks(),F=useCallbacks(),H;function j(B,V,X){Q(B);const ne=F.list();return ne.length?ne.forEach(ce=>ce(B,V,X)):console.error(B),Promise.reject(B)}function q(){return H&&u.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((B,V)=>{N.add([B,V])})}function Q(B){return H||(H=!B,O(),N.list().forEach(([V,X])=>B?X(B):V()),N.reset()),B}function U(B,V,X,ne){const{scrollBehavior:ce}=n;if(!isBrowser||!ce)return Promise.resolve();const k=!X&&getSavedScrollPosition(getScrollKey(B.fullPath,0))||(ne||!X)&&history.state&&history.state.scroll||null;return nextTick().then(()=>ce(B,V,k)).then(P=>P&&scrollToPosition(P)).catch(P=>j(P,B,V))}const $=B=>s.go(B);let K;const G=new Set,ae={currentRoute:u,listening:!0,addRoute:g,removeRoute:m,hasRoute:y,getRoutes:v,resolve:E,options:n,push:S,replace:x,go:$,back:()=>$(-1),forward:()=>$(1),beforeEach:a.add,beforeResolve:i.add,afterEach:o.add,onError:F.add,isReady:q,install(B){const V=this;B.component("RouterLink",RouterLink),B.component("RouterView",RouterView),B.config.globalProperties.$router=V,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(u)}),isBrowser&&!K&&u.value===START_LOCATION_NORMALIZED&&(K=!0,S(s.location).catch(ce=>{}));const X={};for(const ce in START_LOCATION_NORMALIZED)X[ce]=computed(()=>u.value[ce]);B.provide(routerKey,V),B.provide(routeLocationKey,reactive(X)),B.provide(routerViewLocationKey,u);const ne=B.unmount;G.add(B),B.unmount=function(){G.delete(B),G.size<1&&(l=START_LOCATION_NORMALIZED,D&&D(),D=null,u.value=START_LOCATION_NORMALIZED,K=!1,H=!1),ne()}}};function W(B){return B.reduce((V,X)=>V.then(()=>C(X)),Promise.resolve())}return ae}function extractChangingRecords(n,e){const t=[],r=[],s=[],a=Math.max(e.matched.length,n.matched.length);for(let i=0;i<a;i++){const o=e.matched[i];o&&(n.matched.find(l=>isSameRouteRecord(l,o))?r.push(o):t.push(o));const u=n.matched[i];u&&(e.matched.find(l=>isSameRouteRecord(l,u))||s.push(u))}return[t,r,s]}const routes=[{path:"/",component:Application},{path:"/network",component:_sfc_main$p},{path:"/setting",component:_sfc_main$o}],router=createRouter({history:createWebHashHistory(),routes});createApp(_sfc_main).use(router).mount("#app");
